import{S as N,i as O,s as Q,L as R,c as S,m as T,t as q,a as B,d as F,G as U,f as V,F as X,g as c,h,A as G,j as i,z as C,k as v,l as u,o as W,q as Y,u as I,v as Z,n as y,y as J,p as P,b as x,e as ee,B as te,D as A,E as se}from"./index-YYc-gSi4.js";function D(o){let e,a,s,n;return{c(){e=c("br"),a=h(),s=c("strong"),n=G(o[2])},m(t,l){v(t,e,l),v(t,a,l),v(t,s,l),u(s,n)},p(t,l){l&4&&te(n,t[2])},d(t){t&&(y(e),y(a),y(s))}}}function ae(o){let e,a,s,n,t,l,g,d,b;return{c(){e=c("div"),a=c("label"),s=c("i"),t=h(),l=c("input"),i(s,"class","iconoir-lock"),i(a,"for",n=o[6]),i(a,"class","addon prefix"),l.required=!0,i(l,"type","password"),i(l,"id",g=o[6]),i(l,"placeholder","Password"),i(e,"class","field-group")},m(m,p){v(m,e,p),u(e,a),u(a,s),u(e,t),u(e,l),A(l,o[0]),d||(b=[I(se.call(null,a,{position:"left",text:"Password"})),W(l,"input",o[5])],d=!0)},p(m,p){p&64&&n!==(n=m[6])&&i(a,"for",n),p&64&&g!==(g=m[6])&&i(l,"id",g),p&1&&l.value!==m[0]&&A(l,m[0])},d(m){m&&y(e),d=!1,J(b)}}}function le(o){let e,a,s,n,t,l,g,d,b,m,p,H,_,M,E,w,k,L,j;s=new V({});let f=o[2]&&D(o);return p=new X({props:{class:"form-field form-field-lg",name:"password",$$slots:{default:[ae,({uniqueId:r})=>({6:r}),({uniqueId:r})=>r?64:0]},$$scope:{ctx:o}}}),{c(){e=c("div"),a=c("header"),S(s.$$.fragment),n=h(),t=c("form"),l=c("h4"),l.textContent=`${K}`,g=h(),d=c("p"),b=G(`Enter your password to confirm your new email:
                `),f&&f.c(),m=h(),S(p.$$.fragment),H=h(),_=c("button"),_.innerHTML='<span class="txt">Confirm email change</span>',M=h(),E=c("div"),w=c("a"),w.innerHTML='<div class="txt">Back to Login</div>',i(a,"class","block txt-center m-b-base"),i(l,"class","m-b-sm"),i(d,"class","m-b-sm"),i(_,"type","submit"),i(_,"class","btn btn-block btn-lg btn-primary"),C(_,"btn-disabled",o[1]),C(_,"btn-loading",o[1]),i(t,"class","panel txt-center"),i(w,"href","/login"),i(w,"class","fade link-prev"),i(E,"class","block txt-center m-t-base"),i(e,"class","wrapper wrapper-sm m-b-base entrance-top")},m(r,$){v(r,e,$),u(e,a),T(s,a,null),u(e,n),u(e,t),u(t,l),u(t,g),u(t,d),u(d,b),f&&f.m(d,null),u(t,m),T(p,t,null),u(t,H),u(t,_),u(e,M),u(e,E),u(E,w),k=!0,L||(j=[W(t,"submit",Y(o[3])),I(Z.call(null,w))],L=!0)},p(r,$){r[2]?f?f.p(r,$):(f=D(r),f.c(),f.m(d,null)):f&&(f.d(1),f=null);const z={};$&193&&(z.$$scope={dirty:$,ctx:r}),p.$set(z),(!k||$&2)&&C(_,"btn-disabled",r[1]),(!k||$&2)&&C(_,"btn-loading",r[1])},i(r){k||(q(s.$$.fragment,r),q(p.$$.fragment,r),k=!0)},o(r){B(s.$$.fragment,r),B(p.$$.fragment,r),k=!1},d(r){r&&y(e),F(s),f&&f.d(),F(p),L=!1,J(j)}}}function ne(o){let e,a;return e=new R({props:{fullpage:!0,header:!1,title:K,$$slots:{default:[le]},$$scope:{ctx:o}}}),{c(){S(e.$$.fragment)},m(s,n){T(e,s,n),a=!0},p(s,[n]){const t={};n&135&&(t.$$scope={dirty:n,ctx:s}),e.$set(t)},i(s){a||(q(e.$$.fragment,s),a=!0)},o(s){B(e.$$.fragment,s),a=!1},d(s){F(e,s)}}}const K="Email change";function oe(o,e,a){let s,{params:n}=e,t="",l=!1;async function g(){if(!l){a(1,l=!0);try{await P.collection("users").confirmEmailChange(n==null?void 0:n.token,t),await P.collection("users").authWithPassword(s,t),x("Successfully updated your email address."),ee("/login")}catch(b){P.error(b)}a(1,l=!1)}}function d(){t=this.value,a(0,t)}return o.$$set=b=>{"params"in b&&a(4,n=b.params)},o.$$.update=()=>{o.$$.dirty&16&&a(2,s=U(n==null?void 0:n.token).newEmail||"")},[t,l,s,g,n,d]}class ie extends N{constructor(e){super(),O(this,e,oe,ne,Q,{params:4})}}export{ie as default};
