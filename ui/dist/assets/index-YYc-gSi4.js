var Vd=Object.defineProperty;var zd=(n,e,t)=>e in n?Vd(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var Ks=(n,e,t)=>zd(n,typeof e!="symbol"?e+"":e,t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const l of s)if(l.type==="childList")for(const r of l.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&i(r)}).observe(document,{childList:!0,subtree:!0});function t(s){const l={};return s.integrity&&(l.integrity=s.integrity),s.referrerPolicy&&(l.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?l.credentials="include":s.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function i(s){if(s.ep)return;s.ep=!0;const l=t(s);fetch(s.href,l)}})();function Q(){}const Ji=n=>n;function Me(n,e){for(const t in e)n[t]=e[t];return n}function Lf(n){return n()}function hr(){return Object.create(null)}function pe(n){n.forEach(Lf)}function Qe(n){return typeof n=="function"}function he(n,e){return n!=n?e==e:n!==e||n&&typeof n=="object"||typeof n=="function"}let ls;function zn(n,e){return n===e?!0:(ls||(ls=document.createElement("a")),ls.href=e,n===ls.href)}function Bd(n){return Object.keys(n).length===0}function Nl(n,...e){if(n==null){for(const i of e)i(void 0);return Q}const t=n.subscribe(...e);return t.unsubscribe?()=>t.unsubscribe():t}function Bn(n){let e;return Nl(n,t=>e=t)(),e}function x(n,e,t){n.$$.on_destroy.push(Nl(e,t))}function st(n,e,t,i){if(n){const s=If(n,e,t,i);return n[0](s)}}function If(n,e,t,i){return n[1]&&i?Me(t.ctx.slice(),n[1](i(e))):t.ctx}function lt(n,e,t,i){if(n[2]&&i){const s=n[2](i(t));if(e.dirty===void 0)return s;if(typeof s=="object"){const l=[],r=Math.max(e.dirty.length,s.length);for(let o=0;o<r;o+=1)l[o]=e.dirty[o]|s[o];return l}return e.dirty|s}return e.dirty}function rt(n,e,t,i,s,l){if(s){const r=If(e,t,i,l);n.p(r,s)}}function ot(n){if(n.ctx.length>32){const e=[],t=n.ctx.length/32;for(let i=0;i<t;i++)e[i]=-1;return e}return-1}function Zt(n){const e={};for(const t in n)t[0]!=="$"&&(e[t]=n[t]);return e}function ut(n,e){const t={};e=new Set(e);for(const i in n)!e.has(i)&&i[0]!=="$"&&(t[i]=n[i]);return t}function _r(n){return n??""}function ve(n,e,t){return n.set(t),e}function ge(n){return n&&Qe(n.destroy)?n.destroy:Q}function gr(n){const e=typeof n=="string"&&n.match(/^\s*(-?[\d.]+)([^\s]*)\s*$/);return e?[parseFloat(e[1]),e[2]||"px"]:[n,"px"]}const Zd=["",!0,1,"true","contenteditable"],jf=typeof window<"u";let Ms=jf?()=>window.performance.now():()=>Date.now(),Al=jf?n=>requestAnimationFrame(n):Q;const ci=new Set;function Pf(n){ci.forEach(e=>{e.c(n)||(ci.delete(e),e.f())}),ci.size!==0&&Al(Pf)}function Rs(n){let e;return ci.size===0&&Al(Pf),{promise:new Promise(t=>{ci.add(e={c:n,f:t})}),abort(){ci.delete(e)}}}function y(n,e){n.appendChild(e)}function Nf(n){if(!n)return document;const e=n.getRootNode?n.getRootNode():n.ownerDocument;return e&&e.host?e:n.ownerDocument}function Yd(n){const e=w("style");return e.textContent="/* empty */",Kd(Nf(n),e),e.sheet}function Kd(n,e){return y(n.head||n,e),e.sheet}function k(n,e,t){n.insertBefore(e,t||null)}function v(n){n.parentNode&&n.parentNode.removeChild(n)}function tn(n,e){for(let t=0;t<n.length;t+=1)n[t]&&n[t].d(e)}function w(n){return document.createElement(n)}function ee(n){return document.createTextNode(n)}function I(){return ee(" ")}function Ne(){return ee("")}function H(n,e,t,i){return n.addEventListener(e,t,i),()=>n.removeEventListener(e,t,i)}function be(n){return function(e){return e.preventDefault(),n.call(this,e)}}function Be(n){return function(e){return e.stopPropagation(),n.call(this,e)}}function p(n,e,t){t==null?n.removeAttribute(e):n.getAttribute(e)!==t&&n.setAttribute(e,t)}const Gd=["width","height"];function Zn(n,e){const t=Object.getOwnPropertyDescriptors(n.__proto__);for(const i in e)e[i]==null?n.removeAttribute(i):i==="style"?n.style.cssText=e[i]:i==="__value"?n.value=n[i]=e[i]:t[i]&&t[i].set&&Gd.indexOf(i)===-1?n[i]=e[i]:p(n,i,e[i])}function Jd(n,e){Object.keys(e).forEach(t=>{Xd(n,t,e[t])})}function Xd(n,e,t){const i=e.toLowerCase();i in n?n[i]=typeof n[i]=="boolean"&&t===""?!0:t:e in n?n[e]=typeof n[e]=="boolean"&&t===""?!0:t:p(n,e,t)}function vs(n){return/-/.test(n)?Jd:Zn}function Af(n){let e;return{p(...t){e=t,e.forEach(i=>n.push(i))},r(){e.forEach(t=>n.splice(n.indexOf(t),1))}}}function yt(n){return n===""?null:+n}function Qd(n){return Array.from(n.childNodes)}function ke(n,e){e=""+e,n.data!==e&&(n.data=e)}function Df(n,e){e=""+e,n.wholeText!==e&&(n.data=e)}function xd(n,e,t){~Zd.indexOf(t)?Df(n,e):ke(n,e)}function _e(n,e){n.value=e??""}function Ue(n,e,t,i){t==null?n.style.removeProperty(e):n.style.setProperty(e,t,"")}function Z(n,e,t){n.classList.toggle(e,!!t)}function Mf(n,e,{bubbles:t=!1,cancelable:i=!1}={}){return new CustomEvent(n,{detail:e,bubbles:t,cancelable:i})}function Ln(n,e){return new n(e)}const ks=new Map;let Ss=0;function ep(n){let e=5381,t=n.length;for(;t--;)e=(e<<5)-e^n.charCodeAt(t);return e>>>0}function tp(n,e){const t={stylesheet:Yd(e),rules:{}};return ks.set(n,t),t}function zi(n,e,t,i,s,l,r,o=0){const a=16.666/i;let u=`{
`;for(let b=0;b<=1;b+=a){const g=e+(t-e)*l(b);u+=b*100+`%{${r(g,1-g)}}
`}const f=u+`100% {${r(t,1-t)}}
}`,c=`__svelte_${ep(f)}_${o}`,d=Nf(n),{stylesheet:m,rules:h}=ks.get(d)||tp(d,n);h[c]||(h[c]=!0,m.insertRule(`@keyframes ${c} ${f}`,m.cssRules.length));const _=n.style.animation||"";return n.style.animation=`${_?`${_}, `:""}${c} ${i}ms linear ${s}ms 1 both`,Ss+=1,c}function Bi(n,e){const t=(n.style.animation||"").split(", "),i=t.filter(e?l=>l.indexOf(e)<0:l=>l.indexOf("__svelte")===-1),s=t.length-i.length;s&&(n.style.animation=i.join(", "),Ss-=s,Ss||np())}function np(){Al(()=>{Ss||(ks.forEach(n=>{const{ownerNode:e}=n.stylesheet;e&&v(e)}),ks.clear())})}function Rf(n,e,t,i){if(!e)return Q;const s=n.getBoundingClientRect();if(e.left===s.left&&e.right===s.right&&e.top===s.top&&e.bottom===s.bottom)return Q;const{delay:l=0,duration:r=300,easing:o=Ji,start:a=Ms()+l,end:u=a+r,tick:f=Q,css:c}=t(n,{from:e,to:s},i);let d=!0,m=!1,h;function _(){c&&(h=zi(n,0,1,r,l,o,c)),l||(m=!0)}function b(){c&&Bi(n,h),d=!1}return Rs(g=>{if(!m&&g>=a&&(m=!0),m&&g>=u&&(f(1,0),b()),!d)return!1;if(m){const T=g-a,L=0+1*o(T/r);f(L,1-L)}return!0}),_(),f(0,1),b}function Hf(n){const e=getComputedStyle(n);if(e.position!=="absolute"&&e.position!=="fixed"){const{width:t,height:i}=e,s=n.getBoundingClientRect();n.style.position="absolute",n.style.width=t,n.style.height=i,Uf(n,s)}}function Uf(n,e){const t=n.getBoundingClientRect();if(e.left!==t.left||e.top!==t.top){const i=getComputedStyle(n),s=i.transform==="none"?"":i.transform;n.style.transform=`${s} translate(${e.left-t.left}px, ${e.top-t.top}px)`}}let Zi;function Ui(n){Zi=n}function Hs(){if(!Zi)throw new Error("Function called outside component initialization");return Zi}function hn(n){Hs().$$.on_mount.push(n)}function ip(n){Hs().$$.after_update.push(n)}function Yt(n){Hs().$$.on_destroy.push(n)}function tt(){const n=Hs();return(e,t,{cancelable:i=!1}={})=>{const s=n.$$.callbacks[e];if(s){const l=Mf(e,t,{cancelable:i});return s.slice().forEach(r=>{r.call(n,l)}),!l.defaultPrevented}return!0}}function $e(n,e){const t=n.$$.callbacks[e.type];t&&t.slice().forEach(i=>i.call(this,e))}const si=[],le=[];let di=[];const pl=[],qf=Promise.resolve();let ml=!1;function $f(){ml||(ml=!0,qf.then(Ff))}function St(){return $f(),qf}function vt(n){di.push(n)}function je(n){pl.push(n)}const Gs=new Set;let Qn=0;function Ff(){if(Qn!==0)return;const n=Zi;do{try{for(;Qn<si.length;){const e=si[Qn];Qn++,Ui(e),sp(e.$$)}}catch(e){throw si.length=0,Qn=0,e}for(Ui(null),si.length=0,Qn=0;le.length;)le.pop()();for(let e=0;e<di.length;e+=1){const t=di[e];Gs.has(t)||(Gs.add(t),t())}di.length=0}while(si.length);for(;pl.length;)pl.pop()();ml=!1,Gs.clear(),Ui(n)}function sp(n){if(n.fragment!==null){n.update(),pe(n.before_update);const e=n.dirty;n.dirty=[-1],n.fragment&&n.fragment.p(n.ctx,e),n.after_update.forEach(vt)}}function lp(n){const e=[],t=[];di.forEach(i=>n.indexOf(i)===-1?e.push(i):t.push(i)),t.forEach(i=>i()),di=e}let Ai;function Dl(){return Ai||(Ai=Promise.resolve(),Ai.then(()=>{Ai=null})),Ai}function Wn(n,e,t){n.dispatchEvent(Mf(`${e?"intro":"outro"}${t}`))}const _s=new Set;let ln;function ae(){ln={r:0,c:[],p:ln}}function ue(){ln.r||pe(ln.c),ln=ln.p}function E(n,e){n&&n.i&&(_s.delete(n),n.i(e))}function j(n,e,t,i){if(n&&n.o){if(_s.has(n))return;_s.add(n),ln.c.push(()=>{_s.delete(n),i&&(t&&n.d(1),i())}),n.o(e)}else i&&i()}const Ml={duration:0};function Wf(n,e,t){const i={direction:"in"};let s=e(n,t,i),l=!1,r,o,a=0;function u(){r&&Bi(n,r)}function f(){const{delay:d=0,duration:m=300,easing:h=Ji,tick:_=Q,css:b}=s||Ml;b&&(r=zi(n,0,1,m,d,h,b,a++)),_(0,1);const g=Ms()+d,T=g+m;o&&o.abort(),l=!0,vt(()=>Wn(n,!0,"start")),o=Rs(L=>{if(l){if(L>=T)return _(1,0),Wn(n,!0,"end"),u(),l=!1;if(L>=g){const O=h((L-g)/m);_(O,1-O)}}return l})}let c=!1;return{start(){c||(c=!0,Bi(n),Qe(s)?(s=s(i),Dl().then(f)):f())},invalidate(){c=!1},end(){l&&(u(),l=!1)}}}function Vf(n,e,t){const i={direction:"out"};let s=e(n,t,i),l=!0,r;const o=ln;o.r+=1;let a;function u(){const{delay:f=0,duration:c=300,easing:d=Ji,tick:m=Q,css:h}=s||Ml;h&&(r=zi(n,1,0,c,f,d,h));const _=Ms()+f,b=_+c;vt(()=>Wn(n,!1,"start")),"inert"in n&&(a=n.inert,n.inert=!0),Rs(g=>{if(l){if(g>=b)return m(0,1),Wn(n,!1,"end"),--o.r||pe(o.c),!1;if(g>=_){const T=d((g-_)/c);m(1-T,T)}}return l})}return Qe(s)?Dl().then(()=>{s=s(i),u()}):u(),{end(f){f&&"inert"in n&&(n.inert=a),f&&s.tick&&s.tick(1,0),l&&(r&&Bi(n,r),l=!1)}}}function ft(n,e,t,i){let l=e(n,t,{direction:"both"}),r=i?0:1,o=null,a=null,u=null,f;function c(){u&&Bi(n,u)}function d(h,_){const b=h.b-r;return _*=Math.abs(b),{a:r,b:h.b,d:b,duration:_,start:h.start,end:h.start+_,group:h.group}}function m(h){const{delay:_=0,duration:b=300,easing:g=Ji,tick:T=Q,css:L}=l||Ml,O={start:Ms()+_,b:h};h||(O.group=ln,ln.r+=1),"inert"in n&&(h?f!==void 0&&(n.inert=f):(f=n.inert,n.inert=!0)),o||a?a=O:(L&&(c(),u=zi(n,r,h,b,_,g,L)),h&&T(0,1),o=d(O,b),vt(()=>Wn(n,h,"start")),Rs(C=>{if(a&&C>a.start&&(o=d(a,b),a=null,Wn(n,o.b,"start"),L&&(c(),u=zi(n,r,o.b,o.duration,0,g,l.css))),o){if(C>=o.end)T(r=o.b,1-r),Wn(n,o.b,"end"),a||(o.b?c():--o.group.r||pe(o.group.c)),o=null;else if(C>=o.start){const S=C-o.start;r=o.a+o.d*g(S/o.duration),T(r,1-r)}}return!!(o||a)}))}return{run(h){Qe(l)?Dl().then(()=>{l=l({direction:h?"in":"out"}),m(h)}):m(h)},end(){c(),o=a=null}}}function Ee(n){return(n==null?void 0:n.length)!==void 0?n:Array.from(n)}function zf(n,e){n.d(1),e.delete(n.key)}function jt(n,e){j(n,1,1,()=>{e.delete(n.key)})}function Bf(n,e){n.f(),jt(n,e)}function kt(n,e,t,i,s,l,r,o,a,u,f,c){let d=n.length,m=l.length,h=d;const _={};for(;h--;)_[n[h].key]=h;const b=[],g=new Map,T=new Map,L=[];for(h=m;h--;){const P=c(s,l,h),M=t(P);let A=r.get(M);A?L.push(()=>A.p(P,e)):(A=u(M,P),A.c()),g.set(M,b[h]=A),M in _&&T.set(M,Math.abs(h-_[M]))}const O=new Set,C=new Set;function S(P){E(P,1),P.m(o,f),r.set(P.key,P),f=P.first,m--}for(;d&&m;){const P=b[m-1],M=n[d-1],A=P.key,D=M.key;P===M?(f=P.first,d--,m--):g.has(D)?!r.has(A)||O.has(A)?S(P):C.has(D)?d--:T.get(A)>T.get(D)?(C.add(A),S(P)):(O.add(D),d--):(a(M,r),d--)}for(;d--;){const P=n[d];g.has(P.key)||a(P,r)}for(;m;)S(b[m-1]);return pe(L),b}function gt(n,e){const t={},i={},s={$$scope:1};let l=n.length;for(;l--;){const r=n[l],o=e[l];if(o){for(const a in r)a in o||(i[a]=1);for(const a in o)s[a]||(t[a]=o[a],s[a]=1);n[l]=o}else for(const a in r)s[a]=1}for(const r in i)r in t||(t[r]=void 0);return t}function It(n){return typeof n=="object"&&n!==null?n:{}}function Pe(n,e,t){const i=n.$$.props[e];i!==void 0&&(n.$$.bound[i]=t,t(n.$$.ctx[i]))}function W(n){n&&n.c()}function $(n,e,t){const{fragment:i,after_update:s}=n.$$;i&&i.m(e,t),vt(()=>{const l=n.$$.on_mount.map(Lf).filter(Qe);n.$$.on_destroy?n.$$.on_destroy.push(...l):pe(l),n.$$.on_mount=[]}),s.forEach(vt)}function F(n,e){const t=n.$$;t.fragment!==null&&(lp(t.after_update),pe(t.on_destroy),t.fragment&&t.fragment.d(e),t.on_destroy=t.fragment=null,t.ctx=[])}function rp(n,e){n.$$.dirty[0]===-1&&(si.push(n),$f(),n.$$.dirty.fill(0)),n.$$.dirty[e/31|0]|=1<<e%31}function we(n,e,t,i,s,l,r=null,o=[-1]){const a=Zi;Ui(n);const u=n.$$={fragment:null,ctx:[],props:l,update:Q,not_equal:s,bound:hr(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(a?a.$$.context:[])),callbacks:hr(),dirty:o,skip_bound:!1,root:e.target||a.$$.root};r&&r(u.root);let f=!1;if(u.ctx=t?t(n,e.props||{},(c,d,...m)=>{const h=m.length?m[0]:d;return u.ctx&&s(u.ctx[c],u.ctx[c]=h)&&(!u.skip_bound&&u.bound[c]&&u.bound[c](h),f&&rp(n,c)),d}):[],u.update(),f=!0,pe(u.before_update),u.fragment=i?i(u.ctx):!1,e.target){if(e.hydrate){const c=Qd(e.target);u.fragment&&u.fragment.l(c),c.forEach(v)}else u.fragment&&u.fragment.c();e.intro&&E(n.$$.fragment),$(n,e.target,e.anchor),Ff()}Ui(a)}class ye{constructor(){Ks(this,"$$");Ks(this,"$$set")}$destroy(){F(this,1),this.$destroy=Q}$on(e,t){if(!Qe(t))return Q;const i=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return i.push(t),()=>{const s=i.indexOf(t);s!==-1&&i.splice(s,1)}}$set(e){this.$$set&&!Bd(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const op="4";typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(op);const xn=[];function Zf(n,e){return{subscribe:Fe(n,e).subscribe}}function Fe(n,e=Q){let t;const i=new Set;function s(o){if(he(n,o)&&(n=o,t)){const a=!xn.length;for(const u of i)u[1](),xn.push(u,n);if(a){for(let u=0;u<xn.length;u+=2)xn[u][0](xn[u+1]);xn.length=0}}}function l(o){s(o(n))}function r(o,a=Q){const u=[o,a];return i.add(u),i.size===1&&(t=e(s,l)||Q),o(n),()=>{i.delete(u),i.size===0&&t&&(t(),t=null)}}return{set:s,update:l,subscribe:r}}function Nt(n,e,t){const i=!Array.isArray(n),s=i?[n]:n;if(!s.every(Boolean))throw new Error("derived() expects stores as input, got a falsy value");const l=e.length<2;return Zf(t,(r,o)=>{let a=!1;const u=[];let f=0,c=Q;const d=()=>{if(f)return;c();const h=e(i?u[0]:u,r,o);l?r(h):c=Qe(h)?h:Q},m=s.map((h,_)=>Nl(h,b=>{u[_]=b,f&=~(1<<_),a&&d()},()=>{f|=1<<_}));return a=!0,d(),function(){pe(m),c(),a=!1}})}function ap(n,e){if(n instanceof RegExp)return{keys:!1,pattern:n};var t,i,s,l,r=[],o="",a=n.split("/");for(a[0]||a.shift();s=a.shift();)t=s[0],t==="*"?(r.push("wild"),o+="/(.*)"):t===":"?(i=s.indexOf("?",1),l=s.indexOf(".",1),r.push(s.substring(1,~i?i:~l?l:s.length)),o+=~i&&!~l?"(?:/([^/]+?))?":"/([^/]+?)",~l&&(o+=(~i?"?":"")+"\\"+s.substring(l))):o+="/"+s;return{keys:r,pattern:new RegExp("^"+o+"/?$","i")}}function up(n){let e,t,i;const s=[n[2]];var l=n[0];function r(o,a){let u={};for(let f=0;f<s.length;f+=1)u=Me(u,s[f]);return a!==void 0&&a&4&&(u=Me(u,gt(s,[It(o[2])]))),{props:u}}return l&&(e=Ln(l,r(n)),e.$on("routeEvent",n[7])),{c(){e&&W(e.$$.fragment),t=Ne()},m(o,a){e&&$(e,o,a),k(o,t,a),i=!0},p(o,a){if(a&1&&l!==(l=o[0])){if(e){ae();const u=e;j(u.$$.fragment,1,0,()=>{F(u,1)}),ue()}l?(e=Ln(l,r(o,a)),e.$on("routeEvent",o[7]),W(e.$$.fragment),E(e.$$.fragment,1),$(e,t.parentNode,t)):e=null}else if(l){const u=a&4?gt(s,[It(o[2])]):{};e.$set(u)}},i(o){i||(e&&E(e.$$.fragment,o),i=!0)},o(o){e&&j(e.$$.fragment,o),i=!1},d(o){o&&v(t),e&&F(e,o)}}}function fp(n){let e,t,i;const s=[{params:n[1]},n[2]];var l=n[0];function r(o,a){let u={};for(let f=0;f<s.length;f+=1)u=Me(u,s[f]);return a!==void 0&&a&6&&(u=Me(u,gt(s,[a&2&&{params:o[1]},a&4&&It(o[2])]))),{props:u}}return l&&(e=Ln(l,r(n)),e.$on("routeEvent",n[6])),{c(){e&&W(e.$$.fragment),t=Ne()},m(o,a){e&&$(e,o,a),k(o,t,a),i=!0},p(o,a){if(a&1&&l!==(l=o[0])){if(e){ae();const u=e;j(u.$$.fragment,1,0,()=>{F(u,1)}),ue()}l?(e=Ln(l,r(o,a)),e.$on("routeEvent",o[6]),W(e.$$.fragment),E(e.$$.fragment,1),$(e,t.parentNode,t)):e=null}else if(l){const u=a&6?gt(s,[a&2&&{params:o[1]},a&4&&It(o[2])]):{};e.$set(u)}},i(o){i||(e&&E(e.$$.fragment,o),i=!0)},o(o){e&&j(e.$$.fragment,o),i=!1},d(o){o&&v(t),e&&F(e,o)}}}function cp(n){let e,t,i,s;const l=[fp,up],r=[];function o(a,u){return a[1]?0:1}return e=o(n),t=r[e]=l[e](n),{c(){t.c(),i=Ne()},m(a,u){r[e].m(a,u),k(a,i,u),s=!0},p(a,[u]){let f=e;e=o(a),e===f?r[e].p(a,u):(ae(),j(r[f],1,1,()=>{r[f]=null}),ue(),t=r[e],t?t.p(a,u):(t=r[e]=l[e](a),t.c()),E(t,1),t.m(i.parentNode,i))},i(a){s||(E(t),s=!0)},o(a){j(t),s=!1},d(a){a&&v(i),r[e].d(a)}}}function br(){const n=window.location.href.indexOf("#/");let e=n>-1?window.location.href.substr(n+1):"/";const t=e.indexOf("?");let i="";return t>-1&&(i=e.substr(t+1),e=e.substr(0,t)),{location:e,querystring:i}}const Rl=Zf(null,function(e){e(br());const t=()=>{e(br())};return window.addEventListener("hashchange",t,!1),function(){window.removeEventListener("hashchange",t,!1)}});Nt(Rl,n=>n.location);const Yf=Nt(Rl,n=>n.querystring),wr=Fe(void 0);async function gi(n){if(!n||n.length<1||n.charAt(0)!="/"&&n.indexOf("#/")!==0)throw Error("Invalid parameter location");await St(),history.replaceState({...history.state,__svelte_spa_router_scrollX:window.scrollX,__svelte_spa_router_scrollY:window.scrollY},void 0),window.location.hash=(n.charAt(0)=="#"?"":"#")+n}async function Bt(n){if(!n||n.length<1||n.charAt(0)!="/"&&n.indexOf("#/")!==0)throw Error("Invalid parameter location");await St();const e=(n.charAt(0)=="#"?"":"#")+n;try{const t={...history.state};delete t.__svelte_spa_router_scrollX,delete t.__svelte_spa_router_scrollY,window.history.replaceState(t,void 0,e)}catch{console.warn("Caught exception while replacing the current page. If you're running this in the Svelte REPL, please note that the `replace` method might not work in this environment.")}window.dispatchEvent(new Event("hashchange"))}function Si(n,e){if(e=vr(e),!n||!n.tagName||n.tagName.toLowerCase()!="a")throw Error('Action "link" can only be used with <a> tags');return yr(n,e),{update(t){t=vr(t),yr(n,t)}}}function dp(n){n?window.scrollTo(n.__svelte_spa_router_scrollX,n.__svelte_spa_router_scrollY):window.scrollTo(0,0)}function yr(n,e){let t=e.href||n.getAttribute("href");if(t&&t.charAt(0)=="/")t="#"+t;else if(!t||t.length<2||t.slice(0,2)!="#/")throw Error('Invalid value for "href" attribute: '+t);n.setAttribute("href",t),n.addEventListener("click",i=>{i.preventDefault(),e.disabled||pp(i.currentTarget.getAttribute("href"))})}function vr(n){return n&&typeof n=="string"?{href:n}:n||{}}function pp(n){history.replaceState({...history.state,__svelte_spa_router_scrollX:window.scrollX,__svelte_spa_router_scrollY:window.scrollY},void 0),window.location.hash=n}function mp(n,e,t){let{routes:i={}}=e,{prefix:s=""}=e,{restoreScrollState:l=!1}=e;class r{constructor(C,S){if(!S||typeof S!="function"&&(typeof S!="object"||S._sveltesparouter!==!0))throw Error("Invalid component object");if(!C||typeof C=="string"&&(C.length<1||C.charAt(0)!="/"&&C.charAt(0)!="*")||typeof C=="object"&&!(C instanceof RegExp))throw Error('Invalid value for "path" argument - strings must start with / or *');const{pattern:P,keys:M}=ap(C);this.path=C,typeof S=="object"&&S._sveltesparouter===!0?(this.component=S.component,this.conditions=S.conditions||[],this.userData=S.userData,this.props=S.props||{}):(this.component=()=>Promise.resolve(S),this.conditions=[],this.props={}),this._pattern=P,this._keys=M}match(C){if(s){if(typeof s=="string")if(C.startsWith(s))C=C.substr(s.length)||"/";else return null;else if(s instanceof RegExp){const A=C.match(s);if(A&&A[0])C=C.substr(A[0].length)||"/";else return null}}const S=this._pattern.exec(C);if(S===null)return null;if(this._keys===!1)return S;const P={};let M=0;for(;M<this._keys.length;){try{P[this._keys[M]]=decodeURIComponent(S[M+1]||"")||null}catch{P[this._keys[M]]=null}M++}return P}async checkConditions(C){for(let S=0;S<this.conditions.length;S++)if(!await this.conditions[S](C))return!1;return!0}}const o=[];i instanceof Map?i.forEach((O,C)=>{o.push(new r(C,O))}):Object.keys(i).forEach(O=>{o.push(new r(O,i[O]))});let a=null,u=null,f={};const c=tt();async function d(O,C){await St(),c(O,C)}let m=null,h=null;l&&(h=O=>{O.state&&(O.state.__svelte_spa_router_scrollY||O.state.__svelte_spa_router_scrollX)?m=O.state:m=null},window.addEventListener("popstate",h),ip(()=>{dp(m)}));let _=null,b=null;const g=Rl.subscribe(async O=>{_=O;let C=0;for(;C<o.length;){const S=o[C].match(O.location);if(!S){C++;continue}const P={route:o[C].path,location:O.location,querystring:O.querystring,userData:o[C].userData,params:S&&typeof S=="object"&&Object.keys(S).length?S:null};if(!await o[C].checkConditions(P)){t(0,a=null),b=null,d("conditionsFailed",P);return}d("routeLoading",Object.assign({},P));const M=o[C].component;if(b!=M){M.loading?(t(0,a=M.loading),b=M,t(1,u=M.loadingParams),t(2,f={}),d("routeLoaded",Object.assign({},P,{component:a,name:a.name,params:u}))):(t(0,a=null),b=null);const A=await M();if(O!=_)return;t(0,a=A&&A.default||A),b=M}S&&typeof S=="object"&&Object.keys(S).length?t(1,u=S):t(1,u=null),t(2,f=o[C].props),d("routeLoaded",Object.assign({},P,{component:a,name:a.name,params:u})).then(()=>{wr.set(u)});return}t(0,a=null),b=null,wr.set(void 0)});Yt(()=>{g(),h&&window.removeEventListener("popstate",h)});function T(O){$e.call(this,n,O)}function L(O){$e.call(this,n,O)}return n.$$set=O=>{"routes"in O&&t(3,i=O.routes),"prefix"in O&&t(4,s=O.prefix),"restoreScrollState"in O&&t(5,l=O.restoreScrollState)},n.$$.update=()=>{n.$$.dirty&32&&(history.scrollRestoration=l?"manual":"auto")},[a,u,f,i,s,l,T,L]}class hp extends ye{constructor(e){super(),we(this,e,mp,cp,he,{routes:3,prefix:4,restoreScrollState:5})}}const _p="modulepreload",gp=function(n,e){return new URL(n,e).href},kr={},Us=function(e,t,i){let s=Promise.resolve();if(t&&t.length>0){const r=document.getElementsByTagName("link"),o=document.querySelector("meta[property=csp-nonce]"),a=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));s=Promise.allSettled(t.map(u=>{if(u=gp(u,i),u in kr)return;kr[u]=!0;const f=u.endsWith(".css"),c=f?'[rel="stylesheet"]':"";if(!!i)for(let h=r.length-1;h>=0;h--){const _=r[h];if(_.href===u&&(!f||_.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${u}"]${c}`))return;const m=document.createElement("link");if(m.rel=f?"stylesheet":_p,f||(m.as="script"),m.crossOrigin="",m.href=u,a&&m.setAttribute("nonce",a),document.head.appendChild(m),f)return new Promise((h,_)=>{m.addEventListener("load",h),m.addEventListener("error",()=>_(new Error(`Unable to preload CSS for ${u}`)))})}))}function l(r){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=r,window.dispatchEvent(o),!o.defaultPrevented)throw r}return s.then(r=>{for(const o of r||[])o.status==="rejected"&&l(o.reason);return e().catch(l)})};function nn(n){if(!n)throw Error("Parameter args is required");if(!n.component==!n.asyncComponent)throw Error("One and only one of component and asyncComponent is required");if(n.component&&(n.asyncComponent=()=>Promise.resolve(n.component)),typeof n.asyncComponent!="function")throw Error("Parameter asyncComponent must be a function");if(n.conditions){Array.isArray(n.conditions)||(n.conditions=[n.conditions]);for(let t=0;t<n.conditions.length;t++)if(!n.conditions[t]||typeof n.conditions[t]!="function")throw Error("Invalid parameter conditions["+t+"]")}return n.loadingComponent&&(n.asyncComponent.loading=n.loadingComponent,n.asyncComponent.loadingParams=n.loadingParams||void 0),{component:n.asyncComponent,userData:n.userData,conditions:n.conditions&&n.conditions.length?n.conditions:void 0,props:n.props&&Object.keys(n.props).length?n.props:{},_sveltesparouter:!0}}class Ht extends Error{constructor(e){var t,i,s,l;super("ClientResponseError"),this.url="",this.status=0,this.response={},this.isAbort=!1,this.originalError=null,Object.setPrototypeOf(this,Ht.prototype),e!==null&&typeof e=="object"&&(this.url=typeof e.url=="string"?e.url:"",this.status=typeof e.status=="number"?e.status:0,this.isAbort=!!e.isAbort,this.originalError=e.originalError,e.response!==null&&typeof e.response=="object"?this.response=e.response:e.data!==null&&typeof e.data=="object"?this.response=e.data:this.response={}),this.originalError||e instanceof Ht||(this.originalError=e),typeof DOMException<"u"&&e instanceof DOMException&&(this.isAbort=!0),this.name="ClientResponseError "+this.status,this.message=(t=this.response)==null?void 0:t.message,this.message||(this.isAbort?this.message="The request was autocancelled. You can find more info in https://github.com/pocketbase/js-sdk#auto-cancellation.":(l=(s=(i=this.originalError)==null?void 0:i.cause)==null?void 0:s.message)!=null&&l.includes("ECONNREFUSED ::1")?this.message="Failed to connect to the PocketBase server. Try changing the SDK URL from localhost to 127.0.0.1 (https://github.com/pocketbase/js-sdk/issues/21).":this.message="Something went wrong while processing your request.")}get data(){return this.response}toJSON(){return{...this}}}const rs=/^[\u0009\u0020-\u007e\u0080-\u00ff]+$/;function bp(n,e){const t={};if(typeof n!="string")return t;const i=Object.assign({},{}).decode||wp;let s=0;for(;s<n.length;){const l=n.indexOf("=",s);if(l===-1)break;let r=n.indexOf(";",s);if(r===-1)r=n.length;else if(r<l){s=n.lastIndexOf(";",l-1)+1;continue}const o=n.slice(s,l).trim();if(t[o]===void 0){let a=n.slice(l+1,r).trim();a.charCodeAt(0)===34&&(a=a.slice(1,-1));try{t[o]=i(a)}catch{t[o]=a}}s=r+1}return t}function Sr(n,e,t){const i=Object.assign({},t||{}),s=i.encode||yp;if(!rs.test(n))throw new TypeError("argument name is invalid");const l=s(e);if(l&&!rs.test(l))throw new TypeError("argument val is invalid");let r=n+"="+l;if(i.maxAge!=null){const o=i.maxAge-0;if(isNaN(o)||!isFinite(o))throw new TypeError("option maxAge is invalid");r+="; Max-Age="+Math.floor(o)}if(i.domain){if(!rs.test(i.domain))throw new TypeError("option domain is invalid");r+="; Domain="+i.domain}if(i.path){if(!rs.test(i.path))throw new TypeError("option path is invalid");r+="; Path="+i.path}if(i.expires){if(!function(a){return Object.prototype.toString.call(a)==="[object Date]"||a instanceof Date}(i.expires)||isNaN(i.expires.valueOf()))throw new TypeError("option expires is invalid");r+="; Expires="+i.expires.toUTCString()}if(i.httpOnly&&(r+="; HttpOnly"),i.secure&&(r+="; Secure"),i.priority)switch(typeof i.priority=="string"?i.priority.toLowerCase():i.priority){case"low":r+="; Priority=Low";break;case"medium":r+="; Priority=Medium";break;case"high":r+="; Priority=High";break;default:throw new TypeError("option priority is invalid")}if(i.sameSite)switch(typeof i.sameSite=="string"?i.sameSite.toLowerCase():i.sameSite){case!0:r+="; SameSite=Strict";break;case"lax":r+="; SameSite=Lax";break;case"strict":r+="; SameSite=Strict";break;case"none":r+="; SameSite=None";break;default:throw new TypeError("option sameSite is invalid")}return r}function wp(n){return n.indexOf("%")!==-1?decodeURIComponent(n):n}function yp(n){return encodeURIComponent(n)}const vp=typeof navigator<"u"&&navigator.product==="ReactNative"||typeof global<"u"&&global.HermesInternal;let Kf;function pi(n){if(n)try{const e=decodeURIComponent(Kf(n.split(".")[1]).split("").map(function(t){return"%"+("00"+t.charCodeAt(0).toString(16)).slice(-2)}).join(""));return JSON.parse(e)||{}}catch{}return{}}function Gf(n,e=0){let t=pi(n);return!(Object.keys(t).length>0&&(!t.exp||t.exp-e>Date.now()/1e3))}Kf=typeof atob!="function"||vp?n=>{let e=String(n).replace(/=+$/,"");if(e.length%4==1)throw new Error("'atob' failed: The string to be decoded is not correctly encoded.");for(var t,i,s=0,l=0,r="";i=e.charAt(l++);~i&&(t=s%4?64*t+i:i,s++%4)?r+=String.fromCharCode(255&t>>(-2*s&6)):0)i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(i);return r}:atob;const Tr="pb_auth";class Hl{constructor(){this.baseToken="",this.baseModel=null,this._onChangeCallbacks=[]}get token(){return this.baseToken}get record(){return this.baseModel}get model(){return this.baseModel}get isValid(){return!Gf(this.token)}get isSuperuser(){var t,i;let e=pi(this.token);return e.type=="auth"&&(((t=this.record)==null?void 0:t.collectionName)=="_superusers"||!((i=this.record)!=null&&i.collectionName)&&e.collectionId=="pbc_3142635823")}get isAdmin(){return console.warn("Please replace pb.authStore.isAdmin with pb.authStore.isSuperuser OR simply check the value of pb.authStore.record?.collectionName"),this.isSuperuser}get isAuthRecord(){return console.warn("Please replace pb.authStore.isAuthRecord with !pb.authStore.isSuperuser OR simply check the value of pb.authStore.record?.collectionName"),pi(this.token).type=="auth"&&!this.isSuperuser}save(e,t){this.baseToken=e||"",this.baseModel=t||null,this.triggerChange()}clear(){this.baseToken="",this.baseModel=null,this.triggerChange()}loadFromCookie(e,t=Tr){const i=bp(e||"")[t]||"";let s={};try{s=JSON.parse(i),(typeof s===null||typeof s!="object"||Array.isArray(s))&&(s={})}catch{}this.save(s.token||"",s.record||s.model||null)}exportToCookie(e,t=Tr){var a,u;const i={secure:!0,sameSite:!0,httpOnly:!0,path:"/"},s=pi(this.token);i.expires=s!=null&&s.exp?new Date(1e3*s.exp):new Date("1970-01-01"),e=Object.assign({},i,e);const l={token:this.token,record:this.record?JSON.parse(JSON.stringify(this.record)):null};let r=Sr(t,JSON.stringify(l),e);const o=typeof Blob<"u"?new Blob([r]).size:r.length;if(l.record&&o>4096){l.record={id:(a=l.record)==null?void 0:a.id,email:(u=l.record)==null?void 0:u.email};const f=["collectionId","collectionName","verified"];for(const c in this.record)f.includes(c)&&(l.record[c]=this.record[c]);r=Sr(t,JSON.stringify(l),e)}return r}onChange(e,t=!1){return this._onChangeCallbacks.push(e),t&&e(this.token,this.record),()=>{for(let i=this._onChangeCallbacks.length-1;i>=0;i--)if(this._onChangeCallbacks[i]==e)return delete this._onChangeCallbacks[i],void this._onChangeCallbacks.splice(i,1)}}triggerChange(){for(const e of this._onChangeCallbacks)e&&e(this.token,this.record)}}class Jf extends Hl{constructor(e="pocketbase_auth"){super(),this.storageFallback={},this.storageKey=e,this._bindStorageEvent()}get token(){return(this._storageGet(this.storageKey)||{}).token||""}get record(){const e=this._storageGet(this.storageKey)||{};return e.record||e.model||null}get model(){return this.record}save(e,t){this._storageSet(this.storageKey,{token:e,record:t}),super.save(e,t)}clear(){this._storageRemove(this.storageKey),super.clear()}_storageGet(e){if(typeof window<"u"&&(window!=null&&window.localStorage)){const t=window.localStorage.getItem(e)||"";try{return JSON.parse(t)}catch{return t}}return this.storageFallback[e]}_storageSet(e,t){if(typeof window<"u"&&(window!=null&&window.localStorage)){let i=t;typeof t!="string"&&(i=JSON.stringify(t)),window.localStorage.setItem(e,i)}else this.storageFallback[e]=t}_storageRemove(e){var t;typeof window<"u"&&(window!=null&&window.localStorage)&&((t=window.localStorage)==null||t.removeItem(e)),delete this.storageFallback[e]}_bindStorageEvent(){typeof window<"u"&&(window!=null&&window.localStorage)&&window.addEventListener&&window.addEventListener("storage",e=>{if(e.key!=this.storageKey)return;const t=this._storageGet(this.storageKey)||{};super.save(t.token||"",t.record||t.model||null)})}}class Pn{constructor(e){this.client=e}}class kp extends Pn{async getAll(e){return e=Object.assign({method:"GET"},e),this.client.send("/api/settings",e)}async update(e,t){return t=Object.assign({method:"PATCH",body:e},t),this.client.send("/api/settings",t)}async testS3(e="storage",t){return t=Object.assign({method:"POST",body:{filesystem:e}},t),this.client.send("/api/settings/test/s3",t).then(()=>!0)}async testEmail(e,t,i,s){return s=Object.assign({method:"POST",body:{email:t,template:i,collection:e}},s),this.client.send("/api/settings/test/email",s).then(()=>!0)}async generateAppleClientSecret(e,t,i,s,l,r){return r=Object.assign({method:"POST",body:{clientId:e,teamId:t,keyId:i,privateKey:s,duration:l}},r),this.client.send("/api/settings/apple/generate-client-secret",r)}}const Sp=["requestKey","$cancelKey","$autoCancel","fetch","headers","body","query","params","cache","credentials","headers","integrity","keepalive","method","mode","redirect","referrer","referrerPolicy","signal","window"];function Ul(n){if(n){n.query=n.query||{};for(let e in n)Sp.includes(e)||(n.query[e]=n[e],delete n[e])}}function Xf(n){const e=[];for(const t in n){if(n[t]===null)continue;const i=n[t],s=encodeURIComponent(t);if(Array.isArray(i))for(const l of i)e.push(s+"="+encodeURIComponent(l));else i instanceof Date?e.push(s+"="+encodeURIComponent(i.toISOString())):typeof i!==null&&typeof i=="object"?e.push(s+"="+encodeURIComponent(JSON.stringify(i))):e.push(s+"="+encodeURIComponent(i))}return e.join("&")}class Qf extends Pn{constructor(){super(...arguments),this.clientId="",this.eventSource=null,this.subscriptions={},this.lastSentSubscriptions=[],this.maxConnectTimeout=15e3,this.reconnectAttempts=0,this.maxReconnectAttempts=1/0,this.predefinedReconnectIntervals=[200,300,500,1e3,1200,1500,2e3],this.pendingConnects=[]}get isConnected(){return!!this.eventSource&&!!this.clientId&&!this.pendingConnects.length}async subscribe(e,t,i){var r;if(!e)throw new Error("topic must be set.");let s=e;if(i){Ul(i=Object.assign({},i));const o="options="+encodeURIComponent(JSON.stringify({query:i.query,headers:i.headers}));s+=(s.includes("?")?"&":"?")+o}const l=function(o){const a=o;let u;try{u=JSON.parse(a==null?void 0:a.data)}catch{}t(u||{})};return this.subscriptions[s]||(this.subscriptions[s]=[]),this.subscriptions[s].push(l),this.isConnected?this.subscriptions[s].length===1?await this.submitSubscriptions():(r=this.eventSource)==null||r.addEventListener(s,l):await this.connect(),async()=>this.unsubscribeByTopicAndListener(e,l)}async unsubscribe(e){var i;let t=!1;if(e){const s=this.getSubscriptionsByTopic(e);for(let l in s)if(this.hasSubscriptionListeners(l)){for(let r of this.subscriptions[l])(i=this.eventSource)==null||i.removeEventListener(l,r);delete this.subscriptions[l],t||(t=!0)}}else this.subscriptions={};this.hasSubscriptionListeners()?t&&await this.submitSubscriptions():this.disconnect()}async unsubscribeByPrefix(e){var i;let t=!1;for(let s in this.subscriptions)if((s+"?").startsWith(e)){t=!0;for(let l of this.subscriptions[s])(i=this.eventSource)==null||i.removeEventListener(s,l);delete this.subscriptions[s]}t&&(this.hasSubscriptionListeners()?await this.submitSubscriptions():this.disconnect())}async unsubscribeByTopicAndListener(e,t){var l;let i=!1;const s=this.getSubscriptionsByTopic(e);for(let r in s){if(!Array.isArray(this.subscriptions[r])||!this.subscriptions[r].length)continue;let o=!1;for(let a=this.subscriptions[r].length-1;a>=0;a--)this.subscriptions[r][a]===t&&(o=!0,delete this.subscriptions[r][a],this.subscriptions[r].splice(a,1),(l=this.eventSource)==null||l.removeEventListener(r,t));o&&(this.subscriptions[r].length||delete this.subscriptions[r],i||this.hasSubscriptionListeners(r)||(i=!0))}this.hasSubscriptionListeners()?i&&await this.submitSubscriptions():this.disconnect()}hasSubscriptionListeners(e){var t,i;if(this.subscriptions=this.subscriptions||{},e)return!!((t=this.subscriptions[e])!=null&&t.length);for(let s in this.subscriptions)if((i=this.subscriptions[s])!=null&&i.length)return!0;return!1}async submitSubscriptions(){if(this.clientId)return this.addAllSubscriptionListeners(),this.lastSentSubscriptions=this.getNonEmptySubscriptionKeys(),this.client.send("/api/realtime",{method:"POST",body:{clientId:this.clientId,subscriptions:this.lastSentSubscriptions},requestKey:this.getSubscriptionsCancelKey()}).catch(e=>{if(!(e!=null&&e.isAbort))throw e})}getSubscriptionsCancelKey(){return"realtime_"+this.clientId}getSubscriptionsByTopic(e){const t={};e=e.includes("?")?e:e+"?";for(let i in this.subscriptions)(i+"?").startsWith(e)&&(t[i]=this.subscriptions[i]);return t}getNonEmptySubscriptionKeys(){const e=[];for(let t in this.subscriptions)this.subscriptions[t].length&&e.push(t);return e}addAllSubscriptionListeners(){if(this.eventSource){this.removeAllSubscriptionListeners();for(let e in this.subscriptions)for(let t of this.subscriptions[e])this.eventSource.addEventListener(e,t)}}removeAllSubscriptionListeners(){if(this.eventSource)for(let e in this.subscriptions)for(let t of this.subscriptions[e])this.eventSource.removeEventListener(e,t)}async connect(){if(!(this.reconnectAttempts>0))return new Promise((e,t)=>{this.pendingConnects.push({resolve:e,reject:t}),this.pendingConnects.length>1||this.initConnect()})}initConnect(){this.disconnect(!0),clearTimeout(this.connectTimeoutId),this.connectTimeoutId=setTimeout(()=>{this.connectErrorHandler(new Error("EventSource connect took too long."))},this.maxConnectTimeout),this.eventSource=new EventSource(this.client.buildURL("/api/realtime")),this.eventSource.onerror=e=>{this.connectErrorHandler(new Error("Failed to establish realtime connection."))},this.eventSource.addEventListener("PB_CONNECT",e=>{const t=e;this.clientId=t==null?void 0:t.lastEventId,this.submitSubscriptions().then(async()=>{let i=3;for(;this.hasUnsentSubscriptions()&&i>0;)i--,await this.submitSubscriptions()}).then(()=>{for(let s of this.pendingConnects)s.resolve();this.pendingConnects=[],this.reconnectAttempts=0,clearTimeout(this.reconnectTimeoutId),clearTimeout(this.connectTimeoutId);const i=this.getSubscriptionsByTopic("PB_CONNECT");for(let s in i)for(let l of i[s])l(e)}).catch(i=>{this.clientId="",this.connectErrorHandler(i)})})}hasUnsentSubscriptions(){const e=this.getNonEmptySubscriptionKeys();if(e.length!=this.lastSentSubscriptions.length)return!0;for(const t of e)if(!this.lastSentSubscriptions.includes(t))return!0;return!1}connectErrorHandler(e){if(clearTimeout(this.connectTimeoutId),clearTimeout(this.reconnectTimeoutId),!this.clientId&&!this.reconnectAttempts||this.reconnectAttempts>this.maxReconnectAttempts){for(let i of this.pendingConnects)i.reject(new Ht(e));return this.pendingConnects=[],void this.disconnect()}this.disconnect(!0);const t=this.predefinedReconnectIntervals[this.reconnectAttempts]||this.predefinedReconnectIntervals[this.predefinedReconnectIntervals.length-1];this.reconnectAttempts++,this.reconnectTimeoutId=setTimeout(()=>{this.initConnect()},t)}disconnect(e=!1){var t;if(clearTimeout(this.connectTimeoutId),clearTimeout(this.reconnectTimeoutId),this.removeAllSubscriptionListeners(),this.client.cancelRequest(this.getSubscriptionsCancelKey()),(t=this.eventSource)==null||t.close(),this.eventSource=null,this.clientId="",!e){this.reconnectAttempts=0;for(let i of this.pendingConnects)i.resolve();this.pendingConnects=[]}}}class xf extends Pn{decode(e){return e}async getFullList(e,t){if(typeof e=="number")return this._getFullList(e,t);let i=500;return(t=Object.assign({},e,t)).batch&&(i=t.batch,delete t.batch),this._getFullList(i,t)}async getList(e=1,t=30,i){return(i=Object.assign({method:"GET"},i)).query=Object.assign({page:e,perPage:t},i.query),this.client.send(this.baseCrudPath,i).then(s=>{var l;return s.items=((l=s.items)==null?void 0:l.map(r=>this.decode(r)))||[],s})}async getFirstListItem(e,t){return(t=Object.assign({requestKey:"one_by_filter_"+this.baseCrudPath+"_"+e},t)).query=Object.assign({filter:e,skipTotal:1},t.query),this.getList(1,1,t).then(i=>{var s;if(!((s=i==null?void 0:i.items)!=null&&s.length))throw new Ht({status:404,response:{code:404,message:"The requested resource wasn't found.",data:{}}});return i.items[0]})}async getOne(e,t){if(!e)throw new Ht({url:this.client.buildURL(this.baseCrudPath+"/"),status:404,response:{code:404,message:"Missing required record id.",data:{}}});return t=Object.assign({method:"GET"},t),this.client.send(this.baseCrudPath+"/"+encodeURIComponent(e),t).then(i=>this.decode(i))}async create(e,t){return t=Object.assign({method:"POST",body:e},t),this.client.send(this.baseCrudPath,t).then(i=>this.decode(i))}async update(e,t,i){return i=Object.assign({method:"PATCH",body:t},i),this.client.send(this.baseCrudPath+"/"+encodeURIComponent(e),i).then(s=>this.decode(s))}async delete(e,t){return t=Object.assign({method:"DELETE"},t),this.client.send(this.baseCrudPath+"/"+encodeURIComponent(e),t).then(()=>!0)}_getFullList(e=500,t){(t=t||{}).query=Object.assign({skipTotal:1},t.query);let i=[],s=async l=>this.getList(l,e||500,t).then(r=>{const o=r.items;return i=i.concat(o),o.length==r.perPage?s(l+1):i});return s(1)}}function wn(n,e,t,i){const s=i!==void 0;return s||t!==void 0?s?(console.warn(n),e.body=Object.assign({},e.body,t),e.query=Object.assign({},e.query,i),e):Object.assign(e,t):e}function Js(n){var e;(e=n._resetAutoRefresh)==null||e.call(n)}class Tp extends xf{constructor(e,t){super(e),this.collectionIdOrName=t}get baseCrudPath(){return this.baseCollectionPath+"/records"}get baseCollectionPath(){return"/api/collections/"+encodeURIComponent(this.collectionIdOrName)}get isSuperusers(){return this.collectionIdOrName=="_superusers"||this.collectionIdOrName=="_pbc_2773867675"}async subscribe(e,t,i){if(!e)throw new Error("Missing topic.");if(!t)throw new Error("Missing subscription callback.");return this.client.realtime.subscribe(this.collectionIdOrName+"/"+e,t,i)}async unsubscribe(e){return e?this.client.realtime.unsubscribe(this.collectionIdOrName+"/"+e):this.client.realtime.unsubscribeByPrefix(this.collectionIdOrName)}async getFullList(e,t){if(typeof e=="number")return super.getFullList(e,t);const i=Object.assign({},e,t);return super.getFullList(i)}async getList(e=1,t=30,i){return super.getList(e,t,i)}async getFirstListItem(e,t){return super.getFirstListItem(e,t)}async getOne(e,t){return super.getOne(e,t)}async create(e,t){return super.create(e,t)}async update(e,t,i){return super.update(e,t,i).then(s=>{var l,r,o;if(((l=this.client.authStore.record)==null?void 0:l.id)===(s==null?void 0:s.id)&&(((r=this.client.authStore.record)==null?void 0:r.collectionId)===this.collectionIdOrName||((o=this.client.authStore.record)==null?void 0:o.collectionName)===this.collectionIdOrName)){let a=Object.assign({},this.client.authStore.record.expand),u=Object.assign({},this.client.authStore.record,s);a&&(u.expand=Object.assign(a,s.expand)),this.client.authStore.save(this.client.authStore.token,u)}return s})}async delete(e,t){return super.delete(e,t).then(i=>{var s,l,r;return!i||((s=this.client.authStore.record)==null?void 0:s.id)!==e||((l=this.client.authStore.record)==null?void 0:l.collectionId)!==this.collectionIdOrName&&((r=this.client.authStore.record)==null?void 0:r.collectionName)!==this.collectionIdOrName||this.client.authStore.clear(),i})}authResponse(e){const t=this.decode((e==null?void 0:e.record)||{});return this.client.authStore.save(e==null?void 0:e.token,t),Object.assign({},e,{token:(e==null?void 0:e.token)||"",record:t})}async listAuthMethods(e){return e=Object.assign({method:"GET",fields:"mfa,otp,password,oauth2"},e),this.client.send(this.baseCollectionPath+"/auth-methods",e)}async authWithPassword(e,t,i){let s;i=Object.assign({method:"POST",body:{identity:e,password:t}},i),this.isSuperusers&&(s=i.autoRefreshThreshold,delete i.autoRefreshThreshold,i.autoRefresh||Js(this.client));let l=await this.client.send(this.baseCollectionPath+"/auth-with-password",i);return l=this.authResponse(l),s&&this.isSuperusers&&function(o,a,u,f){Js(o);const c=o.beforeSend,d=o.authStore.record,m=o.authStore.onChange((h,_)=>{(!h||(_==null?void 0:_.id)!=(d==null?void 0:d.id)||(_!=null&&_.collectionId||d!=null&&d.collectionId)&&(_==null?void 0:_.collectionId)!=(d==null?void 0:d.collectionId))&&Js(o)});o._resetAutoRefresh=function(){m(),o.beforeSend=c,delete o._resetAutoRefresh},o.beforeSend=async(h,_)=>{var L;const b=o.authStore.token;if((L=_.query)!=null&&L.autoRefresh)return c?c(h,_):{url:h,sendOptions:_};let g=o.authStore.isValid;if(g&&Gf(o.authStore.token,a))try{await u()}catch{g=!1}g||await f();const T=_.headers||{};for(let O in T)if(O.toLowerCase()=="authorization"&&b==T[O]&&o.authStore.token){T[O]=o.authStore.token;break}return _.headers=T,c?c(h,_):{url:h,sendOptions:_}}}(this.client,s,()=>this.authRefresh({autoRefresh:!0}),()=>this.authWithPassword(e,t,Object.assign({autoRefresh:!0},i))),l}async authWithOAuth2Code(e,t,i,s,l,r,o){let a={method:"POST",body:{provider:e,code:t,codeVerifier:i,redirectURL:s,createData:l}};return a=wn("This form of authWithOAuth2Code(provider, code, codeVerifier, redirectURL, createData?, body?, query?) is deprecated. Consider replacing it with authWithOAuth2Code(provider, code, codeVerifier, redirectURL, createData?, options?).",a,r,o),this.client.send(this.baseCollectionPath+"/auth-with-oauth2",a).then(u=>this.authResponse(u))}authWithOAuth2(...e){if(e.length>1||typeof(e==null?void 0:e[0])=="string")return console.warn("PocketBase: This form of authWithOAuth2() is deprecated and may get removed in the future. Please replace with authWithOAuth2Code() OR use the authWithOAuth2() realtime form as shown in https://pocketbase.io/docs/authentication/#oauth2-integration."),this.authWithOAuth2Code((e==null?void 0:e[0])||"",(e==null?void 0:e[1])||"",(e==null?void 0:e[2])||"",(e==null?void 0:e[3])||"",(e==null?void 0:e[4])||{},(e==null?void 0:e[5])||{},(e==null?void 0:e[6])||{});const t=(e==null?void 0:e[0])||{};let i=null;t.urlCallback||(i=Or(void 0));const s=new Qf(this.client);function l(){i==null||i.close(),s.unsubscribe()}const r={},o=t.requestKey;return o&&(r.requestKey=o),this.listAuthMethods(r).then(a=>{var d;const u=a.oauth2.providers.find(m=>m.name===t.provider);if(!u)throw new Ht(new Error(`Missing or invalid provider "${t.provider}".`));const f=this.client.buildURL("/api/oauth2-redirect"),c=o?(d=this.client.cancelControllers)==null?void 0:d[o]:void 0;return c&&(c.signal.onabort=()=>{l()}),new Promise(async(m,h)=>{var _;try{await s.subscribe("@oauth2",async L=>{var C;const O=s.clientId;try{if(!L.state||O!==L.state)throw new Error("State parameters don't match.");if(L.error||!L.code)throw new Error("OAuth2 redirect error or missing code: "+L.error);const S=Object.assign({},t);delete S.provider,delete S.scopes,delete S.createData,delete S.urlCallback,(C=c==null?void 0:c.signal)!=null&&C.onabort&&(c.signal.onabort=null);const P=await this.authWithOAuth2Code(u.name,L.code,u.codeVerifier,f,t.createData,S);m(P)}catch(S){h(new Ht(S))}l()});const b={state:s.clientId};(_=t.scopes)!=null&&_.length&&(b.scope=t.scopes.join(" "));const g=this._replaceQueryParams(u.authURL+f,b);await(t.urlCallback||function(L){i?i.location.href=L:i=Or(L)})(g)}catch(b){l(),h(new Ht(b))}})}).catch(a=>{throw l(),a})}async authRefresh(e,t){let i={method:"POST"};return i=wn("This form of authRefresh(body?, query?) is deprecated. Consider replacing it with authRefresh(options?).",i,e,t),this.client.send(this.baseCollectionPath+"/auth-refresh",i).then(s=>this.authResponse(s))}async requestPasswordReset(e,t,i){let s={method:"POST",body:{email:e}};return s=wn("This form of requestPasswordReset(email, body?, query?) is deprecated. Consider replacing it with requestPasswordReset(email, options?).",s,t,i),this.client.send(this.baseCollectionPath+"/request-password-reset",s).then(()=>!0)}async confirmPasswordReset(e,t,i,s,l){let r={method:"POST",body:{token:e,password:t,passwordConfirm:i}};return r=wn("This form of confirmPasswordReset(token, password, passwordConfirm, body?, query?) is deprecated. Consider replacing it with confirmPasswordReset(token, password, passwordConfirm, options?).",r,s,l),this.client.send(this.baseCollectionPath+"/confirm-password-reset",r).then(()=>!0)}async requestVerification(e,t,i){let s={method:"POST",body:{email:e}};return s=wn("This form of requestVerification(email, body?, query?) is deprecated. Consider replacing it with requestVerification(email, options?).",s,t,i),this.client.send(this.baseCollectionPath+"/request-verification",s).then(()=>!0)}async confirmVerification(e,t,i){let s={method:"POST",body:{token:e}};return s=wn("This form of confirmVerification(token, body?, query?) is deprecated. Consider replacing it with confirmVerification(token, options?).",s,t,i),this.client.send(this.baseCollectionPath+"/confirm-verification",s).then(()=>{const l=pi(e),r=this.client.authStore.record;return r&&!r.verified&&r.id===l.id&&r.collectionId===l.collectionId&&(r.verified=!0,this.client.authStore.save(this.client.authStore.token,r)),!0})}async requestEmailChange(e,t,i){let s={method:"POST",body:{newEmail:e}};return s=wn("This form of requestEmailChange(newEmail, body?, query?) is deprecated. Consider replacing it with requestEmailChange(newEmail, options?).",s,t,i),this.client.send(this.baseCollectionPath+"/request-email-change",s).then(()=>!0)}async confirmEmailChange(e,t,i,s){let l={method:"POST",body:{token:e,password:t}};return l=wn("This form of confirmEmailChange(token, password, body?, query?) is deprecated. Consider replacing it with confirmEmailChange(token, password, options?).",l,i,s),this.client.send(this.baseCollectionPath+"/confirm-email-change",l).then(()=>{const r=pi(e),o=this.client.authStore.record;return o&&o.id===r.id&&o.collectionId===r.collectionId&&this.client.authStore.clear(),!0})}async listExternalAuths(e,t){return this.client.collection("_externalAuths").getFullList(Object.assign({},t,{filter:this.client.filter("recordRef = {:id}",{id:e})}))}async unlinkExternalAuth(e,t,i){const s=await this.client.collection("_externalAuths").getFirstListItem(this.client.filter("recordRef = {:recordId} && provider = {:provider}",{recordId:e,provider:t}));return this.client.collection("_externalAuths").delete(s.id,i).then(()=>!0)}async requestOTP(e,t){return t=Object.assign({method:"POST",body:{email:e}},t),this.client.send(this.baseCollectionPath+"/request-otp",t)}async authWithOTP(e,t,i){return i=Object.assign({method:"POST",body:{otpId:e,password:t}},i),this.client.send(this.baseCollectionPath+"/auth-with-otp",i).then(s=>this.authResponse(s))}async impersonate(e,t,i){(i=Object.assign({method:"POST",body:{duration:t}},i)).headers=i.headers||{},i.headers.Authorization||(i.headers.Authorization=this.client.authStore.token);const s=new _n(this.client.baseURL,new Hl,this.client.lang),l=await s.send(this.baseCollectionPath+"/impersonate/"+encodeURIComponent(e),i);return s.authStore.save(l==null?void 0:l.token,this.decode((l==null?void 0:l.record)||{})),s}_replaceQueryParams(e,t={}){let i=e,s="";e.indexOf("?")>=0&&(i=e.substring(0,e.indexOf("?")),s=e.substring(e.indexOf("?")+1));const l={},r=s.split("&");for(const o of r){if(o=="")continue;const a=o.split("=");l[decodeURIComponent(a[0].replace(/\+/g," "))]=decodeURIComponent((a[1]||"").replace(/\+/g," "))}for(let o in t)t.hasOwnProperty(o)&&(t[o]==null?delete l[o]:l[o]=t[o]);s="";for(let o in l)l.hasOwnProperty(o)&&(s!=""&&(s+="&"),s+=encodeURIComponent(o.replace(/%20/g,"+"))+"="+encodeURIComponent(l[o].replace(/%20/g,"+")));return s!=""?i+"?"+s:i}}function Or(n){if(typeof window>"u"||!(window!=null&&window.open))throw new Ht(new Error("Not in a browser context - please pass a custom urlCallback function."));let e=1024,t=768,i=window.innerWidth,s=window.innerHeight;e=e>i?i:e,t=t>s?s:t;let l=i/2-e/2,r=s/2-t/2;return window.open(n,"popup_window","width="+e+",height="+t+",top="+r+",left="+l+",resizable,menubar=no")}class Op extends xf{get baseCrudPath(){return"/api/collections"}async import(e,t=!1,i){return i=Object.assign({method:"PUT",body:{collections:e,deleteMissing:t}},i),this.client.send(this.baseCrudPath+"/import",i).then(()=>!0)}async getScaffolds(e){return e=Object.assign({method:"GET"},e),this.client.send(this.baseCrudPath+"/meta/scaffolds",e)}async truncate(e,t){return t=Object.assign({method:"DELETE"},t),this.client.send(this.baseCrudPath+"/"+encodeURIComponent(e)+"/truncate",t).then(()=>!0)}}class Cp extends Pn{async getList(e=1,t=30,i){return(i=Object.assign({method:"GET"},i)).query=Object.assign({page:e,perPage:t},i.query),this.client.send("/api/logs",i)}async getOne(e,t){if(!e)throw new Ht({url:this.client.buildURL("/api/logs/"),status:404,response:{code:404,message:"Missing required log id.",data:{}}});return t=Object.assign({method:"GET"},t),this.client.send("/api/logs/"+encodeURIComponent(e),t)}async getStats(e){return e=Object.assign({method:"GET"},e),this.client.send("/api/logs/stats",e)}}class Ep extends Pn{async check(e){return e=Object.assign({method:"GET"},e),this.client.send("/api/health",e)}}class Lp extends Pn{getUrl(e,t,i={}){return console.warn("Please replace pb.files.getUrl() with pb.files.getURL()"),this.getURL(e,t,i)}getURL(e,t,i={}){if(!t||!(e!=null&&e.id)||!(e!=null&&e.collectionId)&&!(e!=null&&e.collectionName))return"";const s=[];s.push("api"),s.push("files"),s.push(encodeURIComponent(e.collectionId||e.collectionName)),s.push(encodeURIComponent(e.id)),s.push(encodeURIComponent(t));let l=this.client.buildURL(s.join("/"));if(Object.keys(i).length){i.download===!1&&delete i.download;const r=new URLSearchParams(i);l+=(l.includes("?")?"&":"?")+r}return l}async getToken(e){return e=Object.assign({method:"POST"},e),this.client.send("/api/files/token",e).then(t=>(t==null?void 0:t.token)||"")}}class Ip extends Pn{async getFullList(e){return e=Object.assign({method:"GET"},e),this.client.send("/api/backups",e)}async create(e,t){return t=Object.assign({method:"POST",body:{name:e}},t),this.client.send("/api/backups",t).then(()=>!0)}async upload(e,t){return t=Object.assign({method:"POST",body:e},t),this.client.send("/api/backups/upload",t).then(()=>!0)}async delete(e,t){return t=Object.assign({method:"DELETE"},t),this.client.send(`/api/backups/${encodeURIComponent(e)}`,t).then(()=>!0)}async restore(e,t){return t=Object.assign({method:"POST"},t),this.client.send(`/api/backups/${encodeURIComponent(e)}/restore`,t).then(()=>!0)}getDownloadUrl(e,t){return console.warn("Please replace pb.backups.getDownloadUrl() with pb.backups.getDownloadURL()"),this.getDownloadURL(e,t)}getDownloadURL(e,t){return this.client.buildURL(`/api/backups/${encodeURIComponent(t)}?token=${encodeURIComponent(e)}`)}}function hl(n){return typeof Blob<"u"&&n instanceof Blob||typeof File<"u"&&n instanceof File||n!==null&&typeof n=="object"&&n.uri&&(typeof navigator<"u"&&navigator.product==="ReactNative"||typeof global<"u"&&global.HermesInternal)}function Cr(n){return n&&(n.constructor.name==="FormData"||typeof FormData<"u"&&n instanceof FormData)}function Er(n){for(const e in n){const t=Array.isArray(n[e])?n[e]:[n[e]];for(const i of t)if(hl(i))return!0}return!1}class jp extends Pn{constructor(){super(...arguments),this.requests=[],this.subs={}}collection(e){return this.subs[e]||(this.subs[e]=new Pp(this.requests,e)),this.subs[e]}async send(e){const t=new FormData,i=[];for(let s=0;s<this.requests.length;s++){const l=this.requests[s];if(i.push({method:l.method,url:l.url,headers:l.headers,body:l.json}),l.files)for(let r in l.files){const o=l.files[r]||[];for(let a of o)t.append("requests."+s+"."+r,a)}}return t.append("@jsonPayload",JSON.stringify({requests:i})),e=Object.assign({method:"POST",body:t},e),this.client.send("/api/batch",e)}}class Pp{constructor(e,t){this.requests=[],this.requests=e,this.collectionIdOrName=t}upsert(e,t){t=Object.assign({body:e||{}},t);const i={method:"PUT",url:"/api/collections/"+encodeURIComponent(this.collectionIdOrName)+"/records"};this.prepareRequest(i,t),this.requests.push(i)}create(e,t){t=Object.assign({body:e||{}},t);const i={method:"POST",url:"/api/collections/"+encodeURIComponent(this.collectionIdOrName)+"/records"};this.prepareRequest(i,t),this.requests.push(i)}update(e,t,i){i=Object.assign({body:t||{}},i);const s={method:"PATCH",url:"/api/collections/"+encodeURIComponent(this.collectionIdOrName)+"/records/"+encodeURIComponent(e)};this.prepareRequest(s,i),this.requests.push(s)}delete(e,t){t=Object.assign({},t);const i={method:"DELETE",url:"/api/collections/"+encodeURIComponent(this.collectionIdOrName)+"/records/"+encodeURIComponent(e)};this.prepareRequest(i,t),this.requests.push(i)}prepareRequest(e,t){if(Ul(t),e.headers=t.headers,e.json={},e.files={},t.query!==void 0){const i=Xf(t.query);i&&(e.url+=(e.url.includes("?")?"&":"?")+i)}for(const i in t.body){const s=t.body[i];if(hl(s))e.files[i]=e.files[i]||[],e.files[i].push(s);else if(Array.isArray(s)){const l=[],r=[];for(const o of s)hl(o)?l.push(o):r.push(o);if(l.length>0&&l.length==s.length){e.files[i]=e.files[i]||[];for(let o of l)e.files[i].push(o)}else if(e.json[i]=r,l.length>0){let o=i;i.startsWith("+")||i.endsWith("+")||(o+="+"),e.files[o]=e.files[o]||[];for(let a of l)e.files[o].push(a)}}else e.json[i]=s}}}class _n{get baseUrl(){return this.baseURL}set baseUrl(e){this.baseURL=e}constructor(e="/",t,i="en-US"){this.cancelControllers={},this.recordServices={},this.enableAutoCancellation=!0,this.baseURL=e,this.lang=i,t?this.authStore=t:typeof window<"u"&&window.Deno?this.authStore=new Hl:this.authStore=new Jf,this.collections=new Op(this),this.files=new Lp(this),this.logs=new Cp(this),this.settings=new kp(this),this.realtime=new Qf(this),this.health=new Ep(this),this.backups=new Ip(this)}get admins(){return this.collection("_superusers")}createBatch(){return new jp(this)}collection(e){return this.recordServices[e]||(this.recordServices[e]=new Tp(this,e)),this.recordServices[e]}autoCancellation(e){return this.enableAutoCancellation=!!e,this}cancelRequest(e){return this.cancelControllers[e]&&(this.cancelControllers[e].abort(),delete this.cancelControllers[e]),this}cancelAllRequests(){for(let e in this.cancelControllers)this.cancelControllers[e].abort();return this.cancelControllers={},this}filter(e,t){if(!t)return e;for(let i in t){let s=t[i];switch(typeof s){case"boolean":case"number":s=""+s;break;case"string":s="'"+s.replace(/'/g,"\\'")+"'";break;default:s=s===null?"null":s instanceof Date?"'"+s.toISOString().replace("T"," ")+"'":"'"+JSON.stringify(s).replace(/'/g,"\\'")+"'"}e=e.replaceAll("{:"+i+"}",s)}return e}getFileUrl(e,t,i={}){return console.warn("Please replace pb.getFileUrl() with pb.files.getURL()"),this.files.getURL(e,t,i)}buildUrl(e){return console.warn("Please replace pb.buildUrl() with pb.buildURL()"),this.buildURL(e)}buildURL(e){var i;let t=this.baseURL;return typeof window>"u"||!window.location||t.startsWith("https://")||t.startsWith("http://")||(t=(i=window.location.origin)!=null&&i.endsWith("/")?window.location.origin.substring(0,window.location.origin.length-1):window.location.origin||"",this.baseURL.startsWith("/")||(t+=window.location.pathname||"/",t+=t.endsWith("/")?"":"/"),t+=this.baseURL),e&&(t+=t.endsWith("/")?"":"/",t+=e.startsWith("/")?e.substring(1):e),t}async send(e,t){t=this.initSendOptions(e,t);let i=this.buildURL(e);if(this.beforeSend){const s=Object.assign({},await this.beforeSend(i,t));s.url!==void 0||s.options!==void 0?(i=s.url||i,t=s.options||t):Object.keys(s).length&&(t=s,console!=null&&console.warn&&console.warn("Deprecated format of beforeSend return: please use `return { url, options }`, instead of `return options`."))}if(t.query!==void 0){const s=Xf(t.query);s&&(i+=(i.includes("?")?"&":"?")+s),delete t.query}return this.getHeader(t.headers,"Content-Type")=="application/json"&&t.body&&typeof t.body!="string"&&(t.body=JSON.stringify(t.body)),(t.fetch||fetch)(i,t).then(async s=>{let l={};try{l=await s.json()}catch{}if(this.afterSend&&(l=await this.afterSend(s,l,t)),s.status>=400)throw new Ht({url:s.url,status:s.status,data:l});return l}).catch(s=>{throw new Ht(s)})}initSendOptions(e,t){if((t=Object.assign({method:"GET"},t)).body=function(s){if(typeof FormData>"u"||s===void 0||typeof s!="object"||s===null||Cr(s)||!Er(s))return s;const l=new FormData;for(const r in s){const o=s[r];if(typeof o!="object"||Er({data:o})){const a=Array.isArray(o)?o:[o];for(let u of a)l.append(r,u)}else{let a={};a[r]=o,l.append("@jsonPayload",JSON.stringify(a))}}return l}(t.body),Ul(t),t.query=Object.assign({},t.params,t.query),t.requestKey===void 0&&(t.$autoCancel===!1||t.query.$autoCancel===!1?t.requestKey=null:(t.$cancelKey||t.query.$cancelKey)&&(t.requestKey=t.$cancelKey||t.query.$cancelKey)),delete t.$autoCancel,delete t.query.$autoCancel,delete t.$cancelKey,delete t.query.$cancelKey,this.getHeader(t.headers,"Content-Type")!==null||Cr(t.body)||(t.headers=Object.assign({},t.headers,{"Content-Type":"application/json"})),this.getHeader(t.headers,"Accept-Language")===null&&(t.headers=Object.assign({},t.headers,{"Accept-Language":this.lang})),this.authStore.token&&this.getHeader(t.headers,"Authorization")===null&&(t.headers=Object.assign({},t.headers,{Authorization:this.authStore.token})),this.enableAutoCancellation&&t.requestKey!==null){const i=t.requestKey||(t.method||"GET")+e;delete t.requestKey,this.cancelRequest(i);const s=new AbortController;this.cancelControllers[i]=s,t.signal=s.signal}return t}getHeader(e,t){e=e||{},t=t.toLowerCase();for(let i in e)if(i.toLowerCase()==t)return e[i];return null}}class Jn extends Error{}class Np extends Jn{constructor(e){super(`Invalid DateTime: ${e.toMessage()}`)}}class Ap extends Jn{constructor(e){super(`Invalid Interval: ${e.toMessage()}`)}}class Dp extends Jn{constructor(e){super(`Invalid Duration: ${e.toMessage()}`)}}class ri extends Jn{}class ec extends Jn{constructor(e){super(`Invalid unit ${e}`)}}class Ct extends Jn{}class yn extends Jn{constructor(){super("Zone is an abstract class")}}const me="numeric",en="short",Ut="long",Ts={year:me,month:me,day:me},tc={year:me,month:en,day:me},Mp={year:me,month:en,day:me,weekday:en},nc={year:me,month:Ut,day:me},ic={year:me,month:Ut,day:me,weekday:Ut},sc={hour:me,minute:me},lc={hour:me,minute:me,second:me},rc={hour:me,minute:me,second:me,timeZoneName:en},oc={hour:me,minute:me,second:me,timeZoneName:Ut},ac={hour:me,minute:me,hourCycle:"h23"},uc={hour:me,minute:me,second:me,hourCycle:"h23"},fc={hour:me,minute:me,second:me,hourCycle:"h23",timeZoneName:en},cc={hour:me,minute:me,second:me,hourCycle:"h23",timeZoneName:Ut},dc={year:me,month:me,day:me,hour:me,minute:me},pc={year:me,month:me,day:me,hour:me,minute:me,second:me},mc={year:me,month:en,day:me,hour:me,minute:me},hc={year:me,month:en,day:me,hour:me,minute:me,second:me},Rp={year:me,month:en,day:me,weekday:en,hour:me,minute:me},_c={year:me,month:Ut,day:me,hour:me,minute:me,timeZoneName:en},gc={year:me,month:Ut,day:me,hour:me,minute:me,second:me,timeZoneName:en},bc={year:me,month:Ut,day:me,weekday:Ut,hour:me,minute:me,timeZoneName:Ut},wc={year:me,month:Ut,day:me,weekday:Ut,hour:me,minute:me,second:me,timeZoneName:Ut};class Xi{get type(){throw new yn}get name(){throw new yn}get ianaName(){return this.name}get isUniversal(){throw new yn}offsetName(e,t){throw new yn}formatOffset(e,t){throw new yn}offset(e){throw new yn}equals(e){throw new yn}get isValid(){throw new yn}}let Xs=null;class qs extends Xi{static get instance(){return Xs===null&&(Xs=new qs),Xs}get type(){return"system"}get name(){return new Intl.DateTimeFormat().resolvedOptions().timeZone}get isUniversal(){return!1}offsetName(e,{format:t,locale:i}){return Lc(e,t,i)}formatOffset(e,t){return qi(this.offset(e),t)}offset(e){return-new Date(e).getTimezoneOffset()}equals(e){return e.type==="system"}get isValid(){return!0}}let gs={};function Hp(n){return gs[n]||(gs[n]=new Intl.DateTimeFormat("en-US",{hour12:!1,timeZone:n,year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",era:"short"})),gs[n]}const Up={year:0,month:1,day:2,era:3,hour:4,minute:5,second:6};function qp(n,e){const t=n.format(e).replace(/\u200E/g,""),i=/(\d+)\/(\d+)\/(\d+) (AD|BC),? (\d+):(\d+):(\d+)/.exec(t),[,s,l,r,o,a,u,f]=i;return[r,s,l,o,a,u,f]}function $p(n,e){const t=n.formatToParts(e),i=[];for(let s=0;s<t.length;s++){const{type:l,value:r}=t[s],o=Up[l];l==="era"?i[o]=r:De(o)||(i[o]=parseInt(r,10))}return i}let os={};class mn extends Xi{static create(e){return os[e]||(os[e]=new mn(e)),os[e]}static resetCache(){os={},gs={}}static isValidSpecifier(e){return this.isValidZone(e)}static isValidZone(e){if(!e)return!1;try{return new Intl.DateTimeFormat("en-US",{timeZone:e}).format(),!0}catch{return!1}}constructor(e){super(),this.zoneName=e,this.valid=mn.isValidZone(e)}get type(){return"iana"}get name(){return this.zoneName}get isUniversal(){return!1}offsetName(e,{format:t,locale:i}){return Lc(e,t,i,this.name)}formatOffset(e,t){return qi(this.offset(e),t)}offset(e){const t=new Date(e);if(isNaN(t))return NaN;const i=Hp(this.name);let[s,l,r,o,a,u,f]=i.formatToParts?$p(i,t):qp(i,t);o==="BC"&&(s=-Math.abs(s)+1);const d=Fs({year:s,month:l,day:r,hour:a===24?0:a,minute:u,second:f,millisecond:0});let m=+t;const h=m%1e3;return m-=h>=0?h:1e3+h,(d-m)/(60*1e3)}equals(e){return e.type==="iana"&&e.name===this.name}get isValid(){return this.valid}}let Lr={};function Fp(n,e={}){const t=JSON.stringify([n,e]);let i=Lr[t];return i||(i=new Intl.ListFormat(n,e),Lr[t]=i),i}let _l={};function gl(n,e={}){const t=JSON.stringify([n,e]);let i=_l[t];return i||(i=new Intl.DateTimeFormat(n,e),_l[t]=i),i}let bl={};function Wp(n,e={}){const t=JSON.stringify([n,e]);let i=bl[t];return i||(i=new Intl.NumberFormat(n,e),bl[t]=i),i}let wl={};function Vp(n,e={}){const{base:t,...i}=e,s=JSON.stringify([n,i]);let l=wl[s];return l||(l=new Intl.RelativeTimeFormat(n,e),wl[s]=l),l}let Mi=null;function zp(){return Mi||(Mi=new Intl.DateTimeFormat().resolvedOptions().locale,Mi)}let Ir={};function Bp(n){let e=Ir[n];if(!e){const t=new Intl.Locale(n);e="getWeekInfo"in t?t.getWeekInfo():t.weekInfo,Ir[n]=e}return e}function Zp(n){const e=n.indexOf("-x-");e!==-1&&(n=n.substring(0,e));const t=n.indexOf("-u-");if(t===-1)return[n];{let i,s;try{i=gl(n).resolvedOptions(),s=n}catch{const a=n.substring(0,t);i=gl(a).resolvedOptions(),s=a}const{numberingSystem:l,calendar:r}=i;return[s,l,r]}}function Yp(n,e,t){return(t||e)&&(n.includes("-u-")||(n+="-u"),t&&(n+=`-ca-${t}`),e&&(n+=`-nu-${e}`)),n}function Kp(n){const e=[];for(let t=1;t<=12;t++){const i=Ae.utc(2009,t,1);e.push(n(i))}return e}function Gp(n){const e=[];for(let t=1;t<=7;t++){const i=Ae.utc(2016,11,13+t);e.push(n(i))}return e}function as(n,e,t,i){const s=n.listingMode();return s==="error"?null:s==="en"?t(e):i(e)}function Jp(n){return n.numberingSystem&&n.numberingSystem!=="latn"?!1:n.numberingSystem==="latn"||!n.locale||n.locale.startsWith("en")||new Intl.DateTimeFormat(n.intl).resolvedOptions().numberingSystem==="latn"}class Xp{constructor(e,t,i){this.padTo=i.padTo||0,this.floor=i.floor||!1;const{padTo:s,floor:l,...r}=i;if(!t||Object.keys(r).length>0){const o={useGrouping:!1,...i};i.padTo>0&&(o.minimumIntegerDigits=i.padTo),this.inf=Wp(e,o)}}format(e){if(this.inf){const t=this.floor?Math.floor(e):e;return this.inf.format(t)}else{const t=this.floor?Math.floor(e):Vl(e,3);return wt(t,this.padTo)}}}class Qp{constructor(e,t,i){this.opts=i,this.originalZone=void 0;let s;if(this.opts.timeZone)this.dt=e;else if(e.zone.type==="fixed"){const r=-1*(e.offset/60),o=r>=0?`Etc/GMT+${r}`:`Etc/GMT${r}`;e.offset!==0&&mn.create(o).valid?(s=o,this.dt=e):(s="UTC",this.dt=e.offset===0?e:e.setZone("UTC").plus({minutes:e.offset}),this.originalZone=e.zone)}else e.zone.type==="system"?this.dt=e:e.zone.type==="iana"?(this.dt=e,s=e.zone.name):(s="UTC",this.dt=e.setZone("UTC").plus({minutes:e.offset}),this.originalZone=e.zone);const l={...this.opts};l.timeZone=l.timeZone||s,this.dtf=gl(t,l)}format(){return this.originalZone?this.formatToParts().map(({value:e})=>e).join(""):this.dtf.format(this.dt.toJSDate())}formatToParts(){const e=this.dtf.formatToParts(this.dt.toJSDate());return this.originalZone?e.map(t=>{if(t.type==="timeZoneName"){const i=this.originalZone.offsetName(this.dt.ts,{locale:this.dt.locale,format:this.opts.timeZoneName});return{...t,value:i}}else return t}):e}resolvedOptions(){return this.dtf.resolvedOptions()}}class xp{constructor(e,t,i){this.opts={style:"long",...i},!t&&Cc()&&(this.rtf=Vp(e,i))}format(e,t){return this.rtf?this.rtf.format(e,t):km(t,e,this.opts.numeric,this.opts.style!=="long")}formatToParts(e,t){return this.rtf?this.rtf.formatToParts(e,t):[]}}const em={firstDay:1,minimalDays:4,weekend:[6,7]};class Ke{static fromOpts(e){return Ke.create(e.locale,e.numberingSystem,e.outputCalendar,e.weekSettings,e.defaultToEN)}static create(e,t,i,s,l=!1){const r=e||mt.defaultLocale,o=r||(l?"en-US":zp()),a=t||mt.defaultNumberingSystem,u=i||mt.defaultOutputCalendar,f=yl(s)||mt.defaultWeekSettings;return new Ke(o,a,u,f,r)}static resetCache(){Mi=null,_l={},bl={},wl={}}static fromObject({locale:e,numberingSystem:t,outputCalendar:i,weekSettings:s}={}){return Ke.create(e,t,i,s)}constructor(e,t,i,s,l){const[r,o,a]=Zp(e);this.locale=r,this.numberingSystem=t||o||null,this.outputCalendar=i||a||null,this.weekSettings=s,this.intl=Yp(this.locale,this.numberingSystem,this.outputCalendar),this.weekdaysCache={format:{},standalone:{}},this.monthsCache={format:{},standalone:{}},this.meridiemCache=null,this.eraCache={},this.specifiedLocale=l,this.fastNumbersCached=null}get fastNumbers(){return this.fastNumbersCached==null&&(this.fastNumbersCached=Jp(this)),this.fastNumbersCached}listingMode(){const e=this.isEnglish(),t=(this.numberingSystem===null||this.numberingSystem==="latn")&&(this.outputCalendar===null||this.outputCalendar==="gregory");return e&&t?"en":"intl"}clone(e){return!e||Object.getOwnPropertyNames(e).length===0?this:Ke.create(e.locale||this.specifiedLocale,e.numberingSystem||this.numberingSystem,e.outputCalendar||this.outputCalendar,yl(e.weekSettings)||this.weekSettings,e.defaultToEN||!1)}redefaultToEN(e={}){return this.clone({...e,defaultToEN:!0})}redefaultToSystem(e={}){return this.clone({...e,defaultToEN:!1})}months(e,t=!1){return as(this,e,Pc,()=>{const i=t?{month:e,day:"numeric"}:{month:e},s=t?"format":"standalone";return this.monthsCache[s][e]||(this.monthsCache[s][e]=Kp(l=>this.extract(l,i,"month"))),this.monthsCache[s][e]})}weekdays(e,t=!1){return as(this,e,Dc,()=>{const i=t?{weekday:e,year:"numeric",month:"long",day:"numeric"}:{weekday:e},s=t?"format":"standalone";return this.weekdaysCache[s][e]||(this.weekdaysCache[s][e]=Gp(l=>this.extract(l,i,"weekday"))),this.weekdaysCache[s][e]})}meridiems(){return as(this,void 0,()=>Mc,()=>{if(!this.meridiemCache){const e={hour:"numeric",hourCycle:"h12"};this.meridiemCache=[Ae.utc(2016,11,13,9),Ae.utc(2016,11,13,19)].map(t=>this.extract(t,e,"dayperiod"))}return this.meridiemCache})}eras(e){return as(this,e,Rc,()=>{const t={era:e};return this.eraCache[e]||(this.eraCache[e]=[Ae.utc(-40,1,1),Ae.utc(2017,1,1)].map(i=>this.extract(i,t,"era"))),this.eraCache[e]})}extract(e,t,i){const s=this.dtFormatter(e,t),l=s.formatToParts(),r=l.find(o=>o.type.toLowerCase()===i);return r?r.value:null}numberFormatter(e={}){return new Xp(this.intl,e.forceSimple||this.fastNumbers,e)}dtFormatter(e,t={}){return new Qp(e,this.intl,t)}relFormatter(e={}){return new xp(this.intl,this.isEnglish(),e)}listFormatter(e={}){return Fp(this.intl,e)}isEnglish(){return this.locale==="en"||this.locale.toLowerCase()==="en-us"||new Intl.DateTimeFormat(this.intl).resolvedOptions().locale.startsWith("en-us")}getWeekSettings(){return this.weekSettings?this.weekSettings:Ec()?Bp(this.locale):em}getStartOfWeek(){return this.getWeekSettings().firstDay}getMinDaysInFirstWeek(){return this.getWeekSettings().minimalDays}getWeekendDays(){return this.getWeekSettings().weekend}equals(e){return this.locale===e.locale&&this.numberingSystem===e.numberingSystem&&this.outputCalendar===e.outputCalendar}toString(){return`Locale(${this.locale}, ${this.numberingSystem}, ${this.outputCalendar})`}}let Qs=null;class Pt extends Xi{static get utcInstance(){return Qs===null&&(Qs=new Pt(0)),Qs}static instance(e){return e===0?Pt.utcInstance:new Pt(e)}static parseSpecifier(e){if(e){const t=e.match(/^utc(?:([+-]\d{1,2})(?::(\d{2}))?)?$/i);if(t)return new Pt(Ws(t[1],t[2]))}return null}constructor(e){super(),this.fixed=e}get type(){return"fixed"}get name(){return this.fixed===0?"UTC":`UTC${qi(this.fixed,"narrow")}`}get ianaName(){return this.fixed===0?"Etc/UTC":`Etc/GMT${qi(-this.fixed,"narrow")}`}offsetName(){return this.name}formatOffset(e,t){return qi(this.fixed,t)}get isUniversal(){return!0}offset(){return this.fixed}equals(e){return e.type==="fixed"&&e.fixed===this.fixed}get isValid(){return!0}}class tm extends Xi{constructor(e){super(),this.zoneName=e}get type(){return"invalid"}get name(){return this.zoneName}get isUniversal(){return!1}offsetName(){return null}formatOffset(){return""}offset(){return NaN}equals(){return!1}get isValid(){return!1}}function Sn(n,e){if(De(n)||n===null)return e;if(n instanceof Xi)return n;if(om(n)){const t=n.toLowerCase();return t==="default"?e:t==="local"||t==="system"?qs.instance:t==="utc"||t==="gmt"?Pt.utcInstance:Pt.parseSpecifier(t)||mn.create(n)}else return On(n)?Pt.instance(n):typeof n=="object"&&"offset"in n&&typeof n.offset=="function"?n:new tm(n)}const ql={arab:"[٠-٩]",arabext:"[۰-۹]",bali:"[᭐-᭙]",beng:"[০-৯]",deva:"[०-९]",fullwide:"[０-９]",gujr:"[૦-૯]",hanidec:"[〇|一|二|三|四|五|六|七|八|九]",khmr:"[០-៩]",knda:"[೦-೯]",laoo:"[໐-໙]",limb:"[᥆-᥏]",mlym:"[൦-൯]",mong:"[᠐-᠙]",mymr:"[၀-၉]",orya:"[୦-୯]",tamldec:"[௦-௯]",telu:"[౦-౯]",thai:"[๐-๙]",tibt:"[༠-༩]",latn:"\\d"},jr={arab:[1632,1641],arabext:[1776,1785],bali:[6992,7001],beng:[2534,2543],deva:[2406,2415],fullwide:[65296,65303],gujr:[2790,2799],khmr:[6112,6121],knda:[3302,3311],laoo:[3792,3801],limb:[6470,6479],mlym:[3430,3439],mong:[6160,6169],mymr:[4160,4169],orya:[2918,2927],tamldec:[3046,3055],telu:[3174,3183],thai:[3664,3673],tibt:[3872,3881]},nm=ql.hanidec.replace(/[\[|\]]/g,"").split("");function im(n){let e=parseInt(n,10);if(isNaN(e)){e="";for(let t=0;t<n.length;t++){const i=n.charCodeAt(t);if(n[t].search(ql.hanidec)!==-1)e+=nm.indexOf(n[t]);else for(const s in jr){const[l,r]=jr[s];i>=l&&i<=r&&(e+=i-l)}}return parseInt(e,10)}else return e}let li={};function sm(){li={}}function Xt({numberingSystem:n},e=""){const t=n||"latn";return li[t]||(li[t]={}),li[t][e]||(li[t][e]=new RegExp(`${ql[t]}${e}`)),li[t][e]}let Pr=()=>Date.now(),Nr="system",Ar=null,Dr=null,Mr=null,Rr=60,Hr,Ur=null;class mt{static get now(){return Pr}static set now(e){Pr=e}static set defaultZone(e){Nr=e}static get defaultZone(){return Sn(Nr,qs.instance)}static get defaultLocale(){return Ar}static set defaultLocale(e){Ar=e}static get defaultNumberingSystem(){return Dr}static set defaultNumberingSystem(e){Dr=e}static get defaultOutputCalendar(){return Mr}static set defaultOutputCalendar(e){Mr=e}static get defaultWeekSettings(){return Ur}static set defaultWeekSettings(e){Ur=yl(e)}static get twoDigitCutoffYear(){return Rr}static set twoDigitCutoffYear(e){Rr=e%100}static get throwOnInvalid(){return Hr}static set throwOnInvalid(e){Hr=e}static resetCaches(){Ke.resetCache(),mn.resetCache(),Ae.resetCache(),sm()}}class xt{constructor(e,t){this.reason=e,this.explanation=t}toMessage(){return this.explanation?`${this.reason}: ${this.explanation}`:this.reason}}const yc=[0,31,59,90,120,151,181,212,243,273,304,334],vc=[0,31,60,91,121,152,182,213,244,274,305,335];function Vt(n,e){return new xt("unit out of range",`you specified ${e} (of type ${typeof e}) as a ${n}, which is invalid`)}function $l(n,e,t){const i=new Date(Date.UTC(n,e-1,t));n<100&&n>=0&&i.setUTCFullYear(i.getUTCFullYear()-1900);const s=i.getUTCDay();return s===0?7:s}function kc(n,e,t){return t+(Qi(n)?vc:yc)[e-1]}function Sc(n,e){const t=Qi(n)?vc:yc,i=t.findIndex(l=>l<e),s=e-t[i];return{month:i+1,day:s}}function Fl(n,e){return(n-e+7)%7+1}function Os(n,e=4,t=1){const{year:i,month:s,day:l}=n,r=kc(i,s,l),o=Fl($l(i,s,l),t);let a=Math.floor((r-o+14-e)/7),u;return a<1?(u=i-1,a=Yi(u,e,t)):a>Yi(i,e,t)?(u=i+1,a=1):u=i,{weekYear:u,weekNumber:a,weekday:o,...Vs(n)}}function qr(n,e=4,t=1){const{weekYear:i,weekNumber:s,weekday:l}=n,r=Fl($l(i,1,e),t),o=mi(i);let a=s*7+l-r-7+e,u;a<1?(u=i-1,a+=mi(u)):a>o?(u=i+1,a-=mi(i)):u=i;const{month:f,day:c}=Sc(u,a);return{year:u,month:f,day:c,...Vs(n)}}function xs(n){const{year:e,month:t,day:i}=n,s=kc(e,t,i);return{year:e,ordinal:s,...Vs(n)}}function $r(n){const{year:e,ordinal:t}=n,{month:i,day:s}=Sc(e,t);return{year:e,month:i,day:s,...Vs(n)}}function Fr(n,e){if(!De(n.localWeekday)||!De(n.localWeekNumber)||!De(n.localWeekYear)){if(!De(n.weekday)||!De(n.weekNumber)||!De(n.weekYear))throw new ri("Cannot mix locale-based week fields with ISO-based week fields");return De(n.localWeekday)||(n.weekday=n.localWeekday),De(n.localWeekNumber)||(n.weekNumber=n.localWeekNumber),De(n.localWeekYear)||(n.weekYear=n.localWeekYear),delete n.localWeekday,delete n.localWeekNumber,delete n.localWeekYear,{minDaysInFirstWeek:e.getMinDaysInFirstWeek(),startOfWeek:e.getStartOfWeek()}}else return{minDaysInFirstWeek:4,startOfWeek:1}}function lm(n,e=4,t=1){const i=$s(n.weekYear),s=zt(n.weekNumber,1,Yi(n.weekYear,e,t)),l=zt(n.weekday,1,7);return i?s?l?!1:Vt("weekday",n.weekday):Vt("week",n.weekNumber):Vt("weekYear",n.weekYear)}function rm(n){const e=$s(n.year),t=zt(n.ordinal,1,mi(n.year));return e?t?!1:Vt("ordinal",n.ordinal):Vt("year",n.year)}function Tc(n){const e=$s(n.year),t=zt(n.month,1,12),i=zt(n.day,1,Cs(n.year,n.month));return e?t?i?!1:Vt("day",n.day):Vt("month",n.month):Vt("year",n.year)}function Oc(n){const{hour:e,minute:t,second:i,millisecond:s}=n,l=zt(e,0,23)||e===24&&t===0&&i===0&&s===0,r=zt(t,0,59),o=zt(i,0,59),a=zt(s,0,999);return l?r?o?a?!1:Vt("millisecond",s):Vt("second",i):Vt("minute",t):Vt("hour",e)}function De(n){return typeof n>"u"}function On(n){return typeof n=="number"}function $s(n){return typeof n=="number"&&n%1===0}function om(n){return typeof n=="string"}function am(n){return Object.prototype.toString.call(n)==="[object Date]"}function Cc(){try{return typeof Intl<"u"&&!!Intl.RelativeTimeFormat}catch{return!1}}function Ec(){try{return typeof Intl<"u"&&!!Intl.Locale&&("weekInfo"in Intl.Locale.prototype||"getWeekInfo"in Intl.Locale.prototype)}catch{return!1}}function um(n){return Array.isArray(n)?n:[n]}function Wr(n,e,t){if(n.length!==0)return n.reduce((i,s)=>{const l=[e(s),s];return i&&t(i[0],l[0])===i[0]?i:l},null)[1]}function fm(n,e){return e.reduce((t,i)=>(t[i]=n[i],t),{})}function bi(n,e){return Object.prototype.hasOwnProperty.call(n,e)}function yl(n){if(n==null)return null;if(typeof n!="object")throw new Ct("Week settings must be an object");if(!zt(n.firstDay,1,7)||!zt(n.minimalDays,1,7)||!Array.isArray(n.weekend)||n.weekend.some(e=>!zt(e,1,7)))throw new Ct("Invalid week settings");return{firstDay:n.firstDay,minimalDays:n.minimalDays,weekend:Array.from(n.weekend)}}function zt(n,e,t){return $s(n)&&n>=e&&n<=t}function cm(n,e){return n-e*Math.floor(n/e)}function wt(n,e=2){const t=n<0;let i;return t?i="-"+(""+-n).padStart(e,"0"):i=(""+n).padStart(e,"0"),i}function kn(n){if(!(De(n)||n===null||n===""))return parseInt(n,10)}function An(n){if(!(De(n)||n===null||n===""))return parseFloat(n)}function Wl(n){if(!(De(n)||n===null||n==="")){const e=parseFloat("0."+n)*1e3;return Math.floor(e)}}function Vl(n,e,t=!1){const i=10**e;return(t?Math.trunc:Math.round)(n*i)/i}function Qi(n){return n%4===0&&(n%100!==0||n%400===0)}function mi(n){return Qi(n)?366:365}function Cs(n,e){const t=cm(e-1,12)+1,i=n+(e-t)/12;return t===2?Qi(i)?29:28:[31,null,31,30,31,30,31,31,30,31,30,31][t-1]}function Fs(n){let e=Date.UTC(n.year,n.month-1,n.day,n.hour,n.minute,n.second,n.millisecond);return n.year<100&&n.year>=0&&(e=new Date(e),e.setUTCFullYear(n.year,n.month-1,n.day)),+e}function Vr(n,e,t){return-Fl($l(n,1,e),t)+e-1}function Yi(n,e=4,t=1){const i=Vr(n,e,t),s=Vr(n+1,e,t);return(mi(n)-i+s)/7}function vl(n){return n>99?n:n>mt.twoDigitCutoffYear?1900+n:2e3+n}function Lc(n,e,t,i=null){const s=new Date(n),l={hourCycle:"h23",year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"};i&&(l.timeZone=i);const r={timeZoneName:e,...l},o=new Intl.DateTimeFormat(t,r).formatToParts(s).find(a=>a.type.toLowerCase()==="timezonename");return o?o.value:null}function Ws(n,e){let t=parseInt(n,10);Number.isNaN(t)&&(t=0);const i=parseInt(e,10)||0,s=t<0||Object.is(t,-0)?-i:i;return t*60+s}function Ic(n){const e=Number(n);if(typeof n=="boolean"||n===""||Number.isNaN(e))throw new Ct(`Invalid unit value ${n}`);return e}function Es(n,e){const t={};for(const i in n)if(bi(n,i)){const s=n[i];if(s==null)continue;t[e(i)]=Ic(s)}return t}function qi(n,e){const t=Math.trunc(Math.abs(n/60)),i=Math.trunc(Math.abs(n%60)),s=n>=0?"+":"-";switch(e){case"short":return`${s}${wt(t,2)}:${wt(i,2)}`;case"narrow":return`${s}${t}${i>0?`:${i}`:""}`;case"techie":return`${s}${wt(t,2)}${wt(i,2)}`;default:throw new RangeError(`Value format ${e} is out of range for property format`)}}function Vs(n){return fm(n,["hour","minute","second","millisecond"])}const dm=["January","February","March","April","May","June","July","August","September","October","November","December"],jc=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],pm=["J","F","M","A","M","J","J","A","S","O","N","D"];function Pc(n){switch(n){case"narrow":return[...pm];case"short":return[...jc];case"long":return[...dm];case"numeric":return["1","2","3","4","5","6","7","8","9","10","11","12"];case"2-digit":return["01","02","03","04","05","06","07","08","09","10","11","12"];default:return null}}const Nc=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],Ac=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],mm=["M","T","W","T","F","S","S"];function Dc(n){switch(n){case"narrow":return[...mm];case"short":return[...Ac];case"long":return[...Nc];case"numeric":return["1","2","3","4","5","6","7"];default:return null}}const Mc=["AM","PM"],hm=["Before Christ","Anno Domini"],_m=["BC","AD"],gm=["B","A"];function Rc(n){switch(n){case"narrow":return[...gm];case"short":return[..._m];case"long":return[...hm];default:return null}}function bm(n){return Mc[n.hour<12?0:1]}function wm(n,e){return Dc(e)[n.weekday-1]}function ym(n,e){return Pc(e)[n.month-1]}function vm(n,e){return Rc(e)[n.year<0?0:1]}function km(n,e,t="always",i=!1){const s={years:["year","yr."],quarters:["quarter","qtr."],months:["month","mo."],weeks:["week","wk."],days:["day","day","days"],hours:["hour","hr."],minutes:["minute","min."],seconds:["second","sec."]},l=["hours","minutes","seconds"].indexOf(n)===-1;if(t==="auto"&&l){const c=n==="days";switch(e){case 1:return c?"tomorrow":`next ${s[n][0]}`;case-1:return c?"yesterday":`last ${s[n][0]}`;case 0:return c?"today":`this ${s[n][0]}`}}const r=Object.is(e,-0)||e<0,o=Math.abs(e),a=o===1,u=s[n],f=i?a?u[1]:u[2]||u[1]:a?s[n][0]:n;return r?`${o} ${f} ago`:`in ${o} ${f}`}function zr(n,e){let t="";for(const i of n)i.literal?t+=i.val:t+=e(i.val);return t}const Sm={D:Ts,DD:tc,DDD:nc,DDDD:ic,t:sc,tt:lc,ttt:rc,tttt:oc,T:ac,TT:uc,TTT:fc,TTTT:cc,f:dc,ff:mc,fff:_c,ffff:bc,F:pc,FF:hc,FFF:gc,FFFF:wc};class Et{static create(e,t={}){return new Et(e,t)}static parseFormat(e){let t=null,i="",s=!1;const l=[];for(let r=0;r<e.length;r++){const o=e.charAt(r);o==="'"?(i.length>0&&l.push({literal:s||/^\s+$/.test(i),val:i}),t=null,i="",s=!s):s||o===t?i+=o:(i.length>0&&l.push({literal:/^\s+$/.test(i),val:i}),i=o,t=o)}return i.length>0&&l.push({literal:s||/^\s+$/.test(i),val:i}),l}static macroTokenToFormatOpts(e){return Sm[e]}constructor(e,t){this.opts=t,this.loc=e,this.systemLoc=null}formatWithSystemDefault(e,t){return this.systemLoc===null&&(this.systemLoc=this.loc.redefaultToSystem()),this.systemLoc.dtFormatter(e,{...this.opts,...t}).format()}dtFormatter(e,t={}){return this.loc.dtFormatter(e,{...this.opts,...t})}formatDateTime(e,t){return this.dtFormatter(e,t).format()}formatDateTimeParts(e,t){return this.dtFormatter(e,t).formatToParts()}formatInterval(e,t){return this.dtFormatter(e.start,t).dtf.formatRange(e.start.toJSDate(),e.end.toJSDate())}resolvedOptions(e,t){return this.dtFormatter(e,t).resolvedOptions()}num(e,t=0){if(this.opts.forceSimple)return wt(e,t);const i={...this.opts};return t>0&&(i.padTo=t),this.loc.numberFormatter(i).format(e)}formatDateTimeFromString(e,t){const i=this.loc.listingMode()==="en",s=this.loc.outputCalendar&&this.loc.outputCalendar!=="gregory",l=(m,h)=>this.loc.extract(e,m,h),r=m=>e.isOffsetFixed&&e.offset===0&&m.allowZ?"Z":e.isValid?e.zone.formatOffset(e.ts,m.format):"",o=()=>i?bm(e):l({hour:"numeric",hourCycle:"h12"},"dayperiod"),a=(m,h)=>i?ym(e,m):l(h?{month:m}:{month:m,day:"numeric"},"month"),u=(m,h)=>i?wm(e,m):l(h?{weekday:m}:{weekday:m,month:"long",day:"numeric"},"weekday"),f=m=>{const h=Et.macroTokenToFormatOpts(m);return h?this.formatWithSystemDefault(e,h):m},c=m=>i?vm(e,m):l({era:m},"era"),d=m=>{switch(m){case"S":return this.num(e.millisecond);case"u":case"SSS":return this.num(e.millisecond,3);case"s":return this.num(e.second);case"ss":return this.num(e.second,2);case"uu":return this.num(Math.floor(e.millisecond/10),2);case"uuu":return this.num(Math.floor(e.millisecond/100));case"m":return this.num(e.minute);case"mm":return this.num(e.minute,2);case"h":return this.num(e.hour%12===0?12:e.hour%12);case"hh":return this.num(e.hour%12===0?12:e.hour%12,2);case"H":return this.num(e.hour);case"HH":return this.num(e.hour,2);case"Z":return r({format:"narrow",allowZ:this.opts.allowZ});case"ZZ":return r({format:"short",allowZ:this.opts.allowZ});case"ZZZ":return r({format:"techie",allowZ:this.opts.allowZ});case"ZZZZ":return e.zone.offsetName(e.ts,{format:"short",locale:this.loc.locale});case"ZZZZZ":return e.zone.offsetName(e.ts,{format:"long",locale:this.loc.locale});case"z":return e.zoneName;case"a":return o();case"d":return s?l({day:"numeric"},"day"):this.num(e.day);case"dd":return s?l({day:"2-digit"},"day"):this.num(e.day,2);case"c":return this.num(e.weekday);case"ccc":return u("short",!0);case"cccc":return u("long",!0);case"ccccc":return u("narrow",!0);case"E":return this.num(e.weekday);case"EEE":return u("short",!1);case"EEEE":return u("long",!1);case"EEEEE":return u("narrow",!1);case"L":return s?l({month:"numeric",day:"numeric"},"month"):this.num(e.month);case"LL":return s?l({month:"2-digit",day:"numeric"},"month"):this.num(e.month,2);case"LLL":return a("short",!0);case"LLLL":return a("long",!0);case"LLLLL":return a("narrow",!0);case"M":return s?l({month:"numeric"},"month"):this.num(e.month);case"MM":return s?l({month:"2-digit"},"month"):this.num(e.month,2);case"MMM":return a("short",!1);case"MMMM":return a("long",!1);case"MMMMM":return a("narrow",!1);case"y":return s?l({year:"numeric"},"year"):this.num(e.year);case"yy":return s?l({year:"2-digit"},"year"):this.num(e.year.toString().slice(-2),2);case"yyyy":return s?l({year:"numeric"},"year"):this.num(e.year,4);case"yyyyyy":return s?l({year:"numeric"},"year"):this.num(e.year,6);case"G":return c("short");case"GG":return c("long");case"GGGGG":return c("narrow");case"kk":return this.num(e.weekYear.toString().slice(-2),2);case"kkkk":return this.num(e.weekYear,4);case"W":return this.num(e.weekNumber);case"WW":return this.num(e.weekNumber,2);case"n":return this.num(e.localWeekNumber);case"nn":return this.num(e.localWeekNumber,2);case"ii":return this.num(e.localWeekYear.toString().slice(-2),2);case"iiii":return this.num(e.localWeekYear,4);case"o":return this.num(e.ordinal);case"ooo":return this.num(e.ordinal,3);case"q":return this.num(e.quarter);case"qq":return this.num(e.quarter,2);case"X":return this.num(Math.floor(e.ts/1e3));case"x":return this.num(e.ts);default:return f(m)}};return zr(Et.parseFormat(t),d)}formatDurationFromString(e,t){const i=a=>{switch(a[0]){case"S":return"millisecond";case"s":return"second";case"m":return"minute";case"h":return"hour";case"d":return"day";case"w":return"week";case"M":return"month";case"y":return"year";default:return null}},s=a=>u=>{const f=i(u);return f?this.num(a.get(f),u.length):u},l=Et.parseFormat(t),r=l.reduce((a,{literal:u,val:f})=>u?a:a.concat(f),[]),o=e.shiftTo(...r.map(i).filter(a=>a));return zr(l,s(o))}}const Hc=/[A-Za-z_+-]{1,256}(?::?\/[A-Za-z0-9_+-]{1,256}(?:\/[A-Za-z0-9_+-]{1,256})?)?/;function Ti(...n){const e=n.reduce((t,i)=>t+i.source,"");return RegExp(`^${e}$`)}function Oi(...n){return e=>n.reduce(([t,i,s],l)=>{const[r,o,a]=l(e,s);return[{...t,...r},o||i,a]},[{},null,1]).slice(0,2)}function Ci(n,...e){if(n==null)return[null,null];for(const[t,i]of e){const s=t.exec(n);if(s)return i(s)}return[null,null]}function Uc(...n){return(e,t)=>{const i={};let s;for(s=0;s<n.length;s++)i[n[s]]=kn(e[t+s]);return[i,null,t+s]}}const qc=/(?:(Z)|([+-]\d\d)(?::?(\d\d))?)/,Tm=`(?:${qc.source}?(?:\\[(${Hc.source})\\])?)?`,zl=/(\d\d)(?::?(\d\d)(?::?(\d\d)(?:[.,](\d{1,30}))?)?)?/,$c=RegExp(`${zl.source}${Tm}`),Bl=RegExp(`(?:T${$c.source})?`),Om=/([+-]\d{6}|\d{4})(?:-?(\d\d)(?:-?(\d\d))?)?/,Cm=/(\d{4})-?W(\d\d)(?:-?(\d))?/,Em=/(\d{4})-?(\d{3})/,Lm=Uc("weekYear","weekNumber","weekDay"),Im=Uc("year","ordinal"),jm=/(\d{4})-(\d\d)-(\d\d)/,Fc=RegExp(`${zl.source} ?(?:${qc.source}|(${Hc.source}))?`),Pm=RegExp(`(?: ${Fc.source})?`);function hi(n,e,t){const i=n[e];return De(i)?t:kn(i)}function Nm(n,e){return[{year:hi(n,e),month:hi(n,e+1,1),day:hi(n,e+2,1)},null,e+3]}function Ei(n,e){return[{hours:hi(n,e,0),minutes:hi(n,e+1,0),seconds:hi(n,e+2,0),milliseconds:Wl(n[e+3])},null,e+4]}function xi(n,e){const t=!n[e]&&!n[e+1],i=Ws(n[e+1],n[e+2]),s=t?null:Pt.instance(i);return[{},s,e+3]}function es(n,e){const t=n[e]?mn.create(n[e]):null;return[{},t,e+1]}const Am=RegExp(`^T?${zl.source}$`),Dm=/^-?P(?:(?:(-?\d{1,20}(?:\.\d{1,20})?)Y)?(?:(-?\d{1,20}(?:\.\d{1,20})?)M)?(?:(-?\d{1,20}(?:\.\d{1,20})?)W)?(?:(-?\d{1,20}(?:\.\d{1,20})?)D)?(?:T(?:(-?\d{1,20}(?:\.\d{1,20})?)H)?(?:(-?\d{1,20}(?:\.\d{1,20})?)M)?(?:(-?\d{1,20})(?:[.,](-?\d{1,20}))?S)?)?)$/;function Mm(n){const[e,t,i,s,l,r,o,a,u]=n,f=e[0]==="-",c=a&&a[0]==="-",d=(m,h=!1)=>m!==void 0&&(h||m&&f)?-m:m;return[{years:d(An(t)),months:d(An(i)),weeks:d(An(s)),days:d(An(l)),hours:d(An(r)),minutes:d(An(o)),seconds:d(An(a),a==="-0"),milliseconds:d(Wl(u),c)}]}const Rm={GMT:0,EDT:-4*60,EST:-5*60,CDT:-5*60,CST:-6*60,MDT:-6*60,MST:-7*60,PDT:-7*60,PST:-8*60};function Zl(n,e,t,i,s,l,r){const o={year:e.length===2?vl(kn(e)):kn(e),month:jc.indexOf(t)+1,day:kn(i),hour:kn(s),minute:kn(l)};return r&&(o.second=kn(r)),n&&(o.weekday=n.length>3?Nc.indexOf(n)+1:Ac.indexOf(n)+1),o}const Hm=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|(?:([+-]\d\d)(\d\d)))$/;function Um(n){const[,e,t,i,s,l,r,o,a,u,f,c]=n,d=Zl(e,s,i,t,l,r,o);let m;return a?m=Rm[a]:u?m=0:m=Ws(f,c),[d,new Pt(m)]}function qm(n){return n.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").trim()}const $m=/^(Mon|Tue|Wed|Thu|Fri|Sat|Sun), (\d\d) (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) (\d{4}) (\d\d):(\d\d):(\d\d) GMT$/,Fm=/^(Monday|Tuesday|Wednesday|Thursday|Friday|Saturday|Sunday), (\d\d)-(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)-(\d\d) (\d\d):(\d\d):(\d\d) GMT$/,Wm=/^(Mon|Tue|Wed|Thu|Fri|Sat|Sun) (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) ( \d|\d\d) (\d\d):(\d\d):(\d\d) (\d{4})$/;function Br(n){const[,e,t,i,s,l,r,o]=n;return[Zl(e,s,i,t,l,r,o),Pt.utcInstance]}function Vm(n){const[,e,t,i,s,l,r,o]=n;return[Zl(e,o,t,i,s,l,r),Pt.utcInstance]}const zm=Ti(Om,Bl),Bm=Ti(Cm,Bl),Zm=Ti(Em,Bl),Ym=Ti($c),Wc=Oi(Nm,Ei,xi,es),Km=Oi(Lm,Ei,xi,es),Gm=Oi(Im,Ei,xi,es),Jm=Oi(Ei,xi,es);function Xm(n){return Ci(n,[zm,Wc],[Bm,Km],[Zm,Gm],[Ym,Jm])}function Qm(n){return Ci(qm(n),[Hm,Um])}function xm(n){return Ci(n,[$m,Br],[Fm,Br],[Wm,Vm])}function eh(n){return Ci(n,[Dm,Mm])}const th=Oi(Ei);function nh(n){return Ci(n,[Am,th])}const ih=Ti(jm,Pm),sh=Ti(Fc),lh=Oi(Ei,xi,es);function rh(n){return Ci(n,[ih,Wc],[sh,lh])}const Zr="Invalid Duration",Vc={weeks:{days:7,hours:7*24,minutes:7*24*60,seconds:7*24*60*60,milliseconds:7*24*60*60*1e3},days:{hours:24,minutes:24*60,seconds:24*60*60,milliseconds:24*60*60*1e3},hours:{minutes:60,seconds:60*60,milliseconds:60*60*1e3},minutes:{seconds:60,milliseconds:60*1e3},seconds:{milliseconds:1e3}},oh={years:{quarters:4,months:12,weeks:52,days:365,hours:365*24,minutes:365*24*60,seconds:365*24*60*60,milliseconds:365*24*60*60*1e3},quarters:{months:3,weeks:13,days:91,hours:91*24,minutes:91*24*60,seconds:91*24*60*60,milliseconds:91*24*60*60*1e3},months:{weeks:4,days:30,hours:30*24,minutes:30*24*60,seconds:30*24*60*60,milliseconds:30*24*60*60*1e3},...Vc},Ft=146097/400,ei=146097/4800,ah={years:{quarters:4,months:12,weeks:Ft/7,days:Ft,hours:Ft*24,minutes:Ft*24*60,seconds:Ft*24*60*60,milliseconds:Ft*24*60*60*1e3},quarters:{months:3,weeks:Ft/28,days:Ft/4,hours:Ft*24/4,minutes:Ft*24*60/4,seconds:Ft*24*60*60/4,milliseconds:Ft*24*60*60*1e3/4},months:{weeks:ei/7,days:ei,hours:ei*24,minutes:ei*24*60,seconds:ei*24*60*60,milliseconds:ei*24*60*60*1e3},...Vc},qn=["years","quarters","months","weeks","days","hours","minutes","seconds","milliseconds"],uh=qn.slice(0).reverse();function vn(n,e,t=!1){const i={values:t?e.values:{...n.values,...e.values||{}},loc:n.loc.clone(e.loc),conversionAccuracy:e.conversionAccuracy||n.conversionAccuracy,matrix:e.matrix||n.matrix};return new ze(i)}function zc(n,e){let t=e.milliseconds??0;for(const i of uh.slice(1))e[i]&&(t+=e[i]*n[i].milliseconds);return t}function Yr(n,e){const t=zc(n,e)<0?-1:1;qn.reduceRight((i,s)=>{if(De(e[s]))return i;if(i){const l=e[i]*t,r=n[s][i],o=Math.floor(l/r);e[s]+=o*t,e[i]-=o*r*t}return s},null),qn.reduce((i,s)=>{if(De(e[s]))return i;if(i){const l=e[i]%1;e[i]-=l,e[s]+=l*n[i][s]}return s},null)}function fh(n){const e={};for(const[t,i]of Object.entries(n))i!==0&&(e[t]=i);return e}class ze{constructor(e){const t=e.conversionAccuracy==="longterm"||!1;let i=t?ah:oh;e.matrix&&(i=e.matrix),this.values=e.values,this.loc=e.loc||Ke.create(),this.conversionAccuracy=t?"longterm":"casual",this.invalid=e.invalid||null,this.matrix=i,this.isLuxonDuration=!0}static fromMillis(e,t){return ze.fromObject({milliseconds:e},t)}static fromObject(e,t={}){if(e==null||typeof e!="object")throw new Ct(`Duration.fromObject: argument expected to be an object, got ${e===null?"null":typeof e}`);return new ze({values:Es(e,ze.normalizeUnit),loc:Ke.fromObject(t),conversionAccuracy:t.conversionAccuracy,matrix:t.matrix})}static fromDurationLike(e){if(On(e))return ze.fromMillis(e);if(ze.isDuration(e))return e;if(typeof e=="object")return ze.fromObject(e);throw new Ct(`Unknown duration argument ${e} of type ${typeof e}`)}static fromISO(e,t){const[i]=eh(e);return i?ze.fromObject(i,t):ze.invalid("unparsable",`the input "${e}" can't be parsed as ISO 8601`)}static fromISOTime(e,t){const[i]=nh(e);return i?ze.fromObject(i,t):ze.invalid("unparsable",`the input "${e}" can't be parsed as ISO 8601`)}static invalid(e,t=null){if(!e)throw new Ct("need to specify a reason the Duration is invalid");const i=e instanceof xt?e:new xt(e,t);if(mt.throwOnInvalid)throw new Dp(i);return new ze({invalid:i})}static normalizeUnit(e){const t={year:"years",years:"years",quarter:"quarters",quarters:"quarters",month:"months",months:"months",week:"weeks",weeks:"weeks",day:"days",days:"days",hour:"hours",hours:"hours",minute:"minutes",minutes:"minutes",second:"seconds",seconds:"seconds",millisecond:"milliseconds",milliseconds:"milliseconds"}[e&&e.toLowerCase()];if(!t)throw new ec(e);return t}static isDuration(e){return e&&e.isLuxonDuration||!1}get locale(){return this.isValid?this.loc.locale:null}get numberingSystem(){return this.isValid?this.loc.numberingSystem:null}toFormat(e,t={}){const i={...t,floor:t.round!==!1&&t.floor!==!1};return this.isValid?Et.create(this.loc,i).formatDurationFromString(this,e):Zr}toHuman(e={}){if(!this.isValid)return Zr;const t=qn.map(i=>{const s=this.values[i];return De(s)?null:this.loc.numberFormatter({style:"unit",unitDisplay:"long",...e,unit:i.slice(0,-1)}).format(s)}).filter(i=>i);return this.loc.listFormatter({type:"conjunction",style:e.listStyle||"narrow",...e}).format(t)}toObject(){return this.isValid?{...this.values}:{}}toISO(){if(!this.isValid)return null;let e="P";return this.years!==0&&(e+=this.years+"Y"),(this.months!==0||this.quarters!==0)&&(e+=this.months+this.quarters*3+"M"),this.weeks!==0&&(e+=this.weeks+"W"),this.days!==0&&(e+=this.days+"D"),(this.hours!==0||this.minutes!==0||this.seconds!==0||this.milliseconds!==0)&&(e+="T"),this.hours!==0&&(e+=this.hours+"H"),this.minutes!==0&&(e+=this.minutes+"M"),(this.seconds!==0||this.milliseconds!==0)&&(e+=Vl(this.seconds+this.milliseconds/1e3,3)+"S"),e==="P"&&(e+="T0S"),e}toISOTime(e={}){if(!this.isValid)return null;const t=this.toMillis();return t<0||t>=864e5?null:(e={suppressMilliseconds:!1,suppressSeconds:!1,includePrefix:!1,format:"extended",...e,includeOffset:!1},Ae.fromMillis(t,{zone:"UTC"}).toISOTime(e))}toJSON(){return this.toISO()}toString(){return this.toISO()}[Symbol.for("nodejs.util.inspect.custom")](){return this.isValid?`Duration { values: ${JSON.stringify(this.values)} }`:`Duration { Invalid, reason: ${this.invalidReason} }`}toMillis(){return this.isValid?zc(this.matrix,this.values):NaN}valueOf(){return this.toMillis()}plus(e){if(!this.isValid)return this;const t=ze.fromDurationLike(e),i={};for(const s of qn)(bi(t.values,s)||bi(this.values,s))&&(i[s]=t.get(s)+this.get(s));return vn(this,{values:i},!0)}minus(e){if(!this.isValid)return this;const t=ze.fromDurationLike(e);return this.plus(t.negate())}mapUnits(e){if(!this.isValid)return this;const t={};for(const i of Object.keys(this.values))t[i]=Ic(e(this.values[i],i));return vn(this,{values:t},!0)}get(e){return this[ze.normalizeUnit(e)]}set(e){if(!this.isValid)return this;const t={...this.values,...Es(e,ze.normalizeUnit)};return vn(this,{values:t})}reconfigure({locale:e,numberingSystem:t,conversionAccuracy:i,matrix:s}={}){const r={loc:this.loc.clone({locale:e,numberingSystem:t}),matrix:s,conversionAccuracy:i};return vn(this,r)}as(e){return this.isValid?this.shiftTo(e).get(e):NaN}normalize(){if(!this.isValid)return this;const e=this.toObject();return Yr(this.matrix,e),vn(this,{values:e},!0)}rescale(){if(!this.isValid)return this;const e=fh(this.normalize().shiftToAll().toObject());return vn(this,{values:e},!0)}shiftTo(...e){if(!this.isValid)return this;if(e.length===0)return this;e=e.map(r=>ze.normalizeUnit(r));const t={},i={},s=this.toObject();let l;for(const r of qn)if(e.indexOf(r)>=0){l=r;let o=0;for(const u in i)o+=this.matrix[u][r]*i[u],i[u]=0;On(s[r])&&(o+=s[r]);const a=Math.trunc(o);t[r]=a,i[r]=(o*1e3-a*1e3)/1e3}else On(s[r])&&(i[r]=s[r]);for(const r in i)i[r]!==0&&(t[l]+=r===l?i[r]:i[r]/this.matrix[l][r]);return Yr(this.matrix,t),vn(this,{values:t},!0)}shiftToAll(){return this.isValid?this.shiftTo("years","months","weeks","days","hours","minutes","seconds","milliseconds"):this}negate(){if(!this.isValid)return this;const e={};for(const t of Object.keys(this.values))e[t]=this.values[t]===0?0:-this.values[t];return vn(this,{values:e},!0)}get years(){return this.isValid?this.values.years||0:NaN}get quarters(){return this.isValid?this.values.quarters||0:NaN}get months(){return this.isValid?this.values.months||0:NaN}get weeks(){return this.isValid?this.values.weeks||0:NaN}get days(){return this.isValid?this.values.days||0:NaN}get hours(){return this.isValid?this.values.hours||0:NaN}get minutes(){return this.isValid?this.values.minutes||0:NaN}get seconds(){return this.isValid?this.values.seconds||0:NaN}get milliseconds(){return this.isValid?this.values.milliseconds||0:NaN}get isValid(){return this.invalid===null}get invalidReason(){return this.invalid?this.invalid.reason:null}get invalidExplanation(){return this.invalid?this.invalid.explanation:null}equals(e){if(!this.isValid||!e.isValid||!this.loc.equals(e.loc))return!1;function t(i,s){return i===void 0||i===0?s===void 0||s===0:i===s}for(const i of qn)if(!t(this.values[i],e.values[i]))return!1;return!0}}const ti="Invalid Interval";function ch(n,e){return!n||!n.isValid?pt.invalid("missing or invalid start"):!e||!e.isValid?pt.invalid("missing or invalid end"):e<n?pt.invalid("end before start",`The end of an interval must be after its start, but you had start=${n.toISO()} and end=${e.toISO()}`):null}class pt{constructor(e){this.s=e.start,this.e=e.end,this.invalid=e.invalid||null,this.isLuxonInterval=!0}static invalid(e,t=null){if(!e)throw new Ct("need to specify a reason the Interval is invalid");const i=e instanceof xt?e:new xt(e,t);if(mt.throwOnInvalid)throw new Ap(i);return new pt({invalid:i})}static fromDateTimes(e,t){const i=Di(e),s=Di(t),l=ch(i,s);return l??new pt({start:i,end:s})}static after(e,t){const i=ze.fromDurationLike(t),s=Di(e);return pt.fromDateTimes(s,s.plus(i))}static before(e,t){const i=ze.fromDurationLike(t),s=Di(e);return pt.fromDateTimes(s.minus(i),s)}static fromISO(e,t){const[i,s]=(e||"").split("/",2);if(i&&s){let l,r;try{l=Ae.fromISO(i,t),r=l.isValid}catch{r=!1}let o,a;try{o=Ae.fromISO(s,t),a=o.isValid}catch{a=!1}if(r&&a)return pt.fromDateTimes(l,o);if(r){const u=ze.fromISO(s,t);if(u.isValid)return pt.after(l,u)}else if(a){const u=ze.fromISO(i,t);if(u.isValid)return pt.before(o,u)}}return pt.invalid("unparsable",`the input "${e}" can't be parsed as ISO 8601`)}static isInterval(e){return e&&e.isLuxonInterval||!1}get start(){return this.isValid?this.s:null}get end(){return this.isValid?this.e:null}get isValid(){return this.invalidReason===null}get invalidReason(){return this.invalid?this.invalid.reason:null}get invalidExplanation(){return this.invalid?this.invalid.explanation:null}length(e="milliseconds"){return this.isValid?this.toDuration(e).get(e):NaN}count(e="milliseconds",t){if(!this.isValid)return NaN;const i=this.start.startOf(e,t);let s;return t!=null&&t.useLocaleWeeks?s=this.end.reconfigure({locale:i.locale}):s=this.end,s=s.startOf(e,t),Math.floor(s.diff(i,e).get(e))+(s.valueOf()!==this.end.valueOf())}hasSame(e){return this.isValid?this.isEmpty()||this.e.minus(1).hasSame(this.s,e):!1}isEmpty(){return this.s.valueOf()===this.e.valueOf()}isAfter(e){return this.isValid?this.s>e:!1}isBefore(e){return this.isValid?this.e<=e:!1}contains(e){return this.isValid?this.s<=e&&this.e>e:!1}set({start:e,end:t}={}){return this.isValid?pt.fromDateTimes(e||this.s,t||this.e):this}splitAt(...e){if(!this.isValid)return[];const t=e.map(Di).filter(r=>this.contains(r)).sort((r,o)=>r.toMillis()-o.toMillis()),i=[];let{s}=this,l=0;for(;s<this.e;){const r=t[l]||this.e,o=+r>+this.e?this.e:r;i.push(pt.fromDateTimes(s,o)),s=o,l+=1}return i}splitBy(e){const t=ze.fromDurationLike(e);if(!this.isValid||!t.isValid||t.as("milliseconds")===0)return[];let{s:i}=this,s=1,l;const r=[];for(;i<this.e;){const o=this.start.plus(t.mapUnits(a=>a*s));l=+o>+this.e?this.e:o,r.push(pt.fromDateTimes(i,l)),i=l,s+=1}return r}divideEqually(e){return this.isValid?this.splitBy(this.length()/e).slice(0,e):[]}overlaps(e){return this.e>e.s&&this.s<e.e}abutsStart(e){return this.isValid?+this.e==+e.s:!1}abutsEnd(e){return this.isValid?+e.e==+this.s:!1}engulfs(e){return this.isValid?this.s<=e.s&&this.e>=e.e:!1}equals(e){return!this.isValid||!e.isValid?!1:this.s.equals(e.s)&&this.e.equals(e.e)}intersection(e){if(!this.isValid)return this;const t=this.s>e.s?this.s:e.s,i=this.e<e.e?this.e:e.e;return t>=i?null:pt.fromDateTimes(t,i)}union(e){if(!this.isValid)return this;const t=this.s<e.s?this.s:e.s,i=this.e>e.e?this.e:e.e;return pt.fromDateTimes(t,i)}static merge(e){const[t,i]=e.sort((s,l)=>s.s-l.s).reduce(([s,l],r)=>l?l.overlaps(r)||l.abutsStart(r)?[s,l.union(r)]:[s.concat([l]),r]:[s,r],[[],null]);return i&&t.push(i),t}static xor(e){let t=null,i=0;const s=[],l=e.map(a=>[{time:a.s,type:"s"},{time:a.e,type:"e"}]),r=Array.prototype.concat(...l),o=r.sort((a,u)=>a.time-u.time);for(const a of o)i+=a.type==="s"?1:-1,i===1?t=a.time:(t&&+t!=+a.time&&s.push(pt.fromDateTimes(t,a.time)),t=null);return pt.merge(s)}difference(...e){return pt.xor([this].concat(e)).map(t=>this.intersection(t)).filter(t=>t&&!t.isEmpty())}toString(){return this.isValid?`[${this.s.toISO()} – ${this.e.toISO()})`:ti}[Symbol.for("nodejs.util.inspect.custom")](){return this.isValid?`Interval { start: ${this.s.toISO()}, end: ${this.e.toISO()} }`:`Interval { Invalid, reason: ${this.invalidReason} }`}toLocaleString(e=Ts,t={}){return this.isValid?Et.create(this.s.loc.clone(t),e).formatInterval(this):ti}toISO(e){return this.isValid?`${this.s.toISO(e)}/${this.e.toISO(e)}`:ti}toISODate(){return this.isValid?`${this.s.toISODate()}/${this.e.toISODate()}`:ti}toISOTime(e){return this.isValid?`${this.s.toISOTime(e)}/${this.e.toISOTime(e)}`:ti}toFormat(e,{separator:t=" – "}={}){return this.isValid?`${this.s.toFormat(e)}${t}${this.e.toFormat(e)}`:ti}toDuration(e,t){return this.isValid?this.e.diff(this.s,e,t):ze.invalid(this.invalidReason)}mapEndpoints(e){return pt.fromDateTimes(e(this.s),e(this.e))}}class us{static hasDST(e=mt.defaultZone){const t=Ae.now().setZone(e).set({month:12});return!e.isUniversal&&t.offset!==t.set({month:6}).offset}static isValidIANAZone(e){return mn.isValidZone(e)}static normalizeZone(e){return Sn(e,mt.defaultZone)}static getStartOfWeek({locale:e=null,locObj:t=null}={}){return(t||Ke.create(e)).getStartOfWeek()}static getMinimumDaysInFirstWeek({locale:e=null,locObj:t=null}={}){return(t||Ke.create(e)).getMinDaysInFirstWeek()}static getWeekendWeekdays({locale:e=null,locObj:t=null}={}){return(t||Ke.create(e)).getWeekendDays().slice()}static months(e="long",{locale:t=null,numberingSystem:i=null,locObj:s=null,outputCalendar:l="gregory"}={}){return(s||Ke.create(t,i,l)).months(e)}static monthsFormat(e="long",{locale:t=null,numberingSystem:i=null,locObj:s=null,outputCalendar:l="gregory"}={}){return(s||Ke.create(t,i,l)).months(e,!0)}static weekdays(e="long",{locale:t=null,numberingSystem:i=null,locObj:s=null}={}){return(s||Ke.create(t,i,null)).weekdays(e)}static weekdaysFormat(e="long",{locale:t=null,numberingSystem:i=null,locObj:s=null}={}){return(s||Ke.create(t,i,null)).weekdays(e,!0)}static meridiems({locale:e=null}={}){return Ke.create(e).meridiems()}static eras(e="short",{locale:t=null}={}){return Ke.create(t,null,"gregory").eras(e)}static features(){return{relative:Cc(),localeWeek:Ec()}}}function Kr(n,e){const t=s=>s.toUTC(0,{keepLocalTime:!0}).startOf("day").valueOf(),i=t(e)-t(n);return Math.floor(ze.fromMillis(i).as("days"))}function dh(n,e,t){const i=[["years",(a,u)=>u.year-a.year],["quarters",(a,u)=>u.quarter-a.quarter+(u.year-a.year)*4],["months",(a,u)=>u.month-a.month+(u.year-a.year)*12],["weeks",(a,u)=>{const f=Kr(a,u);return(f-f%7)/7}],["days",Kr]],s={},l=n;let r,o;for(const[a,u]of i)t.indexOf(a)>=0&&(r=a,s[a]=u(n,e),o=l.plus(s),o>e?(s[a]--,n=l.plus(s),n>e&&(o=n,s[a]--,n=l.plus(s))):n=o);return[n,s,o,r]}function ph(n,e,t,i){let[s,l,r,o]=dh(n,e,t);const a=e-s,u=t.filter(c=>["hours","minutes","seconds","milliseconds"].indexOf(c)>=0);u.length===0&&(r<e&&(r=s.plus({[o]:1})),r!==s&&(l[o]=(l[o]||0)+a/(r-s)));const f=ze.fromObject(l,i);return u.length>0?ze.fromMillis(a,i).shiftTo(...u).plus(f):f}const mh="missing Intl.DateTimeFormat.formatToParts support";function Ze(n,e=t=>t){return{regex:n,deser:([t])=>e(im(t))}}const hh=" ",Bc=`[ ${hh}]`,Zc=new RegExp(Bc,"g");function _h(n){return n.replace(/\./g,"\\.?").replace(Zc,Bc)}function Gr(n){return n.replace(/\./g,"").replace(Zc," ").toLowerCase()}function Qt(n,e){return n===null?null:{regex:RegExp(n.map(_h).join("|")),deser:([t])=>n.findIndex(i=>Gr(t)===Gr(i))+e}}function Jr(n,e){return{regex:n,deser:([,t,i])=>Ws(t,i),groups:e}}function fs(n){return{regex:n,deser:([e])=>e}}function gh(n){return n.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function bh(n,e){const t=Xt(e),i=Xt(e,"{2}"),s=Xt(e,"{3}"),l=Xt(e,"{4}"),r=Xt(e,"{6}"),o=Xt(e,"{1,2}"),a=Xt(e,"{1,3}"),u=Xt(e,"{1,6}"),f=Xt(e,"{1,9}"),c=Xt(e,"{2,4}"),d=Xt(e,"{4,6}"),m=b=>({regex:RegExp(gh(b.val)),deser:([g])=>g,literal:!0}),_=(b=>{if(n.literal)return m(b);switch(b.val){case"G":return Qt(e.eras("short"),0);case"GG":return Qt(e.eras("long"),0);case"y":return Ze(u);case"yy":return Ze(c,vl);case"yyyy":return Ze(l);case"yyyyy":return Ze(d);case"yyyyyy":return Ze(r);case"M":return Ze(o);case"MM":return Ze(i);case"MMM":return Qt(e.months("short",!0),1);case"MMMM":return Qt(e.months("long",!0),1);case"L":return Ze(o);case"LL":return Ze(i);case"LLL":return Qt(e.months("short",!1),1);case"LLLL":return Qt(e.months("long",!1),1);case"d":return Ze(o);case"dd":return Ze(i);case"o":return Ze(a);case"ooo":return Ze(s);case"HH":return Ze(i);case"H":return Ze(o);case"hh":return Ze(i);case"h":return Ze(o);case"mm":return Ze(i);case"m":return Ze(o);case"q":return Ze(o);case"qq":return Ze(i);case"s":return Ze(o);case"ss":return Ze(i);case"S":return Ze(a);case"SSS":return Ze(s);case"u":return fs(f);case"uu":return fs(o);case"uuu":return Ze(t);case"a":return Qt(e.meridiems(),0);case"kkkk":return Ze(l);case"kk":return Ze(c,vl);case"W":return Ze(o);case"WW":return Ze(i);case"E":case"c":return Ze(t);case"EEE":return Qt(e.weekdays("short",!1),1);case"EEEE":return Qt(e.weekdays("long",!1),1);case"ccc":return Qt(e.weekdays("short",!0),1);case"cccc":return Qt(e.weekdays("long",!0),1);case"Z":case"ZZ":return Jr(new RegExp(`([+-]${o.source})(?::(${i.source}))?`),2);case"ZZZ":return Jr(new RegExp(`([+-]${o.source})(${i.source})?`),2);case"z":return fs(/[a-z_+-/]{1,256}?/i);case" ":return fs(/[^\S\n\r]/);default:return m(b)}})(n)||{invalidReason:mh};return _.token=n,_}const wh={year:{"2-digit":"yy",numeric:"yyyyy"},month:{numeric:"M","2-digit":"MM",short:"MMM",long:"MMMM"},day:{numeric:"d","2-digit":"dd"},weekday:{short:"EEE",long:"EEEE"},dayperiod:"a",dayPeriod:"a",hour12:{numeric:"h","2-digit":"hh"},hour24:{numeric:"H","2-digit":"HH"},minute:{numeric:"m","2-digit":"mm"},second:{numeric:"s","2-digit":"ss"},timeZoneName:{long:"ZZZZZ",short:"ZZZ"}};function yh(n,e,t){const{type:i,value:s}=n;if(i==="literal"){const a=/^\s+$/.test(s);return{literal:!a,val:a?" ":s}}const l=e[i];let r=i;i==="hour"&&(e.hour12!=null?r=e.hour12?"hour12":"hour24":e.hourCycle!=null?e.hourCycle==="h11"||e.hourCycle==="h12"?r="hour12":r="hour24":r=t.hour12?"hour12":"hour24");let o=wh[r];if(typeof o=="object"&&(o=o[l]),o)return{literal:!1,val:o}}function vh(n){return[`^${n.map(t=>t.regex).reduce((t,i)=>`${t}(${i.source})`,"")}$`,n]}function kh(n,e,t){const i=n.match(e);if(i){const s={};let l=1;for(const r in t)if(bi(t,r)){const o=t[r],a=o.groups?o.groups+1:1;!o.literal&&o.token&&(s[o.token.val[0]]=o.deser(i.slice(l,l+a))),l+=a}return[i,s]}else return[i,{}]}function Sh(n){const e=l=>{switch(l){case"S":return"millisecond";case"s":return"second";case"m":return"minute";case"h":case"H":return"hour";case"d":return"day";case"o":return"ordinal";case"L":case"M":return"month";case"y":return"year";case"E":case"c":return"weekday";case"W":return"weekNumber";case"k":return"weekYear";case"q":return"quarter";default:return null}};let t=null,i;return De(n.z)||(t=mn.create(n.z)),De(n.Z)||(t||(t=new Pt(n.Z)),i=n.Z),De(n.q)||(n.M=(n.q-1)*3+1),De(n.h)||(n.h<12&&n.a===1?n.h+=12:n.h===12&&n.a===0&&(n.h=0)),n.G===0&&n.y&&(n.y=-n.y),De(n.u)||(n.S=Wl(n.u)),[Object.keys(n).reduce((l,r)=>{const o=e(r);return o&&(l[o]=n[r]),l},{}),t,i]}let el=null;function Th(){return el||(el=Ae.fromMillis(1555555555555)),el}function Oh(n,e){if(n.literal)return n;const t=Et.macroTokenToFormatOpts(n.val),i=Jc(t,e);return i==null||i.includes(void 0)?n:i}function Yc(n,e){return Array.prototype.concat(...n.map(t=>Oh(t,e)))}class Kc{constructor(e,t){if(this.locale=e,this.format=t,this.tokens=Yc(Et.parseFormat(t),e),this.units=this.tokens.map(i=>bh(i,e)),this.disqualifyingUnit=this.units.find(i=>i.invalidReason),!this.disqualifyingUnit){const[i,s]=vh(this.units);this.regex=RegExp(i,"i"),this.handlers=s}}explainFromTokens(e){if(this.isValid){const[t,i]=kh(e,this.regex,this.handlers),[s,l,r]=i?Sh(i):[null,null,void 0];if(bi(i,"a")&&bi(i,"H"))throw new ri("Can't include meridiem when specifying 24-hour format");return{input:e,tokens:this.tokens,regex:this.regex,rawMatches:t,matches:i,result:s,zone:l,specificOffset:r}}else return{input:e,tokens:this.tokens,invalidReason:this.invalidReason}}get isValid(){return!this.disqualifyingUnit}get invalidReason(){return this.disqualifyingUnit?this.disqualifyingUnit.invalidReason:null}}function Gc(n,e,t){return new Kc(n,t).explainFromTokens(e)}function Ch(n,e,t){const{result:i,zone:s,specificOffset:l,invalidReason:r}=Gc(n,e,t);return[i,s,l,r]}function Jc(n,e){if(!n)return null;const i=Et.create(e,n).dtFormatter(Th()),s=i.formatToParts(),l=i.resolvedOptions();return s.map(r=>yh(r,n,l))}const tl="Invalid DateTime",Xr=864e13;function Ri(n){return new xt("unsupported zone",`the zone "${n.name}" is not supported`)}function nl(n){return n.weekData===null&&(n.weekData=Os(n.c)),n.weekData}function il(n){return n.localWeekData===null&&(n.localWeekData=Os(n.c,n.loc.getMinDaysInFirstWeek(),n.loc.getStartOfWeek())),n.localWeekData}function Dn(n,e){const t={ts:n.ts,zone:n.zone,c:n.c,o:n.o,loc:n.loc,invalid:n.invalid};return new Ae({...t,...e,old:t})}function Xc(n,e,t){let i=n-e*60*1e3;const s=t.offset(i);if(e===s)return[i,e];i-=(s-e)*60*1e3;const l=t.offset(i);return s===l?[i,s]:[n-Math.min(s,l)*60*1e3,Math.max(s,l)]}function cs(n,e){n+=e*60*1e3;const t=new Date(n);return{year:t.getUTCFullYear(),month:t.getUTCMonth()+1,day:t.getUTCDate(),hour:t.getUTCHours(),minute:t.getUTCMinutes(),second:t.getUTCSeconds(),millisecond:t.getUTCMilliseconds()}}function bs(n,e,t){return Xc(Fs(n),e,t)}function Qr(n,e){const t=n.o,i=n.c.year+Math.trunc(e.years),s=n.c.month+Math.trunc(e.months)+Math.trunc(e.quarters)*3,l={...n.c,year:i,month:s,day:Math.min(n.c.day,Cs(i,s))+Math.trunc(e.days)+Math.trunc(e.weeks)*7},r=ze.fromObject({years:e.years-Math.trunc(e.years),quarters:e.quarters-Math.trunc(e.quarters),months:e.months-Math.trunc(e.months),weeks:e.weeks-Math.trunc(e.weeks),days:e.days-Math.trunc(e.days),hours:e.hours,minutes:e.minutes,seconds:e.seconds,milliseconds:e.milliseconds}).as("milliseconds"),o=Fs(l);let[a,u]=Xc(o,t,n.zone);return r!==0&&(a+=r,u=n.zone.offset(a)),{ts:a,o:u}}function ni(n,e,t,i,s,l){const{setZone:r,zone:o}=t;if(n&&Object.keys(n).length!==0||e){const a=e||o,u=Ae.fromObject(n,{...t,zone:a,specificOffset:l});return r?u:u.setZone(o)}else return Ae.invalid(new xt("unparsable",`the input "${s}" can't be parsed as ${i}`))}function ds(n,e,t=!0){return n.isValid?Et.create(Ke.create("en-US"),{allowZ:t,forceSimple:!0}).formatDateTimeFromString(n,e):null}function sl(n,e){const t=n.c.year>9999||n.c.year<0;let i="";return t&&n.c.year>=0&&(i+="+"),i+=wt(n.c.year,t?6:4),e?(i+="-",i+=wt(n.c.month),i+="-",i+=wt(n.c.day)):(i+=wt(n.c.month),i+=wt(n.c.day)),i}function xr(n,e,t,i,s,l){let r=wt(n.c.hour);return e?(r+=":",r+=wt(n.c.minute),(n.c.millisecond!==0||n.c.second!==0||!t)&&(r+=":")):r+=wt(n.c.minute),(n.c.millisecond!==0||n.c.second!==0||!t)&&(r+=wt(n.c.second),(n.c.millisecond!==0||!i)&&(r+=".",r+=wt(n.c.millisecond,3))),s&&(n.isOffsetFixed&&n.offset===0&&!l?r+="Z":n.o<0?(r+="-",r+=wt(Math.trunc(-n.o/60)),r+=":",r+=wt(Math.trunc(-n.o%60))):(r+="+",r+=wt(Math.trunc(n.o/60)),r+=":",r+=wt(Math.trunc(n.o%60)))),l&&(r+="["+n.zone.ianaName+"]"),r}const Qc={month:1,day:1,hour:0,minute:0,second:0,millisecond:0},Eh={weekNumber:1,weekday:1,hour:0,minute:0,second:0,millisecond:0},Lh={ordinal:1,hour:0,minute:0,second:0,millisecond:0},xc=["year","month","day","hour","minute","second","millisecond"],Ih=["weekYear","weekNumber","weekday","hour","minute","second","millisecond"],jh=["year","ordinal","hour","minute","second","millisecond"];function Ph(n){const e={year:"year",years:"year",month:"month",months:"month",day:"day",days:"day",hour:"hour",hours:"hour",minute:"minute",minutes:"minute",quarter:"quarter",quarters:"quarter",second:"second",seconds:"second",millisecond:"millisecond",milliseconds:"millisecond",weekday:"weekday",weekdays:"weekday",weeknumber:"weekNumber",weeksnumber:"weekNumber",weeknumbers:"weekNumber",weekyear:"weekYear",weekyears:"weekYear",ordinal:"ordinal"}[n.toLowerCase()];if(!e)throw new ec(n);return e}function eo(n){switch(n.toLowerCase()){case"localweekday":case"localweekdays":return"localWeekday";case"localweeknumber":case"localweeknumbers":return"localWeekNumber";case"localweekyear":case"localweekyears":return"localWeekYear";default:return Ph(n)}}function Nh(n){return ys[n]||(ws===void 0&&(ws=mt.now()),ys[n]=n.offset(ws)),ys[n]}function to(n,e){const t=Sn(e.zone,mt.defaultZone);if(!t.isValid)return Ae.invalid(Ri(t));const i=Ke.fromObject(e);let s,l;if(De(n.year))s=mt.now();else{for(const a of xc)De(n[a])&&(n[a]=Qc[a]);const r=Tc(n)||Oc(n);if(r)return Ae.invalid(r);const o=Nh(t);[s,l]=bs(n,o,t)}return new Ae({ts:s,zone:t,loc:i,o:l})}function no(n,e,t){const i=De(t.round)?!0:t.round,s=(r,o)=>(r=Vl(r,i||t.calendary?0:2,!0),e.loc.clone(t).relFormatter(t).format(r,o)),l=r=>t.calendary?e.hasSame(n,r)?0:e.startOf(r).diff(n.startOf(r),r).get(r):e.diff(n,r).get(r);if(t.unit)return s(l(t.unit),t.unit);for(const r of t.units){const o=l(r);if(Math.abs(o)>=1)return s(o,r)}return s(n>e?-0:0,t.units[t.units.length-1])}function io(n){let e={},t;return n.length>0&&typeof n[n.length-1]=="object"?(e=n[n.length-1],t=Array.from(n).slice(0,n.length-1)):t=Array.from(n),[e,t]}let ws,ys={};class Ae{constructor(e){const t=e.zone||mt.defaultZone;let i=e.invalid||(Number.isNaN(e.ts)?new xt("invalid input"):null)||(t.isValid?null:Ri(t));this.ts=De(e.ts)?mt.now():e.ts;let s=null,l=null;if(!i)if(e.old&&e.old.ts===this.ts&&e.old.zone.equals(t))[s,l]=[e.old.c,e.old.o];else{const o=On(e.o)&&!e.old?e.o:t.offset(this.ts);s=cs(this.ts,o),i=Number.isNaN(s.year)?new xt("invalid input"):null,s=i?null:s,l=i?null:o}this._zone=t,this.loc=e.loc||Ke.create(),this.invalid=i,this.weekData=null,this.localWeekData=null,this.c=s,this.o=l,this.isLuxonDateTime=!0}static now(){return new Ae({})}static local(){const[e,t]=io(arguments),[i,s,l,r,o,a,u]=t;return to({year:i,month:s,day:l,hour:r,minute:o,second:a,millisecond:u},e)}static utc(){const[e,t]=io(arguments),[i,s,l,r,o,a,u]=t;return e.zone=Pt.utcInstance,to({year:i,month:s,day:l,hour:r,minute:o,second:a,millisecond:u},e)}static fromJSDate(e,t={}){const i=am(e)?e.valueOf():NaN;if(Number.isNaN(i))return Ae.invalid("invalid input");const s=Sn(t.zone,mt.defaultZone);return s.isValid?new Ae({ts:i,zone:s,loc:Ke.fromObject(t)}):Ae.invalid(Ri(s))}static fromMillis(e,t={}){if(On(e))return e<-Xr||e>Xr?Ae.invalid("Timestamp out of range"):new Ae({ts:e,zone:Sn(t.zone,mt.defaultZone),loc:Ke.fromObject(t)});throw new Ct(`fromMillis requires a numerical input, but received a ${typeof e} with value ${e}`)}static fromSeconds(e,t={}){if(On(e))return new Ae({ts:e*1e3,zone:Sn(t.zone,mt.defaultZone),loc:Ke.fromObject(t)});throw new Ct("fromSeconds requires a numerical input")}static fromObject(e,t={}){e=e||{};const i=Sn(t.zone,mt.defaultZone);if(!i.isValid)return Ae.invalid(Ri(i));const s=Ke.fromObject(t),l=Es(e,eo),{minDaysInFirstWeek:r,startOfWeek:o}=Fr(l,s),a=mt.now(),u=De(t.specificOffset)?i.offset(a):t.specificOffset,f=!De(l.ordinal),c=!De(l.year),d=!De(l.month)||!De(l.day),m=c||d,h=l.weekYear||l.weekNumber;if((m||f)&&h)throw new ri("Can't mix weekYear/weekNumber units with year/month/day or ordinals");if(d&&f)throw new ri("Can't mix ordinal dates with month/day");const _=h||l.weekday&&!m;let b,g,T=cs(a,u);_?(b=Ih,g=Eh,T=Os(T,r,o)):f?(b=jh,g=Lh,T=xs(T)):(b=xc,g=Qc);let L=!1;for(const D of b){const R=l[D];De(R)?L?l[D]=g[D]:l[D]=T[D]:L=!0}const O=_?lm(l,r,o):f?rm(l):Tc(l),C=O||Oc(l);if(C)return Ae.invalid(C);const S=_?qr(l,r,o):f?$r(l):l,[P,M]=bs(S,u,i),A=new Ae({ts:P,zone:i,o:M,loc:s});return l.weekday&&m&&e.weekday!==A.weekday?Ae.invalid("mismatched weekday",`you can't specify both a weekday of ${l.weekday} and a date of ${A.toISO()}`):A.isValid?A:Ae.invalid(A.invalid)}static fromISO(e,t={}){const[i,s]=Xm(e);return ni(i,s,t,"ISO 8601",e)}static fromRFC2822(e,t={}){const[i,s]=Qm(e);return ni(i,s,t,"RFC 2822",e)}static fromHTTP(e,t={}){const[i,s]=xm(e);return ni(i,s,t,"HTTP",t)}static fromFormat(e,t,i={}){if(De(e)||De(t))throw new Ct("fromFormat requires an input string and a format");const{locale:s=null,numberingSystem:l=null}=i,r=Ke.fromOpts({locale:s,numberingSystem:l,defaultToEN:!0}),[o,a,u,f]=Ch(r,e,t);return f?Ae.invalid(f):ni(o,a,i,`format ${t}`,e,u)}static fromString(e,t,i={}){return Ae.fromFormat(e,t,i)}static fromSQL(e,t={}){const[i,s]=rh(e);return ni(i,s,t,"SQL",e)}static invalid(e,t=null){if(!e)throw new Ct("need to specify a reason the DateTime is invalid");const i=e instanceof xt?e:new xt(e,t);if(mt.throwOnInvalid)throw new Np(i);return new Ae({invalid:i})}static isDateTime(e){return e&&e.isLuxonDateTime||!1}static parseFormatForOpts(e,t={}){const i=Jc(e,Ke.fromObject(t));return i?i.map(s=>s?s.val:null).join(""):null}static expandFormat(e,t={}){return Yc(Et.parseFormat(e),Ke.fromObject(t)).map(s=>s.val).join("")}static resetCache(){ws=void 0,ys={}}get(e){return this[e]}get isValid(){return this.invalid===null}get invalidReason(){return this.invalid?this.invalid.reason:null}get invalidExplanation(){return this.invalid?this.invalid.explanation:null}get locale(){return this.isValid?this.loc.locale:null}get numberingSystem(){return this.isValid?this.loc.numberingSystem:null}get outputCalendar(){return this.isValid?this.loc.outputCalendar:null}get zone(){return this._zone}get zoneName(){return this.isValid?this.zone.name:null}get year(){return this.isValid?this.c.year:NaN}get quarter(){return this.isValid?Math.ceil(this.c.month/3):NaN}get month(){return this.isValid?this.c.month:NaN}get day(){return this.isValid?this.c.day:NaN}get hour(){return this.isValid?this.c.hour:NaN}get minute(){return this.isValid?this.c.minute:NaN}get second(){return this.isValid?this.c.second:NaN}get millisecond(){return this.isValid?this.c.millisecond:NaN}get weekYear(){return this.isValid?nl(this).weekYear:NaN}get weekNumber(){return this.isValid?nl(this).weekNumber:NaN}get weekday(){return this.isValid?nl(this).weekday:NaN}get isWeekend(){return this.isValid&&this.loc.getWeekendDays().includes(this.weekday)}get localWeekday(){return this.isValid?il(this).weekday:NaN}get localWeekNumber(){return this.isValid?il(this).weekNumber:NaN}get localWeekYear(){return this.isValid?il(this).weekYear:NaN}get ordinal(){return this.isValid?xs(this.c).ordinal:NaN}get monthShort(){return this.isValid?us.months("short",{locObj:this.loc})[this.month-1]:null}get monthLong(){return this.isValid?us.months("long",{locObj:this.loc})[this.month-1]:null}get weekdayShort(){return this.isValid?us.weekdays("short",{locObj:this.loc})[this.weekday-1]:null}get weekdayLong(){return this.isValid?us.weekdays("long",{locObj:this.loc})[this.weekday-1]:null}get offset(){return this.isValid?+this.o:NaN}get offsetNameShort(){return this.isValid?this.zone.offsetName(this.ts,{format:"short",locale:this.locale}):null}get offsetNameLong(){return this.isValid?this.zone.offsetName(this.ts,{format:"long",locale:this.locale}):null}get isOffsetFixed(){return this.isValid?this.zone.isUniversal:null}get isInDST(){return this.isOffsetFixed?!1:this.offset>this.set({month:1,day:1}).offset||this.offset>this.set({month:5}).offset}getPossibleOffsets(){if(!this.isValid||this.isOffsetFixed)return[this];const e=864e5,t=6e4,i=Fs(this.c),s=this.zone.offset(i-e),l=this.zone.offset(i+e),r=this.zone.offset(i-s*t),o=this.zone.offset(i-l*t);if(r===o)return[this];const a=i-r*t,u=i-o*t,f=cs(a,r),c=cs(u,o);return f.hour===c.hour&&f.minute===c.minute&&f.second===c.second&&f.millisecond===c.millisecond?[Dn(this,{ts:a}),Dn(this,{ts:u})]:[this]}get isInLeapYear(){return Qi(this.year)}get daysInMonth(){return Cs(this.year,this.month)}get daysInYear(){return this.isValid?mi(this.year):NaN}get weeksInWeekYear(){return this.isValid?Yi(this.weekYear):NaN}get weeksInLocalWeekYear(){return this.isValid?Yi(this.localWeekYear,this.loc.getMinDaysInFirstWeek(),this.loc.getStartOfWeek()):NaN}resolvedLocaleOptions(e={}){const{locale:t,numberingSystem:i,calendar:s}=Et.create(this.loc.clone(e),e).resolvedOptions(this);return{locale:t,numberingSystem:i,outputCalendar:s}}toUTC(e=0,t={}){return this.setZone(Pt.instance(e),t)}toLocal(){return this.setZone(mt.defaultZone)}setZone(e,{keepLocalTime:t=!1,keepCalendarTime:i=!1}={}){if(e=Sn(e,mt.defaultZone),e.equals(this.zone))return this;if(e.isValid){let s=this.ts;if(t||i){const l=e.offset(this.ts),r=this.toObject();[s]=bs(r,l,e)}return Dn(this,{ts:s,zone:e})}else return Ae.invalid(Ri(e))}reconfigure({locale:e,numberingSystem:t,outputCalendar:i}={}){const s=this.loc.clone({locale:e,numberingSystem:t,outputCalendar:i});return Dn(this,{loc:s})}setLocale(e){return this.reconfigure({locale:e})}set(e){if(!this.isValid)return this;const t=Es(e,eo),{minDaysInFirstWeek:i,startOfWeek:s}=Fr(t,this.loc),l=!De(t.weekYear)||!De(t.weekNumber)||!De(t.weekday),r=!De(t.ordinal),o=!De(t.year),a=!De(t.month)||!De(t.day),u=o||a,f=t.weekYear||t.weekNumber;if((u||r)&&f)throw new ri("Can't mix weekYear/weekNumber units with year/month/day or ordinals");if(a&&r)throw new ri("Can't mix ordinal dates with month/day");let c;l?c=qr({...Os(this.c,i,s),...t},i,s):De(t.ordinal)?(c={...this.toObject(),...t},De(t.day)&&(c.day=Math.min(Cs(c.year,c.month),c.day))):c=$r({...xs(this.c),...t});const[d,m]=bs(c,this.o,this.zone);return Dn(this,{ts:d,o:m})}plus(e){if(!this.isValid)return this;const t=ze.fromDurationLike(e);return Dn(this,Qr(this,t))}minus(e){if(!this.isValid)return this;const t=ze.fromDurationLike(e).negate();return Dn(this,Qr(this,t))}startOf(e,{useLocaleWeeks:t=!1}={}){if(!this.isValid)return this;const i={},s=ze.normalizeUnit(e);switch(s){case"years":i.month=1;case"quarters":case"months":i.day=1;case"weeks":case"days":i.hour=0;case"hours":i.minute=0;case"minutes":i.second=0;case"seconds":i.millisecond=0;break}if(s==="weeks")if(t){const l=this.loc.getStartOfWeek(),{weekday:r}=this;r<l&&(i.weekNumber=this.weekNumber-1),i.weekday=l}else i.weekday=1;if(s==="quarters"){const l=Math.ceil(this.month/3);i.month=(l-1)*3+1}return this.set(i)}endOf(e,t){return this.isValid?this.plus({[e]:1}).startOf(e,t).minus(1):this}toFormat(e,t={}){return this.isValid?Et.create(this.loc.redefaultToEN(t)).formatDateTimeFromString(this,e):tl}toLocaleString(e=Ts,t={}){return this.isValid?Et.create(this.loc.clone(t),e).formatDateTime(this):tl}toLocaleParts(e={}){return this.isValid?Et.create(this.loc.clone(e),e).formatDateTimeParts(this):[]}toISO({format:e="extended",suppressSeconds:t=!1,suppressMilliseconds:i=!1,includeOffset:s=!0,extendedZone:l=!1}={}){if(!this.isValid)return null;const r=e==="extended";let o=sl(this,r);return o+="T",o+=xr(this,r,t,i,s,l),o}toISODate({format:e="extended"}={}){return this.isValid?sl(this,e==="extended"):null}toISOWeekDate(){return ds(this,"kkkk-'W'WW-c")}toISOTime({suppressMilliseconds:e=!1,suppressSeconds:t=!1,includeOffset:i=!0,includePrefix:s=!1,extendedZone:l=!1,format:r="extended"}={}){return this.isValid?(s?"T":"")+xr(this,r==="extended",t,e,i,l):null}toRFC2822(){return ds(this,"EEE, dd LLL yyyy HH:mm:ss ZZZ",!1)}toHTTP(){return ds(this.toUTC(),"EEE, dd LLL yyyy HH:mm:ss 'GMT'")}toSQLDate(){return this.isValid?sl(this,!0):null}toSQLTime({includeOffset:e=!0,includeZone:t=!1,includeOffsetSpace:i=!0}={}){let s="HH:mm:ss.SSS";return(t||e)&&(i&&(s+=" "),t?s+="z":e&&(s+="ZZ")),ds(this,s,!0)}toSQL(e={}){return this.isValid?`${this.toSQLDate()} ${this.toSQLTime(e)}`:null}toString(){return this.isValid?this.toISO():tl}[Symbol.for("nodejs.util.inspect.custom")](){return this.isValid?`DateTime { ts: ${this.toISO()}, zone: ${this.zone.name}, locale: ${this.locale} }`:`DateTime { Invalid, reason: ${this.invalidReason} }`}valueOf(){return this.toMillis()}toMillis(){return this.isValid?this.ts:NaN}toSeconds(){return this.isValid?this.ts/1e3:NaN}toUnixInteger(){return this.isValid?Math.floor(this.ts/1e3):NaN}toJSON(){return this.toISO()}toBSON(){return this.toJSDate()}toObject(e={}){if(!this.isValid)return{};const t={...this.c};return e.includeConfig&&(t.outputCalendar=this.outputCalendar,t.numberingSystem=this.loc.numberingSystem,t.locale=this.loc.locale),t}toJSDate(){return new Date(this.isValid?this.ts:NaN)}diff(e,t="milliseconds",i={}){if(!this.isValid||!e.isValid)return ze.invalid("created by diffing an invalid DateTime");const s={locale:this.locale,numberingSystem:this.numberingSystem,...i},l=um(t).map(ze.normalizeUnit),r=e.valueOf()>this.valueOf(),o=r?this:e,a=r?e:this,u=ph(o,a,l,s);return r?u.negate():u}diffNow(e="milliseconds",t={}){return this.diff(Ae.now(),e,t)}until(e){return this.isValid?pt.fromDateTimes(this,e):this}hasSame(e,t,i){if(!this.isValid)return!1;const s=e.valueOf(),l=this.setZone(e.zone,{keepLocalTime:!0});return l.startOf(t,i)<=s&&s<=l.endOf(t,i)}equals(e){return this.isValid&&e.isValid&&this.valueOf()===e.valueOf()&&this.zone.equals(e.zone)&&this.loc.equals(e.loc)}toRelative(e={}){if(!this.isValid)return null;const t=e.base||Ae.fromObject({},{zone:this.zone}),i=e.padding?this<t?-e.padding:e.padding:0;let s=["years","months","days","hours","minutes","seconds"],l=e.unit;return Array.isArray(e.unit)&&(s=e.unit,l=void 0),no(t,this.plus(i),{...e,numeric:"always",units:s,unit:l})}toRelativeCalendar(e={}){return this.isValid?no(e.base||Ae.fromObject({},{zone:this.zone}),this,{...e,numeric:"auto",units:["years","months","days"],calendary:!0}):null}static min(...e){if(!e.every(Ae.isDateTime))throw new Ct("min requires all arguments be DateTimes");return Wr(e,t=>t.valueOf(),Math.min)}static max(...e){if(!e.every(Ae.isDateTime))throw new Ct("max requires all arguments be DateTimes");return Wr(e,t=>t.valueOf(),Math.max)}static fromFormatExplain(e,t,i={}){const{locale:s=null,numberingSystem:l=null}=i,r=Ke.fromOpts({locale:s,numberingSystem:l,defaultToEN:!0});return Gc(r,e,t)}static fromStringExplain(e,t,i={}){return Ae.fromFormatExplain(e,t,i)}static buildFormatParser(e,t={}){const{locale:i=null,numberingSystem:s=null}=t,l=Ke.fromOpts({locale:i,numberingSystem:s,defaultToEN:!0});return new Kc(l,e)}static fromFormatParser(e,t,i={}){if(De(e)||De(t))throw new Ct("fromFormatParser requires an input string and a format parser");const{locale:s=null,numberingSystem:l=null}=i,r=Ke.fromOpts({locale:s,numberingSystem:l,defaultToEN:!0});if(!r.equals(t.locale))throw new Ct(`fromFormatParser called with a locale of ${r}, but the format parser was created for ${t.locale}`);const{result:o,zone:a,specificOffset:u,invalidReason:f}=t.explainFromTokens(e);return f?Ae.invalid(f):ni(o,a,i,`format ${t.format}`,e,u)}static get DATE_SHORT(){return Ts}static get DATE_MED(){return tc}static get DATE_MED_WITH_WEEKDAY(){return Mp}static get DATE_FULL(){return nc}static get DATE_HUGE(){return ic}static get TIME_SIMPLE(){return sc}static get TIME_WITH_SECONDS(){return lc}static get TIME_WITH_SHORT_OFFSET(){return rc}static get TIME_WITH_LONG_OFFSET(){return oc}static get TIME_24_SIMPLE(){return ac}static get TIME_24_WITH_SECONDS(){return uc}static get TIME_24_WITH_SHORT_OFFSET(){return fc}static get TIME_24_WITH_LONG_OFFSET(){return cc}static get DATETIME_SHORT(){return dc}static get DATETIME_SHORT_WITH_SECONDS(){return pc}static get DATETIME_MED(){return mc}static get DATETIME_MED_WITH_SECONDS(){return hc}static get DATETIME_MED_WITH_WEEKDAY(){return Rp}static get DATETIME_FULL(){return _c}static get DATETIME_FULL_WITH_SECONDS(){return gc}static get DATETIME_HUGE(){return bc}static get DATETIME_HUGE_WITH_SECONDS(){return wc}}function Di(n){if(Ae.isDateTime(n))return n;if(n&&n.valueOf&&On(n.valueOf()))return Ae.fromJSDate(n);if(n&&typeof n=="object")return Ae.fromObject(n);throw new Ct(`Unknown datetime argument: ${n}, of type ${typeof n}`)}const ps=[],Ah="abcdefghijklmnopqrstuvwxyz0123456789";class J{static isObject(e){return e!==null&&typeof e=="object"&&e.constructor===Object}static isEmpty(e){return typeof e>"u"||e===null||e===""||e==="00000000-0000-0000-0000-000000000000"||e==="0001-01-01 00:00:00.000Z"||e==="0001-01-01"||Array.isArray(e)&&e.length===0||J.isObject(e)&&Object.keys(e).length===0}static isInput(e){let t=e&&e.tagName?e.tagName.toLowerCase():"";return t==="input"||t==="select"||t==="textarea"||e.isContentEditable}static isFocusable(e){let t=e&&e.tagName?e.tagName.toLowerCase():"";return J.isInput(e)||t==="button"||t==="a"||t==="details"||e.tabIndex>=0}static toArray(e,t=!1){return Array.isArray(e)?e.slice():(t||!J.isEmpty(e))&&typeof e<"u"?[e]:[]}static inArray(e,t){e=Array.isArray(e)?e:[];for(let i=e.length-1;i>=0;i--)if(e[i]==t)return!0;return!1}static removeByValue(e,t){e=Array.isArray(e)?e:[];for(let i=e.length-1;i>=0;i--)if(e[i]==t){e.splice(i,1);break}}static pushUnique(e,t){J.inArray(e,t)||e.push(t)}static findByKey(e,t,i){e=Array.isArray(e)?e:[];for(let s in e)if(e[s][t]==i)return e[s];return null}static removeByKey(e,t,i){for(let s in e)e[s][t]==i&&e.splice(s,1)}static pushOrReplaceObject(e,t,i="id"){for(let s=e.length-1;s>=0;s--)if(e[s][i]==t[i]){e[s]=t;return}e.push(t)}static filterDuplicatesByKey(e,t="id"){e=Array.isArray(e)?e:[];const i={};for(const s of e)i[s[t]]=s;return Object.values(i)}static getNestedVal(e,t,i=null,s="."){let l=e||{},r=(t||"").split(s);for(const o of r){if(!J.isObject(l)&&!Array.isArray(l)||typeof l[o]>"u")return i;l=l[o]}return l}static setByPath(e,t,i,s="."){if(e===null||typeof e!="object"){console.warn("setByPath: data not an object or array.");return}let l=e,r=t.split(s),o=r.pop();for(const a of r)(!J.isObject(l)&&!Array.isArray(l)||!J.isObject(l[a])&&!Array.isArray(l[a]))&&(l[a]={}),l=l[a];l[o]=i}static deleteByPath(e,t,i="."){let s=e||{},l=(t||"").split(i),r=l.pop();for(const o of l)(!J.isObject(s)&&!Array.isArray(s)||!J.isObject(s[o])&&!Array.isArray(s[o]))&&(s[o]={}),s=s[o];Array.isArray(s)?s.splice(r,1):J.isObject(s)&&delete s[r],l.length>0&&(Array.isArray(s)&&!s.length||J.isObject(s)&&!Object.keys(s).length)&&(Array.isArray(e)&&e.length>0||J.isObject(e)&&Object.keys(e).length>0)&&J.deleteByPath(e,l.join(i),i)}static randomString(e=8,t=Ah){let i="";for(let s=0;s<e;s++)i+=t.charAt(Math.floor(Math.random()*t.length));return i}static sentenize(e,t=!0){if(typeof e!="string")return"";if(e=e.trim().split("_").join(" "),e==="")return e;if(e=e[0].toUpperCase()+e.substring(1),t){let i=e[e.length-1];i!=="."&&i!=="?"&&i!=="!"&&(e+=".")}return e}static splitNonEmpty(e,t=","){const i=(e||"").split(t),s=[];for(let l of i)l=l.trim(),J.isEmpty(l)||s.push(l);return s}static joinNonEmpty(e,t=", "){const i=[];for(let s of e)s=typeof s=="string"?s.trim():"",J.isEmpty(s)||i.push(s);return i.join(t)}static getInitials(e){if(e=(e||"").split("@")[0].trim(),e.length<=2)return e.toUpperCase();const t=e.split(/[\.\_\-\ ]/);return t.length>=2?(t[0][0]+t[1][0]).toUpperCase():e[0].toUpperCase()}static getWordInfoAt(e,t){let i=e.replace(/(\r\n|\n|\r)/gm," ").split(" "),s=0,l=0,r=0;for(let o=0;o<i.length;o++){if(l=s+o,r=l+i[o].length-1,t>=l&&t<=r)return{start:l,end:r,word:i[o]};s+=i[o].length}return{}}static getDateTime(e){if(typeof e=="string"){const t={19:"yyyy-MM-dd HH:mm:ss",23:"yyyy-MM-dd HH:mm:ss.SSS",20:"yyyy-MM-dd HH:mm:ss'Z'",24:"yyyy-MM-dd HH:mm:ss.SSS'Z'"},i=t[e.length]||t[19];return Ae.fromFormat(e,i,{zone:"UTC"})}return Ae.fromJSDate(e)}static formatToUTCDate(e,t="yyyy-MM-dd HH:mm:ss"){return J.getDateTime(e).toUTC().toFormat(t)}static formatToLocalDate(e,t="yyyy-MM-dd HH:mm:ss"){return J.getDateTime(e).toLocal().toFormat(t)}static relativeDate(e){return J.getDateTime(e).toRelative()}static async copyToClipboard(e){var t;if(e=""+e,!(!e.length||!((t=window==null?void 0:window.navigator)!=null&&t.clipboard)))return window.navigator.clipboard.writeText(e).catch(i=>{console.warn("Failed to copy.",i)})}static yieldToMain(){return new Promise(e=>{setTimeout(e,0)})}static isDesktopPrototype(e){return e.size==""}static getPrototypeIcon(e){return J.isDesktopPrototype(e)?"iconoir-modern-tv":"iconoir-smartphone-device"}static getUserDisplayName(e){return(e==null?void 0:e.name)||(e==null?void 0:e.email)||(e!=null&&e.username?"@"+(e==null?void 0:e.username):e==null?void 0:e.id)||""}static getCommentAuthor(e){var t;return J.getUserDisplayName((t=e==null?void 0:e.expand)==null?void 0:t.user)||(e==null?void 0:e.guestEmail)||""}static sortItemsByIds(e,t){e=e||[],t=t||[];const i=[];for(const s of t){const l=e.findIndex(r=>r.id==s);l<0||(i.push(e[l]),e.splice(l,1))}for(let s of e)i.push(s);return i}static triggerEvent(e){window.dispatchEvent(new Event(e))}static getHashQueryParams(){let e="";const t=window.location.hash.indexOf("?");return t>-1&&(e=window.location.hash.substring(t+1)),Object.fromEntries(new URLSearchParams(e))}static replaceHashQueryParams(e){e=e||{};let t="",i=window.location.hash;const s=i.indexOf("?");s>-1&&(t=i.substring(s+1),i=i.substring(0,s));const l=new URLSearchParams(t);for(let a in e){const u=e[a];u===null?l.delete(a):l.set(a,u)}t=l.toString(),t!=""&&(i+="?"+t);let r=window.location.href;const o=r.indexOf("#");o>-1&&(r=r.substring(0,o)),window.location.replace(r+i)}static getProjectLinkURL(e){let t=window.location.pathname.replace(/\/$/,"");const i=t.split("/");return i[i.length-1]=="_"&&(t=i.slice(0,i.length-1).join("/")),window.location.origin+t+"/#/"+((e==null?void 0:e.username)||"")}static generateThumb(e,t=100,i=100){return new Promise(s=>{let l=new FileReader;l.onload=function(r){let o=new Image;o.onload=function(){let a=document.createElement("canvas"),u=a.getContext("2d"),f=o.width,c=o.height;return a.width=t,a.height=i,u.drawImage(o,f>c?(f-c)/2:0,0,f>c?c:f,f>c?c:f,0,0,t,i),s(a.toDataURL(e.type))},o.src=r.target.result},l.readAsDataURL(e)})}static loadImage(e){return new Promise((t,i)=>{if(ps[e])return t({success:!0,url:e,width:ps[e].width,height:ps[e].height});let s=new Image;s.onload=()=>(ps[e]={width:s.naturalWidth,height:s.naturalHeight},t({success:!0,url:e,width:s.naturalWidth,height:s.naturalHeight})),s.onerror=()=>t({success:!1,url:e,width:0,height:0}),s.crossOrigin="Anonymous",s.src=e})}static closestFeatureEdge(e,t={},i=5){t.x=(t.x||0)<<0,t.y=(t.y||0)<<0,t.w=(t.w||e.naturalWidth)<<0,t.h=(t.h||e.naturalHeight)<<0;let s=document.createElement("canvas");s.width=t.w,s.height=t.h;let l=s.getContext("2d");l.fillStyle="white",l.fillRect(0,0,t.w,t.h),l.drawImage(e,t.x,t.y,t.w,t.h,0,0,t.w,t.h);let r=l.getImageData(0,0,t.w,t.h);for(let c=0;c<r.height;c++)for(let d=0;d<r.width;d++){let m=(d+c*r.width)*4,h=(r.data[m]+r.data[m+1]+r.data[m+2])/3;r.data[m]=h,r.data[m+1]=h,r.data[m+2]=h}let o=t.w,a=0,u=t.h,f=0;for(let c=0;c<r.height;c++)for(let d=0;d<r.width;d++){let m=(d+c*r.width)*4,h=r.data[m],_=r.data[m-4],b=r.data[m],g=r.data[m-t.w*4],T=r.data[m+t.w*4];(h>_+i||h<_-i||h>b+i||h<b-i||h>g+i||h<g-i||h>T+i||h<T-i)&&(d<o&&(o=d),d>a&&(a=d),c<u&&(u=c),c>f&&(f=c))}return o=o<t.w?o:0,u=u<t.h?u:0,a=a||t.w,f=f||t.h,{x:o,y:u,w:a-o,h:f-u}}static normalizePointerEvent(e){var t,i,s,l,r,o,a,u;typeof e.clientX>"u"&&typeof((i=(t=e.touches)==null?void 0:t[0])==null?void 0:i.clientX)<"u"&&(e.clientX=e.touches[0].clientX),typeof e.clientY>"u"&&typeof((l=(s=e.touches)==null?void 0:s[0])==null?void 0:l.clientY)<"u"&&(e.clientY=e.touches[0].clientY),typeof e.offsetX>"u"&&typeof((o=(r=e.touches)==null?void 0:r[0])==null?void 0:o.pageX)<"u"&&e.target&&(e.offsetX=e.touches[0].pageX-e.target.getBoundingClientRect().left),typeof e.offsetY>"u"&&typeof((u=(a=e.touches)==null?void 0:a[0])==null?void 0:u.pageY)<"u"&&e.target&&(e.offsetY=e.touches[0].pageY-e.target.getBoundingClientRect().top||0)}}const zs=Fe([]);function _t(n,e=3e3){return Gl(n,"success",e)}function Yl(n,e=4e3){return Gl(n,"error",e)}function Kl(n,e=4500){return Gl(n,"warning",e)}function Gl(n,e,t){t=t||4e3;const i={message:n,type:e,duration:t,timeout:setTimeout(()=>{ed(i)},t)};zs.update(s=>(Jl(s,i.message),J.pushOrReplaceObject(s,i,"message"),s))}function ed(n){zs.update(e=>(Jl(e,n),e))}function Ki(){zs.update(n=>{for(let e of n)Jl(n,e);return[]})}function Jl(n,e){let t;typeof e=="string"?t=J.findByKey(n,"message",e):t=e,t&&(clearTimeout(t.timeout),J.removeByKey(n,"message",t.message))}const Bs=Fe({});function Kt(n){Bs.set(n||{})}function Dh(n){Bs.update(e=>(J.deleteByPath(e,n),e))}const Xn=Fe({});function so(n){Xn.set(n||{})}const wi=Mh();function Mh(n="appOptions"){let e={};const t=window.localStorage.getItem(n);if(t)try{e=JSON.parse(t)||{},e.appURL=e.appURL||e.appUrl||"",e.termsURL=e.termsURL||e.termsUrl||"",e.allowHotspotsURL=e.allowHotspotsURL||e.allowHotspotsUrl||"",delete e.appUrl,delete e.termsUrl,delete e.allowHotspotsUrl}catch{}const i=[],s=o=>(i.push(o),o(e),()=>{const a=i.findIndex(u=>u===o);a>=0&&i.splice(a,1)}),l=o=>{e=o||{},window.localStorage.setItem(n,JSON.stringify(e)),i.forEach(a=>a(e))};return{subscribe:s,set:l,update:o=>l(o(e))}}const kl="pr_redirect";_n.prototype.rememberPath=function(){window.localStorage.setItem(kl,window.location.hash.slice(1))};_n.prototype.replaceWithRemembered=function(n="/"){const e=window.localStorage.getItem(kl);e&&window.localStorage.removeItem(kl),Bt(e||n)};_n.prototype.logout=function(n=!0){this.authStore.clear(),n&&Bt("/login")};_n.prototype.error=function(n,e=!0,t=""){if(!n||!(n instanceof Error)||n.isAbort)return;const i=(n==null?void 0:n.status)<<0,s=(n==null?void 0:n.response)||{};let l=e&&(s.message||n.message||t);if(l&&Yl(l),i==0&&console.log(n),J.isEmpty(s.data)||Kt(s.data),i===401)return this.rememberPath(),this.cancelAllRequests(),this.logout();if(i===403)return this.rememberPath(),this.cancelAllRequests(),Bt("/login")};_n.prototype.initStore=function(n=""){const e="pr_user_auth"+n;this.authStore.storageKey!=e&&(this.authStore=new Rh(e))};class Rh extends Jf{constructor(e="pr_user_auth"){super(e),this.save(this.token,this.record)}save(e,t){super.save(e,t),t&&t.collectionName=="users"&&so(t)}clear(){var e;((e=this.record)==null?void 0:e.collectionName)=="users"&&so(null),super.clear()}}const z=new _n("");z.initStore();if(z.authStore.isValid){const n=new _n(z.baseURL,z.authStore);n.collection(n.authStore.record.collectionName).authRefresh().catch(e=>{console.warn("Failed to refresh the authenticated record",e);const t=(e==null?void 0:e.status)<<0;(t==401||t==403)&&(n.rememberPath(),n.authStore.clear(),Bt("/login"))})}function Hh(n){const e=new _n(z.baseURL);return e.initStore(n),e}function Uh(n){e();function e(){z.authStore.isValid?Bt("/projects"):z.logout()}return[]}class qh extends ye{constructor(e){super(),we(this,e,Uh,null,he,{})}}function lo(n){let e;return{c(){e=w("span"),e.textContent="Presentator",p(e,"class","txt")},m(t,i){k(t,e,i)},d(t){t&&v(e)}}}function $h(n){let e,t,i,s,l,r,o,a=n[0]&&lo();return{c(){e=w("a"),t=w("img"),s=I(),a&&a.c(),zn(t.src,i="./images/logo.svg")||p(t,"src",i),p(t,"width","30"),p(t,"height","37"),p(t,"alt","Presentator logo"),p(e,"href","/"),p(e,"class",l="app-logo "+n[1]),p(e,"draggable","false")},m(u,f){k(u,e,f),y(e,t),y(e,s),a&&a.m(e,null),r||(o=ge(Si.call(null,e)),r=!0)},p(u,[f]){u[0]?a||(a=lo(),a.c(),a.m(e,null)):a&&(a.d(1),a=null),f&2&&l!==(l="app-logo "+u[1])&&p(e,"class",l)},i:Q,o:Q,d(u){u&&v(e),a&&a.d(),r=!1,o()}}}function Fh(n,e,t){let{withText:i=!0}=e,{class:s=""}=e;return n.$$set=l=>{"withText"in l&&t(0,i=l.withText),"class"in l&&t(1,s=l.class)},[i,s]}class Xl extends ye{constructor(e){super(),we(this,e,Fh,$h,he,{withText:0,class:1})}}function Ql(n){const e=n-1;return e*e*e+1}function Sl(n,{delay:e=0,duration:t=400,easing:i=Ji}={}){const s=+getComputedStyle(n).opacity;return{delay:e,duration:t,easing:i,css:l=>`opacity: ${l*s}`}}function In(n,{delay:e=0,duration:t=400,easing:i=Ql,x:s=0,y:l=0,opacity:r=0}={}){const o=getComputedStyle(n),a=+o.opacity,u=o.transform==="none"?"":o.transform,f=a*(1-r),[c,d]=gr(s),[m,h]=gr(l);return{delay:e,duration:t,easing:i,css:(_,b)=>`
			transform: ${u} translate(${(1-_)*c}${d}, ${(1-_)*m}${h});
			opacity: ${a-f*b}`}}function Ot(n,{delay:e=0,duration:t=400,easing:i=Ql,axis:s="y"}={}){const l=getComputedStyle(n),r=+l.opacity,o=s==="y"?"height":"width",a=parseFloat(l[o]),u=s==="y"?["top","bottom"]:["left","right"],f=u.map(g=>`${g[0].toUpperCase()}${g.slice(1)}`),c=parseFloat(l[`padding${f[0]}`]),d=parseFloat(l[`padding${f[1]}`]),m=parseFloat(l[`margin${f[0]}`]),h=parseFloat(l[`margin${f[1]}`]),_=parseFloat(l[`border${f[0]}Width`]),b=parseFloat(l[`border${f[1]}Width`]);return{delay:e,duration:t,easing:i,css:g=>`overflow: hidden;opacity: ${Math.min(g*20,1)*r};${o}: ${g*a}px;padding-${u[0]}: ${g*c}px;padding-${u[1]}: ${g*d}px;margin-${u[0]}: ${g*m}px;margin-${u[1]}: ${g*h}px;border-${u[0]}-width: ${g*_}px;border-${u[1]}-width: ${g*b}px;`}}function ro(n){let e,t,i;const s=n[21].default,l=st(s,n,n[20],null);return{c(){e=w("div"),l&&l.c(),p(e,"class",n[1]),Z(e,"active",n[0])},m(r,o){k(r,e,o),l&&l.m(e,null),n[22](e),i=!0},p(r,o){l&&l.p&&(!i||o[0]&1048576)&&rt(l,s,r,r[20],i?lt(s,r[20],o,null):ot(r[20]),null),(!i||o[0]&2)&&p(e,"class",r[1]),(!i||o[0]&3)&&Z(e,"active",r[0])},i(r){i||(E(l,r),r&&vt(()=>{i&&(t||(t=ft(e,In,{duration:150,y:3},!0)),t.run(1))}),i=!0)},o(r){j(l,r),r&&(t||(t=ft(e,In,{duration:150,y:3},!1)),t.run(0)),i=!1},d(r){r&&v(e),l&&l.d(r),n[22](null),r&&t&&t.end()}}}function Wh(n){let e,t,i,s,l=n[0]&&ro(n);return{c(){e=w("div"),l&&l.c(),p(e,"class","toggler-container"),p(e,"tabindex","-1")},m(r,o){k(r,e,o),l&&l.m(e,null),n[23](e),t=!0,i||(s=[H(window,"mousedown",n[5]),H(window,"click",n[6]),H(window,"keydown",n[4]),H(window,"focusin",n[7])],i=!0)},p(r,o){r[0]?l?(l.p(r,o),o[0]&1&&E(l,1)):(l=ro(r),l.c(),E(l,1),l.m(e,null)):l&&(ae(),j(l,1,1,()=>{l=null}),ue())},i(r){t||(E(l),t=!0)},o(r){j(l),t=!1},d(r){r&&v(e),l&&l.d(),n[23](null),i=!1,pe(s)}}}function Vh(n,e,t){let{$$slots:i={},$$scope:s}=e,{trigger:l=void 0}=e,{active:r=!1}=e,{escHide:o=!0}=e,{focusHide:a=!0}=e,{autoScroll:u=!0}=e,{disableHide:f=!1}=e,{closableClass:c="closable"}=e,{closableToggle:d=!0}=e,{class:m=""}=e,h,_,b,g,T=!1;const L=tt();function O(){f||C()}function C(){t(0,r=!1),T=!1,clearTimeout(g)}function S(){t(0,r=!0),clearTimeout(g),g=setTimeout(()=>{u&&(_!=null&&_.scrollIntoViewIfNeeded?_==null||_.scrollIntoViewIfNeeded():_!=null&&_.scrollIntoView&&(_==null||_.scrollIntoView({behavior:"smooth",block:"nearest"})))},180)}function P(){r?O():S()}function M(U){return!h||U.classList.contains(c)||(b==null?void 0:b.contains(U))&&!h.contains(U)||h.contains(U)&&U.closest&&U.closest("."+c)}function A(U){(!r||d&&M(U.target))&&(U.stopPropagation(),P())}function D(U){(U.code==="Enter"||U.code==="Space")&&(!r||M(U.target))&&P()}function R(U){r&&o&&U.code==="Escape"&&!J.isInput(U.target)&&(U.preventDefault(),O())}function Y(U){r&&!(h!=null&&h.contains(U.target))?T=!0:T&&(T=!1)}function G(U){r&&T&&!(h!=null&&h.contains(U.target))&&!(b!=null&&b.contains(U.target))&&O()}function B(U){a&&(Y(U),G(U))}function N(U){V(),h==null||h.addEventListener("click",A),t(19,b=U||(h==null?void 0:h.parentNode)),b==null||b.addEventListener("click",A),b==null||b.addEventListener("keydown",D)}function V(){var U;clearTimeout(g),h==null||h.removeEventListener("click",A),(U=b==null?void 0:b.classList)==null||U.remove("active"),b==null||b.removeEventListener("click",A),b==null||b.removeEventListener("keydown",D)}hn(()=>(N(),()=>V()));function te(U){le[U?"unshift":"push"](()=>{_=U,t(3,_)})}function X(U){le[U?"unshift":"push"](()=>{h=U,t(2,h)})}return n.$$set=U=>{"trigger"in U&&t(8,l=U.trigger),"active"in U&&t(0,r=U.active),"escHide"in U&&t(9,o=U.escHide),"focusHide"in U&&t(10,a=U.focusHide),"autoScroll"in U&&t(11,u=U.autoScroll),"disableHide"in U&&t(12,f=U.disableHide),"closableClass"in U&&t(13,c=U.closableClass),"closableToggle"in U&&t(14,d=U.closableToggle),"class"in U&&t(1,m=U.class),"$$scope"in U&&t(20,s=U.$$scope)},n.$$.update=()=>{var U,ce;n.$$.dirty[0]&260&&h&&N(l),n.$$.dirty[0]&524289&&(r?((U=b==null?void 0:b.classList)==null||U.add("active"),L("show")):((ce=b==null?void 0:b.classList)==null||ce.remove("active"),L("hide")))},[r,m,h,_,R,Y,G,B,l,o,a,u,f,c,d,O,C,S,P,b,s,i,te,X]}class At extends ye{constructor(e){super(),we(this,e,Vh,Wh,he,{trigger:8,active:0,escHide:9,focusHide:10,autoScroll:11,disableHide:12,closableClass:13,closableToggle:14,class:1,hide:15,forceHide:16,show:17,toggle:18},null,[-1,-1])}get hide(){return this.$$.ctx[15]}get forceHide(){return this.$$.ctx[16]}get show(){return this.$$.ctx[17]}get toggle(){return this.$$.ctx[18]}}const zh=n=>({}),oo=n=>({});function Bh(n){let e;const t=n[6].placeholder,i=st(t,n,n[5],oo),s=i||Gh(n);return{c(){s&&s.c()},m(l,r){s&&s.m(l,r),e=!0},p(l,r){i?i.p&&(!e||r&32)&&rt(i,t,l,l[5],e?lt(t,l[5],r,zh):ot(l[5]),oo):s&&s.p&&(!e||r&1)&&s.p(l,e?r:-1)},i(l){e||(E(s,l),e=!0)},o(l){j(s,l),e=!1},d(l){s&&s.d(l)}}}function Zh(n){let e,t,i;return{c(){var s,l;e=w("img"),zn(e.src,t=n[2])||p(e,"src",t),p(e,"draggable","false"),p(e,"alt",i=(((s=n[0])==null?void 0:s.name)||((l=n[0])==null?void 0:l.username))+" avatar")},m(s,l){k(s,e,l)},p(s,l){var r,o;l&4&&!zn(e.src,t=s[2])&&p(e,"src",t),l&1&&i!==(i=(((r=s[0])==null?void 0:r.name)||((o=s[0])==null?void 0:o.username))+" avatar")&&p(e,"alt",i)},i:Q,o:Q,d(s){s&&v(e)}}}function Yh(n){let e;return{c(){e=w("i"),p(e,"class","iconoir-user")},m(t,i){k(t,e,i)},p:Q,d(t){t&&v(e)}}}function Kh(n){let e,t=J.getInitials(n[0].name||n[0].email)+"",i;return{c(){e=w("span"),i=ee(t),p(e,"class","txt")},m(s,l){k(s,e,l),y(e,i)},p(s,l){l&1&&t!==(t=J.getInitials(s[0].name||s[0].email)+"")&&ke(i,t)},d(s){s&&v(e)}}}function Gh(n){let e;function t(l,r){var o,a;return(o=l[0])!=null&&o.name||(a=l[0])!=null&&a.email?Kh:Yh}let i=t(n),s=i(n);return{c(){s.c(),e=Ne()},m(l,r){s.m(l,r),k(l,e,r)},p(l,r){i===(i=t(l))&&s?s.p(l,r):(s.d(1),s=i(l),s&&(s.c(),s.m(e.parentNode,e)))},d(l){l&&v(e),s.d(l)}}}function Jh(n){let e,t,i,s,l,r;const o=[Zh,Bh],a=[];function u(h,_){return h[2]?0:1}t=u(n),i=a[t]=o[t](n);const f=n[6].default,c=st(f,n,n[5],null);let d=[{class:l="thumb thumb-circle "+n[1]},n[3]],m={};for(let h=0;h<d.length;h+=1)m=Me(m,d[h]);return{c(){e=w("figure"),i.c(),s=I(),c&&c.c(),Zn(e,m)},m(h,_){k(h,e,_),a[t].m(e,null),y(e,s),c&&c.m(e,null),r=!0},p(h,[_]){let b=t;t=u(h),t===b?a[t].p(h,_):(ae(),j(a[b],1,1,()=>{a[b]=null}),ue(),i=a[t],i?i.p(h,_):(i=a[t]=o[t](h),i.c()),E(i,1),i.m(e,s)),c&&c.p&&(!r||_&32)&&rt(c,f,h,h[5],r?lt(f,h[5],_,null):ot(h[5]),null),Zn(e,m=gt(d,[(!r||_&2&&l!==(l="thumb thumb-circle "+h[1]))&&{class:l},_&8&&h[3]]))},i(h){r||(E(i),E(c,h),r=!0)},o(h){j(i),j(c,h),r=!1},d(h){h&&v(e),a[t].d(),c&&c.d(h)}}}function Xh(n,e,t){const i=["user","file","class"];let s=ut(e,i),{$$slots:l={},$$scope:r}=e,{user:o}=e,{file:a=null}=e,{class:u=""}=e,f="";async function c(){a?t(2,f=await J.generateThumb(a)):o!=null&&o.avatar?t(2,f=z.files.getURL(o,o.avatar,{thumb:"100x100"})):t(2,f="")}return n.$$set=d=>{e=Me(Me({},e),Zt(d)),t(3,s=ut(e,i)),"user"in d&&t(0,o=d.user),"file"in d&&t(4,a=d.file),"class"in d&&t(1,u=d.class),"$$scope"in d&&t(5,r=d.$$scope)},n.$$.update=()=>{n.$$.dirty&17&&(a||o)&&c()},[o,u,f,s,a,r,l]}class ts extends ye{constructor(e){super(),we(this,e,Xh,Jh,he,{user:0,file:4,class:1})}}const Tl="app-tooltip";let Ol,Mn;function ao(n){return typeof n=="string"?{text:n,position:"bottom",hideOnClick:null}:n||{}}function Cn(){return Mn=Mn||document.querySelector("."+Tl),Mn||(Mn=document.createElement("div"),Mn.classList.add(Tl),document.body.appendChild(Mn)),Mn}function td(n,e,t=null){let i=Cn();if(!i.classList.contains("active")||!(e!=null&&e.text)){Cl();return}i.textContent=e.text,e.sub?i.dataset.sub=e.sub:delete i.dataset.sub,i.className=Tl+" active",e.class&&i.classList.add(e.class),e.position&&i.classList.add(e.position),i.style.top="0px",i.style.left="0px";let s=i.offsetHeight,l=i.offsetWidth,r=n.getBoundingClientRect(),o=0,a=0,u=5;e.position=="follow"&&t?(o=t.clientY+u,a=t.clientX+u):e.position=="left"?(o=r.top+r.height/2-s/2,a=r.left-l-u):e.position=="right"?(o=r.top+r.height/2-s/2,a=r.right+u):e.position=="top"?(o=r.top-s-u,a=r.left+r.width/2-l/2):e.position=="top-left"?(o=r.top-s-u,a=r.left):e.position=="top-right"?(o=r.top-s-u,a=r.right-l):e.position=="bottom-left"?(o=r.top+r.height+u,a=r.left):e.position=="bottom-right"?(o=r.top+r.height+u,a=r.right-l):(o=r.top+r.height+u,a=r.left+r.width/2-l/2),a+l>document.documentElement.clientWidth&&(a=document.documentElement.clientWidth-l),a=a>=0?a:0,o+s>document.documentElement.clientHeight&&(o=document.documentElement.clientHeight-s),o=o>=0?o:0,i.style.top=o+"px",i.style.left=a+"px"}function Cl(){clearTimeout(Ol),Cn().classList.remove("active"),Cn().activeNode=void 0}function Qh(n,e,t){Cn().activeNode=n,clearTimeout(Ol);function i(){Cn().classList.add("active"),td(n,e,t)}e.delay?Ol=setTimeout(i,e.delay):i()}function Te(n,e){let t=ao(e);function i(l){Qh(n,t,l)}function s(l){Cl()}return!t.noAria&&t.text&&n.setAttribute("aria-description",t.text),t.position=="follow"&&n.addEventListener("mousemove",i),n.addEventListener("mouseenter",i),n.addEventListener("mouseleave",s),n.addEventListener("focusin",i),n.addEventListener("blur",s),(t.hideOnClick===!0||t.hideOnClick===null&&J.isFocusable(n))&&n.addEventListener("click",s),Cn(),{update(l){var r,o;t=ao(l),!t.noAria&&t.text?n.setAttribute("aria-description",t.text):n.removeAttribute("aria-description"),t.position=="follow"?n.addEventListener("mousemove",i):n.removeEventListener("mousemove",i),(o=(r=Cn())==null?void 0:r.activeNode)!=null&&o.contains(n)&&td(n,t)},destroy(){var l,r;(r=(l=Cn())==null?void 0:l.activeNode)!=null&&r.contains(n)&&Cl(),n.removeEventListener("mousemove",i),n.removeEventListener("mouseenter",i),n.removeEventListener("focusin",i),n.removeEventListener("mouseleave",s),n.removeEventListener("blur",s),n.removeEventListener("click",s)}}}const qt=Fe([]),Yn=Fe(""),oi=Fe(!1);function xl(){qt.set([]),Yn.set(""),oi.set(!1)}const Tt=Nt([qt,Yn],([n,e])=>n.length?e&&n.find(t=>t.id==e)||n[n.length-1]:null);Tt.set=n=>{J.isObject(n)?yi(n,!0):Yn.set(n)};function yi(n,e=!1){n&&(qt.update(t=>(J.pushOrReplaceObject(t,n),t)),e&&Yn.set(n.id))}function nd(n){n&&(qt.update(e=>(J.removeByKey(e,"id",n.id),e)),Yn.update(e=>e==n.id?"":e))}let $n;async function xh(n){return $n==null||$n(),z.collection("prototypes").subscribe("*",e=>{e.action==="delete"?nd(e.record):yi(e.record)},{filter:`project="${n}"`}).then(e=>($n=e,e)).catch(e=>{console.warn("failed to init prototypes subscription:",e)})}const er=Fe({});function Lt(n,e,t){return new Promise(i=>{er.set({text:n,yesCallback:async()=>{e&&await e(),i()},noCallback:async()=>{t&&await t(),i()}})})}function id(){er.set({})}const Se={preview:"preview",hotspots:"hotspots",comments:"comments"};Object.freeze(Se);const Kn=Fe(""),Gi=Fe(""),Ls=Fe(""),dt=Fe([]),ai=Fe(""),vi=Fe(null),Hi=Fe(!1),Li=Fe(Se.preview),Ii=Fe(!1),Vn=Fe(1),Is=Fe(!1),js=Fe(!0);function tr(){ir(),dt.set([]),Gi.set(""),Kn.set(""),Ls.set(""),ai.set(""),vi.set(null),Hi.set(!1),Vn.set(1),Is.set(!1),js.set(!0)}const Ye=Nt([dt,Kn],([n,e])=>n.length?e&&n.find(t=>t.id==e)||n[0]:null);Ye.set=n=>{Gi.set(Bn(Kn)||null),vi.set(null),J.isObject(n)?jn(n,!0):Kn.set(n)};const sd=Nt([dt,Gi],([n,e])=>!n.length||!e?null:n.find(t=>t.id==e));sd.set=n=>{J.isObject(n)?(jn(n),Gi.set(n.id)):Gi.set(n)};const ui=Nt([dt,Ls],([n,e])=>!n.length||!e?null:n.find(t=>t.id==e));ui.set=n=>{J.isObject(n)?(jn(n),Ls.set(n.id)):Ls.set(n)};function El(n=1){const e=Bn(dt)||[];if(!e.length)return null;const t=Bn(Kn)||null;let i=e.findIndex(s=>s.id==t)+n;return i<0?i=0:i>=e.length&&(i=e.length-1),e[i]}function Tn(n=1){const e=El(n);if(!(e!=null&&e.id))return;const t=Bn(Kn)||null;(t==null?void 0:t.id)!=e.id&&Ye.set(e.id)}function jn(n,e=!1){n&&(dt.update(t=>(J.pushOrReplaceObject(t,n),t)),e&&Ye.set(n.id))}function Ll(n){n&&dt.update(e=>(J.removeByKey(e,"id",n.id),qt.update(t=>{var s;const i=t.find(l=>l.id==n.prototype);return(s=i==null?void 0:i.screensOrder)!=null&&s.length&&J.removeByValue(i.screensOrder,i.id),t}),Kn.update(t=>t==n.id?"":t),e))}let Rt;async function nr(n){return Rt==null||Rt(),z.collection("screens").subscribe("*",e=>{e.action==="delete"?Ll(e.record):jn(e.record)},{filter:`prototype="${n}"`}).then(e=>(Rt=e,e)).catch(e=>{console.warn("failed to init screens subscription:",e)})}function Ps(n){var t,i;if(!(n!=null&&n.id))return 0;let e=(i=(t=Bn(Tt))==null?void 0:t.screensOrder)==null?void 0:i.indexOf(n.id);return e<0&&(e=Bn(dt).findIndex(s=>s.id==n.id)),e+1}const ld="fitToScreen";function rd(){Ii.update(n=>(n=!n,window.localStorage.setItem(ld,n?1:0),J.replaceHashQueryParams({fit:n?1:0}),n))}function od(){const n=J.getHashQueryParams();let e=typeof n.fit<"u"?n.fit:window.localStorage.getItem(ld);e=!!(e<<0),Ii.set(e),J.replaceHashQueryParams({fit:e?1:0})}function ir(){const n=J.getHashQueryParams();Wt(n.mode)}function Wt(n){(!n||!Se[n])&&(n=Se.preview),Li.set(n),J.replaceHashQueryParams({mode:n})}async function sr(n,e){return Lt("Screen replacement could result in hotspots and comments misplacement if the new screen image has different dimensions from the original. Do you still want to proceed?",async()=>e1(n,e))}async function e1(n,e){if(!e||!(n!=null&&n.id)||n.isReplacing)return;n.isReplacing=!0;const t=new FormData;t.append("file",e),t.append("title",e.name.split(".").slice(0,-1).join(".")||e.name);try{const i=await z.collection("screens").update(n.id,t,{requestKey:"replace"+n.id});n.isReplacing=!1,jn(i)}catch(i){i.isAbort||(n.isReplacing=!1,z.error(i))}}const gn=Fe([]),ad=Nt([Ye,gn],([n,e])=>n!=null&&n.id?e.filter(t=>{var i,s;return((s=(i=t.expand)==null?void 0:i.comment)==null?void 0:s.screen)==n.id}):[]);function lr(n){gn.update(e=>(J.removeByKey(e,"id",(n==null?void 0:n.id)||n),e))}function t1(n){n.read||gn.update(e=>(J.pushOrReplaceObject(e,n),e))}const ud="comment.screen.prototype.project,comment.user";async function n1(){try{const n=await z.collection("notifications").getFullList({filter:"read=false",expand:ud});return gn.set(n),i1()}catch(n){n.isAbort||console.warn("loadNotifications:",n)}}let Fn;async function i1(){return Fn==null||Fn(),z.collection("notifications").subscribe("*",async n=>{n.action=="delete"||n.record.read?lr(n.record):t1(n.record)},{expand:ud}).then(n=>(Fn=n,n)).catch(n=>{n.isAbort||console.log("notifications subscription failed:",n)})}const s1=n=>({}),uo=n=>({});function fo(n,e,t){const i=n.slice();return i[51]=e[t],i}const l1=n=>({}),co=n=>({});function po(n,e,t){const i=n.slice();return i[51]=e[t],i[55]=t,i}function mo(n){let e,t,i;return{c(){e=w("div"),t=ee(n[2]),i=I(),p(e,"class","block txt-placeholder"),Z(e,"link-hint",!n[5]&&!n[6])},m(s,l){k(s,e,l),y(e,t),y(e,i)},p(s,l){l[0]&4&&ke(t,s[2]),l[0]&96&&Z(e,"link-hint",!s[5]&&!s[6])},d(s){s&&v(e)}}}function r1(n){let e,t=n[51]+"",i;return{c(){e=w("span"),i=ee(t),p(e,"class","txt")},m(s,l){k(s,e,l),y(e,i)},p(s,l){l[0]&1&&t!==(t=s[51]+"")&&ke(i,t)},i:Q,o:Q,d(s){s&&v(e)}}}function o1(n){let e,t,i;const s=[{item:n[51]},n[12]];var l=n[11];function r(o,a){let u={};for(let f=0;f<s.length;f+=1)u=Me(u,s[f]);return a!==void 0&&a[0]&4097&&(u=Me(u,gt(s,[a[0]&1&&{item:o[51]},a[0]&4096&&It(o[12])]))),{props:u}}return l&&(e=Ln(l,r(n))),{c(){e&&W(e.$$.fragment),t=Ne()},m(o,a){e&&$(e,o,a),k(o,t,a),i=!0},p(o,a){if(a[0]&2048&&l!==(l=o[11])){if(e){ae();const u=e;j(u.$$.fragment,1,0,()=>{F(u,1)}),ue()}l?(e=Ln(l,r(o,a)),W(e.$$.fragment),E(e.$$.fragment,1),$(e,t.parentNode,t)):e=null}else if(l){const u=a[0]&4097?gt(s,[a[0]&1&&{item:o[51]},a[0]&4096&&It(o[12])]):{};e.$set(u)}},i(o){i||(e&&E(e.$$.fragment,o),i=!0)},o(o){e&&j(e.$$.fragment,o),i=!1},d(o){o&&v(t),e&&F(e,o)}}}function ho(n){let e,t,i;function s(){return n[38](n[51])}return{c(){e=w("span"),e.innerHTML='<i class="iconoir-xmark"></i>',p(e,"class","clear")},m(l,r){k(l,e,r),t||(i=[ge(Te.call(null,e,"Clear")),H(e,"click",Be(be(s)))],t=!0)},p(l,r){n=l},d(l){l&&v(e),t=!1,pe(i)}}}function _o(n){let e,t,i,s,l,r;const o=[o1,r1],a=[];function u(c,d){return c[11]?0:1}t=u(n),i=a[t]=o[t](n);let f=(n[4]||n[9])&&ho(n);return{c(){e=w("div"),i.c(),s=I(),f&&f.c(),l=I(),p(e,"class","option")},m(c,d){k(c,e,d),a[t].m(e,null),y(e,s),f&&f.m(e,null),y(e,l),r=!0},p(c,d){let m=t;t=u(c),t===m?a[t].p(c,d):(ae(),j(a[m],1,1,()=>{a[m]=null}),ue(),i=a[t],i?i.p(c,d):(i=a[t]=o[t](c),i.c()),E(i,1),i.m(e,s)),c[4]||c[9]?f?f.p(c,d):(f=ho(c),f.c(),f.m(e,l)):f&&(f.d(1),f=null)},i(c){r||(E(i),r=!0)},o(c){j(i),r=!1},d(c){c&&v(e),a[t].d(),f&&f.d()}}}function go(n){let e,t,i;function s(r){n[44](r)}let l={class:"dropdown dropdown-block options-dropdown "+n[8]+" "+(n[7]?"dropdown-upside":""),trigger:n[21],$$slots:{default:[f1]},$$scope:{ctx:n}};return n[22]!==void 0&&(l.active=n[22]),e=new At({props:l}),n[43](e),le.push(()=>Pe(e,"active",s)),e.$on("show",n[28]),e.$on("hide",n[45]),{c(){W(e.$$.fragment)},m(r,o){$(e,r,o),i=!0},p(r,o){const a={};o[0]&384&&(a.class="dropdown dropdown-block options-dropdown "+r[8]+" "+(r[7]?"dropdown-upside":"")),o[0]&2097152&&(a.trigger=r[21]),o[0]&25486346|o[1]&65536&&(a.$$scope={dirty:o,ctx:r}),!t&&o[0]&4194304&&(t=!0,a.active=r[22],je(()=>t=!1)),e.$set(a)},i(r){i||(E(e.$$.fragment,r),i=!0)},o(r){j(e.$$.fragment,r),i=!1},d(r){n[43](null),F(e,r)}}}function bo(n){let e,t,i,s,l,r,o,a,u=n[18].length&&wo(n);return{c(){e=w("div"),t=w("label"),i=w("div"),i.innerHTML='<i class="iconoir-search"></i>',s=I(),l=w("input"),r=I(),u&&u.c(),p(i,"class","addon"),l.autofocus=!0,p(l,"type","text"),p(l,"placeholder",n[3]),p(t,"class","field-group"),p(e,"class","form-field form-field-sm options-search")},m(f,c){k(f,e,c),y(e,t),y(t,i),y(t,s),y(t,l),_e(l,n[18]),y(t,r),u&&u.m(t,null),l.focus(),o||(a=H(l,"input",n[40]),o=!0)},p(f,c){c[0]&8&&p(l,"placeholder",f[3]),c[0]&262144&&l.value!==f[18]&&_e(l,f[18]),f[18].length?u?u.p(f,c):(u=wo(f),u.c(),u.m(t,null)):u&&(u.d(1),u=null)},d(f){f&&v(e),u&&u.d(),o=!1,a()}}}function wo(n){let e,t,i,s;return{c(){e=w("div"),t=w("button"),t.innerHTML='<i class="iconoir-xmark"></i>',p(t,"type","button"),p(t,"class","btn btn-xs btn-circle btn-hint btn-transparent clear"),p(e,"class","addon suffix")},m(l,r){k(l,e,r),y(e,t),i||(s=H(t,"click",Be(be(n[25]))),i=!0)},p:Q,d(l){l&&v(e),i=!1,s()}}}function yo(n){let e,t=n[1]&&vo(n);return{c(){t&&t.c(),e=Ne()},m(i,s){t&&t.m(i,s),k(i,e,s)},p(i,s){i[1]?t?t.p(i,s):(t=vo(i),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},d(i){i&&v(e),t&&t.d(i)}}}function vo(n){let e,t;return{c(){e=w("div"),t=ee(n[1]),p(e,"class","txt-missing")},m(i,s){k(i,e,s),y(e,t)},p(i,s){s[0]&2&&ke(t,i[1])},d(i){i&&v(e)}}}function a1(n){let e=n[51]+"",t;return{c(){t=ee(e)},m(i,s){k(i,t,s)},p(i,s){s[0]&16777216&&e!==(e=i[51]+"")&&ke(t,e)},i:Q,o:Q,d(i){i&&v(t)}}}function u1(n){let e,t,i;const s=[{item:n[51]},n[14]];var l=n[13];function r(o,a){let u={};for(let f=0;f<s.length;f+=1)u=Me(u,s[f]);return a!==void 0&&a[0]&16793600&&(u=Me(u,gt(s,[a[0]&16777216&&{item:o[51]},a[0]&16384&&It(o[14])]))),{props:u}}return l&&(e=Ln(l,r(n))),{c(){e&&W(e.$$.fragment),t=Ne()},m(o,a){e&&$(e,o,a),k(o,t,a),i=!0},p(o,a){if(a[0]&8192&&l!==(l=o[13])){if(e){ae();const u=e;j(u.$$.fragment,1,0,()=>{F(u,1)}),ue()}l?(e=Ln(l,r(o,a)),W(e.$$.fragment),E(e.$$.fragment,1),$(e,t.parentNode,t)):e=null}else if(l){const u=a[0]&16793600?gt(s,[a[0]&16777216&&{item:o[51]},a[0]&16384&&It(o[14])]):{};e.$set(u)}},i(o){i||(e&&E(e.$$.fragment,o),i=!0)},o(o){e&&j(e.$$.fragment,o),i=!1},d(o){o&&v(t),e&&F(e,o)}}}function ko(n){let e,t,i,s,l,r,o;const a=[u1,a1],u=[];function f(m,h){return m[13]?0:1}t=f(n),i=u[t]=a[t](n);function c(...m){return n[41](n[51],...m)}function d(...m){return n[42](n[51],...m)}return{c(){e=w("div"),i.c(),s=I(),p(e,"tabindex","0"),p(e,"class","dropdown-item option"),Z(e,"closable",n[10]),Z(e,"selected",n[23](n[51]))},m(m,h){k(m,e,h),u[t].m(e,null),y(e,s),l=!0,r||(o=[H(e,"click",c),H(e,"keydown",d)],r=!0)},p(m,h){n=m;let _=t;t=f(n),t===_?u[t].p(n,h):(ae(),j(u[_],1,1,()=>{u[_]=null}),ue(),i=u[t],i?i.p(n,h):(i=u[t]=a[t](n),i.c()),E(i,1),i.m(e,s)),(!l||h[0]&1024)&&Z(e,"closable",n[10]),(!l||h[0]&25165824)&&Z(e,"selected",n[23](n[51]))},i(m){l||(E(i),l=!0)},o(m){j(i),l=!1},d(m){m&&v(e),u[t].d(),r=!1,pe(o)}}}function f1(n){let e,t,i,s,l,r=n[15]&&bo(n);const o=n[37].beforeOptions,a=st(o,n,n[47],co);let u=Ee(n[24]),f=[];for(let _=0;_<u.length;_+=1)f[_]=ko(fo(n,u,_));const c=_=>j(f[_],1,1,()=>{f[_]=null});let d=null;u.length||(d=yo(n));const m=n[37].afterOptions,h=st(m,n,n[47],uo);return{c(){r&&r.c(),e=I(),a&&a.c(),t=I(),i=w("div");for(let _=0;_<f.length;_+=1)f[_].c();d&&d.c(),s=I(),h&&h.c(),p(i,"class","options-list")},m(_,b){r&&r.m(_,b),k(_,e,b),a&&a.m(_,b),k(_,t,b),k(_,i,b);for(let g=0;g<f.length;g+=1)f[g]&&f[g].m(i,null);d&&d.m(i,null),k(_,s,b),h&&h.m(_,b),l=!0},p(_,b){if(_[15]?r?r.p(_,b):(r=bo(_),r.c(),r.m(e.parentNode,e)):r&&(r.d(1),r=null),a&&a.p&&(!l||b[1]&65536)&&rt(a,o,_,_[47],l?lt(o,_[47],b,l1):ot(_[47]),co),b[0]&226518018){u=Ee(_[24]);let g;for(g=0;g<u.length;g+=1){const T=fo(_,u,g);f[g]?(f[g].p(T,b),E(f[g],1)):(f[g]=ko(T),f[g].c(),E(f[g],1),f[g].m(i,null))}for(ae(),g=u.length;g<f.length;g+=1)c(g);ue(),!u.length&&d?d.p(_,b):u.length?d&&(d.d(1),d=null):(d=yo(_),d.c(),d.m(i,null))}h&&h.p&&(!l||b[1]&65536)&&rt(h,m,_,_[47],l?lt(m,_[47],b,s1):ot(_[47]),uo)},i(_){if(!l){E(a,_);for(let b=0;b<u.length;b+=1)E(f[b]);E(h,_),l=!0}},o(_){j(a,_),f=f.filter(Boolean);for(let b=0;b<f.length;b+=1)j(f[b]);j(h,_),l=!1},d(_){_&&(v(e),v(t),v(i),v(s)),r&&r.d(_),a&&a.d(_),tn(f,_),d&&d.d(),h&&h.d(_)}}}function c1(n){let e,t,i,s,l,r,o=Ee(J.toArray(n[0])),a=[];for(let d=0;d<o.length;d+=1)a[d]=_o(po(n,o,d));const u=d=>j(a[d],1,1,()=>{a[d]=null});let f=null;o.length||(f=mo(n));let c=!n[5]&&!n[6]&&go(n);return{c(){e=w("div"),t=w("div");for(let d=0;d<a.length;d+=1)a[d].c();f&&f.c(),s=I(),c&&c.c(),p(t,"tabindex",i=n[5]||n[6]?"-1":"0"),p(t,"class","selected-container"),Z(t,"disabled",n[5]),Z(t,"readonly",n[6]),p(e,"class",l="select "+n[16]),Z(e,"active",n[22]),Z(e,"upside",n[7]),Z(e,"multiple",n[4]),Z(e,"disabled",n[5]),Z(e,"readonly",n[6])},m(d,m){k(d,e,m),y(e,t);for(let h=0;h<a.length;h+=1)a[h]&&a[h].m(t,null);f&&f.m(t,null),n[39](t),y(e,s),c&&c.m(e,null),n[46](e),r=!0},p(d,m){if(m[0]&137845){o=Ee(J.toArray(d[0]));let h;for(h=0;h<o.length;h+=1){const _=po(d,o,h);a[h]?(a[h].p(_,m),E(a[h],1)):(a[h]=_o(_),a[h].c(),E(a[h],1),a[h].m(t,null))}for(ae(),h=o.length;h<a.length;h+=1)u(h);ue(),!o.length&&f?f.p(d,m):o.length?f&&(f.d(1),f=null):(f=mo(d),f.c(),f.m(t,null))}(!r||m[0]&96&&i!==(i=d[5]||d[6]?"-1":"0"))&&p(t,"tabindex",i),(!r||m[0]&32)&&Z(t,"disabled",d[5]),(!r||m[0]&64)&&Z(t,"readonly",d[6]),!d[5]&&!d[6]?c?(c.p(d,m),m[0]&96&&E(c,1)):(c=go(d),c.c(),E(c,1),c.m(e,null)):c&&(ae(),j(c,1,1,()=>{c=null}),ue()),(!r||m[0]&65536&&l!==(l="select "+d[16]))&&p(e,"class",l),(!r||m[0]&4259840)&&Z(e,"active",d[22]),(!r||m[0]&65664)&&Z(e,"upside",d[7]),(!r||m[0]&65552)&&Z(e,"multiple",d[4]),(!r||m[0]&65568)&&Z(e,"disabled",d[5]),(!r||m[0]&65600)&&Z(e,"readonly",d[6])},i(d){if(!r){for(let m=0;m<o.length;m+=1)E(a[m]);E(c),r=!0}},o(d){a=a.filter(Boolean);for(let m=0;m<a.length;m+=1)j(a[m]);j(c),r=!1},d(d){d&&v(e),tn(a,d),f&&f.d(),n[39](null),c&&c.d(),n[46](null)}}}function d1(n,e){let t=(""+e).replace(/\s+/g,"").toLowerCase(),i=n;try{typeof n=="object"&&n!==null&&(i=JSON.stringify(n))}catch{}return(""+i).replace(/\s+/g,"").toLowerCase().includes(t)}function p1(n,e,t){let i,s,{$$slots:l={},$$scope:r}=e,{id:o=""}=e,{noOptionsText:a="No options found"}=e,{selectPlaceholder:u="Select"}=e,{searchPlaceholder:f="Search..."}=e,{items:c=[]}=e,{multiple:d=!1}=e,{disabled:m=!1}=e,{readonly:h=!1}=e,{upside:_=!1}=e,{dropdownClass:b=""}=e,{selected:g=d?[]:void 0}=e,{toggle:T=d}=e,{closable:L=!0}=e,{labelComponent:O=void 0}=e,{labelComponentProps:C={}}=e,{optionComponent:S=void 0}=e,{optionComponentProps:P={}}=e,{searchable:M=!1}=e,{searchFunc:A=void 0}=e,{class:D=""}=e,R,Y="",G,B,N=!1;function V(ie){if(J.isEmpty(g))return;let Ve=J.toArray(g);J.inArray(Ve,ie)&&(J.removeByValue(Ve,ie),t(0,g=Ve)),G==null||G.dispatchEvent(new CustomEvent("change",{detail:g,bubbles:!0}))}function te(ie){if(d){let Ve=J.toArray(g);J.inArray(Ve,ie)||t(0,g=[...Ve,ie])}else t(0,g=ie);G==null||G.dispatchEvent(new CustomEvent("change",{detail:g,bubbles:!0}))}function X(ie){return s(ie)?V(ie):te(ie)}function U(){t(0,g=d?[]:void 0)}function ce(){R!=null&&R.show&&(R==null||R.show())}function oe(){R!=null&&R.hide&&(R==null||R.hide())}function de(){if(J.isEmpty(g)||J.isEmpty(c))return;let ie=J.toArray(g),Ve=[];for(const fe of ie)J.inArray(c,fe)||Ve.push(fe);if(Ve.length){for(const fe of Ve)J.removeByValue(ie,fe);t(0,g=d?ie:ie[0])}}function Ce(){t(18,Y="")}function xe(ie,Ve){ie=ie||[];const fe=A||d1;return ie.filter(Le=>fe(Le,Ve))||[]}function at(ie,Ve){ie.preventDefault(),T&&d?X(Ve):te(Ve)}function nt(ie,Ve){(ie.code==="Enter"||ie.code==="Space")&&(at(ie,Ve),L&&oe())}function ct(){Ce(),setTimeout(()=>{const ie=G==null?void 0:G.querySelector(".dropdown-item.option.selected");ie&&(ie.focus(),ie.scrollIntoView({block:"nearest"}))},0)}function K(ie){ie.stopPropagation(),!h&&!m&&(R==null||R.toggle())}hn(()=>{const ie=document.querySelectorAll(`label[for="${o}"]`);for(const Ve of ie)Ve.addEventListener("click",K);return()=>{for(const Ve of ie)Ve.removeEventListener("click",K)}});const se=ie=>V(ie);function q(ie){le[ie?"unshift":"push"](()=>{B=ie,t(21,B)})}function ne(){Y=this.value,t(18,Y)}const He=(ie,Ve)=>at(Ve,ie),ht=(ie,Ve)=>nt(Ve,ie);function qe(ie){le[ie?"unshift":"push"](()=>{R=ie,t(19,R)})}function it(ie){N=ie,t(22,N)}function Dt(ie){$e.call(this,n,ie)}function Mt(ie){le[ie?"unshift":"push"](()=>{G=ie,t(20,G)})}return n.$$set=ie=>{"id"in ie&&t(29,o=ie.id),"noOptionsText"in ie&&t(1,a=ie.noOptionsText),"selectPlaceholder"in ie&&t(2,u=ie.selectPlaceholder),"searchPlaceholder"in ie&&t(3,f=ie.searchPlaceholder),"items"in ie&&t(30,c=ie.items),"multiple"in ie&&t(4,d=ie.multiple),"disabled"in ie&&t(5,m=ie.disabled),"readonly"in ie&&t(6,h=ie.readonly),"upside"in ie&&t(7,_=ie.upside),"dropdownClass"in ie&&t(8,b=ie.dropdownClass),"selected"in ie&&t(0,g=ie.selected),"toggle"in ie&&t(9,T=ie.toggle),"closable"in ie&&t(10,L=ie.closable),"labelComponent"in ie&&t(11,O=ie.labelComponent),"labelComponentProps"in ie&&t(12,C=ie.labelComponentProps),"optionComponent"in ie&&t(13,S=ie.optionComponent),"optionComponentProps"in ie&&t(14,P=ie.optionComponentProps),"searchable"in ie&&t(15,M=ie.searchable),"searchFunc"in ie&&t(31,A=ie.searchFunc),"class"in ie&&t(16,D=ie.class),"$$scope"in ie&&t(47,r=ie.$$scope)},n.$$.update=()=>{n.$$.dirty[0]&1073741824&&c&&(de(),Ce()),n.$$.dirty[0]&1074003968&&t(24,i=xe(c,Y)),n.$$.dirty[0]&1&&t(23,s=function(ie){const Ve=J.toArray(g);return J.inArray(Ve,ie)})},[g,a,u,f,d,m,h,_,b,T,L,O,C,S,P,M,D,V,Y,R,G,B,N,s,i,Ce,at,nt,ct,o,c,A,te,X,U,ce,oe,l,se,q,ne,He,ht,qe,it,Dt,Mt,r]}class m1 extends ye{constructor(e){super(),we(this,e,p1,c1,he,{id:29,noOptionsText:1,selectPlaceholder:2,searchPlaceholder:3,items:30,multiple:4,disabled:5,readonly:6,upside:7,dropdownClass:8,selected:0,toggle:9,closable:10,labelComponent:11,labelComponentProps:12,optionComponent:13,optionComponentProps:14,searchable:15,searchFunc:31,class:16,deselectItem:17,selectItem:32,toggleItem:33,reset:34,showDropdown:35,hideDropdown:36},null,[-1,-1])}get deselectItem(){return this.$$.ctx[17]}get selectItem(){return this.$$.ctx[32]}get toggleItem(){return this.$$.ctx[33]}get reset(){return this.$$.ctx[34]}get showDropdown(){return this.$$.ctx[35]}get hideDropdown(){return this.$$.ctx[36]}}function So(n){let e,t;return{c(){e=w("i"),p(e,"class",t="icon "+n[0].icon)},m(i,s){k(i,e,s)},p(i,s){s&1&&t!==(t="icon "+i[0].icon)&&p(e,"class",t)},d(i){i&&v(e)}}}function h1(n){let e,t,i=(n[0].label||n[0].name||n[0].title||n[0].id||n[0].value)+"",s,l=n[0].icon&&So(n);return{c(){l&&l.c(),e=I(),t=w("span"),s=ee(i),p(t,"class","txt")},m(r,o){l&&l.m(r,o),k(r,e,o),k(r,t,o),y(t,s)},p(r,[o]){r[0].icon?l?l.p(r,o):(l=So(r),l.c(),l.m(e.parentNode,e)):l&&(l.d(1),l=null),o&1&&i!==(i=(r[0].label||r[0].name||r[0].title||r[0].id||r[0].value)+"")&&ke(s,i)},i:Q,o:Q,d(r){r&&(v(e),v(t)),l&&l.d(r)}}}function _1(n,e,t){let{item:i={}}=e;return n.$$set=s=>{"item"in s&&t(0,i=s.item)},[i]}class To extends ye{constructor(e){super(),we(this,e,_1,h1,he,{item:0})}}const g1=n=>({}),Oo=n=>({});function b1(n){let e;const t=n[8].afterOptions,i=st(t,n,n[12],Oo);return{c(){i&&i.c()},m(s,l){i&&i.m(s,l),e=!0},p(s,l){i&&i.p&&(!e||l&4096)&&rt(i,t,s,s[12],e?lt(t,s[12],l,g1):ot(s[12]),Oo)},i(s){e||(E(i,s),e=!0)},o(s){j(i,s),e=!1},d(s){i&&i.d(s)}}}function w1(n){let e,t,i;const s=[{items:n[1]},{multiple:n[2]},{labelComponent:n[3]},{optionComponent:n[4]},n[5]];function l(o){n[9](o)}let r={$$slots:{afterOptions:[b1]},$$scope:{ctx:n}};for(let o=0;o<s.length;o+=1)r=Me(r,s[o]);return n[0]!==void 0&&(r.selected=n[0]),e=new m1({props:r}),le.push(()=>Pe(e,"selected",l)),e.$on("show",n[10]),e.$on("hide",n[11]),{c(){W(e.$$.fragment)},m(o,a){$(e,o,a),i=!0},p(o,[a]){const u=a&62?gt(s,[a&2&&{items:o[1]},a&4&&{multiple:o[2]},a&8&&{labelComponent:o[3]},a&16&&{optionComponent:o[4]},a&32&&It(o[5])]):{};a&4096&&(u.$$scope={dirty:a,ctx:o}),!t&&a&1&&(t=!0,u.selected=o[0],je(()=>t=!1)),e.$set(u)},i(o){i||(E(e.$$.fragment,o),i=!0)},o(o){j(e.$$.fragment,o),i=!1},d(o){F(e,o)}}}function y1(n,e,t){const i=["items","multiple","selected","labelComponent","optionComponent","selectionKey","keyOfSelected"];let s=ut(e,i),{$$slots:l={},$$scope:r}=e,{items:o=[]}=e,{multiple:a=!1}=e,{selected:u=a?[]:void 0}=e,{labelComponent:f=To}=e,{optionComponent:c=To}=e,{selectionKey:d="value"}=e,{keyOfSelected:m=a?[]:void 0}=e;function h(L){L=J.toArray(L,!0);let O=[];for(let C of L){const S=J.findByKey(o,d,C);S&&O.push(S)}L.length&&!O.length||t(0,u=a?O:O[0])}async function _(L){let O=J.toArray(L,!0).map(C=>C[d]);o.length&&t(6,m=a?O:O[0])}function b(L){u=L,t(0,u)}function g(L){$e.call(this,n,L)}function T(L){$e.call(this,n,L)}return n.$$set=L=>{e=Me(Me({},e),Zt(L)),t(5,s=ut(e,i)),"items"in L&&t(1,o=L.items),"multiple"in L&&t(2,a=L.multiple),"selected"in L&&t(0,u=L.selected),"labelComponent"in L&&t(3,f=L.labelComponent),"optionComponent"in L&&t(4,c=L.optionComponent),"selectionKey"in L&&t(7,d=L.selectionKey),"keyOfSelected"in L&&t(6,m=L.keyOfSelected),"$$scope"in L&&t(12,r=L.$$scope)},n.$$.update=()=>{n.$$.dirty&66&&o&&h(m),n.$$.dirty&1&&_(u)},[u,o,a,f,c,s,m,d,l,b,g,T,r]}class cn extends ye{constructor(e){super(),we(this,e,y1,w1,he,{items:1,multiple:2,selected:0,labelComponent:3,optionComponent:4,selectionKey:7,keyOfSelected:6})}}function Co(n,e,t){var l;const i=n.slice();i[19]=e[t];const s=((l=i[19].expand)==null?void 0:l.comment)||{};return i[20]=s,i}function Eo(n){let e,t=n[1].length+"",i;return{c(){e=w("sub"),i=ee(t),p(e,"class","sub sub-warning"),p(e,"title","Unread notifications")},m(s,l){k(s,e,l),y(e,i)},p(s,l){l&2&&t!==(t=s[1].length+"")&&ke(i,t)},d(s){s&&v(e)}}}function v1(n){let e;return{c(){e=w("div"),e.innerHTML='<figure class="icon"><i class="iconoir-bell"></i></figure> <p class="txt-hint">You don&#39;t have any unread notifications!</p>',p(e,"class","placeholder-block placeholder-block-sm p-base")},m(t,i){k(t,e,i)},p:Q,i:Q,o:Q,d(t){t&&v(e)}}}function k1(n){let e,t,i,s,l,r,o,a,u,f,c,d,m=[],h=new Map,_,b,g;function T(S){n[12](S)}let L={items:n[5]};n[0]!==void 0&&(L.keyOfSelected=n[0]),r=new cn({props:L}),le.push(()=>Pe(r,"keyOfSelected",T));let O=Ee(n[6]);const C=S=>S[19].id;for(let S=0;S<O.length;S+=1){let P=Co(n,O,S),M=C(P);h.set(M,m[S]=Io(M,P))}return{c(){e=w("div"),t=w("div"),t.innerHTML="<h6>Notifications</h6>",i=I(),s=w("div"),l=w("div"),W(r.$$.fragment),a=I(),u=w("div"),f=w("button"),f.innerHTML='<span class="txt">Mark all as read</span>',c=I(),d=w("div");for(let S=0;S<m.length;S+=1)m[S].c();p(t,"class","flex m-b-xs"),p(f,"type","button"),p(f,"class","txt-sm link-fade"),Z(f,"txt-disabled",n[4]),p(u,"class","addon"),p(l,"class","field-group"),p(s,"class","form-field form-field-sm m-b-0 m-l-auto"),p(e,"class","block p-t-xs p-b-sm p-l-sm p-r-sm"),p(d,"class","list notifications-list")},m(S,P){k(S,e,P),y(e,t),y(e,i),y(e,s),y(s,l),$(r,l,null),y(l,a),y(l,u),y(u,f),k(S,c,P),k(S,d,P);for(let M=0;M<m.length;M+=1)m[M]&&m[M].m(d,null);_=!0,b||(g=H(f,"click",be(n[13])),b=!0)},p(S,P){const M={};P&32&&(M.items=S[5]),!o&&P&1&&(o=!0,M.keyOfSelected=S[0],je(()=>o=!1)),r.$set(M),(!_||P&16)&&Z(f,"txt-disabled",S[4]),P&832&&(O=Ee(S[6]),ae(),m=kt(m,P,C,1,S,O,h,d,jt,Io,null,Co),ue())},i(S){if(!_){E(r.$$.fragment,S);for(let P=0;P<O.length;P+=1)E(m[P]);_=!0}},o(S){j(r.$$.fragment,S);for(let P=0;P<m.length;P+=1)j(m[P]);_=!1},d(S){S&&(v(e),v(c),v(d)),F(r);for(let P=0;P<m.length;P+=1)m[P].d();b=!1,g()}}}function Lo(n){let e,t,i=n[20].expand.screen.title+"",s;return{c(){e=w("div"),t=w("small"),s=ee(i),p(t,"class","screen-title"),p(e,"class","row txt-hint")},m(l,r){k(l,e,r),y(e,t),y(t,s)},p(l,r){r&64&&i!==(i=l[20].expand.screen.title+"")&&ke(s,i)},d(l){l&&v(e)}}}function Io(n,e){var N,V,te;let t,i,s,l,r,o,a,u=J.getCommentAuthor(e[20])+"",f,c,d,m=J.relativeDate(e[20].created)+"",h,_,b,g,T,L,O,C=e[20].message+"",S,P,M,A,D,R;i=new ts({props:{user:(N=e[20].expand)==null?void 0:N.user,class:"avatar"}});function Y(){return e[14](e[19])}let G=((te=(V=e[20].expand)==null?void 0:V.screen)==null?void 0:te.title)&&Lo(e);function B(){return e[15](e[20])}return{key:n,first:null,c(){t=w("div"),W(i.$$.fragment),s=I(),l=w("div"),r=w("div"),o=w("div"),a=w("small"),f=ee(u),c=I(),d=w("small"),h=ee(m),_=I(),b=w("nav"),g=w("button"),g.innerHTML='<i class="iconoir-check"></i>',T=I(),L=w("div"),O=w("div"),S=ee(C),P=I(),G&&G.c(),M=I(),p(a,"class","name"),p(d,"class","txt-xs txt-hint date"),p(o,"class","inline-flex flex-row-gap-0"),p(g,"type","button"),p(g,"class","btn btn-xs btn-circle btn-transparent btn-hint"),p(b,"class","ctrls"),p(r,"class","row"),p(O,"class","message"),p(L,"class","row"),p(l,"class","content"),p(t,"class","list-item handle"),this.first=t},m(X,U){k(X,t,U),$(i,t,null),y(t,s),y(t,l),y(l,r),y(r,o),y(o,a),y(a,f),y(o,c),y(o,d),y(d,h),y(r,_),y(r,b),y(b,g),y(l,T),y(l,L),y(L,O),y(O,S),y(l,P),G&&G.m(l,null),y(t,M),A=!0,D||(R=[ge(Te.call(null,g,"Mark as read")),H(g,"click",Be(be(Y))),H(t,"click",B)],D=!0)},p(X,U){var oe,de,Ce;e=X;const ce={};U&64&&(ce.user=(oe=e[20].expand)==null?void 0:oe.user),i.$set(ce),(!A||U&64)&&u!==(u=J.getCommentAuthor(e[20])+"")&&ke(f,u),(!A||U&64)&&m!==(m=J.relativeDate(e[20].created)+"")&&ke(h,m),(!A||U&64)&&C!==(C=e[20].message+"")&&ke(S,C),(Ce=(de=e[20].expand)==null?void 0:de.screen)!=null&&Ce.title?G?G.p(e,U):(G=Lo(e),G.c(),G.m(l,null)):G&&(G.d(1),G=null)},i(X){A||(E(i.$$.fragment,X),A=!0)},o(X){j(i.$$.fragment,X),A=!1},d(X){X&&v(t),F(i),G&&G.d(),D=!1,pe(R)}}}function S1(n){let e,t,i,s;const l=[k1,v1],r=[];function o(a,u){return a[1].length?0:1}return t=o(n),i=r[t]=l[t](n),{c(){e=w("div"),i.c(),p(e,"class","content")},m(a,u){k(a,e,u),r[t].m(e,null),s=!0},p(a,u){let f=t;t=o(a),t===f?r[t].p(a,u):(ae(),j(r[f],1,1,()=>{r[f]=null}),ue(),i=r[t],i?i.p(a,u):(i=r[t]=l[t](a),i.c()),E(i,1),i.m(e,null))},i(a){s||(E(i),s=!0)},o(a){j(i),s=!1},d(a){a&&v(e),r[t].d()}}}function T1(n){let e,t,i,s,l,r,o,a,u,f,c,d=n[1].length&&Eo(n);function m(_){n[17](_)}let h={class:"dropdown notifications-dropdown",$$slots:{default:[S1]},$$scope:{ctx:n}};return n[3]!==void 0&&(h.active=n[3]),r=new At({props:h}),n[16](r),le.push(()=>Pe(r,"active",m)),r.$on("show",n[7]),{c(){e=w("div"),t=w("i"),s=I(),d&&d.c(),l=I(),W(r.$$.fragment),p(t,"class",i="iconoir-bell "+(n[1].length?"txt-warning":"txt-hint")),p(e,"tabindex","0"),p(e,"class","btn btn-hint btn-transparent btn-circle notifications-btn")},m(_,b){k(_,e,b),y(e,t),y(e,s),d&&d.m(e,null),y(e,l),$(r,e,null),u=!0,f||(c=ge(a=Te.call(null,e,n[3]?void 0:{position:"bottom",text:"Notifications"})),f=!0)},p(_,[b]){(!u||b&2&&i!==(i="iconoir-bell "+(_[1].length?"txt-warning":"txt-hint")))&&p(t,"class",i),_[1].length?d?d.p(_,b):(d=Eo(_),d.c(),d.m(e,l)):d&&(d.d(1),d=null);const g={};b&8388723&&(g.$$scope={dirty:b,ctx:_}),!o&&b&8&&(o=!0,g.active=_[3],je(()=>o=!1)),r.$set(g),a&&Qe(a.update)&&b&8&&a.update.call(null,_[3]?void 0:{position:"bottom",text:"Notifications"})},i(_){u||(E(r.$$.fragment,_),u=!0)},o(_){j(r.$$.fragment,_),u=!1},d(_){_&&v(e),d&&d.d(),n[16](null),F(r),f=!1,c()}}}function O1(n,e=[]){return n.length?n:e}function C1(n,e,t){let i;x(n,gn,S=>t(1,i=S));let s,l=!1,r=!1,o="",a=[],u=[];function f(){s==null||s.show()}function c(){s==null||s.hide()}function d(){t(0,o=""),m()}function m(){var P,M,A,D,R,Y,G;const S={};for(let B of i){const N=(G=(Y=(R=(D=(A=(M=(P=B.expand)==null?void 0:P.comment)==null?void 0:M.expand)==null?void 0:A.screen)==null?void 0:D.expand)==null?void 0:R.prototype)==null?void 0:Y.expand)==null?void 0:G.project;N&&(S[N.id]={label:N.title,value:N.id})}t(5,a=Object.values(S)),a.length!=1?t(5,a=[{label:"All projects",value:""}].concat(a)):t(0,o=a[0].value)}async function h(S){t(4,r=!0),S=J.toArray(S),S.length||(S=i.map(P=>P.id));try{const P=[];for(let M of S)P.push(z.collection("notifications").update(M,{read:!0})),lr(M);await Promise.allSettled(P)}catch(P){P.isAbort||z.error(P)}t(4,r=!1)}function _(S){var R,Y,G,B,N,V;const P=(B=(G=(Y=(R=S.expand)==null?void 0:R.screen)==null?void 0:Y.expand)==null?void 0:G.prototype)==null?void 0:B.project,M=(V=(N=S.expand)==null?void 0:N.screen)==null?void 0:V.prototype,A=S.screen,D=S.id;gi(`/projects/${P}/prototypes/${M}/screens/${A}?mode=comments&commentId=${D}`)}hn(()=>{J.getHashQueryParams().notifications&&(J.replaceHashQueryParams({notifications:null}),f())});function b(S){o=S,t(0,o)}const g=()=>h(),T=S=>{h(S.id)},L=S=>_(S);function O(S){le[S?"unshift":"push"](()=>{s=S,t(2,s)})}function C(S){l=S,t(3,l)}return n.$$.update=()=>{n.$$.dirty&2&&i!=null&&i.length&&m(),n.$$.dirty&3&&t(6,u=o?O1(i.filter(S=>{var P,M,A,D,R,Y;return((Y=(R=(D=(A=(M=(P=S.expand)==null?void 0:P.comment)==null?void 0:M.expand)==null?void 0:A.screen)==null?void 0:D.expand)==null?void 0:R.prototype)==null?void 0:Y.project)==o}),i):i)},[o,i,s,l,r,a,u,d,h,_,f,c,b,g,T,L,O,C]}class E1 extends ye{constructor(e){super(),we(this,e,C1,T1,he,{show:10,hide:11})}get show(){return this.$$.ctx[10]}get hide(){return this.$$.ctx[11]}}const L1=n=>({}),jo=n=>({}),I1=n=>({}),Po=n=>({});function No(n){let e,t,i,s,l,r,o,a,u,f,c,d,m,h,_,b,g,T=n[4]&&Ao(n);const L=n[20].header,O=st(L,n,n[19],Po),C=n[20].default,S=st(C,n,n[19],null),P=n[20].footer,M=st(P,n,n[19],jo);return{c(){e=w("div"),t=w("div"),s=I(),l=w("div"),r=w("div"),T&&T.c(),o=I(),O&&O.c(),a=I(),u=w("div"),S&&S.c(),f=I(),c=w("div"),M&&M.c(),p(t,"class","overlay"),p(r,"class","overlay-panel-section panel-header"),p(u,"class","overlay-panel-section panel-content"),p(c,"class","overlay-panel-section panel-footer"),p(l,"class",d="overlay-panel "+n[1]+" "+n[8]),Z(l,"popup",n[2]),p(e,"class","overlay-panel-container"),Z(e,"padded",n[2]),Z(e,"active",n[0])},m(A,D){k(A,e,D),y(e,t),y(e,s),y(e,l),y(l,r),T&&T.m(r,null),y(r,o),O&&O.m(r,null),y(l,a),y(l,u),S&&S.m(u,null),n[22](u),y(l,f),y(l,c),M&&M.m(c,null),_=!0,b||(g=[H(t,"click",be(n[21])),H(u,"scroll",n[23])],b=!0)},p(A,D){n=A,n[4]?T?T.p(n,D):(T=Ao(n),T.c(),T.m(r,o)):T&&(T.d(1),T=null),O&&O.p&&(!_||D[0]&524288)&&rt(O,L,n,n[19],_?lt(L,n[19],D,I1):ot(n[19]),Po),S&&S.p&&(!_||D[0]&524288)&&rt(S,C,n,n[19],_?lt(C,n[19],D,null):ot(n[19]),null),M&&M.p&&(!_||D[0]&524288)&&rt(M,P,n,n[19],_?lt(P,n[19],D,L1):ot(n[19]),jo),(!_||D[0]&258&&d!==(d="overlay-panel "+n[1]+" "+n[8]))&&p(l,"class",d),(!_||D[0]&262)&&Z(l,"popup",n[2]),(!_||D[0]&4)&&Z(e,"padded",n[2]),(!_||D[0]&1)&&Z(e,"active",n[0])},i(A){_||(A&&vt(()=>{_&&(i||(i=ft(t,Sl,{duration:ii,opacity:0},!0)),i.run(1))}),E(O,A),E(S,A),E(M,A),A&&vt(()=>{_&&(h&&h.end(1),m=Wf(l,In,n[2]?{duration:ii,y:-10}:{duration:ii,x:50}),m.start())}),_=!0)},o(A){A&&(i||(i=ft(t,Sl,{duration:ii,opacity:0},!1)),i.run(0)),j(O,A),j(S,A),j(M,A),m&&m.invalidate(),A&&(h=Vf(l,In,n[2]?{duration:ii,y:10}:{duration:ii,x:50})),_=!1},d(A){A&&v(e),A&&i&&i.end(),T&&T.d(),O&&O.d(A),S&&S.d(A),n[22](null),M&&M.d(A),A&&h&&h.end(),b=!1,pe(g)}}}function Ao(n){let e;function t(l,r){return l[2]?P1:j1}let i=t(n),s=i(n);return{c(){s.c(),e=Ne()},m(l,r){s.m(l,r),k(l,e,r)},p(l,r){i===(i=t(l))&&s?s.p(l,r):(s.d(1),s=i(l),s&&(s.c(),s.m(e.parentNode,e)))},d(l){l&&v(e),s.d(l)}}}function j1(n){let e,t,i;return{c(){e=w("button"),e.innerHTML='<i class="iconoir-xmark"></i>',p(e,"tabindex","-1"),p(e,"type","button"),p(e,"class","overlay-close")},m(s,l){k(s,e,l),t||(i=H(e,"click",be(n[5])),t=!0)},p:Q,d(s){s&&v(e),t=!1,i()}}}function P1(n){let e,t,i;return{c(){e=w("button"),e.innerHTML='<i class="iconoir-xmark txt-lg"></i>',p(e,"tabindex","-1"),p(e,"type","button"),p(e,"class","btn btn-sm btn-circle btn-transparent btn-close m-l-auto")},m(s,l){k(s,e,l),t||(i=H(e,"click",be(n[5])),t=!0)},p:Q,d(s){s&&v(e),t=!1,i()}}}function N1(n){let e,t,i,s,l=n[0]&&No(n);return{c(){e=w("div"),l&&l.c(),p(e,"id",n[9]),p(e,"class","overlay-panel-wrapper"),p(e,"tabindex","-1")},m(r,o){k(r,e,o),l&&l.m(e,null),n[24](e),t=!0,i||(s=[H(window,"resize",n[11]),H(window,"keydown",n[10])],i=!0)},p(r,o){r[0]?l?(l.p(r,o),o[0]&1&&E(l,1)):(l=No(r),l.c(),E(l,1),l.m(e,null)):l&&(ae(),j(l,1,1,()=>{l=null}),ue())},i(r){t||(E(l),t=!0)},o(r){j(l),t=!1},d(r){r&&v(e),l&&l.d(),n[24](null),i=!1,pe(s)}}}let Rn,ll=[];function fd(){return Rn=Rn||document.querySelector(".overlays"),Rn||(Rn=document.createElement("div"),Rn.classList.add("overlays"),document.body.appendChild(Rn)),Rn}let ii=150;function Do(){return 1e3+fd().querySelectorAll(".overlay-panel-container.active").length}function A1(n,e,t){let{$$slots:i={},$$scope:s}=e,{class:l=""}=e,{active:r=!1}=e,{popup:o=!1}=e,{overlayClose:a=!0}=e,{btnClose:u=!0}=e,{escHide:f=!0}=e,{beforeOpen:c=void 0}=e,{beforeHide:d=void 0}=e;const m=tt(),h="op_"+J.randomString(5);let _,b,g,T,L="",O=r;function C(){typeof c=="function"&&c()===!1||t(0,r=!0)}function S(){typeof d=="function"&&d()===!1||t(0,r=!1)}function P(){return r}async function M(U){t(18,O=U),U?(g=document.activeElement,m("show"),_==null||_.focus()):(clearTimeout(T),m("hide"),g==null||g.focus(),setTimeout(()=>{g==null||g.blur()},0)),await St(),A()}function A(){_&&(r?t(6,_.style.zIndex=Do(),_):t(6,_.style="",_))}function D(){J.pushUnique(ll,h),document.body.classList.add("overlay-active")}function R(){J.removeByValue(ll,h),ll.length||document.body.classList.remove("overlay-active")}function Y(U){r&&f&&U.code=="Escape"&&!J.isInput(U.target)&&_&&_.style.zIndex==Do()&&(U.preventDefault(),S())}function G(U){r&&B(b)}function B(U,ce){ce&&t(8,L=""),U&&(T||(T=setTimeout(()=>{if(clearTimeout(T),T=null,!U)return;if(U.scrollHeight-U.offsetHeight>0)t(8,L="scrollable");else{t(8,L="");return}U.scrollTop==0?t(8,L+=" scroll-top-reached"):U.scrollTop+U.offsetHeight==U.scrollHeight&&t(8,L+=" scroll-bottom-reached")},100)))}hn(()=>(fd().appendChild(_),()=>{clearTimeout(T),R(),_==null||_.remove()}));const N=()=>a?S():!0;function V(U){le[U?"unshift":"push"](()=>{b=U,t(7,b)})}const te=U=>B(U.target);function X(U){le[U?"unshift":"push"](()=>{_=U,t(6,_)})}return n.$$set=U=>{"class"in U&&t(1,l=U.class),"active"in U&&t(0,r=U.active),"popup"in U&&t(2,o=U.popup),"overlayClose"in U&&t(3,a=U.overlayClose),"btnClose"in U&&t(4,u=U.btnClose),"escHide"in U&&t(13,f=U.escHide),"beforeOpen"in U&&t(14,c=U.beforeOpen),"beforeHide"in U&&t(15,d=U.beforeHide),"$$scope"in U&&t(19,s=U.$$scope)},n.$$.update=()=>{n.$$.dirty[0]&262145&&O!=r&&M(r),n.$$.dirty[0]&128&&B(b,!0),n.$$.dirty[0]&64&&_&&A(),n.$$.dirty[0]&1&&(r?D():R())},[r,l,o,a,u,S,_,b,L,h,Y,G,B,f,c,d,C,P,O,s,i,N,V,te,X]}class dn extends ye{constructor(e){super(),we(this,e,A1,N1,he,{class:1,active:0,popup:2,overlayClose:3,btnClose:4,escHide:13,beforeOpen:14,beforeHide:15,show:16,hide:5,isActive:17},null,[-1,-1])}get show(){return this.$$.ctx[16]}get hide(){return this.$$.ctx[5]}get isActive(){return this.$$.ctx[17]}}function Mo(n,e,t){const i=n.slice();return i[12]=e[t],i}const D1=n=>({}),Ro=n=>({uniqueId:n[4]});function Ho(n){let e,t,i=Ee(n[3]),s=[];for(let r=0;r<i.length;r+=1)s[r]=Uo(Mo(n,i,r));const l=r=>j(s[r],1,1,()=>{s[r]=null});return{c(){for(let r=0;r<s.length;r+=1)s[r].c();e=Ne()},m(r,o){for(let a=0;a<s.length;a+=1)s[a]&&s[a].m(r,o);k(r,e,o),t=!0},p(r,o){if(o&8){i=Ee(r[3]);let a;for(a=0;a<i.length;a+=1){const u=Mo(r,i,a);s[a]?(s[a].p(u,o),E(s[a],1)):(s[a]=Uo(u),s[a].c(),E(s[a],1),s[a].m(e.parentNode,e))}for(ae(),a=i.length;a<s.length;a+=1)l(a);ue()}},i(r){if(!t){for(let o=0;o<i.length;o+=1)E(s[o]);t=!0}},o(r){s=s.filter(Boolean);for(let o=0;o<s.length;o+=1)j(s[o]);t=!1},d(r){r&&v(e),tn(s,r)}}}function Uo(n){let e,t,i=Ns(n[12])+"",s,l,r,o;return{c(){e=w("div"),t=w("pre"),s=ee(i),l=I(),p(e,"class","help-block help-block-error")},m(a,u){k(a,e,u),y(e,t),y(t,s),y(e,l),o=!0},p(a,u){(!o||u&8)&&i!==(i=Ns(a[12])+"")&&ke(s,i)},i(a){o||(a&&vt(()=>{o&&(r||(r=ft(e,Ot,{duration:150},!0)),r.run(1))}),o=!0)},o(a){a&&(r||(r=ft(e,Ot,{duration:150},!1)),r.run(0)),o=!1},d(a){a&&v(e),a&&r&&r.end()}}}function M1(n){let e,t,i,s,l,r;const o=n[9].default,a=st(o,n,n[8],Ro);let u=!n[0]&&Ho(n);return{c(){e=w("div"),a&&a.c(),t=I(),u&&u.c(),p(e,"class",n[1]),Z(e,"error",n[3].length)},m(f,c){var d;k(f,e,c),a&&a.m(e,null),y(e,t),u&&u.m(e,null),n[11](e),s=!0,l||(r=[ge(i=Te.call(null,e,{text:n[0]?Ns((d=n[3])==null?void 0:d[0]):""})),H(e,"click",n[10])],l=!0)},p(f,[c]){var d;a&&a.p&&(!s||c&256)&&rt(a,o,f,f[8],s?lt(o,f[8],c,D1):ot(f[8]),Ro),f[0]?u&&(ae(),j(u,1,1,()=>{u=null}),ue()):u?(u.p(f,c),c&1&&E(u,1)):(u=Ho(f),u.c(),E(u,1),u.m(e,null)),(!s||c&2)&&p(e,"class",f[1]),i&&Qe(i.update)&&c&9&&i.update.call(null,{text:f[0]?Ns((d=f[3])==null?void 0:d[0]):""}),(!s||c&10)&&Z(e,"error",f[3].length)},i(f){s||(E(a,f),E(u),s=!0)},o(f){j(a,f),j(u),s=!1},d(f){f&&v(e),a&&a.d(f),u&&u.d(),n[11](null),l=!1,pe(r)}}}const qo="Invalid value";function Ns(n){return n?typeof n=="object"?(n==null?void 0:n.message)||(n==null?void 0:n.code)||qo:n||qo:""}function R1(n,e,t){let i;x(n,Bs,_=>t(7,i=_));let{$$slots:s={},$$scope:l}=e;const r="field_"+J.randomString(7);let{name:o=""}=e,{inlineError:a=!1}=e,{class:u=void 0}=e,f,c=[];function d(){Dh(o)}hn(()=>(f.addEventListener("input",d),f.addEventListener("change",d),()=>{f.removeEventListener("input",d),f.removeEventListener("change",d)}));function m(_){$e.call(this,n,_)}function h(_){le[_?"unshift":"push"](()=>{f=_,t(2,f)})}return n.$$set=_=>{"name"in _&&t(5,o=_.name),"inlineError"in _&&t(0,a=_.inlineError),"class"in _&&t(1,u=_.class),"$$scope"in _&&t(8,l=_.$$scope)},n.$$.update=()=>{n.$$.dirty&160&&t(3,c=J.toArray(J.getNestedVal(i,o)))},[a,u,f,c,r,o,d,i,l,s,m,h]}class Oe extends ye{constructor(e){super(),we(this,e,R1,M1,he,{name:5,inlineError:0,class:1,changed:6})}get changed(){return this.$$.ctx[6]}}function H1(n){let e,t,i,s,l,r,o,a;return{c(){e=w("label"),t=ee("New email"),s=I(),l=w("input"),p(e,"for",i=n[14]),p(l,"type","email"),p(l,"id",r=n[14]),l.autofocus=!0,l.required=!0},m(u,f){k(u,e,f),y(e,t),k(u,s,f),k(u,l,f),_e(l,n[2]),l.focus(),o||(a=H(l,"input",n[7]),o=!0)},p(u,f){f&16384&&i!==(i=u[14])&&p(e,"for",i),f&16384&&r!==(r=u[14])&&p(l,"id",r),f&4&&l.value!==u[2]&&_e(l,u[2])},d(u){u&&(v(e),v(s),v(l)),o=!1,a()}}}function U1(n){let e,t,i,s,l;return t=new Oe({props:{class:"form-field required",name:"newEmail",$$slots:{default:[H1,({uniqueId:r})=>({14:r}),({uniqueId:r})=>r?16384:0]},$$scope:{ctx:n}}}),{c(){e=w("form"),W(t.$$.fragment),p(e,"id",n[4]),p(e,"class","grid grid-sm")},m(r,o){k(r,e,o),$(t,e,null),i=!0,s||(l=H(e,"submit",be(n[5])),s=!0)},p(r,o){const a={};o&49156&&(a.$$scope={dirty:o,ctx:r}),t.$set(a)},i(r){i||(E(t.$$.fragment,r),i=!0)},o(r){j(t.$$.fragment,r),i=!1},d(r){r&&v(e),F(t),s=!1,l()}}}function q1(n){let e;return{c(){e=w("h5"),e.textContent="Change email",p(e,"class","block txt-center")},m(t,i){k(t,e,i)},p:Q,d(t){t&&v(e)}}}function $1(n){let e,t,i,s,l,r,o;return{c(){e=w("button"),t=w("span"),t.textContent="Cancel",i=I(),s=w("button"),l=w("span"),l.textContent="Send confirmation link",p(t,"class","txt"),p(e,"type","button"),p(e,"class","btn btn-transparent m-r-auto"),e.disabled=n[3],p(l,"class","txt"),p(s,"form",n[4]),p(s,"type","submit"),p(s,"class","btn btn-expanded-sm btn-primary"),s.disabled=n[3],Z(s,"btn-loading",n[3])},m(a,u){k(a,e,u),y(e,t),k(a,i,u),k(a,s,u),y(s,l),r||(o=H(e,"click",n[0]),r=!0)},p(a,u){u&8&&(e.disabled=a[3]),u&8&&(s.disabled=a[3]),u&8&&Z(s,"btn-loading",a[3])},d(a){a&&(v(e),v(i),v(s)),r=!1,o()}}}function F1(n){let e,t,i={beforeHide:n[8],popup:!0,class:"overlay-panel-sm",$$slots:{footer:[$1],header:[q1],default:[U1]},$$scope:{ctx:n}};return e=new dn({props:i}),n[9](e),e.$on("show",n[10]),e.$on("hide",n[11]),{c(){W(e.$$.fragment)},m(s,l){$(e,s,l),t=!0},p(s,[l]){const r={};l&8&&(r.beforeHide=s[8]),l&32780&&(r.$$scope={dirty:l,ctx:s}),e.$set(r)},i(s){t||(E(e.$$.fragment,s),t=!0)},o(s){j(e.$$.fragment,s),t=!1},d(s){n[9](null),F(e,s)}}}function W1(n,e,t){const i=tt(),s="email_"+J.randomString(5);let l,r="",o=!1;function a(){return f(),l==null?void 0:l.show()}function u(){return l==null?void 0:l.hide()}function f(){Kt({}),t(2,r="")}async function c(){t(3,o=!0);try{await z.collection("users").requestEmailChange(r),t(3,o=!1),i("submit"),_t(`A confirmation link was sent to ${r}.`),u()}catch(g){g.isAbort||(t(3,o=!1),z.error(g))}}function d(){r=this.value,t(2,r)}const m=()=>!o;function h(g){le[g?"unshift":"push"](()=>{l=g,t(1,l)})}function _(g){$e.call(this,n,g)}function b(g){$e.call(this,n,g)}return[u,l,r,o,s,c,a,d,m,h,_,b]}class V1 extends ye{constructor(e){super(),we(this,e,W1,F1,he,{show:6,hide:0})}get show(){return this.$$.ctx[6]}get hide(){return this.$$.ctx[0]}}function $o(n){let e,t,i;return{c(){e=w("button"),e.innerHTML='<i class="iconoir-xmark txt-sm"></i>',p(e,"type","button"),p(e,"class","btn btn-xs btn-outline btn-circle btn-close svelte-60psra")},m(s,l){k(s,e,l),t||(i=[ge(Te.call(null,e,{position:"right",text:"Remove avatar"})),H(e,"click",Be(be(n[11])))],t=!0)},p:Q,d(s){s&&v(e),t=!1,pe(i)}}}function z1(n){let e,t=n[8]&&$o(n);return{c(){t&&t.c(),e=Ne()},m(i,s){t&&t.m(i,s),k(i,e,s)},p(i,s){i[8]?t?t.p(i,s):(t=$o(i),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},d(i){i&&v(e),t&&t.d(i)}}}function B1(n){let e;return{c(){e=w("i"),p(e,"class","iconoir-media-image-plus")},m(t,i){k(t,e,i)},p:Q,d(t){t&&v(e)}}}function rl(n){var f;let e,t,i,s,l,r,o;t=new ts({props:{class:"thumb-xl "+(n[8]?"":"thumb-handle"),user:n[1],file:(f=n[2])==null?void 0:f[0],fallbackToOAuth2:!1,$$slots:{placeholder:[B1],default:[z1]},$$scope:{ctx:n}}});let a=[{for:i=n[8]?null:n[32]},{class:"inline-flex"}],u={};for(let c=0;c<a.length;c+=1)u=Me(u,a[c]);return{c(){e=w(n[8]?"div":"label"),W(t.$$.fragment),vs(n[8]?"div":"label")(e,u)},m(c,d){k(c,e,d),$(t,e,null),l=!0,r||(o=ge(s=Te.call(null,e,n[8]?null:"Upload avatar")),r=!0)},p(c,d){var h;const m={};d[0]&256&&(m.class="thumb-xl "+(c[8]?"":"thumb-handle")),d[0]&2&&(m.user=c[1]),d[0]&4&&(m.file=(h=c[2])==null?void 0:h[0]),d[0]&256|d[1]&4&&(m.$$scope={dirty:d,ctx:c}),t.$set(m),vs(c[8]?"div":"label")(e,u=gt(a,[(!l||d[0]&256|d[1]&2&&i!==(i=c[8]?null:c[32]))&&{for:i},{class:"inline-flex"}])),s&&Qe(s.update)&&d[0]&256&&s.update.call(null,c[8]?null:"Upload avatar")},i(c){l||(E(t.$$.fragment,c),l=!0)},o(c){j(t.$$.fragment,c),l=!1},d(c){c&&v(e),F(t),r=!1,o()}}}function Z1(n){let e,t,i,s=n[8]?"div":"label",l,r,o,a,u=(n[8]?"div":"label")&&rl(n);return{c(){e=w("input"),i=I(),u&&u.c(),l=Ne(),p(e,"type","file"),p(e,"class","hidden"),p(e,"id",t=n[32])},m(f,c){k(f,e,c),k(f,i,c),u&&u.m(f,c),k(f,l,c),o||(a=H(e,"change",n[19]),o=!0)},p(f,c){(!r||c[1]&2&&t!==(t=f[32]))&&p(e,"id",t),f[8],s?he(s,f[8]?"div":"label")?(u.d(1),u=rl(f),s=f[8]?"div":"label",u.c(),u.m(l.parentNode,l)):u.p(f,c):(u=rl(f),s=f[8]?"div":"label",u.c(),u.m(l.parentNode,l))},i:Q,o(f){j(u,f),r=!1},d(f){f&&(v(e),v(i),v(l)),u&&u.d(f),o=!1,a()}}}function Y1(n){let e,t,i,s,l,r,o,a;return{c(){e=w("label"),t=ee("Full name"),s=I(),l=w("input"),p(e,"for",i=n[32]),p(l,"type","text"),p(l,"id",r=n[32])},m(u,f){k(u,e,f),y(e,t),k(u,s,f),k(u,l,f),_e(l,n[1].name),o||(a=H(l,"input",n[20]),o=!0)},p(u,f){f[1]&2&&i!==(i=u[32])&&p(e,"for",i),f[1]&2&&r!==(r=u[32])&&p(l,"id",r),f[0]&2&&l.value!==u[1].name&&_e(l,u[1].name)},d(u){u&&(v(e),v(s),v(l)),o=!1,a()}}}function K1(n){let e,t,i,s,l,r,o,a;return{c(){e=w("label"),t=ee("Username"),s=I(),l=w("input"),p(e,"for",i=n[32]),p(l,"type","text"),p(l,"id",r=n[32]),l.required=!0},m(u,f){k(u,e,f),y(e,t),k(u,s,f),k(u,l,f),_e(l,n[1].username),o||(a=H(l,"input",n[21]),o=!0)},p(u,f){f[1]&2&&i!==(i=u[32])&&p(e,"for",i),f[1]&2&&r!==(r=u[32])&&p(l,"id",r),f[0]&2&&l.value!==u[1].username&&_e(l,u[1].username)},d(u){u&&(v(e),v(s),v(l)),o=!1,a()}}}function Fo(n){let e,t,i;function s(o,a){return o[1].email?J1:G1}let l=s(n),r=l(n);return{c(){e=w("button"),r.c(),p(e,"type","button"),p(e,"class","btn btn-xs btn-transparent")},m(o,a){k(o,e,a),r.m(e,null),t||(i=H(e,"click",Be(function(){var u,f;Qe((u=n[5])==null?void 0:u.show())&&((f=n[5])==null||f.show().apply(this,arguments))})),t=!0)},p(o,a){n=o,l!==(l=s(n))&&(r.d(1),r=l(n),r&&(r.c(),r.m(e,null)))},d(o){o&&v(e),r.d(),t=!1,i()}}}function G1(n){let e;return{c(){e=ee("Set email")},m(t,i){k(t,e,i)},d(t){t&&v(e)}}}function J1(n){let e;return{c(){e=ee("Change email")},m(t,i){k(t,e,i)},d(t){t&&v(e)}}}function X1(n){var c;let e,t,i,s,l,r,o,a,u,f=((c=n[9])==null?void 0:c.id)==n[1].id&&Fo(n);return{c(){e=w("label"),t=ee("Email"),s=I(),l=w("div"),r=w("input"),u=I(),f&&f.c(),p(e,"for",i=n[32]),p(r,"type","email"),p(r,"id",o=n[32]),r.value=a=n[1].email,r.readOnly=!0,p(l,"class","field-group")},m(d,m){k(d,e,m),y(e,t),k(d,s,m),k(d,l,m),y(l,r),y(l,u),f&&f.m(l,null)},p(d,m){var h;m[1]&2&&i!==(i=d[32])&&p(e,"for",i),m[1]&2&&o!==(o=d[32])&&p(r,"id",o),m[0]&2&&a!==(a=d[1].email)&&r.value!==a&&(r.value=a),((h=d[9])==null?void 0:h.id)==d[1].id?f?f.p(d,m):(f=Fo(d),f.c(),f.m(l,null)):f&&(f.d(1),f=null)},d(d){d&&(v(e),v(s),v(l)),f&&f.d()}}}function Q1(n){let e,t,i,s,l,r,o,a,u,f;return{c(){e=w("input"),i=I(),s=w("label"),l=w("span"),l.textContent="Public visible email",r=I(),o=w("i"),p(e,"type","checkbox"),p(e,"id",t=n[32]),p(l,"class","txt"),p(o,"class","iconoir-info-circle link-hint"),p(s,"for",a=n[32])},m(c,d){k(c,e,d),e.checked=n[1].emailVisibility,k(c,i,d),k(c,s,d),y(s,l),y(s,r),y(s,o),u||(f=[H(e,"change",n[22]),ge(Te.call(null,o,"By default other users can see only your avatar, name and username."))],u=!0)},p(c,d){d[1]&2&&t!==(t=c[32])&&p(e,"id",t),d[0]&2&&(e.checked=c[1].emailVisibility),d[1]&2&&a!==(a=c[32])&&p(s,"for",a)},d(c){c&&(v(e),v(i),v(s)),u=!1,pe(f)}}}function x1(n){let e,t,i,s,l,r,o,a;return{c(){e=w("input"),i=I(),s=w("label"),l=w("span"),l.textContent="Enable email notifications for watched projects",p(e,"type","checkbox"),p(e,"id",t=n[32]),p(l,"class","txt"),p(s,"for",r=n[32])},m(u,f){k(u,e,f),e.checked=n[1].allowEmailNotifications,k(u,i,f),k(u,s,f),y(s,l),o||(a=H(e,"change",n[23]),o=!0)},p(u,f){f[1]&2&&t!==(t=u[32])&&p(e,"id",t),f[0]&2&&(e.checked=u[1].allowEmailNotifications),f[1]&2&&r!==(r=u[32])&&p(s,"for",r)},d(u){u&&(v(e),v(i),v(s)),o=!1,a()}}}function e_(n){let e,t,i,s,l,r,o,a,u,f,c,d,m,h,_;return t=new Oe({props:{class:"avatar-field block txt-center",name:"avatar",$$slots:{default:[Z1,({uniqueId:b})=>({32:b}),({uniqueId:b})=>[0,b?2:0]]},$$scope:{ctx:n}}}),s=new Oe({props:{class:"form-field",name:"name",$$slots:{default:[Y1,({uniqueId:b})=>({32:b}),({uniqueId:b})=>[0,b?2:0]]},$$scope:{ctx:n}}}),r=new Oe({props:{class:"form-field required",name:"username",$$slots:{default:[K1,({uniqueId:b})=>({32:b}),({uniqueId:b})=>[0,b?2:0]]},$$scope:{ctx:n}}}),a=new Oe({props:{class:"form-field",name:"email",$$slots:{default:[X1,({uniqueId:b})=>({32:b}),({uniqueId:b})=>[0,b?2:0]]},$$scope:{ctx:n}}}),f=new Oe({props:{class:"form-field form-field-toggle",name:"emailVisibility",$$slots:{default:[Q1,({uniqueId:b})=>({32:b}),({uniqueId:b})=>[0,b?2:0]]},$$scope:{ctx:n}}}),d=new Oe({props:{class:"form-field form-field-toggle",name:"allowEmailNotifications",$$slots:{default:[x1,({uniqueId:b})=>({32:b}),({uniqueId:b})=>[0,b?2:0]]},$$scope:{ctx:n}}}),{c(){e=w("form"),W(t.$$.fragment),i=I(),W(s.$$.fragment),l=I(),W(r.$$.fragment),o=I(),W(a.$$.fragment),u=I(),W(f.$$.fragment),c=I(),W(d.$$.fragment),p(e,"id",n[10]),p(e,"class","grid grid-sm")},m(b,g){k(b,e,g),$(t,e,null),y(e,i),$(s,e,null),y(e,l),$(r,e,null),y(e,o),$(a,e,null),y(e,u),$(f,e,null),y(e,c),$(d,e,null),m=!0,h||(_=H(e,"submit",be(n[12])),h=!0)},p(b,g){const T={};g[0]&262|g[1]&6&&(T.$$scope={dirty:g,ctx:b}),t.$set(T);const L={};g[0]&2|g[1]&6&&(L.$$scope={dirty:g,ctx:b}),s.$set(L);const O={};g[0]&2|g[1]&6&&(O.$$scope={dirty:g,ctx:b}),r.$set(O);const C={};g[0]&546|g[1]&6&&(C.$$scope={dirty:g,ctx:b}),a.$set(C);const S={};g[0]&2|g[1]&6&&(S.$$scope={dirty:g,ctx:b}),f.$set(S);const P={};g[0]&2|g[1]&6&&(P.$$scope={dirty:g,ctx:b}),d.$set(P)},i(b){m||(E(t.$$.fragment,b),E(s.$$.fragment,b),E(r.$$.fragment,b),E(a.$$.fragment,b),E(f.$$.fragment,b),E(d.$$.fragment,b),m=!0)},o(b){j(t.$$.fragment,b),j(s.$$.fragment,b),j(r.$$.fragment,b),j(a.$$.fragment,b),j(f.$$.fragment,b),j(d.$$.fragment,b),m=!1},d(b){b&&v(e),F(t),F(s),F(r),F(a),F(f),F(d),h=!1,_()}}}function t_(n){let e;return{c(){e=w("h5"),e.textContent="Account settings",p(e,"class","block txt-center")},m(t,i){k(t,e,i)},p:Q,d(t){t&&v(e)}}}function n_(n){let e,t,i,s,l,r,o;return{c(){e=w("div"),e.innerHTML='<i class="iconoir-send"></i> <span class="txt">Password change request</span>',t=I(),i=w("hr"),s=I(),l=w("div"),l.innerHTML='<i class="iconoir-warning-triangle"></i> <span class="txt">Delete account</span>',p(e,"tabindex","0"),p(e,"class","dropdown-item closable"),p(l,"tabindex","0"),p(l,"class","dropdown-item closable link-danger")},m(a,u){k(a,e,u),k(a,t,u),k(a,i,u),k(a,s,u),k(a,l,u),r||(o=[H(e,"click",n[14]),H(l,"click",n[13])],r=!0)},p:Q,d(a){a&&(v(e),v(t),v(i),v(s),v(l)),r=!1,pe(o)}}}function i_(n){let e,t,i,s,l,r,o,a,u,f,c,d,m,h,_,b;return l=new At({props:{class:"dropdown dropdown-upside dropdown-nowrap dropdown-left dropdown-sm",$$slots:{default:[n_]},$$scope:{ctx:n}}}),{c(){e=w("div"),t=w("button"),i=w("i"),s=I(),W(l.$$.fragment),r=I(),o=w("button"),a=w("span"),a.textContent="Cancel",f=I(),c=w("button"),d=w("span"),d.textContent="Save changes",p(i,"class","iconoir-more-horiz txt-lg"),p(t,"type","button"),p(t,"class","btn btn-sm btn-circle btn-transparent"),t.disabled=n[3],p(t,"aria-label","More"),p(e,"class","inline-flex m-r-auto"),p(a,"class","txt"),p(o,"type","button"),p(o,"class","btn btn-transparent"),o.disabled=u=!n[6],p(d,"class","txt"),p(c,"form",n[10]),p(c,"type","submit"),p(c,"class","btn btn-expanded-sm btn-primary"),c.disabled=m=n[3]||!n[6]||!n[7],Z(c,"btn-loading",n[3])},m(g,T){k(g,e,T),y(e,t),y(t,i),y(t,s),$(l,t,null),k(g,r,T),k(g,o,T),y(o,a),k(g,f,T),k(g,c,T),y(c,d),h=!0,_||(b=H(o,"click",n[0]),_=!0)},p(g,T){const L={};T[1]&4&&(L.$$scope={dirty:T,ctx:g}),l.$set(L),(!h||T[0]&8)&&(t.disabled=g[3]),(!h||T[0]&64&&u!==(u=!g[6]))&&(o.disabled=u),(!h||T[0]&200&&m!==(m=g[3]||!g[6]||!g[7]))&&(c.disabled=m),(!h||T[0]&8)&&Z(c,"btn-loading",g[3])},i(g){h||(E(l.$$.fragment,g),h=!0)},o(g){j(l.$$.fragment,g),h=!1},d(g){g&&(v(e),v(r),v(o),v(f),v(c)),F(l),_=!1,b()}}}function s_(n){let e,t,i,s,l={beforeHide:n[24],popup:!0,$$slots:{footer:[i_],header:[t_],default:[e_]},$$scope:{ctx:n}};e=new dn({props:l}),n[25](e),e.$on("show",n[26]),e.$on("hide",n[27]);let r={};return i=new V1({props:r}),n[28](i),{c(){W(e.$$.fragment),t=I(),W(i.$$.fragment)},m(o,a){$(e,o,a),k(o,t,a),$(i,o,a),s=!0},p(o,a){const u={};a[0]&64&&(u.beforeHide=o[24]),a[0]&1006|a[1]&4&&(u.$$scope={dirty:a,ctx:o}),e.$set(u);const f={};i.$set(f)},i(o){s||(E(e.$$.fragment,o),E(i.$$.fragment,o),s=!0)},o(o){j(e.$$.fragment,o),j(i.$$.fragment,o),s=!1},d(o){o&&v(t),n[25](null),F(e,o),n[28](null),F(i,o)}}}function l_(n,e,t){let i,s,l,r;x(n,Xn,U=>t(9,r=U));const o=tt(),a="settings_"+J.randomString(5);let u,f,c={},d=null,m=!1,h=!1,_=!1,b="";function g(U){return L(),t(1,c=structuredClone(U||{})),t(18,b=JSON.stringify(c)),u==null?void 0:u.show()}function T(){return u==null?void 0:u.hide()}function L(){Kt({}),t(2,d=null)}function O(){t(1,c.avatar=null,c),t(2,d=null)}async function C(){t(3,m=!0);try{const U={name:c.name,username:c.username,emailVisibility:c.emailVisibility,allowEmailNotifications:c.allowEmailNotifications,avatar:c.avatar};d!=null&&d.length&&(U.avatar=d[0]),t(1,c=await z.collection("users").update(c.id,U)),t(3,m=!1),o("save",c),_t("Successfully saved account settings."),await St(),T()}catch(U){U.isAbort||(t(3,m=!1),z.error(U))}}function S(){if(!(c!=null&&c.id))return;let U=`Do you really want to delete your Presentator account and all of its related resources?

Note that projects that have more than one owner will not be deleted.`;t(16,h=!0),Lt(U,async()=>P(),()=>{setTimeout(()=>{t(16,h=!1)},0)})}async function P(){if(c!=null&&c.id){t(16,h=!0);try{const U=c.id==(r==null?void 0:r.id);await z.collection("users").delete(c.id),t(16,h=!1),o("delete",c),_t(`Successfully deleted user ${c.username}.`),U&&z.logout()}catch(U){U.isAbort||(z.error(U),t(16,h=!1))}}}async function M(){if(c!=null&&c.email){t(17,_=!0);try{await z.collection("users").requestPasswordReset(c.email),_t(`Successfully sent password change email to ${c.email}.`),t(17,_=!1)}catch(U){U.isAbort||(z.error(U),t(17,_=!1))}}}function A(){d=this.files,t(2,d)}function D(){c.name=this.value,t(1,c)}function R(){c.username=this.value,t(1,c)}function Y(){c.emailVisibility=this.checked,t(1,c)}function G(){c.allowEmailNotifications=this.checked,t(1,c)}const B=()=>l;function N(U){le[U?"unshift":"push"](()=>{u=U,t(4,u)})}function V(U){$e.call(this,n,U)}function te(U){$e.call(this,n,U)}function X(U){le[U?"unshift":"push"](()=>{f=U,t(5,f)})}return n.$$.update=()=>{n.$$.dirty[0]&6&&t(8,i=(c==null?void 0:c.avatar)||(d==null?void 0:d.length)),n.$$.dirty[0]&262150&&t(7,s=(d==null?void 0:d.length)||b!=JSON.stringify(c)),n.$$.dirty[0]&196616&&t(6,l=!m&&!h&&!_)},[T,c,d,m,u,f,l,s,i,r,a,O,C,S,M,g,h,_,b,A,D,R,Y,G,B,N,V,te,X]}class r_ extends ye{constructor(e){super(),we(this,e,l_,s_,he,{show:15,hide:0},null,[-1,-1])}get show(){return this.$$.ctx[15]}get hide(){return this.$$.ctx[0]}}function Wo(n,e,t){const i=n.slice();return i[13]=e[t][0],i[14]=e[t][1],i}const o_=n=>({}),Vo=n=>({}),a_=n=>({}),zo=n=>({});function Bo(n){let e,t,i,s,l,r,o,a,u,f;t=new Xl({props:{class:"app-logo-sm",withText:!1}});const c=n[8]["header-left"],d=st(c,n,n[12],zo),m=n[8]["header-right"],h=st(m,n,n[12],Vo);return o=new E1({}),u=new ts({props:{tabindex:"0",class:"thumb thumb-dark thumb-circle thumb-handle",user:n[6],$$slots:{default:[f_]},$$scope:{ctx:n}}}),{c(){e=w("header"),W(t.$$.fragment),i=I(),d&&d.c(),s=I(),l=w("div"),h&&h.c(),r=I(),W(o.$$.fragment),a=I(),W(u.$$.fragment),p(l,"class","inline-flex flex-gap-sm m-l-auto"),p(e,"class","app-header")},m(_,b){k(_,e,b),$(t,e,null),y(e,i),d&&d.m(e,null),y(e,s),y(e,l),h&&h.m(l,null),y(l,r),$(o,l,null),y(l,a),$(u,l,null),f=!0},p(_,b){d&&d.p&&(!f||b&4096)&&rt(d,c,_,_[12],f?lt(c,_[12],b,a_):ot(_[12]),zo),h&&h.p&&(!f||b&4096)&&rt(h,m,_,_[12],f?lt(m,_[12],b,o_):ot(_[12]),Vo);const g={};b&64&&(g.user=_[6]),b&4192&&(g.$$scope={dirty:b,ctx:_}),u.$set(g)},i(_){f||(E(t.$$.fragment,_),E(d,_),E(h,_),E(o.$$.fragment,_),E(u.$$.fragment,_),f=!0)},o(_){j(t.$$.fragment,_),j(d,_),j(h,_),j(o.$$.fragment,_),j(u.$$.fragment,_),f=!1},d(_){_&&v(e),F(t),d&&d.d(_),h&&h.d(_),F(o),F(u)}}}function u_(n){let e,t,i,s,l,r,o;return{c(){e=w("button"),e.innerHTML='<i class="iconoir-settings"></i> <span class="txt">Settings</span>',t=I(),i=w("hr"),s=I(),l=w("button"),l.innerHTML='<i class="iconoir-log-out"></i> <span class="txt">Logout</span>',p(e,"type","button"),p(e,"class","dropdown-item closable"),p(l,"type","button"),p(l,"class","dropdown-item")},m(a,u){k(a,e,u),k(a,t,u),k(a,i,u),k(a,s,u),k(a,l,u),r||(o=[H(e,"click",Be(n[9])),H(l,"click",n[10])],r=!0)},p:Q,d(a){a&&(v(e),v(t),v(i),v(s),v(l)),r=!1,pe(o)}}}function f_(n){let e,t;return e=new At({props:{class:"dropdown",$$slots:{default:[u_]},$$scope:{ctx:n}}}),{c(){W(e.$$.fragment)},m(i,s){$(e,i,s),t=!0},p(i,s){const l={};s&4192&&(l.$$scope={dirty:s,ctx:i}),e.$set(l)},i(i){t||(E(e.$$.fragment,i),t=!0)},o(i){j(e.$$.fragment,i),t=!1},d(i){F(e,i)}}}function Zo(n){var a;let e,t,i,s,l,r,o=((a=n[7])==null?void 0:a.links)&&Yo(n);return{c(){e=w("footer"),o&&o.c(),t=I(),i=w("a"),s=w("i"),l=I(),r=w("span"),r.textContent="Presentator v3.3.0",p(s,"class","iconoir-github"),p(r,"class","txt"),p(i,"href","https://github.com/presentator/presentator/releases"),p(i,"target","_blank"),p(i,"rel","noopener noreferrer"),p(e,"class","app-footer")},m(u,f){k(u,e,f),o&&o.m(e,null),y(e,t),y(e,i),y(i,s),y(i,l),y(i,r)},p(u,f){var c;(c=u[7])!=null&&c.links?o?o.p(u,f):(o=Yo(u),o.c(),o.m(e,t)):o&&(o.d(1),o=null)},d(u){u&&v(e),o&&o.d()}}}function Yo(n){var s;let e,t=Ee(Object.entries((s=n[7])==null?void 0:s.links)),i=[];for(let l=0;l<t.length;l+=1)i[l]=Ko(Wo(n,t,l));return{c(){for(let l=0;l<i.length;l+=1)i[l].c();e=Ne()},m(l,r){for(let o=0;o<i.length;o+=1)i[o]&&i[o].m(l,r);k(l,e,r)},p(l,r){var o;if(r&128){t=Ee(Object.entries((o=l[7])==null?void 0:o.links));let a;for(a=0;a<t.length;a+=1){const u=Wo(l,t,a);i[a]?i[a].p(u,r):(i[a]=Ko(u),i[a].c(),i[a].m(e.parentNode,e))}for(;a<i.length;a+=1)i[a].d(1);i.length=t.length}},d(l){l&&v(e),tn(i,l)}}}function Ko(n){let e,t=n[13]+"",i,s,l,r;return{c(){e=w("a"),i=ee(t),l=I(),r=w("span"),r.textContent="|",p(e,"href",s=n[14]),p(e,"target","_blank"),p(e,"rel","noopener noreferrer"),p(r,"class","delimiter")},m(o,a){k(o,e,a),y(e,i),k(o,l,a),k(o,r,a)},p(o,a){a&128&&t!==(t=o[13]+"")&&ke(i,t),a&128&&s!==(s=o[14])&&p(e,"href",s)},d(o){o&&(v(e),v(l),v(r))}}}function c_(n){let e,t,i,s,l,r,o,a,u,f,c;document.title=e=J.joinNonEmpty([n[1],"Presentator"]," - ");let d=n[2]&&Bo(n);const m=n[8].default,h=st(m,n,n[12],null);let _=n[3]&&Zo(n),b={};return f=new r_({props:b}),n[11](f),{c(){t=I(),i=w("div"),d&&d.c(),s=I(),l=w("main"),r=w("div"),h&&h.c(),o=I(),_&&_.c(),u=I(),W(f.$$.fragment),p(r,"class","app-content"),p(l,"class","app-body"),p(i,"class",a="app-layout "+n[0]),Z(i,"fullpage",n[4])},m(g,T){k(g,t,T),k(g,i,T),d&&d.m(i,null),y(i,s),y(i,l),y(l,r),h&&h.m(r,null),y(l,o),_&&_.m(l,null),k(g,u,T),$(f,g,T),c=!0},p(g,[T]){(!c||T&2)&&e!==(e=J.joinNonEmpty([g[1],"Presentator"]," - "))&&(document.title=e),g[2]?d?(d.p(g,T),T&4&&E(d,1)):(d=Bo(g),d.c(),E(d,1),d.m(i,s)):d&&(ae(),j(d,1,1,()=>{d=null}),ue()),h&&h.p&&(!c||T&4096)&&rt(h,m,g,g[12],c?lt(m,g[12],T,null):ot(g[12]),null),g[3]?_?_.p(g,T):(_=Zo(g),_.c(),_.m(l,null)):_&&(_.d(1),_=null),(!c||T&1&&a!==(a="app-layout "+g[0]))&&p(i,"class",a),(!c||T&17)&&Z(i,"fullpage",g[4]);const L={};f.$set(L)},i(g){c||(E(d),E(h,g),E(f.$$.fragment,g),c=!0)},o(g){j(d),j(h,g),j(f.$$.fragment,g),c=!1},d(g){g&&(v(t),v(i),v(u)),d&&d.d(),h&&h.d(g),_&&_.d(),n[11](null),F(f,g)}}}function d_(n,e,t){let i,s;x(n,Xn,b=>t(6,i=b)),x(n,wi,b=>t(7,s=b));let{$$slots:l={},$$scope:r}=e,{class:o=""}=e,{title:a=""}=e,{header:u=!0}=e,{footer:f=!0}=e,{fullpage:c=!1}=e,d;const m=()=>d==null?void 0:d.show(i),h=()=>z.logout();function _(b){le[b?"unshift":"push"](()=>{d=b,t(5,d)})}return n.$$set=b=>{"class"in b&&t(0,o=b.class),"title"in b&&t(1,a=b.title),"header"in b&&t(2,u=b.header),"footer"in b&&t(3,f=b.footer),"fullpage"in b&&t(4,c=b.fullpage),"$$scope"in b&&t(12,r=b.$$scope)},[o,a,u,f,c,d,i,s,l,m,h,_,r]}class ji extends ye{constructor(e){super(),we(this,e,d_,c_,he,{class:0,title:1,header:2,footer:3,fullpage:4})}}function Go(n,e,t){const i=n.slice();return i[8]=e[t],i}function p_(n){let e,t,i,s,l;function r(){return n[4](n[8])}function o(){return n[5](n[8])}return{c(){e=w("img"),zn(e.src,t=z.baseURL+"/_/images/oauth2/"+n[8].name+".svg")||p(e,"src",t),p(e,"alt",i=n[8].displayName+" logo"),p(e,"class","svelte-l24196")},m(a,u){k(a,e,u),s||(l=[H(e,"error",r),H(e,"load",o)],s=!0)},p(a,u){n=a,u&1&&!zn(e.src,t=z.baseURL+"/_/images/oauth2/"+n[8].name+".svg")&&p(e,"src",t),u&1&&i!==(i=n[8].displayName+" logo")&&p(e,"alt",i)},d(a){a&&v(e),s=!1,pe(l)}}}function m_(n){let e;return{c(){e=w("i"),p(e,"class","iconoir-fingerprint")},m(t,i){k(t,e,i)},p:Q,d(t){t&&v(e)}}}function Jo(n){let e,t,i,s,l;function r(f,c){return f[1][f[8].name]?m_:p_}let o=r(n),a=o(n);function u(){return n[6](n[8])}return{c(){e=w("button"),a.c(),t=I(),p(e,"type","button"),p(e,"class","auth-provider svelte-l24196")},m(f,c){k(f,e,c),a.m(e,null),y(e,t),s||(l=[ge(i=Te.call(null,e,n[8].displayName)),H(e,"click",u)],s=!0)},p(f,c){n=f,o===(o=r(n))&&a?a.p(n,c):(a.d(1),a=o(n),a&&(a.c(),a.m(e,t))),i&&Qe(i.update)&&c&1&&i.update.call(null,n[8].displayName)},d(f){f&&v(e),a.d(),s=!1,pe(l)}}}function h_(n){let e,t=Ee(n[0]),i=[];for(let s=0;s<t.length;s+=1)i[s]=Jo(Go(n,t,s));return{c(){e=w("nav");for(let s=0;s<i.length;s+=1)i[s].c();p(e,"class","auth-providers-list svelte-l24196")},m(s,l){k(s,e,l);for(let r=0;r<i.length;r+=1)i[r]&&i[r].m(e,null)},p(s,[l]){if(l&7){t=Ee(s[0]);let r;for(r=0;r<t.length;r+=1){const o=Go(s,t,r);i[r]?i[r].p(o,l):(i[r]=Jo(o),i[r].c(),i[r].m(e,null))}for(;r<i.length;r+=1)i[r].d(1);i.length=t.length}},i:Q,o:Q,d(s){s&&v(e),tn(i,s)}}}function __(n,e,t){const i=tt();let{mfaId:s=null}=e,{providers:l=[]}=e,r={};function o(c){z.collection("users").authWithOAuth2({provider:c,mfaId:s,createData:{allowEmailNotifications:!0}}).then(()=>{i("submit",{})}).catch(d=>{var m;d.isAbort||((m=d.response)!=null&&m.mfaId?(t(3,s=d.response.mfaId),addWarningToast("Second authentication factor is required."),i("submit",{mfaId:s})):z.error(d))})}const a=c=>{t(1,r[c.name]=!0,r)},u=c=>{delete r[c.name]},f=c=>o(c.name);return n.$$set=c=>{"mfaId"in c&&t(3,s=c.mfaId),"providers"in c&&t(0,l=c.providers)},[l,r,o,s,a,u,f]}class cd extends ye{constructor(e){super(),we(this,e,__,h_,he,{mfaId:3,providers:0})}}function g_(n){let e,t;return e=new Oe({props:{class:"form-field form-field-lg",name:"email",$$slots:{default:[w_,({uniqueId:i})=>({11:i}),({uniqueId:i})=>i?2048:0]},$$scope:{ctx:n}}}),{c(){W(e.$$.fragment)},m(i,s){$(e,i,s),t=!0},p(i,s){const l={};s&6145&&(l.$$scope={dirty:s,ctx:i}),e.$set(l)},i(i){t||(E(e.$$.fragment,i),t=!0)},o(i){j(e.$$.fragment,i),t=!1},d(i){F(e,i)}}}function b_(n){let e,t,i,s;return i=new Oe({props:{class:"form-field form-field-lg",name:"password",$$slots:{default:[y_,({uniqueId:l})=>({11:l}),({uniqueId:l})=>l?2048:0]},$$scope:{ctx:n}}}),{c(){e=w("p"),e.textContent="Check your email and enter below the received OTP:",t=I(),W(i.$$.fragment),p(e,"class","m-b-sm")},m(l,r){k(l,e,r),k(l,t,r),$(i,l,r),s=!0},p(l,r){const o={};r&6148&&(o.$$scope={dirty:r,ctx:l}),i.$set(o)},i(l){s||(E(i.$$.fragment,l),s=!0)},o(l){j(i.$$.fragment,l),s=!1},d(l){l&&(v(e),v(t)),F(i,l)}}}function w_(n){let e,t,i,s,l,r,o,a,u;return{c(){e=w("div"),t=w("label"),i=w("i"),l=I(),r=w("input"),p(i,"class","iconoir-mail-open"),p(t,"for",s=n[11]),p(t,"class","addon prefix"),r.autofocus=!0,r.required=!0,p(r,"type","email"),p(r,"id",o=n[11]),p(r,"placeholder","Email"),p(e,"class","field-group")},m(f,c){k(f,e,c),y(e,t),y(t,i),y(e,l),y(e,r),_e(r,n[0]),r.focus(),a||(u=[ge(Te.call(null,t,{position:"left",text:"Email"})),H(r,"input",n[7])],a=!0)},p(f,c){c&2048&&s!==(s=f[11])&&p(t,"for",s),c&2048&&o!==(o=f[11])&&p(r,"id",o),c&1&&r.value!==f[0]&&_e(r,f[0])},d(f){f&&v(e),a=!1,pe(u)}}}function y_(n){let e,t,i,s,l,r,o,a,u;return{c(){e=w("div"),t=w("label"),i=w("i"),l=I(),r=w("input"),p(i,"class","iconoir-lock"),p(t,"for",s=n[11]),p(t,"class","addon prefix"),r.autofocus=!0,r.required=!0,p(r,"type","password"),p(r,"id",o=n[11]),p(r,"placeholder","OTP"),p(e,"class","field-group")},m(f,c){k(f,e,c),y(e,t),y(t,i),y(e,l),y(e,r),_e(r,n[2]),r.focus(),a||(u=[ge(Te.call(null,t,{position:"left",text:"Email"})),H(r,"input",n[6])],a=!0)},p(f,c){c&2048&&s!==(s=f[11])&&p(t,"for",s),c&2048&&o!==(o=f[11])&&p(r,"id",o),c&4&&r.value!==f[2]&&_e(r,f[2])},d(f){f&&v(e),a=!1,pe(u)}}}function v_(n){let e,t,i;return{c(){e=w("span"),e.textContent="Login",t=I(),i=w("i"),p(e,"class","txt"),p(i,"class","iconoir-arrow-right")},m(s,l){k(s,e,l),k(s,t,l),k(s,i,l)},d(s){s&&(v(e),v(t),v(i))}}}function k_(n){let e,t,i;return{c(){e=w("i"),t=I(),i=w("span"),i.textContent="Send OTP",p(e,"class","iconoir-send-mail"),p(i,"class","txt")},m(s,l){k(s,e,l),k(s,t,l),k(s,i,l)},d(s){s&&(v(e),v(t),v(i))}}}function S_(n){let e,t,i,s,l,r,o,a;const u=[b_,g_],f=[];function c(_,b){return _[1]?0:1}t=c(n),i=f[t]=u[t](n);function d(_,b){return _[1]?v_:k_}let m=d(n),h=m(n);return{c(){e=w("form"),i.c(),s=I(),l=w("button"),h.c(),p(l,"type","submit"),p(l,"class","btn btn-block btn-lg btn-primary btn-next"),Z(l,"btn-disabled",n[3]),Z(l,"btn-loading",n[3])},m(_,b){k(_,e,b),f[t].m(e,null),y(e,s),y(e,l),h.m(l,null),r=!0,o||(a=H(e,"submit",be(n[4])),o=!0)},p(_,[b]){let g=t;t=c(_),t===g?f[t].p(_,b):(ae(),j(f[g],1,1,()=>{f[g]=null}),ue(),i=f[t],i?i.p(_,b):(i=f[t]=u[t](_),i.c()),E(i,1),i.m(e,s)),m!==(m=d(_))&&(h.d(1),h=m(_),h&&(h.c(),h.m(l,null))),(!r||b&8)&&Z(l,"btn-disabled",_[3]),(!r||b&8)&&Z(l,"btn-loading",_[3])},i(_){r||(E(i),r=!0)},o(_){j(i),r=!1},d(_){_&&v(e),f[t].d(),h.d(),o=!1,a()}}}function T_(n,e,t){const i=tt();let{mfaId:s=null}=e,{email:l=""}=e,r="",o="",a=!1;async function u(){a||(t(3,a=!0),r?await c():await f(),t(3,a=!1))}async function f(){t(1,r="");try{const h=await z.collection("users").requestOTP(l);t(1,r=h.otpId),Ki()}catch(h){z.error(h)}}async function c(){var h;try{await z.collection("users").authWithOTP(r,o,{mfaId:s}),i("submit",{})}catch(_){(h=_==null?void 0:_.response)!=null&&h.mfaId?(t(5,s=_.response.mfaId),Kl("Second authentication factor is required."),i("submit",{mfaId:s})):z.error(_)}}function d(){o=this.value,t(2,o)}function m(){l=this.value,t(0,l)}return n.$$set=h=>{"mfaId"in h&&t(5,s=h.mfaId),"email"in h&&t(0,l=h.email)},[l,r,o,a,u,s,d,m]}class O_ extends ye{constructor(e){super(),we(this,e,T_,S_,he,{mfaId:5,email:0})}}function C_(n){let e,t,i,s,l,r,o,a,u,f;return{c(){e=w("div"),t=w("label"),i=w("i"),r=I(),o=w("input"),p(i,"class","iconoir-user"),p(t,"for",s=n[10]),p(t,"class","addon prefix"),o.autofocus=!0,o.required=!0,p(o,"type","text"),p(o,"id",a=n[10]),p(o,"placeholder",n[2]),p(e,"class","field-group")},m(c,d){k(c,e,d),y(e,t),y(t,i),y(e,r),y(e,o),_e(o,n[0]),o.focus(),u||(f=[ge(l=Te.call(null,t,{position:"left",text:n[2]})),H(o,"input",n[7])],u=!0)},p(c,d){d&1024&&s!==(s=c[10])&&p(t,"for",s),l&&Qe(l.update)&&d&4&&l.update.call(null,{position:"left",text:c[2]}),d&1024&&a!==(a=c[10])&&p(o,"id",a),d&4&&p(o,"placeholder",c[2]),d&1&&o.value!==c[0]&&_e(o,c[0])},d(c){c&&v(e),u=!1,pe(f)}}}function E_(n){let e,t,i,s,l,r,o,a,u,f,c;return{c(){e=w("div"),t=w("label"),i=w("i"),l=I(),r=w("input"),a=I(),u=w("a"),u.textContent="Forgotten password?",p(i,"class","iconoir-lock"),p(t,"for",s=n[10]),p(t,"class","addon prefix"),r.required=!0,p(r,"type","password"),p(r,"id",o=n[10]),p(r,"placeholder","Password"),p(e,"class","field-group m-b-10"),p(u,"href","/forgotten-password"),p(u,"class","link-primary txt-sm")},m(d,m){k(d,e,m),y(e,t),y(t,i),y(e,l),y(e,r),_e(r,n[1]),k(d,a,m),k(d,u,m),f||(c=[ge(Te.call(null,t,{position:"left",text:"Password"})),H(r,"input",n[8]),ge(Si.call(null,u))],f=!0)},p(d,m){m&1024&&s!==(s=d[10])&&p(t,"for",s),m&1024&&o!==(o=d[10])&&p(r,"id",o),m&2&&r.value!==d[1]&&_e(r,d[1])},d(d){d&&(v(e),v(a),v(u)),f=!1,pe(c)}}}function L_(n){let e,t,i,s,l,r,o,a,u;return t=new Oe({props:{class:"form-field form-field-lg",name:"identity",$$slots:{default:[C_,({uniqueId:f})=>({10:f}),({uniqueId:f})=>f?1024:0]},$$scope:{ctx:n}}}),s=new Oe({props:{class:"form-field form-field-lg",name:"password",$$slots:{default:[E_,({uniqueId:f})=>({10:f}),({uniqueId:f})=>f?1024:0]},$$scope:{ctx:n}}}),{c(){e=w("form"),W(t.$$.fragment),i=I(),W(s.$$.fragment),l=I(),r=w("button"),r.innerHTML='<span class="txt">Login</span> <i class="iconoir-arrow-right"></i>',p(r,"type","submit"),p(r,"class","btn btn-block btn-lg btn-primary btn-next"),Z(r,"btn-disabled",n[3]),Z(r,"btn-loading",n[3])},m(f,c){k(f,e,c),$(t,e,null),y(e,i),$(s,e,null),y(e,l),y(e,r),o=!0,a||(u=H(e,"submit",be(n[4])),a=!0)},p(f,[c]){const d={};c&3077&&(d.$$scope={dirty:c,ctx:f}),t.$set(d);const m={};c&3074&&(m.$$scope={dirty:c,ctx:f}),s.$set(m),(!o||c&8)&&Z(r,"btn-disabled",f[3]),(!o||c&8)&&Z(r,"btn-loading",f[3])},i(f){o||(E(t.$$.fragment,f),E(s.$$.fragment,f),o=!0)},o(f){j(t.$$.fragment,f),j(s.$$.fragment,f),o=!1},d(f){f&&v(e),F(t),F(s),a=!1,u()}}}function I_(n,e,t){const i=tt();let{identityFields:s=[]}=e,{mfaId:l=null}=e,{identity:r=""}=e,{password:o=""}=e,a="",u=!1;async function f(){var m;if(!u){t(3,u=!0);try{await z.collection("users").authWithPassword(r,o,{mfaId:l}),Ki(),i("submit",{})}catch(h){(m=h==null?void 0:h.response)!=null&&m.mfaId?(t(5,l=h.response.mfaId),Kl("Second authentication factor is required."),i("submit",{mfaId:l})):Yl("Invalid login credentials or unverified user.")}t(3,u=!1)}}function c(){r=this.value,t(0,r)}function d(){o=this.value,t(1,o)}return n.$$set=m=>{"identityFields"in m&&t(6,s=m.identityFields),"mfaId"in m&&t(5,l=m.mfaId),"identity"in m&&t(0,r=m.identity),"password"in m&&t(1,o=m.password)},n.$$.update=()=>{n.$$.dirty&64&&t(2,a=J.sentenize((s==null?void 0:s.join(" or "))||"",!1))},[r,o,a,u,f,l,s,c,d]}class j_ extends ye{constructor(e){super(),we(this,e,I_,L_,he,{identityFields:6,mfaId:5,identity:0,password:1})}}function P_(n){let e,t,i,s=n[7]&&!n[1].includes("oaut2"),l,r=n[2]&&Xo(n),o=n[6]&&Qo(n),a=s&&xo(n);return{c(){e=w("div"),r&&r.c(),t=I(),o&&o.c(),i=I(),a&&a.c(),p(e,"class","panel-content")},m(u,f){k(u,e,f),r&&r.m(e,null),y(e,t),o&&o.m(e,null),y(e,i),a&&a.m(e,null),l=!0},p(u,f){u[2]?r?(r.p(u,f),f&4&&E(r,1)):(r=Xo(u),r.c(),E(r,1),r.m(e,t)):r&&(ae(),j(r,1,1,()=>{r=null}),ue()),u[6]?o?(o.p(u,f),f&64&&E(o,1)):(o=Qo(u),o.c(),E(o,1),o.m(e,i)):o&&(ae(),j(o,1,1,()=>{o=null}),ue()),f&130&&(s=u[7]&&!u[1].includes("oaut2")),s?a?(a.p(u,f),f&130&&E(a,1)):(a=xo(u),a.c(),E(a,1),a.m(e,null)):a&&(ae(),j(a,1,1,()=>{a=null}),ue())},i(u){l||(E(r),E(o),E(a),l=!0)},o(u){j(r),j(o),j(a),l=!1},d(u){u&&v(e),r&&r.d(),o&&o.d(),a&&a.d()}}}function N_(n){let e;return{c(){e=w("span"),p(e,"class","loader")},m(t,i){k(t,e,i)},p:Q,i:Q,o:Q,d(t){t&&v(e)}}}function Xo(n){let e,t,i,s;function l(a){n[11](a)}function r(a){n[12](a)}let o={identityFields:n[0].password.identityFields};return n[4]!==void 0&&(o.mfaId=n[4]),n[5]!==void 0&&(o.identity=n[5]),e=new j_({props:o}),le.push(()=>Pe(e,"mfaId",l)),le.push(()=>Pe(e,"identity",r)),e.$on("submit",n[13]),{c(){W(e.$$.fragment)},m(a,u){$(e,a,u),s=!0},p(a,u){const f={};u&1&&(f.identityFields=a[0].password.identityFields),!t&&u&16&&(t=!0,f.mfaId=a[4],je(()=>t=!1)),!i&&u&32&&(i=!0,f.identity=a[5],je(()=>i=!1)),e.$set(f)},i(a){s||(E(e.$$.fragment,a),s=!0)},o(a){j(e.$$.fragment,a),s=!1},d(a){F(e,a)}}}function Qo(n){let e,t,i;function s(r){n[14](r)}let l={email:n[5].includes("@")?n[5]:""};return n[4]!==void 0&&(l.mfaId=n[4]),e=new O_({props:l}),le.push(()=>Pe(e,"mfaId",s)),e.$on("submit",n[15]),{c(){W(e.$$.fragment)},m(r,o){$(e,r,o),i=!0},p(r,o){const a={};o&32&&(a.email=r[5].includes("@")?r[5]:""),!t&&o&16&&(t=!0,a.mfaId=r[4],je(()=>t=!1)),e.$set(a)},i(r){i||(E(e.$$.fragment,r),i=!0)},o(r){j(e.$$.fragment,r),i=!1},d(r){F(e,r)}}}function xo(n){let e,t,i,s;function l(f,c){return f[2]||f[6]?D_:A_}let r=l(n),o=r(n);function a(f){n[16](f)}let u={providers:n[0].oauth2.providers};return n[4]!==void 0&&(u.mfaId=n[4]),t=new cd({props:u}),le.push(()=>Pe(t,"mfaId",a)),t.$on("submit",n[17]),{c(){o.c(),e=I(),W(t.$$.fragment)},m(f,c){o.m(f,c),k(f,e,c),$(t,f,c),s=!0},p(f,c){r!==(r=l(f))&&(o.d(1),o=r(f),o&&(o.c(),o.m(e.parentNode,e)));const d={};c&1&&(d.providers=f[0].oauth2.providers),!i&&c&16&&(i=!0,d.mfaId=f[4],je(()=>i=!1)),t.$set(d)},i(f){s||(E(t.$$.fragment,f),s=!0)},o(f){j(t.$$.fragment,f),s=!1},d(f){f&&v(e),o.d(f),F(t,f)}}}function A_(n){let e;return{c(){e=w("p"),e.textContent="Sign in with",p(e,"class","m-b-sm")},m(t,i){k(t,e,i)},d(t){t&&v(e)}}}function D_(n){let e;return{c(){e=w("p"),e.textContent="Or sign in with",p(e,"class","m-t-base m-b-sm")},m(t,i){k(t,e,i)},d(t){t&&v(e)}}}function M_(n){let e,t,i,s,l,r,o,a,u,f,c,d,m,h,_;i=new Xl({});const b=[N_,P_],g=[];function T(L,O){return L[3]?0:1}return a=T(n),u=g[a]=b[a](n),{c(){e=w("div"),t=w("header"),W(i.$$.fragment),s=I(),l=w("div"),r=w("h4"),r.textContent=`${dd}`,o=I(),u.c(),f=I(),c=w("div"),d=w("a"),d.innerHTML="Don&#39;t have an account yet? <strong>Register!</strong>",p(t,"class","block txt-center m-b-base"),p(r,"class","m-b-base"),p(l,"class","panel txt-center"),p(d,"href","/register"),p(d,"class","fade"),p(c,"class","block txt-center m-t-base"),p(e,"class","wrapper wrapper-sm m-b-base entrance-top")},m(L,O){k(L,e,O),y(e,t),$(i,t,null),y(e,s),y(e,l),y(l,r),y(l,o),g[a].m(l,null),y(e,f),y(e,c),y(c,d),m=!0,h||(_=ge(Si.call(null,d)),h=!0)},p(L,O){let C=a;a=T(L),a===C?g[a].p(L,O):(ae(),j(g[C],1,1,()=>{g[C]=null}),ue(),u=g[a],u?u.p(L,O):(u=g[a]=b[a](L),u.c()),E(u,1),u.m(l,null))},i(L){m||(E(i.$$.fragment,L),E(u),m=!0)},o(L){j(i.$$.fragment,L),j(u),m=!1},d(L){L&&v(e),F(i),g[a].d(),h=!1,_()}}}function R_(n){let e,t;return e=new ji({props:{fullpage:!0,header:!1,title:dd,$$slots:{default:[M_]},$$scope:{ctx:n}}}),{c(){W(e.$$.fragment)},m(i,s){$(e,i,s),t=!0},p(i,[s]){const l={};s&524543&&(l.$$scope={dirty:s,ctx:i}),e.$set(l)},i(i){t||(E(e.$$.fragment,i),t=!0)},o(i){j(e.$$.fragment,i),t=!1},d(i){F(e,i)}}}const dd="Login";function H_(n,e,t){let i,s,l,r,o,a={},u=!1,f=null,c="",d=[];m();async function m(){t(3,u=!0);try{t(0,a=await z.collection("users").listAuthMethods()),t(3,u=!1)}catch(S){S!=null&&S.isAbort&&(z.error(S),t(3,u=!1))}}function h(S,P){d.push(S),t(1,d),P||(Ki(),z.replaceWithRemembered())}function _(S){f=S,t(4,f)}function b(S){c=S,t(5,c)}const g=S=>{var P;return h("passwordAuth",(P=S.detail)==null?void 0:P.mfaId)};function T(S){f=S,t(4,f)}const L=S=>{var P;return h("otp",(P=S.detail)==null?void 0:P.mfaId)};function O(S){f=S,t(4,f)}const C=S=>{var P;return h("oauth2",(P=S.detail)==null?void 0:P.mfaId)};return n.$$.update=()=>{var S,P,M,A,D;n.$$.dirty&1&&t(7,i=((S=a.oauth2)==null?void 0:S.enabled)&&((M=(P=a.oauth2)==null?void 0:P.providers)==null?void 0:M.length)),n.$$.dirty&1&&t(9,s=(A=a.otp)==null?void 0:A.enabled),n.$$.dirty&1&&t(10,l=(D=a.password)==null?void 0:D.enabled),n.$$.dirty&1026&&t(2,r=l&&!d.includes("passwordAuth")),n.$$.dirty&518&&t(6,o=!r&&s&&!d.includes("otp"))},[a,d,r,u,f,c,o,i,h,s,l,_,b,g,T,L,O,C]}class U_ extends ye{constructor(e){super(),we(this,e,H_,R_,he,{})}}function q_(n){let e,t,i,s=n[10]&&ea(n),l=n[9]&&ta(n);return{c(){e=w("div"),s&&s.c(),t=I(),l&&l.c(),p(e,"class","panel-content")},m(r,o){k(r,e,o),s&&s.m(e,null),y(e,t),l&&l.m(e,null),i=!0},p(r,o){r[10]?s?(s.p(r,o),o&1024&&E(s,1)):(s=ea(r),s.c(),E(s,1),s.m(e,t)):s&&(ae(),j(s,1,1,()=>{s=null}),ue()),r[9]?l?(l.p(r,o),o&512&&E(l,1)):(l=ta(r),l.c(),E(l,1),l.m(e,null)):l&&(ae(),j(l,1,1,()=>{l=null}),ue())},i(r){i||(E(s),E(l),i=!0)},o(r){j(s),j(l),i=!1},d(r){r&&v(e),s&&s.d(),l&&l.d()}}}function $_(n){let e;return{c(){e=w("span"),p(e,"class","loader")},m(t,i){k(t,e,i)},p:Q,i:Q,o:Q,d(t){t&&v(e)}}}function F_(n){let e,t,i,s,l,r,o,a;return{c(){e=w("div"),t=w("div"),i=w("p"),s=ee(`Go check your email to verify your account:
                            `),l=w("br"),r=I(),o=w("strong"),a=ee(n[0]),p(t,"class","content txt-center"),p(e,"class","alert m-0")},m(u,f){k(u,e,f),y(e,t),y(t,i),y(i,s),y(i,l),y(i,r),y(i,o),y(o,a)},p(u,f){f&1&&ke(a,u[0])},i:Q,o:Q,d(u){u&&v(e)}}}function ea(n){let e,t,i,s,l,r,o,a,u,f,c,d,m,h,_,b;return e=new Oe({props:{class:"form-field form-field-lg",name:"email",$$slots:{default:[W_,({uniqueId:g})=>({22:g}),({uniqueId:g})=>g?4194304:0]},$$scope:{ctx:n}}}),i=new Oe({props:{class:"form-field form-field-lg",name:"username",$$slots:{default:[V_,({uniqueId:g})=>({22:g}),({uniqueId:g})=>g?4194304:0]},$$scope:{ctx:n}}}),l=new Oe({props:{class:"form-field form-field-lg",name:"password",$$slots:{default:[z_,({uniqueId:g})=>({22:g}),({uniqueId:g})=>g?4194304:0]},$$scope:{ctx:n}}}),o=new Oe({props:{class:"form-field form-field-lg",name:"passwordConfirm",$$slots:{default:[B_,({uniqueId:g})=>({22:g}),({uniqueId:g})=>g?4194304:0]},$$scope:{ctx:n}}}),{c(){W(e.$$.fragment),t=I(),W(i.$$.fragment),s=I(),W(l.$$.fragment),r=I(),W(o.$$.fragment),a=I(),u=w("button"),u.innerHTML='<span class="txt">Register</span> <i class="iconoir-arrow-right"></i>',f=I(),c=w("p"),d=ee(`By registering you agree with our
                            `),m=w("a"),h=ee("Terms and Privacy policy"),p(u,"type","submit"),p(u,"class","btn btn-block btn-lg btn-primary btn-next"),Z(u,"btn-disabled",n[6]),Z(u,"btn-loading",n[6]),p(m,"href",_=n[11].termsURL),p(m,"target","_blank"),p(m,"rel","noreferrer noopener"),p(c,"class","m-t-xs m-b-sm txt-sm txt-hint")},m(g,T){$(e,g,T),k(g,t,T),$(i,g,T),k(g,s,T),$(l,g,T),k(g,r,T),$(o,g,T),k(g,a,T),k(g,u,T),k(g,f,T),k(g,c,T),y(c,d),y(c,m),y(m,h),b=!0},p(g,T){const L={};T&12582913&&(L.$$scope={dirty:T,ctx:g}),e.$set(L);const O={};T&12582924&&(O.$$scope={dirty:T,ctx:g}),i.$set(O);const C={};T&12582928&&(C.$$scope={dirty:T,ctx:g}),l.$set(C);const S={};T&12582944&&(S.$$scope={dirty:T,ctx:g}),o.$set(S),(!b||T&64)&&Z(u,"btn-disabled",g[6]),(!b||T&64)&&Z(u,"btn-loading",g[6]),(!b||T&2048&&_!==(_=g[11].termsURL))&&p(m,"href",_)},i(g){b||(E(e.$$.fragment,g),E(i.$$.fragment,g),E(l.$$.fragment,g),E(o.$$.fragment,g),b=!0)},o(g){j(e.$$.fragment,g),j(i.$$.fragment,g),j(l.$$.fragment,g),j(o.$$.fragment,g),b=!1},d(g){g&&(v(t),v(s),v(r),v(a),v(u),v(f),v(c)),F(e,g),F(i,g),F(l,g),F(o,g)}}}function W_(n){let e,t,i,s,l,r,o,a,u;return{c(){e=w("div"),t=w("label"),i=w("i"),l=I(),r=w("input"),p(i,"class","iconoir-mail"),p(t,"for",s=n[22]),p(t,"class","addon prefix"),r.autofocus=!0,p(r,"type","email"),p(r,"id",o=n[22]),p(r,"name","register_email"),p(r,"placeholder","Email"),p(e,"class","field-group")},m(f,c){k(f,e,c),y(e,t),y(t,i),y(e,l),y(e,r),_e(r,n[0]),r.focus(),a||(u=[ge(Te.call(null,t,{position:"left",text:"Email"})),H(r,"input",n[14])],a=!0)},p(f,c){c&4194304&&s!==(s=f[22])&&p(t,"for",s),c&4194304&&o!==(o=f[22])&&p(r,"id",o),c&1&&r.value!==f[0]&&_e(r,f[0])},d(f){f&&v(e),a=!1,pe(u)}}}function V_(n){let e,t,i,s,l,r,o,a,u;return{c(){e=w("div"),t=w("label"),i=w("i"),l=I(),r=w("input"),p(i,"class","iconoir-user"),p(t,"for",s=n[22]),p(t,"class","addon prefix"),p(r,"type","text"),p(r,"id",o=n[22]),p(r,"name","register_username"),p(r,"placeholder","Username"),p(e,"class","field-group")},m(f,c){k(f,e,c),y(e,t),y(t,i),y(e,l),y(e,r),_e(r,n[3]),a||(u=[ge(Te.call(null,t,{position:"left",text:"Username"})),H(r,"input",n[15]),H(r,"input",n[16])],a=!0)},p(f,c){c&4194304&&s!==(s=f[22])&&p(t,"for",s),c&4194304&&o!==(o=f[22])&&p(r,"id",o),c&8&&r.value!==f[3]&&_e(r,f[3])},d(f){f&&v(e),a=!1,pe(u)}}}function z_(n){let e,t,i,s,l,r,o,a,u;return{c(){e=w("div"),t=w("label"),i=w("i"),l=I(),r=w("input"),p(i,"class","iconoir-lock"),p(t,"for",s=n[22]),p(t,"class","addon prefix"),r.required=!0,p(r,"type","password"),p(r,"id",o=n[22]),p(r,"name","register_password"),p(r,"placeholder","Password"),p(e,"class","field-group")},m(f,c){k(f,e,c),y(e,t),y(t,i),y(e,l),y(e,r),_e(r,n[4]),a||(u=[ge(Te.call(null,t,{position:"left",text:"Password"})),H(r,"input",n[17])],a=!0)},p(f,c){c&4194304&&s!==(s=f[22])&&p(t,"for",s),c&4194304&&o!==(o=f[22])&&p(r,"id",o),c&16&&r.value!==f[4]&&_e(r,f[4])},d(f){f&&v(e),a=!1,pe(u)}}}function B_(n){let e,t,i,s,l,r,o,a,u;return{c(){e=w("div"),t=w("label"),i=w("i"),l=I(),r=w("input"),p(i,"class","iconoir-lock"),p(t,"for",s=n[22]),p(t,"class","addon prefix"),r.required=!0,p(r,"type","password"),p(r,"id",o=n[22]),p(r,"name","register_passwordConfirm"),p(r,"placeholder","Password confirm"),p(r,"autocomplete","new-password"),p(e,"class","field-group")},m(f,c){k(f,e,c),y(e,t),y(t,i),y(e,l),y(e,r),_e(r,n[5]),a||(u=[ge(Te.call(null,t,{position:"left",text:"Password confirm"})),H(r,"input",n[18])],a=!0)},p(f,c){c&4194304&&s!==(s=f[22])&&p(t,"for",s),c&4194304&&o!==(o=f[22])&&p(r,"id",o),c&32&&r.value!==f[5]&&_e(r,f[5])},d(f){f&&v(e),a=!1,pe(u)}}}function ta(n){let e,t,i;function s(o,a){return o[10]?Y_:Z_}let l=s(n),r=l(n);return t=new cd({props:{providers:n[1].oauth2.providers}}),t.$on("submit",n[19]),{c(){r.c(),e=I(),W(t.$$.fragment)},m(o,a){r.m(o,a),k(o,e,a),$(t,o,a),i=!0},p(o,a){l!==(l=s(o))&&(r.d(1),r=l(o),r&&(r.c(),r.m(e.parentNode,e)));const u={};a&2&&(u.providers=o[1].oauth2.providers),t.$set(u)},i(o){i||(E(t.$$.fragment,o),i=!0)},o(o){j(t.$$.fragment,o),i=!1},d(o){o&&v(e),r.d(o),F(t,o)}}}function Z_(n){let e;return{c(){e=w("p"),e.textContent="Sign up with",p(e,"class","m-b-sm")},m(t,i){k(t,e,i)},d(t){t&&v(e)}}}function Y_(n){let e;return{c(){e=w("p"),e.textContent="Or sign up with",p(e,"class","m-t-base m-b-sm")},m(t,i){k(t,e,i)},d(t){t&&v(e)}}}function K_(n){let e,t,i,s,l,r,o,a,u,f,c,d,m,h,_;i=new Xl({});const b=[F_,$_,q_],g=[];function T(L,O){return L[8]?0:L[7]?1:2}return a=T(n),u=g[a]=b[a](n),{c(){e=w("div"),t=w("header"),W(i.$$.fragment),s=I(),l=w("form"),r=w("h4"),r.textContent=`${pd}`,o=I(),u.c(),f=I(),c=w("div"),d=w("a"),d.innerHTML="Already have an account? <strong>Login!</strong>",p(t,"class","block txt-center m-b-base"),p(r,"class","m-b-base"),p(l,"class","panel txt-center"),p(l,"autocomplete","off"),p(d,"href","/login"),p(d,"class","fade"),p(c,"class","block txt-center m-t-base"),p(e,"class","wrapper wrapper-sm m-b-base entrance-top")},m(L,O){k(L,e,O),y(e,t),$(i,t,null),y(e,s),y(e,l),y(l,r),y(l,o),g[a].m(l,null),y(e,f),y(e,c),y(c,d),m=!0,h||(_=[H(l,"submit",be(n[12])),ge(Si.call(null,d))],h=!0)},p(L,O){let C=a;a=T(L),a===C?g[a].p(L,O):(ae(),j(g[C],1,1,()=>{g[C]=null}),ue(),u=g[a],u?u.p(L,O):(u=g[a]=b[a](L),u.c()),E(u,1),u.m(l,null))},i(L){m||(E(i.$$.fragment,L),E(u),m=!0)},o(L){j(i.$$.fragment,L),j(u),m=!1},d(L){L&&v(e),F(i),g[a].d(),h=!1,pe(_)}}}function G_(n){let e,t;return e=new ji({props:{fullpage:!0,header:!1,title:pd,$$slots:{default:[K_]},$$scope:{ctx:n}}}),{c(){W(e.$$.fragment)},m(i,s){$(e,i,s),t=!0},p(i,[s]){const l={};s&8392703&&(l.$$scope={dirty:s,ctx:i}),e.$set(l)},i(i){t||(E(e.$$.fragment,i),t=!0)},o(i){j(e.$$.fragment,i),t=!1},d(i){F(e,i)}}}const pd="Register";function J_(n,e,t){let i,s,l,r;x(n,wi,M=>t(11,r=M));let o="",a="",u="",f="",c=!1,d={},m=!1,h=!1,_=!1;b();async function b(){t(7,m=!0);try{t(1,d=await z.collection("users").listAuthMethods())}catch(M){z.error(M)}t(7,m=!1)}async function g(){if(!c){t(6,c=!0);try{await z.collection("users").create({email:o,username:a,password:u,passwordConfirm:f,allowEmailNotifications:!0}),Ki(),o&&await z.collection("users").requestVerification(o),t(8,h=!0)}catch(M){z.error(M)}t(6,c=!1)}}function T(){o=this.value,t(0,o)}const L=()=>{t(2,_=!0)};function O(){a=this.value,t(3,a),t(2,_),t(13,l),t(0,o)}function C(){u=this.value,t(4,u)}function S(){f=this.value,t(5,f)}const P=M=>{var A;(A=M.detail)!=null&&A.mfaId?Bt("/login"):(Ki(),z.replaceWithRemembered())};return n.$$.update=()=>{var M,A,D,R,Y,G;n.$$.dirty&2&&((M=d.mfa)==null||M.enabled),n.$$.dirty&2&&t(10,i=(A=d.password)==null?void 0:A.enabled),n.$$.dirty&2&&t(9,s=((D=d.oauth2)==null?void 0:D.enabled)&&((Y=(R=d.oauth2)==null?void 0:R.providers)==null?void 0:Y.length)),n.$$.dirty&1&&t(13,l=((G=o.split("@"))==null?void 0:G[0])||""),n.$$.dirty&8196&&(_||t(3,a=l))},[o,d,_,a,u,f,c,m,h,s,i,r,g,l,T,L,O,C,S,P]}class X_ extends ye{constructor(e){super(),we(this,e,J_,G_,he,{})}}const Q_=n=>({isEmpty:n&32}),na=n=>({isEmpty:n[5]}),x_=n=>({isEmpty:n&32}),ia=n=>({isEmpty:n[5]});function sa(n){let e,t,i,s,l,r,o;return{c(){e=w("button"),t=w("span"),t.textContent="Clear",p(t,"class","txt"),p(e,"type","button"),p(e,"class",i="btn btn-warning btn-"+(n[7][n[3]]||"sm")+" btn-expanded-"+(n[7][n[3]]||"sm"))},m(a,u){k(a,e,u),y(e,t),l=!0,r||(o=H(e,"click",Be(n[9])),r=!0)},p(a,u){(!l||u&8&&i!==(i="btn btn-warning btn-"+(a[7][a[3]]||"sm")+" btn-expanded-"+(a[7][a[3]]||"sm")))&&p(e,"class",i)},i(a){l||(a&&vt(()=>{l&&(s||(s=ft(e,In,{duration:150,x:5},!0)),s.run(1))}),l=!0)},o(a){a&&(s||(s=ft(e,In,{duration:150,x:5},!1)),s.run(0)),l=!1},d(a){a&&v(e),a&&s&&s.end(),r=!1,o()}}}function eg(n){let e,t,i,s,l,r,o,a,u,f,c,d;const m=n[11].prefix,h=st(m,n,n[10],ia);let _=!n[5]&&sa(n);const b=n[11].suffix,g=st(b,n,n[10],na);return{c(){e=w("div"),t=w("div"),h&&h.c(),i=I(),s=w("div"),s.innerHTML='<i class="iconoir-search"></i>',l=I(),r=w("input"),o=I(),_&&_.c(),a=I(),g&&g.c(),p(s,"class","addon prefix"),p(r,"type","text"),p(r,"id",n[6]),p(r,"placeholder",n[2]),p(t,"class","field-group"),p(e,"class",u="form-field form-field-"+n[3]+" search-bar "+n[1])},m(T,L){k(T,e,L),y(e,t),h&&h.m(t,null),y(t,i),y(t,s),y(t,l),y(t,r),n[12](r),_e(r,n[0]),y(t,o),_&&_.m(t,null),y(t,a),g&&g.m(t,null),f=!0,c||(d=[H(r,"input",n[13]),H(t,"click",n[8])],c=!0)},p(T,[L]){h&&h.p&&(!f||L&1056)&&rt(h,m,T,T[10],f?lt(m,T[10],L,x_):ot(T[10]),ia),(!f||L&4)&&p(r,"placeholder",T[2]),L&1&&r.value!==T[0]&&_e(r,T[0]),T[5]?_&&(ae(),j(_,1,1,()=>{_=null}),ue()):_?(_.p(T,L),L&32&&E(_,1)):(_=sa(T),_.c(),E(_,1),_.m(t,a)),g&&g.p&&(!f||L&1056)&&rt(g,b,T,T[10],f?lt(b,T[10],L,Q_):ot(T[10]),na),(!f||L&10&&u!==(u="form-field form-field-"+T[3]+" search-bar "+T[1]))&&p(e,"class",u)},i(T){f||(E(h,T),E(_),E(g,T),f=!0)},o(T){j(h,T),j(_),j(g,T),f=!1},d(T){T&&v(e),h&&h.d(T),n[12](null),_&&_.d(),g&&g.d(T),c=!1,pe(d)}}}function tg(n,e,t){let i,{$$slots:s={},$$scope:l}=e;const r="search_"+J.randomString(5),o={lg:"sm",md:"sm",sm:"xs"};let{class:a=""}=e,{value:u}=e,{placeholder:f="Search..."}=e,{size:c="lg"}=e,d;function m(){d==null||d.focus()}function h(){t(0,u="")}function _(g){le[g?"unshift":"push"](()=>{d=g,t(4,d)})}function b(){u=this.value,t(0,u)}return n.$$set=g=>{"class"in g&&t(1,a=g.class),"value"in g&&t(0,u=g.value),"placeholder"in g&&t(2,f=g.placeholder),"size"in g&&t(3,c=g.size),"$$scope"in g&&t(10,l=g.$$scope)},n.$$.update=()=>{n.$$.dirty&1&&t(5,i=J.isEmpty(u))},[u,a,f,c,d,i,r,o,m,h,l,s,_,b]}class md extends ye{constructor(e){super(),we(this,e,tg,eg,he,{class:1,value:0,placeholder:2,size:3})}}const ns=Fe([]),sn=Fe(!1),is=Fe("");function Zs(){ns.set([]),sn.set(!1),is.set("")}const un=Nt([ns,is],([n,e])=>n.length?e&&n.find(t=>t.id==e)||n[0]:null);un.set=n=>{J.isObject(n)?Gn(n,!0):is.set(n)};function Gn(n,e=!1){n&&(ns.update(t=>(J.pushOrReplaceObject(t,n),t)),e&&is.set(n.id))}function ol(n){n&&(ns.update(e=>(J.removeByKey(e,"id",n.id),e)),is.update(e=>e==n.id?"":e))}function la(n){let e,t=n[0].value+"",i;return{c(){e=w("small"),i=ee(t),p(e,"class","txt-hint m-l-auto")},m(s,l){k(s,e,l),y(e,i)},p(s,l){l&1&&t!==(t=s[0].value+"")&&ke(i,t)},d(s){s&&v(e)}}}function ng(n){let e,t,i=n[0].label+"",s,l,r=n[0].value&&la(n);return{c(){e=w("div"),t=w("span"),s=ee(i),l=I(),r&&r.c(),p(t,"class","txt"),p(e,"class","flex")},m(o,a){k(o,e,a),y(e,t),y(t,s),y(e,l),r&&r.m(e,null)},p(o,[a]){a&1&&i!==(i=o[0].label+"")&&ke(s,i),o[0].value?r?r.p(o,a):(r=la(o),r.c(),r.m(e,null)):r&&(r.d(1),r=null)},i:Q,o:Q,d(o){o&&v(e),r&&r.d()}}}function ig(n,e,t){let{item:i={}}=e;return n.$$set=s=>{"item"in s&&t(0,i=s.item)},[i]}class ra extends ye{constructor(e){super(),we(this,e,ig,ng,he,{item:0})}}function oa(n){let e,t,i,s,l,r,o;return{c(){e=w("div"),t=w("input"),i=I(),s=w("div"),l=w("input"),p(t,"type","number"),p(t,"min","1"),p(t,"placeholder","Width"),t.required=!0,p(e,"class","col-3"),p(l,"type","number"),p(l,"min","1"),p(l,"placeholder","Height"),l.required=!0,p(s,"class","col-3")},m(a,u){k(a,e,u),y(e,t),_e(t,n[3]),k(a,i,u),k(a,s,u),y(s,l),_e(l,n[4]),r||(o=[H(t,"input",n[8]),ge(Te.call(null,e,"Width")),H(l,"input",n[9]),ge(Te.call(null,s,"Height"))],r=!0)},p(a,u){u&8&&yt(t.value)!==a[3]&&_e(t,a[3]),u&16&&yt(l.value)!==a[4]&&_e(l,a[4])},d(a){a&&(v(e),v(i),v(s)),r=!1,pe(o)}}}function sg(n){let e,t,i,s,l,r,o;function a(c){n[7](c)}let u={id:n[0],upside:!0,labelComponent:ra,optionComponent:ra,items:n[1]};n[2]!==void 0&&(u.keyOfSelected=n[2]),i=new cn({props:u}),le.push(()=>Pe(i,"keyOfSelected",a));let f=n[2]==""&&oa(n);return{c(){e=w("div"),t=w("div"),W(i.$$.fragment),r=I(),f&&f.c(),p(t,"class",l="col-"+(n[2]==""?6:12)),p(e,"class","grid grid-sm")},m(c,d){k(c,e,d),y(e,t),$(i,t,null),y(e,r),f&&f.m(e,null),o=!0},p(c,[d]){const m={};d&1&&(m.id=c[0]),d&2&&(m.items=c[1]),!s&&d&4&&(s=!0,m.keyOfSelected=c[2],je(()=>s=!1)),i.$set(m),(!o||d&4&&l!==(l="col-"+(c[2]==""?6:12)))&&p(t,"class",l),c[2]==""?f?f.p(c,d):(f=oa(c),f.c(),f.m(e,null)):f&&(f.d(1),f=null)},i(c){o||(E(i.$$.fragment,c),o=!0)},o(c){j(i.$$.fragment,c),o=!1},d(c){c&&v(e),F(i),f&&f.d()}}}function lg(n,e,t){var b;let{id:i}=e,{options:s=[]}=e,{value:l=((b=s==null?void 0:s[0])==null?void 0:b.value)||""}=e,r=l,o="",a=0,u=0;function f(g){t(6,r=g),t(5,l=g),d()}function c(){var g;t(2,o=((g=s.find(T=>T.value==l))==null?void 0:g.value)||""),d()}function d(){const g=l.split("x");t(3,a=(g==null?void 0:g[0])<<0),t(4,u=(g==null?void 0:g[1])<<0)}function m(g){o=g,t(2,o)}function h(){a=yt(this.value),t(3,a)}function _(){u=yt(this.value),t(4,u)}return n.$$set=g=>{"id"in g&&t(0,i=g.id),"options"in g&&t(1,s=g.options),"value"in g&&t(5,l=g.value)},n.$$.update=()=>{n.$$.dirty&96&&r!=l&&(c(),f(l)),n.$$.dirty&2&&s&&c(),n.$$.dirty&4&&o&&f(o),n.$$.dirty&24&&(a||u)&&f(`${a}x${u}`)},[i,s,o,a,u,l,r,m,h,_]}class rg extends ye{constructor(e){super(),we(this,e,lg,sg,he,{id:0,options:1,value:5})}}function og(n){let e,t,i,s,l,r,o,a,u,f,c;return u=Af(n[5][0]),{c(){e=w("input"),i=I(),s=w("label"),l=w("i"),r=I(),o=w("span"),o.textContent="Desktop",p(e,"type","radio"),p(e,"id",t=n[13]),p(e,"name","type"),e.__value=fi,_e(e,e.__value),p(l,"class","iconoir-modern-tv svelte-1i8gqwf"),p(o,"class","txt"),p(s,"for",a=n[13]),p(s,"class","svelte-1i8gqwf"),u.p(e)},m(d,m){k(d,e,m),e.checked=e.__value===n[1],k(d,i,m),k(d,s,m),y(s,l),y(s,r),y(s,o),f||(c=H(e,"change",n[4]),f=!0)},p(d,m){m&8192&&t!==(t=d[13])&&p(e,"id",t),m&2&&(e.checked=e.__value===d[1]),m&8192&&a!==(a=d[13])&&p(s,"for",a)},d(d){d&&(v(e),v(i),v(s)),u.r(),f=!1,c()}}}function ag(n){let e,t,i,s,l,r,o,a,u,f,c;return u=Af(n[5][0]),{c(){e=w("input"),i=I(),s=w("label"),l=w("i"),r=I(),o=w("span"),o.textContent="Mobile",p(e,"type","radio"),p(e,"id",t=n[13]),p(e,"name","type"),e.__value=hd,_e(e,e.__value),p(l,"class","iconoir-smartphone-device svelte-1i8gqwf"),p(o,"class","txt"),p(s,"for",a=n[13]),p(s,"class","svelte-1i8gqwf"),u.p(e)},m(d,m){k(d,e,m),e.checked=e.__value===n[1],k(d,i,m),k(d,s,m),y(s,l),y(s,r),y(s,o),f||(c=H(e,"change",n[6]),f=!0)},p(d,m){m&8192&&t!==(t=d[13])&&p(e,"id",t),m&2&&(e.checked=e.__value===d[1]),m&8192&&a!==(a=d[13])&&p(s,"for",a)},d(d){d&&(v(e),v(i),v(s)),u.r(),f=!1,c()}}}function ug(n){let e,t,i,s,l;return t=new Oe({props:{class:"group-item",$$slots:{default:[og,({uniqueId:r})=>({13:r}),({uniqueId:r})=>r?8192:0]},$$scope:{ctx:n}}}),s=new Oe({props:{class:"group-item",$$slots:{default:[ag,({uniqueId:r})=>({13:r}),({uniqueId:r})=>r?8192:0]},$$scope:{ctx:n}}}),{c(){e=w("div"),W(t.$$.fragment),i=I(),W(s.$$.fragment),p(e,"class","radio-group type-group svelte-1i8gqwf")},m(r,o){k(r,e,o),$(t,e,null),y(e,i),$(s,e,null),l=!0},p(r,o){const a={};o&24578&&(a.$$scope={dirty:o,ctx:r}),t.$set(a);const u={};o&24578&&(u.$$scope={dirty:o,ctx:r}),s.$set(u)},i(r){l||(E(t.$$.fragment,r),E(s.$$.fragment,r),l=!0)},o(r){j(t.$$.fragment,r),j(s.$$.fragment,r),l=!1},d(r){r&&v(e),F(t),F(s)}}}function fg(n){let e,t,i,s;return e=new Oe({props:{class:"form-field m-b-sm entrance-top",$$slots:{default:[dg,({uniqueId:l})=>({13:l}),({uniqueId:l})=>l?8192:0]},$$scope:{ctx:n}}}),i=new Oe({props:{class:"form-field entrance-top",name:"scale",$$slots:{default:[pg,({uniqueId:l})=>({13:l}),({uniqueId:l})=>l?8192:0]},$$scope:{ctx:n}}}),{c(){W(e.$$.fragment),t=I(),W(i.$$.fragment)},m(l,r){$(e,l,r),k(l,t,r),$(i,l,r),s=!0},p(l,r){const o={};r&24577&&(o.$$scope={dirty:r,ctx:l}),e.$set(o);const a={};r&24577&&(a.$$scope={dirty:r,ctx:l}),i.$set(a)},i(l){s||(E(e.$$.fragment,l),E(i.$$.fragment,l),s=!0)},o(l){j(e.$$.fragment,l),j(i.$$.fragment,l),s=!1},d(l){l&&v(t),F(e,l),F(i,l)}}}function cg(n){let e,t;return e=new Oe({props:{class:"form-field entrance-top",name:"scale",$$slots:{default:[mg,({uniqueId:i})=>({13:i}),({uniqueId:i})=>i?8192:0]},$$scope:{ctx:n}}}),{c(){W(e.$$.fragment)},m(i,s){$(e,i,s),t=!0},p(i,s){const l={};s&24577&&(l.$$scope={dirty:s,ctx:i}),e.$set(l)},i(i){t||(E(e.$$.fragment,i),t=!0)},o(i){j(e.$$.fragment,i),t=!1},d(i){F(e,i)}}}function dg(n){let e,t,i;function s(r){n[8](r)}let l={id:n[13],options:n[2]};return n[0].size!==void 0&&(l.value=n[0].size),e=new rg({props:l}),le.push(()=>Pe(e,"value",s)),{c(){W(e.$$.fragment)},m(r,o){$(e,r,o),i=!0},p(r,o){const a={};o&8192&&(a.id=r[13]),!t&&o&1&&(t=!0,a.value=r[0].size,je(()=>t=!1)),e.$set(a)},i(r){i||(E(e.$$.fragment,r),i=!0)},o(r){j(e.$$.fragment,r),i=!1},d(r){F(e,r)}}}function pg(n){let e,t,i,s,l,r,o,a,u;return{c(){e=w("input"),s=I(),l=w("label"),r=w("span"),r.textContent="Auto scale",p(e,"type","checkbox"),p(e,"id",t=n[13]),e.checked=i=n[0].scale==0,p(r,"class","txt"),p(l,"for",o=n[13])},m(f,c){k(f,e,c),k(f,s,c),k(f,l,c),y(l,r),a||(u=H(e,"change",n[9]),a=!0)},p(f,c){c&8192&&t!==(t=f[13])&&p(e,"id",t),c&1&&i!==(i=f[0].scale==0)&&(e.checked=i),c&8192&&o!==(o=f[13])&&p(l,"for",o)},d(f){f&&(v(e),v(s),v(l)),a=!1,u()}}}function mg(n){let e,t,i,s,l,r,o,a,u;return{c(){e=w("input"),s=I(),l=w("label"),r=w("span"),r.textContent="2x Retina rescale",p(e,"type","checkbox"),p(e,"id",t=n[13]),e.checked=i=n[0].scale==.5,p(r,"class","txt"),p(l,"for",o=n[13])},m(f,c){k(f,e,c),k(f,s,c),k(f,l,c),y(l,r),a||(u=H(e,"change",n[7]),a=!0)},p(f,c){c&8192&&t!==(t=f[13])&&p(e,"id",t),c&1&&i!==(i=f[0].scale==.5)&&(e.checked=i),c&8192&&o!==(o=f[13])&&p(l,"for",o)},d(f){f&&(v(e),v(s),v(l)),a=!1,u()}}}function hg(n){let e,t,i,s,l,r;e=new Oe({props:{class:"form-field m-b-sm",$$slots:{default:[ug]},$$scope:{ctx:n}}});const o=[cg,fg],a=[];function u(f,c){return f[1]==fi?0:1}return i=u(n),s=a[i]=o[i](n),{c(){W(e.$$.fragment),t=I(),s.c(),l=Ne()},m(f,c){$(e,f,c),k(f,t,c),a[i].m(f,c),k(f,l,c),r=!0},p(f,[c]){const d={};c&16386&&(d.$$scope={dirty:c,ctx:f}),e.$set(d);let m=i;i=u(f),i===m?a[i].p(f,c):(ae(),j(a[m],1,1,()=>{a[m]=null}),ue(),s=a[i],s?s.p(f,c):(s=a[i]=o[i](f),s.c()),E(s,1),s.m(l.parentNode,l))},i(f){r||(E(e.$$.fragment,f),E(s),r=!0)},o(f){j(e.$$.fragment,f),j(s),r=!1},d(f){f&&(v(t),v(l)),F(e,f),a[i].d(f)}}}const fi="desktop",hd="mobile";function _g(n,e,t){let{prototype:i}=e;const s=[{label:"Google Pixel",value:"412x732"},{label:"iPhone XS",value:"375x812"},{label:"iPhone 13/14",value:"390x844"},{label:"iPad Pro",value:"1024x1366"},{label:"Other",value:""}];let l=fi,r=l;function o(){t(1,l=i.size?hd:fi),t(3,r=l),l==fi&&!i.scale&&t(0,i.scale=1,i)}function a(){t(0,i.size="",i),t(0,i.scale=i.scale==.5?.5:1,i)}function u(){t(0,i.size=s[0].value,i),t(0,i.scale=0,i)}const f=[[]];function c(){l=this.__value,t(1,l)}function d(){l=this.__value,t(1,l)}const m=b=>{var g;(g=b==null?void 0:b.target)!=null&&g.checked?t(0,i.scale=.5,i):t(0,i.scale=1,i)};function h(b){n.$$.not_equal(i.size,b)&&(i.size=b,t(0,i))}const _=b=>{var g;(g=b==null?void 0:b.target)!=null&&g.checked?t(0,i.scale=0,i):t(0,i.scale=1,i)};return n.$$set=b=>{"prototype"in b&&t(0,i=b.prototype)},n.$$.update=()=>{n.$$.dirty&1&&i&&o(),n.$$.dirty&10&&r!=l&&(t(3,r=l),l==fi?a():u())},[i,l,s,r,c,f,d,m,h,_]}class _d extends ye{constructor(e){super(),we(this,e,_g,hg,he,{prototype:0})}}function gg(n){let e,t,i,s,l,r,o,a;return{c(){e=w("label"),t=ee("Project title"),s=I(),l=w("input"),p(e,"for",i=n[17]),p(l,"type","text"),p(l,"id",r=n[17]),l.autofocus=!0,l.required=!0},m(u,f){k(u,e,f),y(e,t),k(u,s,f),k(u,l,f),_e(l,n[2].title),l.focus(),o||(a=H(l,"input",n[10]),o=!0)},p(u,f){f&131072&&i!==(i=u[17])&&p(e,"for",i),f&131072&&r!==(r=u[17])&&p(l,"id",r),f&4&&l.value!==u[2].title&&_e(l,u[2].title)},d(u){u&&(v(e),v(s),v(l)),o=!1,a()}}}function aa(n){let e,t,i,s,l;function r(a){n[11](a)}let o={};return n[3]!==void 0&&(o.prototype=n[3]),i=new _d({props:o}),le.push(()=>Pe(i,"prototype",r)),{c(){e=w("div"),e.textContent="Prototype",t=I(),W(i.$$.fragment),p(e,"class","block m-b-10")},m(a,u){k(a,e,u),k(a,t,u),$(i,a,u),l=!0},p(a,u){const f={};!s&&u&8&&(s=!0,f.prototype=a[3],je(()=>s=!1)),i.$set(f)},i(a){l||(E(i.$$.fragment,a),l=!0)},o(a){j(i.$$.fragment,a),l=!1},d(a){a&&(v(e),v(t)),F(i,a)}}}function bg(n){let e,t,i,s,l,r;t=new Oe({props:{class:"form-field required",name:"title",$$slots:{default:[gg,({uniqueId:a})=>({17:a}),({uniqueId:a})=>a?131072:0]},$$scope:{ctx:n}}});let o=!n[2].id&&aa(n);return{c(){e=w("form"),W(t.$$.fragment),i=I(),o&&o.c(),p(e,"id",n[5]),p(e,"class","content")},m(a,u){k(a,e,u),$(t,e,null),y(e,i),o&&o.m(e,null),s=!0,l||(r=H(e,"submit",be(n[6])),l=!0)},p(a,u){const f={};u&393220&&(f.$$scope={dirty:u,ctx:a}),t.$set(f),a[2].id?o&&(ae(),j(o,1,1,()=>{o=null}),ue()):o?(o.p(a,u),u&4&&E(o,1)):(o=aa(a),o.c(),E(o,1),o.m(e,null))},i(a){s||(E(t.$$.fragment,a),E(o),s=!0)},o(a){j(t.$$.fragment,a),j(o),s=!1},d(a){a&&v(e),F(t),o&&o.d(),l=!1,r()}}}function wg(n){let e,t=n[2].id?"Update project":"Create project",i;return{c(){e=w("h5"),i=ee(t),p(e,"class","block txt-center")},m(s,l){k(s,e,l),y(e,i)},p(s,l){l&4&&t!==(t=s[2].id?"Update project":"Create project")&&ke(i,t)},d(s){s&&v(e)}}}function yg(n){let e,t,i,s,l=n[2].id?"Update project":"Create project",r,o,a;return{c(){e=w("button"),t=ee("Cancel"),i=I(),s=w("button"),r=ee(l),p(e,"type","button"),p(e,"class","btn btn-transparent"),e.disabled=n[4],p(s,"type","submit"),p(s,"form",n[5]),p(s,"class","btn btn-expanded btn-primary m-l-auto"),s.disabled=n[4],Z(s,"btn-loading",n[4])},m(u,f){k(u,e,f),y(e,t),k(u,i,f),k(u,s,f),y(s,r),o||(a=H(e,"click",n[9]),o=!0)},p(u,f){f&16&&(e.disabled=u[4]),f&4&&l!==(l=u[2].id?"Update project":"Create project")&&ke(r,l),f&16&&(s.disabled=u[4]),f&16&&Z(s,"btn-loading",u[4])},d(u){u&&(v(e),v(i),v(s)),o=!1,a()}}}function vg(n){let e,t,i={popup:!0,overlayClose:!n[4],escHide:!n[4],beforeHide:n[12],$$slots:{footer:[yg],header:[wg],default:[bg]},$$scope:{ctx:n}};return e=new dn({props:i}),n[13](e),e.$on("show",n[14]),e.$on("hide",n[15]),{c(){W(e.$$.fragment)},m(s,l){$(e,s,l),t=!0},p(s,[l]){const r={};l&16&&(r.overlayClose=!s[4]),l&16&&(r.escHide=!s[4]),l&16&&(r.beforeHide=s[12]),l&262172&&(r.$$scope={dirty:l,ctx:s}),e.$set(r)},i(s){t||(E(e.$$.fragment,s),t=!0)},o(s){j(e.$$.fragment,s),t=!1},d(s){n[13](null),F(e,s)}}}function kg(n,e,t){const i="project_upsert_"+J.randomString(5),s=tt();let{successRedirect:l=!0}=e,r,o={},a={},u=!1;function f(O){return Kt({}),t(2,o=Object.assign({users:[z.authStore.record.id]},O)),t(3,a={}),o.id||(t(3,a.size="",a),t(3,a.scale=1,a)),r==null?void 0:r.show()}function c(){return r==null?void 0:r.hide()}async function d(){if(!u){t(4,u=!0);try{let O;o.id?O=await z.collection("projects").update(o.id,o):(O=await z.collection("projects").create(o),await z.collection("prototypes").create(Object.assign({project:O.id,title:J.isDesktopPrototype(a)?"Desktop":"Mobile"},a))),s("submit",O),t(4,u=!1),l?gi("/projects/"+O.id+"/prototypes"):c()}catch(O){O.isAbort||(t(4,u=!1),z.error(O))}}}const m=()=>c();function h(){o.title=this.value,t(2,o)}function _(O){a=O,t(3,a)}const b=()=>!u;function g(O){le[O?"unshift":"push"](()=>{r=O,t(1,r)})}function T(O){$e.call(this,n,O)}function L(O){$e.call(this,n,O)}return n.$$set=O=>{"successRedirect"in O&&t(7,l=O.successRedirect)},[c,r,o,a,u,i,d,l,f,m,h,_,b,g,T,L]}class gd extends ye{constructor(e){super(),we(this,e,kg,vg,he,{successRedirect:7,show:8,hide:0})}get show(){return this.$$.ctx[8]}get hide(){return this.$$.ctx[0]}}const Sg=n=>({isLoading:n&1,img:n&1024}),ua=n=>({isLoading:n[0],img:n[10]});function fa(n){let e;return{c(){e=w("span"),p(e,"class",n[8])},m(t,i){k(t,e,i)},p(t,i){i&256&&p(e,"class",t[8])},d(t){t&&v(e)}}}function Tg(n){let e,t,i,s,l,r,o,a,u,f=n[0]&&fa(n);const c=n[17].default,d=st(c,n,n[16],ua);return{c(){e=w("figure"),t=w("img"),s=I(),f&&f.c(),l=I(),d&&d.c(),p(t,"crossorigin","anonymous"),p(t,"loading",n[7]),p(t,"fetchpriority",n[5]),p(t,"alt",n[2]),p(t,"width",n[3]),p(t,"height",n[4]),p(t,"draggable",n[6]),zn(t.src,i=n[1])||p(t,"src",i),p(e,"class",r="lazy-load "+n[9]),Z(e,"loading",n[0])},m(m,h){k(m,e,h),y(e,t),n[21](t),y(e,s),f&&f.m(e,null),y(e,l),d&&d.m(e,null),o=!0,a||(u=[H(t,"load",n[11]),H(t,"error",n[12]),H(t,"click",n[18]),H(t,"mousedown",n[19]),H(t,"touchstart",n[20])],a=!0)},p(m,[h]){(!o||h&128)&&p(t,"loading",m[7]),(!o||h&32)&&p(t,"fetchpriority",m[5]),(!o||h&4)&&p(t,"alt",m[2]),(!o||h&8)&&p(t,"width",m[3]),(!o||h&16)&&p(t,"height",m[4]),(!o||h&64)&&p(t,"draggable",m[6]),(!o||h&2&&!zn(t.src,i=m[1]))&&p(t,"src",i),m[0]?f?f.p(m,h):(f=fa(m),f.c(),f.m(e,l)):f&&(f.d(1),f=null),d&&d.p&&(!o||h&66561)&&rt(d,c,m,m[16],o?lt(c,m[16],h,Sg):ot(m[16]),ua),(!o||h&512&&r!==(r="lazy-load "+m[9]))&&p(e,"class",r),(!o||h&513)&&Z(e,"loading",m[0])},i(m){o||(E(d,m),o=!0)},o(m){j(d,m),o=!1},d(m){m&&v(e),n[21](null),f&&f.d(),d&&d.d(m),a=!1,pe(u)}}}function Og(n,e,t){let{$$slots:i={},$$scope:s}=e;const l=tt();let{src:r}=e,{alt:o=void 0}=e,{width:a=void 0}=e,{height:u=void 0}=e,{fetchpriority:f=void 0}=e,{draggable:c=null}=e,{scale:d=void 0}=e,{loading:m="lazy"}=e,{loaderClass:h="loader"}=e,{isLoading:_=!0}=e,{class:b=""}=e,g,T=r;function L(){return g!=null&&g.naturalWidth?g.clientWidth/g.naturalWidth:1}function O(){S(),l("load",g),t(0,_=!1)}function C(){t(0,_=!1),l("error",g)}function S(){if(!g||!g.complete||typeof d>"u")return;t(10,g.style.width="auto",g),t(10,g.style.height="auto",g),d==0?t(10,g.style["max-width"]="100%",g):t(10,g.style["max-width"]="",g);const R=d>0?g.naturalWidth*d:g.naturalWidth;t(10,g.style.width=R+"px",g)}function P(R){$e.call(this,n,R)}function M(R){$e.call(this,n,R)}function A(R){$e.call(this,n,R)}function D(R){le[R?"unshift":"push"](()=>{g=R,t(10,g)})}return n.$$set=R=>{"src"in R&&t(1,r=R.src),"alt"in R&&t(2,o=R.alt),"width"in R&&t(3,a=R.width),"height"in R&&t(4,u=R.height),"fetchpriority"in R&&t(5,f=R.fetchpriority),"draggable"in R&&t(6,c=R.draggable),"scale"in R&&t(13,d=R.scale),"loading"in R&&t(7,m=R.loading),"loaderClass"in R&&t(8,h=R.loaderClass),"isLoading"in R&&t(0,_=R.isLoading),"class"in R&&t(9,b=R.class),"$$scope"in R&&t(16,s=R.$$scope)},n.$$.update=()=>{n.$$.dirty&32770&&T!=r&&(t(15,T=r),t(0,_=!0)),n.$$.dirty&8192&&typeof d<"u"&&S()},[_,r,o,a,u,f,c,m,h,b,g,O,C,d,L,T,s,i,P,M,A,D]}class Gt extends ye{constructor(e){super(),we(this,e,Og,Tg,he,{src:1,alt:2,width:3,height:4,fetchpriority:5,draggable:6,scale:13,loading:7,loaderClass:8,isLoading:0,class:9,widthRatio:14})}get widthRatio(){return this.$$.ctx[14]}}function al(n){let e,t=n[0][n[3]]+"",i,s,l,r,o,a,u,f=[{spellcheck:s=!1},{tabindex:"0"},{contenteditable:l=n[8]&&!n[1]},{"data-placeholder":n[4]},{class:r="contenteditable inline-edit "+n[6]},n[10]],c={};for(let d=0;d<f.length;d+=1)c=Me(c,f[d]);return{c(){e=w(n[2]),i=ee(t),vs(n[2])(e,c),Z(e,"svelte-obfpdk",!0)},m(d,m){k(d,e,m),y(e,i),n[12](e),a||(u=[H(e,"focus",n[13]),H(e,"blur",n[14]),H(e,"keypress",n[15]),ge(o=Te.call(null,e,n[8]?"":{position:"bottom-left",text:n[5]}))],a=!0)},p(d,m){m&9&&t!==(t=d[0][d[3]]+"")&&xd(i,t,d[8]&&!d[1]),vs(d[2])(e,c=gt(f,[{spellcheck:s},{tabindex:"0"},m&258&&l!==(l=d[8]&&!d[1])&&{contenteditable:l},m&16&&{"data-placeholder":d[4]},m&64&&r!==(r="contenteditable inline-edit "+d[6])&&{class:r},m&1024&&d[10]])),o&&Qe(o.update)&&m&288&&o.update.call(null,d[8]?"":{position:"bottom-left",text:d[5]}),Z(e,"svelte-obfpdk",!0)},d(d){d&&v(e),n[12](null),a=!1,pe(u)}}}function Cg(n){let e,t=n[2],i=n[2]&&al(n);return{c(){e=w("div"),i&&i.c(),p(e,"class","inline-edit-container svelte-obfpdk")},m(s,l){k(s,e,l),i&&i.m(e,null)},p(s,[l]){s[2]?t?he(t,s[2])?(i.d(1),i=al(s),t=s[2],i.c(),i.m(e,null)):i.p(s,l):(i=al(s),t=s[2],i.c(),i.m(e,null)):t&&(i.d(1),i=null,t=s[2])},i:Q,o:Q,d(s){s&&v(e),i&&i.d(s)}}}function Eg(n,e,t){const i=["collection","model","disabled","tag","prop","placeholder","tooltip","class"];let s=ut(e,i),{collection:l=""}=e,{model:r={}}=e,{disabled:o=!1}=e,{tag:a="div"}=e,{prop:u="title"}=e,{placeholder:f="Title"}=e,{tooltip:c="Edit title"}=e,{class:d=""}=e,m,h=!1;async function _(){if(!m)return;const O=m.textContent;if(O||t(7,m.textContent=r[u],m),O!=r[u])try{const C={};C[u]=O;const S=await z.collection(l).update(r.id,C,{requestKey:"inline_"+l+r.id});t(0,r[u]=S[u],r),t(0,r.updated=S.updated,r)}catch(C){C.isAbort||console.warn("Failed to update "+u,C)}}function b(O){le[O?"unshift":"push"](()=>{m=O,t(7,m)})}const g=()=>t(8,h=!0),T=()=>{t(8,h=!1),_()},L=O=>{O.code=="Enter"&&(O.preventDefault(),m==null||m.blur())};return n.$$set=O=>{e=Me(Me({},e),Zt(O)),t(10,s=ut(e,i)),"collection"in O&&t(11,l=O.collection),"model"in O&&t(0,r=O.model),"disabled"in O&&t(1,o=O.disabled),"tag"in O&&t(2,a=O.tag),"prop"in O&&t(3,u=O.prop),"placeholder"in O&&t(4,f=O.placeholder),"tooltip"in O&&t(5,c=O.tooltip),"class"in O&&t(6,d=O.class)},[r,o,a,u,f,c,d,m,h,_,s,l,b,g,T,L]}class rr extends ye{constructor(e){super(),we(this,e,Eg,Cg,he,{collection:11,model:0,disabled:1,tag:2,prop:3,placeholder:4,tooltip:5,class:6})}}function ca(n,e,t){const i=n.slice();return i[23]=e[t],i}function Lg(n){let e;return{c(){e=w("i"),p(e,"class","iconoir-media-image")},m(t,i){k(t,e,i)},p:Q,i:Q,o:Q,d(t){t&&v(e)}}}function Ig(n){let e,t=[],i=new Map,s,l=Ee(n[1]);const r=o=>o[23].id;for(let o=0;o<l.length;o+=1){let a=ca(n,l,o),u=r(a);i.set(u,t[o]=da(u,a))}return{c(){e=w("div");for(let o=0;o<t.length;o+=1)t[o].c();p(e,"class","card-images-set")},m(o,a){k(o,e,a);for(let u=0;u<t.length;u+=1)t[u]&&t[u].m(e,null);s=!0},p(o,a){a&2&&(l=Ee(o[1]),ae(),t=kt(t,a,r,1,o,l,i,e,jt,da,null,ca),ue())},i(o){if(!s){for(let a=0;a<l.length;a+=1)E(t[a]);s=!0}},o(o){for(let a=0;a<t.length;a+=1)j(t[a]);s=!1},d(o){o&&v(e);for(let a=0;a<t.length;a+=1)t[a].d()}}}function da(n,e){let t,i,s,l;return i=new Gt({props:{src:z.files.getURL(e[23],e[23].file,{thumb:"450x0"}),alt:e[23].title}}),{key:n,first:null,c(){t=w("div"),W(i.$$.fragment),s=I(),p(t,"class","card-img"),Ue(t,"background-color",e[23].background),this.first=t},m(r,o){k(r,t,o),$(i,t,null),y(t,s),l=!0},p(r,o){e=r;const a={};o&2&&(a.src=z.files.getURL(e[23],e[23].file,{thumb:"450x0"})),o&2&&(a.alt=e[23].title),i.$set(a),o&2&&Ue(t,"background-color",e[23].background)},i(r){l||(E(i.$$.fragment,r),l=!0)},o(r){j(i.$$.fragment,r),l=!1},d(r){r&&v(t),F(i)}}}function pa(n){let e,t,i,s,l;function r(u,f){return u[0].expand.projectUserPreferences_via_project[0].favorite?Pg:jg}let o=r(n),a=o(n);return{c(){e=w("div"),t=w("button"),a.c(),p(t,"type","button"),p(t,"class","btn btn-sm btn-circle btn-transparent"),Z(t,"fade",!n[0].expand.projectUserPreferences_via_project[0].favorite),p(e,"class","ctrl ctrl-top-left")},m(u,f){k(u,e,f),y(e,t),a.m(t,null),s||(l=[ge(i=Te.call(null,t,n[0].expand.projectUserPreferences_via_project[0].favorite?"Remove from favorites":"Add to favorites")),H(t,"click",Be(n[11]))],s=!0)},p(u,f){o!==(o=r(u))&&(a.d(1),a=o(u),a&&(a.c(),a.m(t,null))),i&&Qe(i.update)&&f&1&&i.update.call(null,u[0].expand.projectUserPreferences_via_project[0].favorite?"Remove from favorites":"Add to favorites"),f&1&&Z(t,"fade",!u[0].expand.projectUserPreferences_via_project[0].favorite)},d(u){u&&v(e),a.d(),s=!1,pe(l)}}}function jg(n){let e;return{c(){e=w("i"),p(e,"class","iconoir-star")},m(t,i){k(t,e,i)},d(t){t&&v(e)}}}function Pg(n){let e;return{c(){e=w("i"),p(e,"class","iconoir-star-solid txt-warning")},m(t,i){k(t,e,i)},d(t){t&&v(e)}}}function Ng(n){let e,t,i;return{c(){e=w("i"),t=I(),i=w("span"),i.textContent="Watch",p(e,"class","iconoir-eye-solid"),p(i,"class","txt")},m(s,l){k(s,e,l),k(s,t,l),k(s,i,l)},d(s){s&&(v(e),v(t),v(i))}}}function Ag(n){let e,t,i;return{c(){e=w("i"),t=I(),i=w("span"),i.textContent="Unwatch",p(e,"class","iconoir-eye"),p(i,"class","txt")},m(s,l){k(s,e,l),k(s,t,l),k(s,i,l)},d(s){s&&(v(e),v(t),v(i))}}}function Dg(n){let e,t,i;return{c(){e=w("div"),e.innerHTML='<i class="iconoir-repository"></i> <span class="txt">Archive</span>',p(e,"class","dropdown-item")},m(s,l){k(s,e,l),t||(i=H(e,"click",n[14]),t=!0)},p:Q,d(s){s&&v(e),t=!1,i()}}}function Mg(n){let e,t,i;return{c(){e=w("div"),e.innerHTML='<i class="iconoir-repository"></i> <span class="txt">Unarchive</span>',p(e,"class","dropdown-item")},m(s,l){k(s,e,l),t||(i=H(e,"click",n[13]),t=!0)},p:Q,d(s){s&&v(e),t=!1,i()}}}function Rg(n){let e,t,i,s,l,r,o,a;function u(_,b){return _[0].expand.projectUserPreferences_via_project[0].watch?Ag:Ng}let f=u(n),c=f(n);function d(_,b){return _[0].archived?Mg:Dg}let m=d(n),h=m(n);return{c(){e=w("div"),c.c(),t=I(),h.c(),i=I(),s=w("hr"),l=I(),r=w("div"),r.innerHTML='<i class="iconoir-trash"></i> <span class="txt">Delete</span>',p(e,"class","dropdown-item"),p(r,"class","dropdown-item link-danger")},m(_,b){k(_,e,b),c.m(e,null),k(_,t,b),h.m(_,b),k(_,i,b),k(_,s,b),k(_,l,b),k(_,r,b),o||(a=[H(e,"click",n[12]),H(r,"click",n[15])],o=!0)},p(_,b){f!==(f=u(_))&&(c.d(1),c=f(_),c&&(c.c(),c.m(e,null))),m===(m=d(_))&&h?h.p(_,b):(h.d(1),h=m(_),h&&(h.c(),h.m(i.parentNode,i)))},d(_){_&&(v(e),v(t),v(i),v(s),v(l),v(r)),c.d(),h.d(_),o=!1,pe(a)}}}function ma(n){let e,t,i,s,l,r,o;return{c(){e=w("div"),t=w("i"),i=I(),s=w("span"),l=ee(n[2]),p(t,"class","iconoir-message-text"),p(s,"class","txt"),p(e,"class","meta-item txt-warning")},m(a,u){k(a,e,u),y(e,t),y(e,i),y(e,s),y(s,l),r||(o=ge(Te.call(null,e,"Unread comments")),r=!0)},p(a,u){u&4&&ke(l,a[2])},d(a){a&&v(e),r=!1,o()}}}function ha(n){let e,t,i;return{c(){e=w("div"),e.innerHTML='<i class="iconoir-repository"></i>',p(e,"class","meta-item")},m(s,l){k(s,e,l),t||(i=ge(Te.call(null,e,"Archived")),t=!0)},d(s){s&&v(e),t=!1,i()}}}function Hg(n){var ce,oe;let e,t,i,s,l,r,o,a,u,f,c,d,m,h,_,b,g,T,L,O,C,S,P,M,A,D,R;const Y=[Ig,Lg],G=[];function B(de,Ce){return de[1].length?0:1}i=B(n),s=G[i]=Y[i](n);let N=((oe=(ce=n[0].expand)==null?void 0:ce.projectUserPreferences_via_project)==null?void 0:oe[0])&&pa(n);h=new At({props:{class:"dropdown dropdown-nowrap dropdown-sm",$$slots:{default:[Rg]},$$scope:{ctx:n}}});function V(de){n[18](de)}let te={tag:"h5",class:"title",collection:"projects"};n[0]!==void 0&&(te.model=n[0]),g=new rr({props:te}),le.push(()=>Pe(g,"model",V));let X=n[2]&&ma(n),U=n[0].archived&&ha();return{c(){e=w("div"),t=w("figure"),s.c(),l=I(),r=w("div"),N&&N.c(),o=I(),a=w("div"),a.innerHTML='<i class="iconoir-media-image-list preview-icon" title="View project"></i>',u=I(),f=w("div"),c=w("button"),d=w("i"),m=I(),W(h.$$.fragment),_=I(),b=w("div"),W(g.$$.fragment),L=I(),O=w("div"),X&&X.c(),C=I(),U&&U.c(),S=I(),P=w("div"),P.innerHTML='<div class="iconoir-calendar"></div>',p(a,"class","ctrl ctrl-center"),p(d,"class","iconoir-more-vert"),p(c,"type","button"),p(c,"class","btn btn-sm btn-circle btn-transparent fade"),p(f,"class","ctrl ctrl-top-right"),p(r,"class","card-overlay handle"),p(t,"class","card-featured"),p(P,"class","meta-item"),p(O,"class","meta"),p(b,"class","card-content"),p(e,"class","card entrance-top")},m(de,Ce){k(de,e,Ce),y(e,t),G[i].m(t,null),y(t,l),y(t,r),N&&N.m(r,null),y(r,o),y(r,a),y(r,u),y(r,f),y(f,c),y(c,d),y(c,m),$(h,c,null),y(e,_),y(e,b),$(g,b,null),y(b,L),y(b,O),X&&X.m(O,null),y(O,C),U&&U.m(O,null),y(O,S),y(O,P),A=!0,D||(R=[H(f,"click",Be(n[10])),H(r,"auxclick",n[16]),H(r,"click",n[17]),ge(M=Te.call(null,P,{text:"Created "+J.relativeDate(n[0].created),sub:J.formatToLocalDate(n[0].created)}))],D=!0)},p(de,[Ce]){var ct,K;let xe=i;i=B(de),i===xe?G[i].p(de,Ce):(ae(),j(G[xe],1,1,()=>{G[xe]=null}),ue(),s=G[i],s?s.p(de,Ce):(s=G[i]=Y[i](de),s.c()),E(s,1),s.m(t,l)),(K=(ct=de[0].expand)==null?void 0:ct.projectUserPreferences_via_project)!=null&&K[0]?N?N.p(de,Ce):(N=pa(de),N.c(),N.m(r,o)):N&&(N.d(1),N=null);const at={};Ce&67108865&&(at.$$scope={dirty:Ce,ctx:de}),h.$set(at);const nt={};!T&&Ce&1&&(T=!0,nt.model=de[0],je(()=>T=!1)),g.$set(nt),de[2]?X?X.p(de,Ce):(X=ma(de),X.c(),X.m(O,C)):X&&(X.d(1),X=null),de[0].archived?U||(U=ha(),U.c(),U.m(O,S)):U&&(U.d(1),U=null),M&&Qe(M.update)&&Ce&1&&M.update.call(null,{text:"Created "+J.relativeDate(de[0].created),sub:J.formatToLocalDate(de[0].created)})},i(de){A||(E(s),E(h.$$.fragment,de),E(g.$$.fragment,de),A=!0)},o(de){j(s),j(h.$$.fragment,de),j(g.$$.fragment,de),A=!1},d(de){de&&v(e),G[i].d(),N&&N.d(),F(h),F(g),X&&X.d(),U&&U.d(),D=!1,pe(R)}}}function Ug(n,e,t){let i,s;x(n,gn,D=>t(9,s=D));let{project:l}=e,r=[];function o(D){var Y,G,B,N,V,te,X,U;t(1,r=[]);const R=((B=(G=(Y=D==null?void 0:D.expand)==null?void 0:Y.prototypes_via_project)==null?void 0:G.sort(function(ce,oe){return ce.created<oe.created?-1:ce.created>oe.created?1:0}))==null?void 0:B.slice(-3))||[];for(let ce of R){let oe=null;(N=ce.screensOrder)!=null&&N[0]&&(oe=(te=(V=ce.expand)==null?void 0:V.screens_via_prototype)==null?void 0:te.find(de=>{var Ce;return de.id==((Ce=ce.screensOrder)==null?void 0:Ce[0])})),oe||(oe=(U=(X=ce.expand)==null?void 0:X.screens_via_prototype)==null?void 0:U[0]),oe&&r.push(oe)}}function a(D,R=!1){const Y="/projects/"+D.id+"/prototypes";R?window.open("#"+Y,"_blank").focus():gi(Y)}async function u(D){Lt(`Do you really want to delete project ${D.title} and all its related screens?`,async()=>f(D),()=>{var R;(R=document.activeElement)==null||R.blur()})}async function f(D){try{await z.collection("projects").delete(D.id),ol(D),_t(`Successfully deleted project ${D.title}.`)}catch(R){R.isAbort||z.error(R)}}async function c(D){Lt(`Do you really want to archive project ${D.title}?`,async()=>d(D),()=>{var R;(R=document.activeElement)==null||R.blur()})}async function d(D){try{await z.collection("projects").update(D.id,{archived:!0}),D.archived||ol(D),_t(`Successfully archived project ${D.title}.`)}catch(R){R.isAbort||z.error(R)}}async function m(D){Lt(`Do you really want to unarchive project ${D.title}?`,async()=>h(D),()=>{var R;(R=document.activeElement)==null||R.blur()})}async function h(D){try{await z.collection("projects").update(D.id,{archived:!1}),D.archived&&ol(D),_t(`Successfully unarchived project ${D.title}.`)}catch(R){R.isAbort||z.error(R)}}async function _(D){if(!(D!=null&&D.id))return D;try{return D.watch=!D.watch,await z.collection("projectUserPreferences").update(D.id,{watch:D.watch})}catch(R){R.isAbort||z.error(R)}}async function b(D){if(!(D!=null&&D.id))return D;try{return D.favorite=!D.favorite,await z.collection("projectUserPreferences").update(D.id,{favorite:D.favorite})}catch(R){R.isAbort||z.error(R)}}function g(D){$e.call(this,n,D)}const T=D=>{var R,Y;b(l.expand.projectUserPreferences_via_project[0]),t(0,l),(Y=(R=D.target)==null?void 0:R.closest("button"))==null||Y.blur()},L=()=>{_(l.expand.projectUserPreferences_via_project[0]),t(0,l)},O=()=>m(l),C=()=>c(l),S=()=>u(l),P=()=>{a(l,!0)},M=()=>{a(l)};function A(D){l=D,t(0,l)}return n.$$set=D=>{"project"in D&&t(0,l=D.project)},n.$$.update=()=>{n.$$.dirty&1&&o(l),n.$$.dirty&513&&t(2,i=s.filter(D=>{var R,Y,G,B,N,V;return!D.read&&((V=(N=(B=(G=(Y=(R=D==null?void 0:D.expand)==null?void 0:R.comment)==null?void 0:Y.expand)==null?void 0:G.screen)==null?void 0:B.expand)==null?void 0:N.prototype)==null?void 0:V.project)==l.id}).length)},[l,r,i,a,u,c,m,_,b,s,g,T,L,O,C,S,P,M,A]}class bd extends ye{constructor(e){super(),we(this,e,Ug,Hg,he,{project:0})}}function _a(n,e,t){const i=n.slice();return i[20]=e[t],i[21]=e,i[22]=t,i}function ga(n,e,t){const i=n.slice();return i[20]=e[t],i[23]=e,i[24]=t,i}function qg(n){let e,t,i,s,l=n[4].length&&ba(n),r=n[4].length&&n[3].length&&ya(),o=n[3].length&&va(n);return{c(){l&&l.c(),e=I(),r&&r.c(),t=I(),o&&o.c(),i=Ne()},m(a,u){l&&l.m(a,u),k(a,e,u),r&&r.m(a,u),k(a,t,u),o&&o.m(a,u),k(a,i,u),s=!0},p(a,u){a[4].length?l?(l.p(a,u),u&16&&E(l,1)):(l=ba(a),l.c(),E(l,1),l.m(e.parentNode,e)):l&&(ae(),j(l,1,1,()=>{l=null}),ue()),a[4].length&&a[3].length?r||(r=ya(),r.c(),r.m(t.parentNode,t)):r&&(r.d(1),r=null),a[3].length?o?(o.p(a,u),u&8&&E(o,1)):(o=va(a),o.c(),E(o,1),o.m(i.parentNode,i)):o&&(ae(),j(o,1,1,()=>{o=null}),ue())},i(a){s||(E(l),E(o),s=!0)},o(a){j(l),j(o),s=!1},d(a){a&&(v(e),v(t),v(i)),l&&l.d(a),r&&r.d(a),o&&o.d(a)}}}function $g(n){let e;function t(l,r){return l[5]?Vg:Wg}let i=t(n),s=i(n);return{c(){s.c(),e=Ne()},m(l,r){s.m(l,r),k(l,e,r)},p(l,r){i===(i=t(l))&&s?s.p(l,r):(s.d(1),s=i(l),s&&(s.c(),s.m(e.parentNode,e)))},i:Q,o:Q,d(l){l&&v(e),s.d(l)}}}function Fg(n){let e;return{c(){e=w("div"),e.innerHTML='<span class="loader loader-lg"></span>',p(e,"class","block txt-center m-t-lg")},m(t,i){k(t,e,i)},p:Q,i:Q,o:Q,d(t){t&&v(e)}}}function ba(n){let e,t=[],i=new Map,s,l=Ee(n[4]);const r=o=>o[20].id;for(let o=0;o<l.length;o+=1){let a=ga(n,l,o),u=r(a);i.set(u,t[o]=wa(u,a))}return{c(){e=w("div");for(let o=0;o<t.length;o+=1)t[o].c();p(e,"class","cards-list")},m(o,a){k(o,e,a);for(let u=0;u<t.length;u+=1)t[u]&&t[u].m(e,null);s=!0},p(o,a){a&16&&(l=Ee(o[4]),ae(),t=kt(t,a,r,1,o,l,i,e,jt,wa,null,ga),ue())},i(o){if(!s){for(let a=0;a<l.length;a+=1)E(t[a]);s=!0}},o(o){for(let a=0;a<t.length;a+=1)j(t[a]);s=!1},d(o){o&&v(e);for(let a=0;a<t.length;a+=1)t[a].d()}}}function wa(n,e){let t,i,s,l;function r(a){e[15](a,e[20],e[23],e[24])}let o={};return e[20]!==void 0&&(o.project=e[20]),i=new bd({props:o}),le.push(()=>Pe(i,"project",r)),{key:n,first:null,c(){t=Ne(),W(i.$$.fragment),this.first=t},m(a,u){k(a,t,u),$(i,a,u),l=!0},p(a,u){e=a;const f={};!s&&u&16&&(s=!0,f.project=e[20],je(()=>s=!1)),i.$set(f)},i(a){l||(E(i.$$.fragment,a),l=!0)},o(a){j(i.$$.fragment,a),l=!1},d(a){a&&v(t),F(i,a)}}}function ya(n){let e;return{c(){e=w("hr")},m(t,i){k(t,e,i)},d(t){t&&v(e)}}}function va(n){let e,t=[],i=new Map,s,l=Ee(n[3]);const r=o=>o[20].id;for(let o=0;o<l.length;o+=1){let a=_a(n,l,o),u=r(a);i.set(u,t[o]=ka(u,a))}return{c(){e=w("div");for(let o=0;o<t.length;o+=1)t[o].c();p(e,"class","cards-list")},m(o,a){k(o,e,a);for(let u=0;u<t.length;u+=1)t[u]&&t[u].m(e,null);s=!0},p(o,a){a&8&&(l=Ee(o[3]),ae(),t=kt(t,a,r,1,o,l,i,e,jt,ka,null,_a),ue())},i(o){if(!s){for(let a=0;a<l.length;a+=1)E(t[a]);s=!0}},o(o){for(let a=0;a<t.length;a+=1)j(t[a]);s=!1},d(o){o&&v(e);for(let a=0;a<t.length;a+=1)t[a].d()}}}function ka(n,e){let t,i,s,l;function r(a){e[16](a,e[20],e[21],e[22])}let o={};return e[20]!==void 0&&(o.project=e[20]),i=new bd({props:o}),le.push(()=>Pe(i,"project",r)),{key:n,first:null,c(){t=Ne(),W(i.$$.fragment),this.first=t},m(a,u){k(a,t,u),$(i,a,u),l=!0},p(a,u){e=a;const f={};!s&&u&8&&(s=!0,f.project=e[20],je(()=>s=!1)),i.$set(f)},i(a){l||(E(i.$$.fragment,a),l=!0)},o(a){j(i.$$.fragment,a),l=!1},d(a){a&&v(t),F(i,a)}}}function Wg(n){let e,t,i,s,l,r,o,a,u,f;return{c(){e=w("div"),t=w("div"),t.innerHTML='<i class="iconoir-grid-plus"></i>',i=I(),s=w("h6"),s.textContent="You don't have any active projects yet!",l=I(),r=w("div"),r.innerHTML="<p>Create a new project to share your designs, collect feedback and more.</p>",o=I(),a=w("button"),a.innerHTML='<i class="iconoir-plus"></i> <span class="txt">New project</span>',p(t,"class","icon"),p(s,"class","title"),p(r,"class","content"),p(a,"type","button"),p(a,"class","btn btn-expanded btn-primary btn-lg m-t-base"),p(e,"class","placeholder-block entrance-top")},m(c,d){k(c,e,d),y(e,t),y(e,i),y(e,s),y(e,l),y(e,r),y(e,o),y(e,a),u||(f=H(a,"click",n[14]),u=!0)},p:Q,d(c){c&&v(e),u=!1,f()}}}function Vg(n){let e;return{c(){e=w("div"),e.innerHTML='<div class="icon"><i class="iconoir-grid-xmark"></i></div> <h6 class="title">No projects found!</h6>',p(e,"class","placeholder-block m-b-sm entrance-top")},m(t,i){k(t,e,i)},p:Q,d(t){t&&v(e)}}}function Sa(n){let e,t,i,s,l;return{c(){e=w("button"),e.innerHTML='<span class="txt">Load more</span>',t=I(),i=w("div"),p(e,"type","button"),p(e,"class","btn btn-semitransparent btn-expanded btn-lg m-b-sm entrance-top"),Z(e,"btn-disabled",n[7]),Z(e,"btn-loading",n[7]),p(i,"class","clearfix")},m(r,o){k(r,e,o),k(r,t,o),k(r,i,o),s||(l=H(e,"click",n[17]),s=!0)},p(r,o){o&128&&Z(e,"btn-disabled",r[7]),o&128&&Z(e,"btn-loading",r[7])},d(r){r&&(v(e),v(t),v(i)),s=!1,l()}}}function Ta(n){let e,t,i;return{c(){e=w("button"),e.textContent="Reset filters",p(e,"type","button"),p(e,"class","btn btn-transparent btn-hint btn-expanded entrance-top")},m(s,l){k(s,e,l),t||(i=H(e,"click",n[9]),t=!0)},p:Q,d(s){s&&v(e),t=!1,i()}}}function zg(n){let e,t,i,s,l,r,o,a;const u=[Fg,$g,qg],f=[];function c(_,b){return _[7]&&!_[0].length?0:!_[7]&&!_[0].length?1:2}e=c(n),t=f[e]=u[e](n);let d=n[6]&&Sa(n),m=!n[7]&&n[5]&&Ta(n),h={};return o=new gd({props:h}),n[18](o),{c(){t.c(),i=I(),s=w("div"),d&&d.c(),l=I(),m&&m.c(),r=I(),W(o.$$.fragment),p(s,"class","block txt-center m-t-base")},m(_,b){f[e].m(_,b),k(_,i,b),k(_,s,b),d&&d.m(s,null),y(s,l),m&&m.m(s,null),k(_,r,b),$(o,_,b),a=!0},p(_,[b]){let g=e;e=c(_),e===g?f[e].p(_,b):(ae(),j(f[g],1,1,()=>{f[g]=null}),ue(),t=f[e],t?t.p(_,b):(t=f[e]=u[e](_),t.c()),E(t,1),t.m(i.parentNode,i)),_[6]?d?d.p(_,b):(d=Sa(_),d.c(),d.m(s,l)):d&&(d.d(1),d=null),!_[7]&&_[5]?m?m.p(_,b):(m=Ta(_),m.c(),m.m(s,null)):m&&(m.d(1),m=null);const T={};o.$set(T)},i(_){a||(E(t),E(o.$$.fragment,_),a=!0)},o(_){j(t),j(o.$$.fragment,_),a=!1},d(_){_&&(v(i),v(s),v(r)),f[e].d(_),d&&d.d(),m&&m.d(),n[18](null),F(o,_)}}}const Oa=50;function Bg(n,e,t){let i,s,l,r,o,a;x(n,sn,P=>t(7,o=P)),x(n,ns,P=>t(0,a=P));let{search:u=""}=e,{archived:f=!1}=e,c,d=1,m=0,h;b();async function _(P=1){P<=1&&b(),ve(sn,o=!0,o);let M=`project.archived=${f}`;return u&&(M+=z.filter("&&project.title~{:title}",{title:u})),z.collection("projectUserPreferences").getList(P,Oa,{sort:"-favorite,-lastVisited,-project.created",filter:M,skipTotal:1,expand:"project.prototypes_via_project.screens_via_prototype",requestKey:"projects_list"}).then(A=>{var D;t(2,d=A.page),t(12,m=A.items.length);for(const R of A.items){const Y=(D=R.expand)==null?void 0:D.project;if(!Y){console.warn("missing project for preference",R.id);continue}delete R.expand,Y.expand=Y.expand||{},Y.expand.projectUserPreferences_via_project=[R],Gn(Y)}ve(sn,o=!1,o)}).catch(A=>{A!=null&&A.isAbort||(ve(sn,o=!1,o),z.error(A))})}function b(){Zs(),t(12,m=0),t(2,d=1)}function g(){t(10,u=""),t(11,f=!1)}const T=()=>c==null?void 0:c.show();function L(P,M,A,D){A[D]=P,t(4,l),t(0,a)}function O(P,M,A,D){A[D]=P,t(3,r),t(0,a)}const C=()=>_(d+1);function S(P){le[P?"unshift":"push"](()=>{c=P,t(1,c)})}return n.$$set=P=>{"search"in P&&t(10,u=P.search),"archived"in P&&t(11,f=P.archived)},n.$$.update=()=>{n.$$.dirty&4096&&t(6,i=m==Oa),n.$$.dirty&11264&&(u!==-1||f!==-1)&&(ve(sn,o=!0,o),clearTimeout(h),t(13,h=setTimeout(()=>_(1),50))),n.$$.dirty&3072&&t(5,s=u||f),n.$$.dirty&1&&t(4,l=a.filter(P=>{var M,A,D;return(D=(A=(M=P.expand)==null?void 0:M.projectUserPreferences_via_project)==null?void 0:A[0])==null?void 0:D.favorite})),n.$$.dirty&1&&t(3,r=a.filter(P=>{var M,A,D;return!((D=(A=(M=P.expand)==null?void 0:M.projectUserPreferences_via_project)==null?void 0:A[0])!=null&&D.favorite)}))},[a,c,d,r,l,s,i,o,_,g,u,f,m,h,T,L,O,C,S]}class Zg extends ye{constructor(e){super(),we(this,e,Bg,zg,he,{search:10,archived:11})}}function Yg(n){let e,t,i;function s(r){n[5](r)}let l={class:"projects-filter-select fade m-l-xs",items:n[3]};return n[2]!==void 0&&(l.keyOfSelected=n[2]),e=new cn({props:l}),le.push(()=>Pe(e,"keyOfSelected",s)),{c(){W(e.$$.fragment)},m(r,o){$(e,r,o),i=!0},p(r,o){const a={};!t&&o&4&&(t=!0,a.keyOfSelected=r[2],je(()=>t=!1)),e.$set(a)},i(r){i||(E(e.$$.fragment,r),i=!0)},o(r){j(e.$$.fragment,r),i=!1},d(r){F(e,r)}}}function Kg(n){let e,t,i,s,l,r,o;function a(m){n[6](m)}let u={placeholder:"Search projects...",$$slots:{suffix:[Yg]},$$scope:{ctx:n}};n[1]!==void 0&&(u.value=n[1]),e=new md({props:u}),le.push(()=>Pe(e,"value",a));function f(m){n[7](m)}function c(m){n[8](m)}let d={};return n[1]!==void 0&&(d.search=n[1]),n[2]!==void 0&&(d.archived=n[2]),s=new Zg({props:d}),le.push(()=>Pe(s,"search",f)),le.push(()=>Pe(s,"archived",c)),{c(){W(e.$$.fragment),i=I(),W(s.$$.fragment)},m(m,h){$(e,m,h),k(m,i,h),$(s,m,h),o=!0},p(m,h){const _={};h&1028&&(_.$$scope={dirty:h,ctx:m}),!t&&h&2&&(t=!0,_.value=m[1],je(()=>t=!1)),e.$set(_);const b={};!l&&h&2&&(l=!0,b.search=m[1],je(()=>l=!1)),!r&&h&4&&(r=!0,b.archived=m[2],je(()=>r=!1)),s.$set(b)},i(m){o||(E(e.$$.fragment,m),E(s.$$.fragment,m),o=!0)},o(m){j(e.$$.fragment,m),j(s.$$.fragment,m),o=!1},d(m){m&&v(i),F(e,m),F(s,m)}}}function Gg(n){let e,t;return{c(){e=w("nav"),t=w("div"),t.textContent=`${wd}`,p(t,"class","breadcrumb-item"),p(e,"class","breadcrumbs")},m(i,s){k(i,e,s),y(e,t)},p:Q,d(i){i&&v(e)}}}function Jg(n){let e,t,i;return{c(){e=w("button"),e.innerHTML='<i class="iconoir-plus"></i> <div class="txt">New project</div>',p(e,"type","button"),p(e,"class","btn btn-primary")},m(s,l){k(s,e,l),t||(i=H(e,"click",n[4]),t=!0)},p:Q,d(s){s&&v(e),t=!1,i()}}}function Xg(n){let e,t,i,s;e=new ji({props:{title:wd,$$slots:{"header-right":[Jg],"header-left":[Gg],default:[Kg]},$$scope:{ctx:n}}});let l={};return i=new gd({props:l}),n[9](i),{c(){W(e.$$.fragment),t=I(),W(i.$$.fragment)},m(r,o){$(e,r,o),k(r,t,o),$(i,r,o),s=!0},p(r,[o]){const a={};o&1031&&(a.$$scope={dirty:o,ctx:r}),e.$set(a);const u={};i.$set(u)},i(r){s||(E(e.$$.fragment,r),E(i.$$.fragment,r),s=!0)},o(r){j(e.$$.fragment,r),j(i.$$.fragment,r),s=!1},d(r){r&&v(t),F(e,r),n[9](null),F(i,r)}}}const wd="Projects";function Qg(n,e,t){const i=[{label:"Active projects",value:!1},{label:"Archived projects",value:!0}];let s,l="",r=!1;const o=()=>s==null?void 0:s.show();function a(m){r=m,t(2,r)}function u(m){l=m,t(1,l)}function f(m){l=m,t(1,l)}function c(m){r=m,t(2,r)}function d(m){le[m?"unshift":"push"](()=>{s=m,t(0,s)})}return[s,l,r,i,o,a,u,f,c,d]}class xg extends ye{constructor(e){super(),we(this,e,Qg,Xg,he,{})}}function eb(n){let e,t,i,s,l,r,o,a;return{c(){e=w("label"),t=ee("Title"),s=I(),l=w("input"),p(e,"for",i=n[18]),p(l,"type","text"),p(l,"id",r=n[18]),l.required=!0},m(u,f){k(u,e,f),y(e,t),k(u,s,f),k(u,l,f),_e(l,n[1].title),o||(a=[H(l,"input",n[9]),H(l,"input",n[10])],o=!0)},p(u,f){f&262144&&i!==(i=u[18])&&p(e,"for",i),f&262144&&r!==(r=u[18])&&p(l,"id",r),f&2&&l.value!==u[1].title&&_e(l,u[1].title)},d(u){u&&(v(e),v(s),v(l)),o=!1,pe(a)}}}function tb(n){let e,t,i,s,l,r,o,a,u,f;t=new Oe({props:{class:"form-field required",name:"title",$$slots:{default:[eb,({uniqueId:m})=>({18:m}),({uniqueId:m})=>m?262144:0]},$$scope:{ctx:n}}});function c(m){n[11](m)}let d={};return n[1]!==void 0&&(d.prototype=n[1]),r=new _d({props:d}),le.push(()=>Pe(r,"prototype",c)),{c(){e=w("form"),W(t.$$.fragment),i=I(),s=w("div"),s.innerHTML='Type<sup class="txt-danger">*</sup>',l=I(),W(r.$$.fragment),p(s,"class","block m-b-10"),p(e,"id",n[5]),p(e,"class","content")},m(m,h){k(m,e,h),$(t,e,null),y(e,i),y(e,s),y(e,l),$(r,e,null),a=!0,u||(f=H(e,"submit",be(n[6])),u=!0)},p(m,h){const _={};h&786438&&(_.$$scope={dirty:h,ctx:m}),t.$set(_);const b={};!o&&h&2&&(o=!0,b.prototype=m[1],je(()=>o=!1)),r.$set(b)},i(m){a||(E(t.$$.fragment,m),E(r.$$.fragment,m),a=!0)},o(m){j(t.$$.fragment,m),j(r.$$.fragment,m),a=!1},d(m){m&&v(e),F(t),F(r),u=!1,f()}}}function nb(n){let e,t=n[1].id?"Update prototype":"Create prototype",i;return{c(){e=w("h5"),i=ee(t),p(e,"class","block txt-center")},m(s,l){k(s,e,l),y(e,i)},p(s,l){l&2&&t!==(t=s[1].id?"Update prototype":"Create prototype")&&ke(i,t)},d(s){s&&v(e)}}}function ib(n){let e,t,i,s,l,r=n[1].id?"Update prototype":"Create prototype",o,a,u;return{c(){e=w("button"),t=w("span"),t.textContent="Cancel",i=I(),s=w("button"),l=w("span"),o=ee(r),p(t,"class","txt"),p(e,"type","button"),p(e,"class","btn btn-transparent"),e.disabled=n[4],p(l,"class","txt"),p(s,"type","submit"),p(s,"form",n[5]),p(s,"class","btn btn-expanded btn-primary m-l-auto"),s.disabled=n[4],Z(s,"btn-loading",n[4])},m(f,c){k(f,e,c),y(e,t),k(f,i,c),k(f,s,c),y(s,l),y(l,o),a||(u=H(e,"click",n[8]),a=!0)},p(f,c){c&16&&(e.disabled=f[4]),c&2&&r!==(r=f[1].id?"Update prototype":"Create prototype")&&ke(o,r),c&16&&(s.disabled=f[4]),c&16&&Z(s,"btn-loading",f[4])},d(f){f&&(v(e),v(i),v(s)),a=!1,u()}}}function sb(n){let e,t,i={popup:!0,overlayClose:!n[4],escHide:!n[4],beforeHide:n[12],$$slots:{footer:[ib],header:[nb],default:[tb]},$$scope:{ctx:n}};return e=new dn({props:i}),n[13](e),e.$on("show",n[14]),e.$on("hide",n[15]),{c(){W(e.$$.fragment)},m(s,l){$(e,s,l),t=!0},p(s,[l]){const r={};l&16&&(r.overlayClose=!s[4]),l&16&&(r.escHide=!s[4]),l&16&&(r.beforeHide=s[12]),l&524310&&(r.$$scope={dirty:l,ctx:s}),e.$set(r)},i(s){t||(E(e.$$.fragment,s),t=!0)},o(s){j(e.$$.fragment,s),t=!1},d(s){n[13](null),F(e,s)}}}function lb(n,e,t){const i="prototype_"+J.randomString(5),s=tt();let l,r={},o=!1,a=!1;function u(C){return c(),t(1,r=Object.assign({},C)),l==null?void 0:l.show()}function f(){return l==null?void 0:l.hide()}function c(){Kt({}),t(2,a=!1)}async function d(){if(!(!r.project||o)){t(4,o=!0);try{let C;r.id?(C=await z.collection("prototypes").update(r.id,r),_t(`Successfully updated prototype ${r.title}.`)):(C=await z.collection("prototypes").create(r),_t(`Successfully created prototype ${r.title}.`)),t(4,o=!1),f(),s("submit",C)}catch(C){C.isAbort||(t(4,o=!1),z.error(C))}}}const m=()=>f(),h=()=>{t(2,a=!0)};function _(){r.title=this.value,t(1,r),t(2,a)}function b(C){r=C,t(1,r),t(2,a)}const g=()=>!o;function T(C){le[C?"unshift":"push"](()=>{l=C,t(3,l)})}function L(C){$e.call(this,n,C)}function O(C){$e.call(this,n,C)}return n.$$.update=()=>{n.$$.dirty&6&&!a&&!r.id&&t(1,r.title=r.size?"Mobile":"Desktop",r)},[f,r,a,l,o,i,d,u,m,h,_,b,g,T,L,O]}class rb extends ye{constructor(e){super(),we(this,e,lb,sb,he,{show:7,hide:0})}get show(){return this.$$.ctx[7]}get hide(){return this.$$.ctx[0]}}const ob=n=>({}),Ca=n=>({});function Ea(n,e,t){const i=n.slice();return i[19]=e[t],i}const ab=n=>({}),La=n=>({});function ub(n){let e,t,i=[],s=new Map,l,r,o,a,u,f;const c=n[9].before,d=st(c,n,n[16],La);let m=Ee(n[2]);const h=g=>g[19].id;for(let g=0;g<m.length;g+=1){let T=Ea(n,m,g),L=h(T);s.set(L,i[g]=Ia(L,T))}const _=n[9].after,b=st(_,n,n[16],Ca);return{c(){e=w("nav"),d&&d.c(),t=I();for(let g=0;g<i.length;g+=1)i[g].c();l=I(),r=w("button"),r.innerHTML='<i class="iconoir-plus"></i>',o=I(),b&&b.c(),p(r,"type","button"),p(r,"class","btn btn-circle btn-transparent link-hint"),p(e,"class","prototypes-bar entrance-left svelte-fzv0qw")},m(g,T){k(g,e,T),d&&d.m(e,null),y(e,t);for(let L=0;L<i.length;L+=1)i[L]&&i[L].m(e,null);y(e,l),y(e,r),y(e,o),b&&b.m(e,null),a=!0,u||(f=[ge(Te.call(null,r,{text:"New prototype",position:"right"})),H(r,"click",n[6])],u=!0)},p(g,T){d&&d.p&&(!a||T&65536)&&rt(d,c,g,g[16],a?lt(c,g[16],T,ab):ot(g[16]),La),T&61&&(m=Ee(g[2]),ae(),i=kt(i,T,h,1,g,m,s,e,jt,Ia,l,Ea),ue()),b&&b.p&&(!a||T&65536)&&rt(b,_,g,g[16],a?lt(_,g[16],T,ob):ot(g[16]),Ca)},i(g){if(!a){E(d,g);for(let T=0;T<m.length;T+=1)E(i[T]);E(b,g),a=!0}},o(g){j(d,g);for(let T=0;T<i.length;T+=1)j(i[T]);j(b,g),a=!1},d(g){g&&v(e),d&&d.d(g);for(let T=0;T<i.length;T+=1)i[T].d();b&&b.d(g),u=!1,pe(f)}}}function fb(n){let e,t,i,s,l,r,o,a,u,f;return{c(){e=w("div"),t=w("div"),t.innerHTML='<i class="iconoir-pen-tablet"></i>',i=I(),s=w("h6"),s.textContent="The project doesn't have any prototypes yet!",l=I(),r=w("div"),r.innerHTML="<p>Create a new desktop or mobile prototype.</p>",o=I(),a=w("button"),a.innerHTML='<i class="iconoir-plus"></i> <span class="txt">New prototype</span>',p(t,"class","icon"),p(s,"class","title"),p(r,"class","content"),p(a,"type","button"),p(a,"class","btn btn-expanded btn-primary btn-lg m-t-base"),p(e,"class","placeholder-block entrance-top")},m(c,d){k(c,e,d),y(e,t),y(e,i),y(e,s),y(e,l),y(e,r),y(e,o),y(e,a),u||(f=H(a,"click",n[6]),u=!0)},p:Q,i:Q,o:Q,d(c){c&&v(e),u=!1,f()}}}function cb(n){let e;return{c(){e=w("div"),e.innerHTML='<span class="loader loader-lg"></span>',p(e,"class","block txt-center m-t-lg")},m(t,i){k(t,e,i)},p:Q,i:Q,o:Q,d(t){t&&v(e)}}}function db(n){let e,t,i,s,l,r,o,a,u;function f(){return n[10](n[19])}function c(){return n[11](n[19])}function d(){return n[12](n[19])}return{c(){e=w("button"),e.innerHTML='<i class="iconoir-edit-pencil"></i> <span class="txt">Edit</span>',t=I(),i=w("button"),i.innerHTML='<i class="iconoir-copy"></i> <span class="txt">Duplicate</span>',s=I(),l=w("hr"),r=I(),o=w("button"),o.innerHTML='<i class="iconoir-trash"></i> <span class="txt">Delete</span>',p(e,"type","button"),p(e,"class","dropdown-item closable"),p(i,"type","button"),p(i,"class","dropdown-item closable"),p(o,"type","button"),p(o,"class","dropdown-item link-danger closable")},m(m,h){k(m,e,h),k(m,t,h),k(m,i,h),k(m,s,h),k(m,l,h),k(m,r,h),k(m,o,h),a||(u=[H(e,"click",be(f)),H(i,"click",be(c)),H(o,"click",be(d))],a=!0)},p(m,h){n=m},d(m){m&&(v(e),v(t),v(i),v(s),v(l),v(r),v(o)),a=!1,pe(u)}}}function Ia(n,e){let t,i,s,l,r,o=e[19].title+"",a,u,f,c,d,m,h,_,b,g,T;h=new At({props:{class:"dropdown dropdown-nowrap dropdown-sm dropdown-right",$$slots:{default:[db]},$$scope:{ctx:e}}});function L(){return e[13](e[19])}return{key:n,first:null,c(){var O;t=w("button"),i=w("i"),l=I(),r=w("span"),a=ee(o),u=I(),f=w("div"),c=w("div"),d=w("i"),m=I(),W(h.$$.fragment),p(i,"class",s=_r(J.getPrototypeIcon(e[19]))+" svelte-fzv0qw"),p(r,"class","txt txt-ellipsis"),p(d,"class","iconoir-more-vert txt-sm txt-sm"),p(c,"class","meta-item"),p(f,"class","meta"),p(t,"type","button"),p(t,"class",_="btn "+(((O=e[3])==null?void 0:O.id)==e[19].id?"btn-semitransparent":"btn-transparent link-hint")),this.first=t},m(O,C){k(O,t,C),y(t,i),y(t,l),y(t,r),y(r,a),y(t,u),y(t,f),y(f,c),y(c,d),y(c,m),$(h,c,null),b=!0,g||(T=H(t,"click",be(L)),g=!0)},p(O,C){var P;e=O,(!b||C&4&&s!==(s=_r(J.getPrototypeIcon(e[19]))+" svelte-fzv0qw"))&&p(i,"class",s),(!b||C&4)&&o!==(o=e[19].title+"")&&ke(a,o);const S={};C&65541&&(S.$$scope={dirty:C,ctx:e}),h.$set(S),(!b||C&12&&_!==(_="btn "+(((P=e[3])==null?void 0:P.id)==e[19].id?"btn-semitransparent":"btn-transparent link-hint")))&&p(t,"class",_)},i(O){b||(E(h.$$.fragment,O),b=!0)},o(O){j(h.$$.fragment,O),b=!1},d(O){O&&v(t),F(h),g=!1,T()}}}function pb(n){let e,t,i,s,l;const r=[cb,fb,ub],o=[];function a(f,c){return f[1]?0:!f[1]&&!f[2].length?1:2}e=a(n),t=o[e]=r[e](n);let u={};return s=new rb({props:u}),n[14](s),s.$on("submit",n[15]),{c(){t.c(),i=I(),W(s.$$.fragment)},m(f,c){o[e].m(f,c),k(f,i,c),$(s,f,c),l=!0},p(f,[c]){let d=e;e=a(f),e===d?o[e].p(f,c):(ae(),j(o[d],1,1,()=>{o[d]=null}),ue(),t=o[e],t?t.p(f,c):(t=o[e]=r[e](f),t.c()),E(t,1),t.m(i.parentNode,i));const m={};s.$set(m)},i(f){l||(E(t),E(s.$$.fragment,f),l=!0)},o(f){j(t),j(s.$$.fragment,f),l=!1},d(f){f&&v(i),o[e].d(f),n[14](null),F(s,f)}}}function mb(n,e,t){let i,s,l;x(n,oi,S=>t(1,i=S)),x(n,qt,S=>t(2,s=S)),x(n,Tt,S=>t(3,l=S));let{$$slots:r={},$$scope:o}=e,{projectId:a}=e,{initialPrototypeId:u=""}=e,f;async function c(S,P){if(S){ve(oi,i=!0,i);try{ve(Tt,l=P,l),ve(qt,s=await z.collection("prototypes").getFullList({filter:`project="${S}"`,sort:"created"}),s),ve(oi,i=!1,i)}catch(M){M!=null&&M.isAbort||(z.error(M),ve(oi,i=!1,i))}}}function d(S){S!=null&&S.id&&Lt("Do you really want to delete the selected prototype and all its screens?",()=>z.collection("prototypes").delete(S.id).then(()=>{nd(S),_t(`Successfully deleted prototype ${S.title}.`)}).catch(P=>{z.error(P)}))}function m(S){Lt("Do you really want to duplicate the selected prototype and all of its screens and hotspots?",async()=>h(S))}async function h(S){if(S!=null&&S.id)try{const P=await z.send("/api/pr/duplicate-prototype/"+encodeURIComponent(S.id),{method:"POST"});yi(P,!0)}catch(P){P.isAbort||z.error(P)}}function _(){f==null||f.show({project:a})}const b=S=>f==null?void 0:f.show(S),g=S=>m(S),T=S=>d(S),L=S=>{ve(Tt,l=S.id,l)};function O(S){le[S?"unshift":"push"](()=>{f=S,t(0,f)})}const C=S=>{S.detail&&yi(S.detail,!0)};return n.$$set=S=>{"projectId"in S&&t(7,a=S.projectId),"initialPrototypeId"in S&&t(8,u=S.initialPrototypeId),"$$scope"in S&&t(16,o=S.$$scope)},n.$$.update=()=>{n.$$.dirty&384&&c(a,u)},[f,i,s,l,d,m,_,a,u,r,b,g,T,L,O,C,o]}class hb extends ye{constructor(e){super(),we(this,e,mb,pb,he,{projectId:7,initialPrototypeId:8})}}function yd(n,{from:e,to:t},i={}){const s=getComputedStyle(n),l=s.transform==="none"?"":s.transform,[r,o]=s.transformOrigin.split(" ").map(parseFloat),a=e.left+e.width*r/t.width-(t.left+r),u=e.top+e.height*o/t.height-(t.top+o),{delay:f=0,duration:c=m=>Math.sqrt(m)*120,easing:d=Ql}=i;return{delay:f,duration:Qe(c)?c(Math.sqrt(a*a+u*u)):c,easing:d,css:(m,h)=>{const _=h*a,b=h*u,g=m+h*e.width/t.width,T=m+h*e.height/t.height;return`transform: ${l} translate(${_}px, ${b}px) scale(${g}, ${T});`}}}const _b=n=>({dragover:n&1}),ja=n=>({dragover:n[0]});function gb(n){let e,t,i,s;const l=n[3].default,r=st(l,n,n[2],ja);return{c(){e=w("div"),r&&r.c()},m(o,a){k(o,e,a),r&&r.m(e,null),t=!0,i||(s=[H(e,"dragover",Be(be(n[4]))),H(e,"dragenter",Be(be(n[5]))),H(e,"dragleave",be(n[6])),H(e,"drop",Be(be(n[7])))],i=!0)},p(o,[a]){r&&r.p&&(!t||a&5)&&rt(r,l,o,o[2],t?lt(l,o[2],a,_b):ot(o[2]),ja)},i(o){t||(E(r,o),t=!0)},o(o){j(r,o),t=!1},d(o){o&&v(e),r&&r.d(o),i=!1,pe(s)}}}function bb(n,e,t){let{$$slots:i={},$$scope:s}=e;const l=tt();let r=!1;function o(c){$e.call(this,n,c)}const a=c=>{t(0,r=!0),l("dragenter")},u=c=>{c.currentTarget.contains(c.relatedTarget)||(c.stopPropagation(),t(0,r=!1),l("dragleave"))},f=c=>{t(0,r=!1),c.dataTransfer.files.length&&l("drop",c.dataTransfer.files)};return n.$$set=c=>{"$$scope"in c&&t(2,s=c.$$scope)},[r,l,s,i,o,a,u,f]}class vd extends ye{constructor(e){super(),we(this,e,bb,gb,he,{})}}const wb=n=>({dragging:n&4,dragover:n&8}),Pa=n=>({dragging:n[2],dragover:n[3]});function yb(n){let e,t,i,s,l;const r=n[10].default,o=st(r,n,n[9],Pa);return{c(){e=w("div"),o&&o.c(),p(e,"draggable",t=!n[1]),p(e,"class","sortable svelte-beosc3"),Z(e,"dragging",n[2]),Z(e,"dragover",n[3])},m(a,u){k(a,e,u),o&&o.m(e,null),i=!0,s||(l=[H(e,"dragover",be(n[11])),H(e,"dragleave",be(n[12])),H(e,"dragend",n[13]),H(e,"dragstart",n[14]),H(e,"drop",be(n[15]))],s=!0)},p(a,[u]){o&&o.p&&(!i||u&524)&&rt(o,r,a,a[9],i?lt(r,a[9],u,wb):ot(a[9]),Pa),(!i||u&2&&t!==(t=!a[1]))&&p(e,"draggable",t),(!i||u&4)&&Z(e,"dragging",a[2]),(!i||u&8)&&Z(e,"dragover",a[3])},i(a){i||(E(o,a),i=!0)},o(a){j(o,a),i=!1},d(a){a&&v(e),o&&o.d(a),s=!1,pe(l)}}}function vb(n,e,t){let{$$slots:i={},$$scope:s}=e;const l=tt();let{index:r}=e,{list:o=[]}=e,{group:a="default"}=e,{disabled:u=!1}=e,{dragHandleClass:f=""}=e,c=!1,d=!1;function m(O,C){if(!(!O||u)){if(f&&!O.target.classList.contains(f)){t(3,d=!1),t(2,c=!1),O.preventDefault();return}t(2,c=!0),O.dataTransfer.effectAllowed="move",O.dataTransfer.dropEffect="move",O.dataTransfer.setData("text/plain",JSON.stringify({index:C,group:a})),l("drag",O)}}function h(O,C){if(t(3,d=!1),t(2,c=!1),!O||u)return;O.dataTransfer.dropEffect="move";let S={};try{S=JSON.parse(O.dataTransfer.getData("text/plain"))}catch{}if(S.group!=a)return;const P=S.index<<0;P<C?(o.splice(C+1,0,o[P]),o.splice(P,1)):(o.splice(C,0,o[P]),o.splice(P+1,1)),t(6,o),l("sort",{oldIndex:P,newIndex:C,list:o})}const _=()=>{t(3,d=!0)},b=()=>{t(3,d=!1)},g=()=>{t(3,d=!1),t(2,c=!1)},T=O=>m(O,r),L=O=>h(O,r);return n.$$set=O=>{"index"in O&&t(0,r=O.index),"list"in O&&t(6,o=O.list),"group"in O&&t(7,a=O.group),"disabled"in O&&t(1,u=O.disabled),"dragHandleClass"in O&&t(8,f=O.dragHandleClass),"$$scope"in O&&t(9,s=O.$$scope)},[r,u,c,d,m,h,o,a,f,s,i,_,b,g,T,L]}class kb extends ye{constructor(e){super(),we(this,e,vb,yb,he,{index:0,list:6,group:7,disabled:1,dragHandleClass:8})}}const Sb=n=>({uniqueId:n&1,isUploading:n&4,dragover:n&16384}),Na=n=>({uniqueId:n[0],isUploading:n[2],dragover:n[14]});function Tb(n){let e,t,i,s,l;const r=n[4].default,o=st(r,n,n[10],Na);return{c(){e=w("input"),t=I(),o&&o.c(),e.multiple=!0,p(e,"id",n[0]),p(e,"type","file"),p(e,"accept","image/*"),p(e,"class","hidden")},m(a,u){k(a,e,u),n[7](e),k(a,t,u),o&&o.m(a,u),i=!0,s||(l=H(e,"change",n[8]),s=!0)},p(a,u){(!i||u&1)&&p(e,"id",a[0]),o&&o.p&&(!i||u&17413)&&rt(o,r,a,a[10],i?lt(r,a[10],u,Sb):ot(a[10]),Na)},i(a){i||(E(o,a),i=!0)},o(a){j(o,a),i=!1},d(a){a&&(v(e),v(t)),n[7](null),o&&o.d(a),s=!1,l()}}}function Ob(n){let e,t,i,s;return e=new vd({props:{$$slots:{default:[Tb,({dragover:l})=>({14:l}),({dragover:l})=>l?16384:0]},$$scope:{ctx:n}}}),e.$on("drop",n[9]),{c(){W(e.$$.fragment)},m(l,r){$(e,l,r),t=!0,i||(s=[H(window,"drop",be(n[6])),H(window,"dragover",Be(be(n[5])))],i=!0)},p(l,[r]){const o={};r&17415&&(o.$$scope={dirty:r,ctx:l}),e.$set(o)},i(l){t||(E(e.$$.fragment,l),t=!0)},o(l){j(e.$$.fragment,l),t=!1},d(l){F(e,l),i=!1,pe(s)}}}function Cb(n,e,t){let i,s;x(n,Tt,g=>t(11,i=g)),x(n,dt,g=>t(12,s=g));let{$$slots:l={},$$scope:r}=e;const o=tt();let{id:a="uploader_"+J.randomString(5)}=e,u,f=!1;async function c(g){if(f||!(i!=null&&i.id)||!(g!=null&&g.length))return;t(2,f=!0);const T=[];let L=[];for(let S=0;S<g.length;S++){const P=g.item(S);let M="s"+S;M+=J.randomString(15-M.length);const A=s==null?void 0:s[s.length-1],D=new FormData;D.append("id",M),D.append("file",P),D.append("title",P.name.split(".").slice(0,-1).join(".")||P.name),D.append("prototype",i.id),D.append("background",(A==null?void 0:A.background)||""),D.append("alignment",(A==null?void 0:A.alignment)||""),T.push(z.collection("screens").create(D,{requestKey:null})),L.push(M)}const O=[],C={};try{const S=await Promise.allSettled(T);for(const M of S)M.status==="fulfilled"?(C[M.value.id]=M.value,jn(M.value)):O.push(M);L=L.filter(M=>!!C[M]);const P=await z.collection("prototypes").update(i.id,{screensOrder:i.screensOrder.concat(L)},{$autoCancel:!1});yi(P),o("upload",Object.values(C)),u&&t(1,u.value="",u)}catch(S){console.warn("screens upload error:",S)}O.length>0&&(console.warn("failed to upload:",O),Kl("Failed to upload some of the selected files.")),t(2,f=!1)}function d(g){$e.call(this,n,g)}const m=g=>{c(g.dataTransfer.files)};function h(g){le[g?"unshift":"push"](()=>{u=g,t(1,u)})}const _=g=>c(g.target.files),b=g=>{c(g.detail)};return n.$$set=g=>{"id"in g&&t(0,a=g.id),"$$scope"in g&&t(10,r=g.$$scope)},[a,u,f,c,l,d,m,h,_,b,r]}class Eb extends ye{constructor(e){super(),we(this,e,Cb,Ob,he,{id:0})}}function Aa(n,e,t){const i=n.slice();return i[41]=e[t],i}function Da(n,e,t){var o,a,u,f,c;const i=n.slice();i[46]=e[t],i[50]=e,i[51]=t;const s=(o=i[10])==null?void 0:o.filter(function(...m){return n[31](i[46],...m)}).length;i[47]=s;const l=(a=i[10])==null?void 0:a.filter(function(...m){return n[32](i[46],...m)}).length;i[48]=l;const r=i[48]+(((c=(f=(u=i[46].expand)==null?void 0:u.comments_via_screen)==null?void 0:f.filter(d=>!d.replyTo&&!d.resolved))==null?void 0:c.length)||0);return i[49]=r,i}function Lb(n){let e,t=[],i=new Map,s,l,r,o,a,u,f=Ee(n[5]?n[8].slice(0,n[5]):n[8]);const c=m=>{var h;return((h=m[3])==null?void 0:h.id)+m[46].id};for(let m=0;m<f.length;m+=1){let h=Da(n,f,m),_=c(h);i.set(_,t[m]=Ra(_,h))}r=new Eb({props:{id:"screen_uploader",$$slots:{default:[qb,({dragover:m,isUploading:h})=>({44:m,45:h}),({dragover:m,isUploading:h})=>[0,(m?8192:0)|(h?16384:0)]]},$$scope:{ctx:n}}}),r.$on("upload",Wb);let d=n[7]&&Ha(n);return{c(){e=w("div");for(let m=0;m<t.length;m+=1)t[m].c();s=I(),l=w("div"),W(r.$$.fragment),o=I(),d&&d.c(),a=Ne(),p(l,"class","card card-placeholder"),p(e,"class","cards-list compact screens-list entrance-top"),Z(e,"reordering",n[4])},m(m,h){k(m,e,h);for(let _=0;_<t.length;_+=1)t[_]&&t[_].m(e,null);y(e,s),y(e,l),$(r,l,null),k(m,o,h),d&&d.m(m,h),k(m,a,h),u=!0},p(m,h){if(h[0]&140601|h[1]&2105344){f=Ee(m[5]?m[8].slice(0,m[5]):m[8]),ae();for(let b=0;b<t.length;b+=1)t[b].r();t=kt(t,h,c,1,m,f,i,e,Bf,Ra,s,Da);for(let b=0;b<t.length;b+=1)t[b].a();ue()}const _={};h[1]&4218880&&(_.$$scope={dirty:h,ctx:m}),r.$set(_),(!u||h[0]&16)&&Z(e,"reordering",m[4]),m[7]?d?(d.p(m,h),h[0]&128&&E(d,1)):(d=Ha(m),d.c(),E(d,1),d.m(a.parentNode,a)):d&&(ae(),j(d,1,1,()=>{d=null}),ue())},i(m){if(!u){for(let h=0;h<f.length;h+=1)E(t[h]);E(r.$$.fragment,m),E(d),u=!0}},o(m){for(let h=0;h<t.length;h+=1)j(t[h]);j(r.$$.fragment,m),j(d),u=!1},d(m){m&&(v(e),v(o),v(a));for(let h=0;h<t.length;h+=1)t[h].d();F(r),d&&d.d(m)}}}function Ib(n){let e;return{c(){e=w("div"),e.innerHTML='<span class="loader loader-lg"></span>',p(e,"class","block txt-center m-t-lg")},m(t,i){k(t,e,i)},p:Q,i:Q,o:Q,d(t){t&&v(e)}}}function jb(n){let e;return{c(){e=w("i"),p(e,"class","iconoir-media-image")},m(t,i){k(t,e,i)},p:Q,i:Q,o:Q,d(t){t&&v(e)}}}function Pb(n){let e,t,i;return t=new Gt({props:{src:z.files.getURL(n[46],n[46].file,{thumb:"450x0"}),alt:n[46].title,draggable:!1}}),{c(){e=w("div"),W(t.$$.fragment),p(e,"class","card-img"),Ue(e,"background-color",n[46].background)},m(s,l){k(s,e,l),$(t,e,null),i=!0},p(s,l){const r={};l[0]&288&&(r.src=z.files.getURL(s[46],s[46].file,{thumb:"450x0"})),l[0]&288&&(r.alt=s[46].title),t.$set(r),l[0]&288&&Ue(e,"background-color",s[46].background)},i(s){i||(E(t.$$.fragment,s),i=!0)},o(s){j(t.$$.fragment,s),i=!1},d(s){s&&v(e),F(t)}}}function Nb(n){let e;return{c(){e=w("span"),p(e,"class","loader loader-lg")},m(t,i){k(t,e,i)},p:Q,i:Q,o:Q,d(t){t&&v(e)}}}function Ab(n){let e,t,i,s,l,r,o;function a(){n[23].call(e,n[46])}function u(...f){return n[24](n[46],...f)}return{c(){e=w("input"),i=I(),s=w("label"),p(e,"type","checkbox"),p(e,"id",t=n[52]),p(s,"for",l=n[52])},m(f,c){k(f,e,c),e.checked=n[0][n[46].id],k(f,i,c),k(f,s,c),r||(o=[H(e,"change",a),H(e,"change",u)],r=!0)},p(f,c){n=f,c[1]&2097152&&t!==(t=n[52])&&p(e,"id",t),c[0]&289&&(e.checked=n[0][n[46].id]),c[1]&2097152&&l!==(l=n[52])&&p(s,"for",l)},d(f){f&&(v(e),v(i),v(s)),r=!1,pe(o)}}}function Db(n){let e,t,i;function s(){return n[25](n[46])}return{c(){e=w("div"),e.innerHTML='<i class="iconoir-trash"></i> <span class="txt">Delete</span>',p(e,"class","dropdown-item link-danger closable")},m(l,r){k(l,e,r),t||(i=H(e,"click",Be(be(s))),t=!0)},p(l,r){n=l},d(l){l&&v(e),t=!1,i()}}}function Mb(n){let e,t,i,s,l,r,o,a,u,f,c,d,m,h,_,b,g,T,L;const O=[Nb,Pb,jb],C=[];function S(P,M){return P[46].isReplacing?0:P[46].file?1:2}return t=S(n),i=C[t]=O[t](n),u=new Oe({props:{class:"form-field m-0",$$slots:{default:[Ab,({uniqueId:P})=>({52:P}),({uniqueId:P})=>[0,P?2097152:0]]},$$scope:{ctx:n}}}),_=new At({props:{class:"dropdown dropdown-sm",$$slots:{default:[Db]},$$scope:{ctx:n}}}),{c(){e=w("figure"),i.c(),s=I(),l=w("a"),r=w("div"),r.innerHTML='<i class="iconoir-play-solid preview-icon"></i>',o=I(),a=w("div"),W(u.$$.fragment),f=I(),c=w("div"),d=w("button"),m=w("i"),h=I(),W(_.$$.fragment),p(r,"class","ctrl ctrl-center"),p(a,"class","ctrl ctrl-top-left"),p(m,"class","iconoir-more-vert"),p(d,"type","button"),p(d,"class","btn btn-sm btn-circle btn-transparent fade"),p(c,"class","ctrl ctrl-top-right"),p(l,"href",b=`/projects/${n[3].project}/prototypes/${n[3].id}/screens/${n[46].id}`),p(l,"class","card-overlay handle"),p(l,"draggable",!1),p(e,"class","card-featured"),p(e,"draggable",!1),Z(e,"dragover",n[44])},m(P,M){k(P,e,M),C[t].m(e,null),y(e,s),y(e,l),y(l,r),y(l,o),y(l,a),$(u,a,null),y(l,f),y(l,c),y(c,d),y(d,m),y(d,h),$(_,d,null),g=!0,T||(L=[H(a,"click",Be(n[22])),H(d,"mousedown",Be(be(n[20]))),H(d,"click",Be(be(n[21]))),ge(Si.call(null,l))],T=!0)},p(P,M){let A=t;t=S(P),t===A?C[t].p(P,M):(ae(),j(C[A],1,1,()=>{C[A]=null}),ue(),i=C[t],i?i.p(P,M):(i=C[t]=O[t](P),i.c()),E(i,1),i.m(e,s));const D={};M[0]&289|M[1]&6291456&&(D.$$scope={dirty:M,ctx:P}),u.$set(D);const R={};M[0]&288|M[1]&4194304&&(R.$$scope={dirty:M,ctx:P}),_.$set(R),(!g||M[0]&296&&b!==(b=`/projects/${P[3].project}/prototypes/${P[3].id}/screens/${P[46].id}`))&&p(l,"href",b),(!g||M[1]&8192)&&Z(e,"dragover",P[44])},i(P){g||(E(i),E(u.$$.fragment,P),E(_.$$.fragment,P),g=!0)},o(P){j(i),j(u.$$.fragment,P),j(_.$$.fragment,P),g=!1},d(P){P&&v(e),C[t].d(),F(u),F(_),T=!1,pe(L)}}}function Rb(n){let e,t,i;function s(r){n[26](r)}let l={index:n[51],$$slots:{default:[Mb]},$$scope:{ctx:n}};return n[8]!==void 0&&(l.list=n[8]),e=new kb({props:l}),le.push(()=>Pe(e,"list",s)),e.$on("drag",n[27]),e.$on("sort",n[28]),{c(){W(e.$$.fragment)},m(r,o){$(e,r,o),i=!0},p(r,o){const a={};o[0]&288&&(a.index=r[51]),o[0]&297|o[1]&4202496&&(a.$$scope={dirty:o,ctx:r}),!t&&o[0]&256&&(t=!0,a.list=r[8],je(()=>t=!1)),e.$set(a)},i(r){i||(E(e.$$.fragment,r),i=!0)},o(r){j(e.$$.fragment,r),i=!1},d(r){F(e,r)}}}function Ma(n){let e,t,i,s,l=n[49]+"",r,o,a,u;return{c(){e=w("div"),t=w("i"),i=I(),s=w("span"),r=ee(l),p(t,"class","iconoir-message-text"),p(s,"class","txt"),p(e,"class","meta-item"),Z(e,"txt-warning",n[47]>0)},m(f,c){k(f,e,c),y(e,t),y(e,i),y(e,s),y(s,r),a||(u=ge(o=Te.call(null,e,n[49]+" unresolved"+(n[47]?`
`+n[47]+" unread":""))),a=!0)},p(f,c){n=f,c[0]&1312&&l!==(l=n[49]+"")&&ke(r,l),o&&Qe(o.update)&&c[0]&1312&&o.update.call(null,n[49]+" unresolved"+(n[47]?`
`+n[47]+" unread":"")),c[0]&1312&&Z(e,"txt-warning",n[47]>0)},d(f){f&&v(e),a=!1,u()}}}function Ra(n,e){let t,i,s,l,r,o,a,u,f,c,d,m,h=Q,_,b,g;function T(...S){return e[29](e[46],...S)}i=new vd({props:{$$slots:{default:[Rb,({dragover:S})=>({44:S}),({dragover:S})=>[0,S?8192:0]]},$$scope:{ctx:e}}}),i.$on("drop",T);function L(S){e[30](S,e[46],e[50],e[51])}let O={tag:"h5",class:"title",collection:"screens"};e[46]!==void 0&&(O.model=e[46]),r=new rr({props:O}),le.push(()=>Pe(r,"model",L));let C=e[49]&&Ma(e);return{key:n,first:null,c(){t=w("div"),W(i.$$.fragment),s=I(),l=w("div"),W(r.$$.fragment),a=I(),u=w("div"),C&&C.c(),f=I(),c=w("div"),c.innerHTML='<div class="iconoir-calendar"></div>',p(c,"class","meta-item"),p(u,"class","meta"),p(l,"class","card-content"),p(t,"class","card screen-card"),Z(t,"selected",e[0][e[46].id]),this.first=t},m(S,P){k(S,t,P),$(i,t,null),y(t,s),y(t,l),$(r,l,null),y(l,a),y(l,u),C&&C.m(u,null),y(u,f),y(u,c),_=!0,b||(g=ge(d=Te.call(null,c,{text:"Created "+J.relativeDate(e[46].created),sub:J.formatToLocalDate(e[46].created)})),b=!0)},p(S,P){e=S;const M={};P[0]&297|P[1]&4202496&&(M.$$scope={dirty:P,ctx:e}),i.$set(M);const A={};!o&&P[0]&288&&(o=!0,A.model=e[46],je(()=>o=!1)),r.$set(A),e[49]?C?C.p(e,P):(C=Ma(e),C.c(),C.m(u,f)):C&&(C.d(1),C=null),d&&Qe(d.update)&&P[0]&288&&d.update.call(null,{text:"Created "+J.relativeDate(e[46].created),sub:J.formatToLocalDate(e[46].created)}),(!_||P[0]&289)&&Z(t,"selected",e[0][e[46].id])},r(){m=t.getBoundingClientRect()},f(){Hf(t),h()},a(){h(),h=Rf(t,m,yd,{duration:200,delay:50})},i(S){_||(E(i.$$.fragment,S),E(r.$$.fragment,S),_=!0)},o(S){j(i.$$.fragment,S),j(r.$$.fragment,S),_=!1},d(S){S&&v(t),F(i),F(r),C&&C.d(),b=!1,g()}}}function Hb(n){let e,t,i,s,l;return{c(){e=w("div"),e.innerHTML='<i class="iconoir-upload-square"></i>',t=I(),i=w("div"),i.textContent="Upload screens",s=I(),l=w("div"),l.textContent="Drop or click here to upload new screens",p(e,"class","icon"),p(i,"class","title"),p(l,"class","content")},m(r,o){k(r,e,o),k(r,t,o),k(r,i,o),k(r,s,o),k(r,l,o)},d(r){r&&(v(e),v(t),v(i),v(s),v(l))}}}function Ub(n){let e;return{c(){e=w("span"),p(e,"class","loader loader-primary")},m(t,i){k(t,e,i)},d(t){t&&v(e)}}}function qb(n){let e,t;function i(r,o){return r[45]?Ub:Hb}let s=i(n),l=s(n);return{c(){e=w("label"),t=w("div"),l.c(),p(t,"class","placeholder"),p(e,"for","screen_uploader"),p(e,"class","card-featured"),Z(e,"dragover",n[44]),Z(e,"no-pointer-events",n[45])},m(r,o){k(r,e,o),y(e,t),l.m(t,null)},p(r,o){s!==(s=i(r))&&(l.d(1),l=s(r),l&&(l.c(),l.m(t,null))),o[1]&8192&&Z(e,"dragover",r[44]),o[1]&16384&&Z(e,"no-pointer-events",r[45])},d(r){r&&v(e),l.d()}}}function Ha(n){let e,t,i,s,l,r,o=n[7]==1?"screen":"screens",a,u,f,c,d,m,h,_,b,g,T,L,O=n[11].length>1&&Ua(n);return{c(){e=w("div"),t=w("div"),i=ee("Selected "),s=w("strong"),l=ee(n[7]),r=I(),a=ee(o),u=I(),O&&O.c(),f=I(),c=w("button"),d=w("span"),d.textContent="Delete",m=I(),h=w("button"),_=w("i"),p(t,"class","info"),p(d,"class","txt"),p(c,"type","button"),p(c,"class","btn btn-sm btn-semitransparent btn-danger btn-expanded-sm"),c.disabled=n[6],Z(c,"btn-loading",n[1]),p(_,"class","iconoir-xmark"),p(h,"type","button"),p(h,"class","btn btn-sm btn-circle btn-transparent m-l-auto"),h.disabled=n[6],p(e,"class","bulk-bar")},m(C,S){k(C,e,S),y(e,t),y(t,i),y(t,s),y(s,l),y(s,r),y(s,a),y(e,u),O&&O.m(e,null),y(e,f),y(e,c),y(c,d),y(e,m),y(e,h),y(h,_),g=!0,T||(L=[H(c,"click",n[16]),ge(Te.call(null,h,{position:"top",text:"Clear selection"})),H(h,"click",n[14])],T=!0)},p(C,S){(!g||S[0]&128)&&ke(l,C[7]),(!g||S[0]&128)&&o!==(o=C[7]==1?"screen":"screens")&&ke(a,o),C[11].length>1?O?(O.p(C,S),S[0]&2048&&E(O,1)):(O=Ua(C),O.c(),E(O,1),O.m(e,f)):O&&(ae(),j(O,1,1,()=>{O=null}),ue()),(!g||S[0]&64)&&(c.disabled=C[6]),(!g||S[0]&2)&&Z(c,"btn-loading",C[1]),(!g||S[0]&64)&&(h.disabled=C[6])},i(C){g||(E(O),C&&vt(()=>{g&&(b||(b=ft(e,In,{duration:150,y:10,opacity:0},!0)),b.run(1))}),g=!0)},o(C){j(O),C&&(b||(b=ft(e,In,{duration:150,y:10,opacity:0},!1)),b.run(0)),g=!1},d(C){C&&v(e),O&&O.d(),C&&b&&b.end(),T=!1,pe(L)}}}function Ua(n){let e,t,i,s,l,r,o;return r=new At({props:{class:"dropdown dropdown-upside dropdown-sm",$$slots:{default:[$b]},$$scope:{ctx:n}}}),{c(){e=w("button"),t=w("span"),t.textContent="Move to",i=I(),s=w("i"),l=I(),W(r.$$.fragment),p(t,"class","txt"),p(s,"class","iconoir-nav-arrow-down"),p(e,"type","button"),p(e,"class","btn btn-sm btn-semitransparent btn-expanded-sm"),e.disabled=n[6],Z(e,"btn-loading",n[2])},m(a,u){k(a,e,u),y(e,t),y(e,i),y(e,s),y(e,l),$(r,e,null),o=!0},p(a,u){const f={};u[0]&2056|u[1]&4194304&&(f.$$scope={dirty:u,ctx:a}),r.$set(f),(!o||u[0]&64)&&(e.disabled=a[6]),(!o||u[0]&4)&&Z(e,"btn-loading",a[2])},i(a){o||(E(r.$$.fragment,a),o=!0)},o(a){j(r.$$.fragment,a),o=!1},d(a){a&&v(e),F(r)}}}function qa(n){let e,t,i=n[41].title+"",s,l,r,o;function a(){return n[33](n[41])}return{c(){e=w("button"),t=w("span"),s=ee(i),l=I(),p(t,"class","txt"),p(e,"type","button"),p(e,"class","dropdown-item closable")},m(u,f){k(u,e,f),y(e,t),y(t,s),y(e,l),r||(o=H(e,"click",a),r=!0)},p(u,f){n=u,f[0]&2048&&i!==(i=n[41].title+"")&&ke(s,i)},d(u){u&&v(e),r=!1,o()}}}function $a(n,e){var l;let t,i,s=e[41].id!=((l=e[3])==null?void 0:l.id)&&qa(e);return{key:n,first:null,c(){t=Ne(),s&&s.c(),i=Ne(),this.first=t},m(r,o){k(r,t,o),s&&s.m(r,o),k(r,i,o)},p(r,o){var a;e=r,e[41].id!=((a=e[3])==null?void 0:a.id)?s?s.p(e,o):(s=qa(e),s.c(),s.m(i.parentNode,i)):s&&(s.d(1),s=null)},d(r){r&&(v(t),v(i)),s&&s.d(r)}}}function $b(n){let e=[],t=new Map,i,s=Ee(n[11]);const l=r=>r[41].id;for(let r=0;r<s.length;r+=1){let o=Aa(n,s,r),a=l(o);t.set(a,e[r]=$a(a,o))}return{c(){for(let r=0;r<e.length;r+=1)e[r].c();i=Ne()},m(r,o){for(let a=0;a<e.length;a+=1)e[a]&&e[a].m(r,o);k(r,i,o)},p(r,o){o[0]&34824&&(s=Ee(r[11]),e=kt(e,o,l,1,r,s,t,i.parentNode,zf,$a,i,Aa))},d(r){r&&v(i);for(let o=0;o<e.length;o+=1)e[o].d(r)}}}function Fb(n){let e,t,i,s,l,r;const o=[Ib,Lb],a=[];function u(f,c){var d;return f[9]&&!f[8].length?0:(d=f[3])!=null&&d.id?1:-1}return~(e=u(n))&&(t=a[e]=o[e](n)),{c(){t&&t.c(),i=Ne()},m(f,c){~e&&a[e].m(f,c),k(f,i,c),s=!0,l||(r=H(window,"keydown",n[12]),l=!0)},p(f,c){let d=e;e=u(f),e===d?~e&&a[e].p(f,c):(t&&(ae(),j(a[d],1,1,()=>{a[d]=null}),ue()),~e?(t=a[e],t?t.p(f,c):(t=a[e]=o[e](f),t.c()),E(t,1),t.m(i.parentNode,i)):t=null)},i(f){s||(E(t),s=!0)},o(f){j(t),s=!1},d(f){f&&v(i),~e&&a[e].d(f),l=!1,r()}}}function Fa(n,e){if(!(e!=null&&e.length)||!n.length)return n;let t,i;return n.sort((s,l)=>(t=e.findIndex(r=>r==s.id),i=e.findIndex(r=>r==l.id),t>=0&&i>=0?t<i?-1:t>i?1:0:s.created<l.created?-1:s.created>l.created?1:0)),n}function Wb(){var n;(n=document.querySelector(".screens-list"))==null||n.scrollIntoView({behavior:"smooth",block:"end"})}function Vb(n,e,t){let i,s,l,r,o,a,u;x(n,dt,K=>t(8,l=K)),x(n,Tt,K=>t(3,r=K)),x(n,Hi,K=>t(9,o=K)),x(n,gn,K=>t(10,a=K)),x(n,qt,K=>t(11,u=K));let f={},c=!1,d=!1,m=!1,h=0,_,b,g;async function T(){for(t(18,_=r==null?void 0:r.id),t(19,b=JSON.stringify(r==null?void 0:r.screensOrder)),P(),t(5,h=50),await L();h<l.length;)await J.yieldToMain(),t(5,h+=15);t(5,h=0)}async function L(){if(r!=null&&r.id){tr(),nr(r.id),ve(Hi,o=!0,o);try{let K=await z.collection("screens").getFullList({filter:`prototype="${r.id}"`,expand:"comments_via_screen",fields:"*,expand.comments_via_screen.id,expand.comments_via_screen.replyTo,expand.comments_via_screen.resolved",sort:"created"});ve(dt,l=Fa(K,r.screensOrder),l),ve(Hi,o=!1,o)}catch(K){K!=null&&K.isAbort||(z.error(K),ve(Hi,o=!1,o))}}}function O(){t(19,b=JSON.stringify(r==null?void 0:r.screensOrder)),clearTimeout(g),g=setTimeout(()=>{ve(dt,l=Fa(l,r.screensOrder),l)},200)}function C(K){if(K.ctrlKey&&K.code=="KeyA"&&!J.isInput(K.target)){K.preventDefault();for(const se of l)t(0,f[se.id]=!0,f)}}async function S(){const K=l.map(ne=>ne.id),se=JSON.stringify(r.screensOrder),q=JSON.stringify(K);if(se!=q)try{t(4,m=!0),clearTimeout(g),t(19,b=q),ve(Tt,r.screensOrder=K,r),await z.collection("prototypes").update(r.id,{screensOrder:K}),t(4,m=!1)}catch(ne){ne.isAbort||(t(4,m=!1),z.error(ne))}}function P(){t(0,f={})}async function M(K){const se=Object.keys(f);Lt(`Do you really want to move the selected ${se.length} ${se.length==1?"screen":"screens"}?`,async()=>A(K))}async function A(K){const se=Object.keys(f);if(!(!se.length||!(K!=null&&K.id)||s)){t(2,d=!0);try{const q=[],ne={prototype:K.id};for(let He of se)q.push(z.collection("screens").update(He,ne,{requestKey:"move_"+He}));q.push(z.collection("prototypes").update(r.id,{"screensOrder-":se})),await Promise.all(q),P(),ve(Tt,r=K.id,r)}catch(q){z.error(q)}t(2,d=!1)}}function D(){const K=Object.keys(f);Lt(`Do you really want to delete the selected ${K.length} ${K.length==1?"screen":"screens"}?`,async()=>R())}async function R(){const K=Object.keys(f);if(!(!K.length||s)){t(1,c=!0);try{const se=K.map(ne=>z.collection("screens").delete(ne));await Promise.all(se);const q=l.filter(ne=>K.includes(ne.id));for(const ne of q)Ll(ne);P(),S(),_t(`Successfully deleted ${K.length} ${K.length==1?"screen":"screens"}.`)}catch(se){se.isAbort||(z.error(se),T())}t(1,c=!1)}}async function Y(K){Lt(`Do you really want to delete ${K.title}?`,async()=>G(K),()=>{var se;(se=document.activeElement)==null||se.blur()})}async function G(K){try{await z.collection("screens").delete(K.id),Ll(K),P(),_t(`Successfully deleted screen ${K.title}.`)}catch(se){se.isAbort||(z.error(se),T())}}Yt(()=>{clearTimeout(g),Rt==null||Rt()});function B(K){$e.call(this,n,K)}function N(K){$e.call(this,n,K)}function V(K){$e.call(this,n,K)}function te(K){f[K.id]=this.checked,t(0,f)}const X=(K,se)=>{se.target.checked||(delete f[K.id],t(0,f),se.target.blur())},U=K=>Y(K);function ce(K){l=K,dt.set(l)}const oe=K=>{if(!K.detail)return;const se=document.createElement("div");se.className="draggable-ghost",document.body.appendChild(se),K.detail.dataTransfer.setDragImage(se,0,0),setTimeout(()=>{se==null||se.remove()},0)},de=()=>{S()},Ce=(K,se)=>{m||sr(K,se.detail[0])};function xe(K,se,q,ne){q[ne]=K,t(5,h)}const at=(K,se)=>{var q,ne;return((ne=(q=se.expand)==null?void 0:q.comment)==null?void 0:ne.screen)==K.id},nt=(K,se)=>{var q,ne,He,ht,qe,it;return!((ne=(q=se.expand)==null?void 0:q.comment)!=null&&ne.replyTo)&&!((ht=(He=se.expand)==null?void 0:He.comment)!=null&&ht.resolved)&&((it=(qe=se.expand)==null?void 0:qe.comment)==null?void 0:it.screen)==K.id},ct=K=>M(K);return n.$$.update=()=>{n.$$.dirty[0]&262152&&_!=(r==null?void 0:r.id)&&T(),n.$$.dirty[0]&786440&&_&&b!=JSON.stringify(r==null?void 0:r.screensOrder)&&O(),n.$$.dirty[0]&1&&t(7,i=Object.keys(f).length),n.$$.dirty[0]&6&&t(6,s=c||d)},[f,c,d,r,m,h,s,i,l,o,a,u,C,S,P,M,D,Y,_,b,B,N,V,te,X,U,ce,oe,de,Ce,xe,at,nt,ct]}class zb extends ye{constructor(e){super(),we(this,e,Vb,Fb,he,{},null,[-1,-1])}}function Wa(n){let e,t,i=n[0].name&&Va(n),s=n[2]&&za();return{c(){e=w("div"),i&&i.c(),t=I(),s&&s.c(),p(e,"class","row")},m(l,r){k(l,e,r),i&&i.m(e,null),y(e,t),s&&s.m(e,null)},p(l,r){l[0].name?i?i.p(l,r):(i=Va(l),i.c(),i.m(e,t)):i&&(i.d(1),i=null),l[2]?s||(s=za(),s.c(),s.m(e,null)):s&&(s.d(1),s=null)},d(l){l&&v(e),i&&i.d(),s&&s.d()}}}function Va(n){let e,t=n[0].name+"",i,s;return{c(){e=w("span"),i=ee(t),p(e,"class","user-name txt-ellipsis"),p(e,"title",s=n[0].name)},m(l,r){k(l,e,r),y(e,i)},p(l,r){r&1&&t!==(t=l[0].name+"")&&ke(i,t),r&1&&s!==(s=l[0].name)&&p(e,"title",s)},d(l){l&&v(e)}}}function za(n){let e;return{c(){e=w("span"),e.textContent="You",p(e,"class","label label-sm label-warning")},m(t,i){k(t,e,i)},d(t){t&&v(e)}}}function Ba(n){let e,t,i,s=n[0].email+"",l,r;return{c(){e=w("small"),e.textContent="|",t=I(),i=w("small"),l=ee(s),p(i,"class","user-email txt-ellipsis"),p(i,"title",r=n[0].email)},m(o,a){k(o,e,a),k(o,t,a),k(o,i,a),y(i,l)},p(o,a){a&1&&s!==(s=o[0].email+"")&&ke(l,s),a&1&&r!==(r=o[0].email)&&p(i,"title",r)},d(o){o&&(v(e),v(t),v(i))}}}function Bb(n){let e,t,i,s,l,r,o,a,u=n[0].username+"",f,c,d,m,h,_;t=new ts({props:{user:n[0]}});let b=(n[0].name||n[2])&&Wa(n),g=n[0].email&&Ba(n);const T=n[5].default,L=st(T,n,n[4],null);return{c(){e=w("div"),W(t.$$.fragment),i=I(),s=w("div"),b&&b.c(),l=I(),r=w("div"),o=w("small"),a=ee("@"),f=ee(u),d=I(),g&&g.c(),m=I(),L&&L.c(),p(o,"class","user-username txt-ellipsis"),p(o,"title",c="@"+n[0].username),p(r,"class","row txt-hint"),p(s,"class","content"),p(e,"class",h="list-item "+n[1])},m(O,C){k(O,e,C),$(t,e,null),y(e,i),y(e,s),b&&b.m(s,null),y(s,l),y(s,r),y(r,o),y(o,a),y(o,f),y(r,d),g&&g.m(r,null),y(e,m),L&&L.m(e,null),_=!0},p(O,[C]){const S={};C&1&&(S.user=O[0]),t.$set(S),O[0].name||O[2]?b?b.p(O,C):(b=Wa(O),b.c(),b.m(s,l)):b&&(b.d(1),b=null),(!_||C&1)&&u!==(u=O[0].username+"")&&ke(f,u),(!_||C&1&&c!==(c="@"+O[0].username))&&p(o,"title",c),O[0].email?g?g.p(O,C):(g=Ba(O),g.c(),g.m(r,null)):g&&(g.d(1),g=null),L&&L.p&&(!_||C&16)&&rt(L,T,O,O[4],_?lt(T,O[4],C,null):ot(O[4]),null),(!_||C&2&&h!==(h="list-item "+O[1]))&&p(e,"class",h)},i(O){_||(E(t.$$.fragment,O),E(L,O),_=!0)},o(O){j(t.$$.fragment,O),j(L,O),_=!1},d(O){O&&v(e),F(t),b&&b.d(),g&&g.d(),L&&L.d(O)}}}function Zb(n,e,t){let i,s;x(n,Xn,u=>t(3,s=u));let{$$slots:l={},$$scope:r}=e,{user:o={}}=e,{class:a=""}=e;return n.$$set=u=>{"user"in u&&t(0,o=u.user),"class"in u&&t(1,a=u.class),"$$scope"in u&&t(4,r=u.$$scope)},n.$$.update=()=>{n.$$.dirty&9&&t(2,i=(s==null?void 0:s.id)==o.id)},[o,a,i,s,r,l]}class kd extends ye{constructor(e){super(),we(this,e,Zb,Bb,he,{user:0,class:1})}}function Za(n,e,t){const i=n.slice();return i[31]=e[t],i}function Ya(n,e,t){const i=n.slice();return i[28]=e[t],i}function Ka(n,e,t){const i=n.slice();return i[31]=e[t],i}function Ga(n,e,t){const i=n.slice();return i[28]=e[t],i}function Yb(n){let e=[],t=new Map,i,s,l=Ee(n[8]);const r=a=>a[31].id;for(let a=0;a<l.length;a+=1){let u=Ka(n,l,a),f=r(u);t.set(f,e[a]=Xa(f,u))}let o=null;return l.length||(o=Ja()),{c(){for(let a=0;a<e.length;a+=1)e[a].c();i=Ne(),o&&o.c()},m(a,u){for(let f=0;f<e.length;f+=1)e[f]&&e[f].m(a,u);k(a,i,u),o&&o.m(a,u),s=!0},p(a,u){u[0]&2340&&(l=Ee(a[8]),ae(),e=kt(e,u,r,1,a,l,t,i.parentNode,jt,Xa,i,Ka),ue(),!l.length&&o?o.p(a,u):l.length?o&&(o.d(1),o=null):(o=Ja(),o.c(),o.m(i.parentNode,i)))},i(a){if(!s){for(let u=0;u<l.length;u+=1)E(e[u]);s=!0}},o(a){for(let u=0;u<e.length;u+=1)j(e[u]);s=!1},d(a){a&&v(i);for(let u=0;u<e.length;u+=1)e[u].d(a);o&&o.d(a)}}}function Kb(n){let e,t=Ee(Array(n[2].users.length||1)),i=[];for(let s=0;s<t.length;s+=1)i[s]=Qa(Ga(n,t,s));return{c(){for(let s=0;s<i.length;s+=1)i[s].c();e=Ne()},m(s,l){for(let r=0;r<i.length;r+=1)i[r]&&i[r].m(s,l);k(s,e,l)},p(s,l){if(l[0]&4){t=Ee(Array(s[2].users.length||1));let r;for(r=0;r<t.length;r+=1){const o=Ga(s,t,r);i[r]?i[r].p(o,l):(i[r]=Qa(),i[r].c(),i[r].m(e.parentNode,e))}for(;r<i.length;r+=1)i[r].d(1);i.length=t.length}},i:Q,o:Q,d(s){s&&v(e),tn(i,s)}}}function Ja(n){let e;return{c(){e=w("div"),e.innerHTML='<div class="block txt-center p-5"><span class="txt-hint">The project doesn&#39;t have any owners yet.</span></div> ',p(e,"class","list-item txt-hint")},m(t,i){k(t,e,i)},p:Q,d(t){t&&v(e)}}}function Gb(n){let e,t,i,s,l,r,o;function a(){return n[15](n[31])}return{c(){e=w("button"),t=w("span"),t.textContent="Revoke access",l=I(),p(t,"class","txt"),p(e,"type","button"),p(e,"class","btn btn-sm btn-semitransparent btn-danger"),e.disabled=i=n[2].users.length==1||n[5]},m(u,f){k(u,e,f),y(e,t),k(u,l,f),r||(o=[ge(s=Te.call(null,e,n[2].users.length==1?"You can't remove the only project owner":"")),H(e,"click",be(a))],r=!0)},p(u,f){n=u,f[0]&36&&i!==(i=n[2].users.length==1||n[5])&&(e.disabled=i),s&&Qe(s.update)&&f[0]&4&&s.update.call(null,n[2].users.length==1?"You can't remove the only project owner":"")},d(u){u&&(v(e),v(l)),r=!1,pe(o)}}}function Xa(n,e){let t,i,s;return i=new kd({props:{user:e[31],$$slots:{default:[Gb]},$$scope:{ctx:e}}}),{key:n,first:null,c(){t=Ne(),W(i.$$.fragment),this.first=t},m(l,r){k(l,t,r),$(i,l,r),s=!0},p(l,r){e=l;const o={};r[0]&256&&(o.user=e[31]),r[0]&292|r[1]&128&&(o.$$scope={dirty:r,ctx:e}),i.$set(o)},i(l){s||(E(i.$$.fragment,l),s=!0)},o(l){j(i.$$.fragment,l),s=!1},d(l){l&&v(t),F(i,l)}}}function Qa(n){let e;return{c(){e=w("div"),e.innerHTML='<figure class="thumb thumb-circle"></figure> <div class="content"><div class="skeleton-loader"></div></div> ',p(e,"class","list-item")},m(t,i){k(t,e,i)},p:Q,d(t){t&&v(e)}}}function xa(n){let e;return{c(){e=w("div"),p(e,"class","clearfix m-b-sm")},m(t,i){k(t,e,i)},d(t){t&&v(e)}}}function Jb(n){let e;return{c(){e=w("div"),e.innerHTML='<div class="block txt-center"><span class="txt-hint">No users found.</span></div>',p(e,"class","list-item svelte-1tb8gd9")},m(t,i){k(t,e,i)},p:Q,i:Q,o:Q,d(t){t&&v(e)}}}function Xb(n){let e=[],t=new Map,i,s,l=Ee(n[6]);const r=o=>o[31].id;for(let o=0;o<l.length;o+=1){let a=Za(n,l,o),u=r(a);t.set(u,e[o]=eu(u,a))}return{c(){for(let o=0;o<e.length;o+=1)e[o].c();i=Ne()},m(o,a){for(let u=0;u<e.length;u+=1)e[u]&&e[u].m(o,a);k(o,i,a),s=!0},p(o,a){a[0]&1104&&(l=Ee(o[6]),ae(),e=kt(e,a,r,1,o,l,t,i.parentNode,jt,eu,i,Za),ue())},i(o){if(!s){for(let a=0;a<l.length;a+=1)E(e[a]);s=!0}},o(o){for(let a=0;a<e.length;a+=1)j(e[a]);s=!1},d(o){o&&v(i);for(let a=0;a<e.length;a+=1)e[a].d(o)}}}function Qb(n){let e,t=Ee(Array(n[6].length||1)),i=[];for(let s=0;s<t.length;s+=1)i[s]=tu(Ya(n,t,s));return{c(){for(let s=0;s<i.length;s+=1)i[s].c();e=Ne()},m(s,l){for(let r=0;r<i.length;r+=1)i[r]&&i[r].m(s,l);k(s,e,l)},p(s,l){if(l[0]&64){t=Ee(Array(s[6].length||1));let r;for(r=0;r<t.length;r+=1){const o=Ya(s,t,r);i[r]?i[r].p(o,l):(i[r]=tu(),i[r].c(),i[r].m(e.parentNode,e))}for(;r<i.length;r+=1)i[r].d(1);i.length=t.length}},i:Q,o:Q,d(s){s&&v(e),tn(i,s)}}}function xb(n){let e,t,i,s,l;function r(){return n[17](n[31])}return{c(){e=w("button"),t=w("span"),t.textContent="Add",i=I(),p(t,"class","txt"),p(e,"type","button"),p(e,"class","btn btn-sm btn-expanded-sm btn-semitransparent"),e.disabled=n[4]},m(o,a){k(o,e,a),y(e,t),k(o,i,a),s||(l=H(e,"click",be(r)),s=!0)},p(o,a){n=o,a[0]&16&&(e.disabled=n[4])},d(o){o&&(v(e),v(i)),s=!1,l()}}}function eu(n,e){let t,i,s;return i=new kd({props:{user:e[31],$$slots:{default:[xb]},$$scope:{ctx:e}}}),{key:n,first:null,c(){t=Ne(),W(i.$$.fragment),this.first=t},m(l,r){k(l,t,r),$(i,l,r),s=!0},p(l,r){e=l;const o={};r[0]&64&&(o.user=e[31]),r[0]&80|r[1]&128&&(o.$$scope={dirty:r,ctx:e}),i.$set(o)},i(l){s||(E(i.$$.fragment,l),s=!0)},o(l){j(i.$$.fragment,l),s=!1},d(l){l&&v(t),F(i,l)}}}function tu(n){let e;return{c(){e=w("div"),e.innerHTML='<figure class="thumb thumb-circle"></figure> <div class="content"><div class="skeleton-loader"></div></div> ',p(e,"class","list-item svelte-1tb8gd9")},m(t,i){k(t,e,i)},p:Q,d(t){t&&v(e)}}}function e0(n){let e,t,i,s,l,r,o,a,u,f,c,d,m,h,_,b;const g=[Kb,Yb],T=[];function L(D,R){return D[9]?0:1}s=L(n),l=T[s]=g[s](n);function O(D){n[16](D)}let C={class:"m-b-0",placeholder:"Search users..."};n[1]!==void 0&&(C.value=n[1]),u=new md({props:C}),le.push(()=>Pe(u,"value",O));let S=(n[7]||n[1])&&xa();const P=[Qb,Xb,Jb],M=[];function A(D,R){return D[7]?0:D[6].length?1:D[1]?2:-1}return~(h=A(n))&&(_=M[h]=P[h](n)),{c(){e=w("h6"),e.textContent="Current owners",t=I(),i=w("div"),l.c(),r=I(),o=w("hr"),a=I(),W(u.$$.fragment),c=I(),S&&S.c(),d=I(),m=w("div"),_&&_.c(),p(e,"class","m-b-sm"),p(i,"class","list list-current-owners"),p(m,"class","list list-suggestions svelte-1tb8gd9")},m(D,R){k(D,e,R),k(D,t,R),k(D,i,R),T[s].m(i,null),k(D,r,R),k(D,o,R),k(D,a,R),$(u,D,R),k(D,c,R),S&&S.m(D,R),k(D,d,R),k(D,m,R),~h&&M[h].m(m,null),b=!0},p(D,R){let Y=s;s=L(D),s===Y?T[s].p(D,R):(ae(),j(T[Y],1,1,()=>{T[Y]=null}),ue(),l=T[s],l?l.p(D,R):(l=T[s]=g[s](D),l.c()),E(l,1),l.m(i,null));const G={};!f&&R[0]&2&&(f=!0,G.value=D[1],je(()=>f=!1)),u.$set(G),D[7]||D[1]?S||(S=xa(),S.c(),S.m(d.parentNode,d)):S&&(S.d(1),S=null);let B=h;h=A(D),h===B?~h&&M[h].p(D,R):(_&&(ae(),j(M[B],1,1,()=>{M[B]=null}),ue()),~h?(_=M[h],_?_.p(D,R):(_=M[h]=P[h](D),_.c()),E(_,1),_.m(m,null)):_=null)},i(D){b||(E(l),E(u.$$.fragment,D),E(_),b=!0)},o(D){j(l),j(u.$$.fragment,D),j(_),b=!1},d(D){D&&(v(e),v(t),v(i),v(r),v(o),v(a),v(c),v(d),v(m)),T[s].d(),F(u,D),S&&S.d(D),~h&&M[h].d()}}}function t0(n){let e;return{c(){e=w("h5"),e.textContent="Manage project owners",p(e,"class","block txt-center")},m(t,i){k(t,e,i)},p:Q,d(t){t&&v(e)}}}function n0(n){let e,t,i,s,l;return{c(){e=w("button"),t=w("span"),t.textContent="Close",p(t,"class","txt"),p(e,"type","button"),p(e,"class","btn btn-transparent m-r-auto"),e.disabled=i=n[4]||n[5]},m(r,o){k(r,e,o),y(e,t),s||(l=H(e,"click",n[14]),s=!0)},p(r,o){o[0]&48&&i!==(i=r[4]||r[5])&&(e.disabled=i)},d(r){r&&v(e),s=!1,l()}}}function i0(n){let e,t,i={popup:!0,overlayClose:!n[4],escHide:!n[4],beforeHide:n[18],$$slots:{footer:[n0],header:[t0],default:[e0]},$$scope:{ctx:n}};return e=new dn({props:i}),n[19](e),e.$on("show",n[20]),e.$on("hide",n[21]),{c(){W(e.$$.fragment)},m(s,l){$(e,s,l),t=!0},p(s,l){const r={};l[0]&16&&(r.overlayClose=!s[4]),l[0]&16&&(r.escHide=!s[4]),l[0]&16&&(r.beforeHide=s[18]),l[0]&1014|l[1]&128&&(r.$$scope={dirty:l,ctx:s}),e.$set(r)},i(s){t||(E(e.$$.fragment,s),t=!0)},o(s){j(e.$$.fragment,s),t=!1},d(s){n[19](null),F(e,s)}}}const nu="project_owners_list",ul="project_owners_suggestions";function s0(n,e,t){let i,s;x(n,un,N=>t(2,i=N)),x(n,Xn,N=>t(22,s=N));const l=tt();let r,o="",a=!1,u=!1,f=[],c=!1,d=[],m=!1,h;function _(){return g(),r==null?void 0:r.show()}function b(){return z.cancelRequest(nu),z.cancelRequest(ul),clearTimeout(h),r==null?void 0:r.hide()}async function g(){var N;if((N=i==null?void 0:i.users)!=null&&N.length){t(8,d=[]),t(9,m=!0);try{const V=await z.collection("users").getFullList({filter:i.users.map(te=>`id="${te}"`).join("||"),requestKey:nu});for(let te of i.users){const X=V.find(U=>U.id==te);X&&d.push(X)}t(9,m=!1)}catch(V){V.isAbort||(z.error(V),t(9,m=!1))}}}async function T(){var N,V;t(7,c=!0);try{let te=["username","name","email"].map(U=>`${U}~"${o.replaceAll('"',"")}"`).join("||");(N=i==null?void 0:i.users)!=null&&N.length&&(te=((V=i==null?void 0:i.users)==null?void 0:V.map(U=>`id!="${U}"`).join("&&"))+` && (${te})`);const X=await z.collection("users").getList(1,30,{filter:te,requestKey:ul});t(6,f=X.items),t(7,c=!1)}catch(te){te.isAbort||(z.error(te),t(7,c=!1))}}function L(N){Lt(`Do you really want to add user ${J.getUserDisplayName(N)} to the project owners?`,async()=>O(N))}async function O(N){if(!(a||!(N!=null&&N.id))){t(4,a=!0);try{const V=await z.collection("projects").update(i.id,{"users+":N.id});Gn(V),J.removeByKey(f,"id",N.id),t(6,f),t(1,o),t(13,h),f.length||t(1,o=""),_t(`Successfully added ${J.getUserDisplayName(N)} to the project owners list.`),l("add",N),t(4,a=!1)}catch(V){V.isAbort||(z.error(V),t(4,a=!1))}}}function C(N){let V=`Do you really want to remove the project access of user ${J.getUserDisplayName(N)}?`;s.id==N.id&&(V=`You no longer will have access to the project! 

Do you really want to remove your user from the project owners list?`),Lt(V,async()=>S(N))}async function S(N){if(!(u||!(N!=null&&N.id))){t(5,u=!0);try{const V=await z.collection("projects").update(i.id,{"users-":N.id});Gn(V),s.id==N.id?(_t(`Successfully removed your user from the ${i.title} owners list.`),Bt("/projects")):_t(`Successfully removed ${J.getUserDisplayName(N)} from the ${i.title} owners list.`),l("remove",N),J.removeByKey(d,"id",N.id),t(8,d),o&&T(),t(5,u=!1)}catch(V){V.isAbort||(z.error(V),t(5,u=!1))}}}Yt(()=>{b()});const P=()=>b(),M=N=>C(N);function A(N){o=N,t(1,o)}const D=N=>L(N),R=()=>!a;function Y(N){le[N?"unshift":"push"](()=>{r=N,t(3,r)})}function G(N){$e.call(this,n,N)}function B(N){$e.call(this,n,N)}return n.$$.update=()=>{n.$$.dirty[0]&8194&&(o?(t(7,c=!0),clearTimeout(h),t(13,h=setTimeout(T,100))):(clearTimeout(h),z.cancelRequest(ul),t(6,f=[]))),n.$$.dirty[0]&4&&(i==null?void 0:i.users)!==-1&&g()},[b,o,i,r,a,u,f,c,d,m,L,C,_,h,P,M,A,D,R,Y,G,B]}class l0 extends ye{constructor(e){super(),we(this,e,s0,i0,he,{show:12,hide:0},null,[-1,-1])}get show(){return this.$$.ctx[12]}get hide(){return this.$$.ctx[0]}}function r0(n){let e,t,i,s,l;return{c(){e=w("i"),p(e,"class",t=n[2]+" "+(n[3]?n[1]:n[0])),p(e,"aria-label","Copy")},m(r,o){k(r,e,o),s||(l=[ge(i=Te.call(null,e,n[3]?"":"Copy")),H(e,"click",Be(n[4]))],s=!0)},p(r,[o]){o&15&&t!==(t=r[2]+" "+(r[3]?r[1]:r[0]))&&p(e,"class",t),i&&Qe(i.update)&&o&8&&i.update.call(null,r[3]?"":"Copy")},i:Q,o:Q,d(r){r&&v(e),s=!1,pe(l)}}}function o0(n,e,t){let{value:i=""}=e,{idleClasses:s="iconoir-copy link-hint"}=e,{successClasses:l="iconoir-check txt-success"}=e,{successDuration:r=500}=e,{class:o=""}=e,a;function u(){i&&(J.copyToClipboard(i),clearTimeout(a),t(3,a=setTimeout(()=>{clearTimeout(a),t(3,a=null)},r)))}return Yt(()=>{a&&clearTimeout(a)}),n.$$set=f=>{"value"in f&&t(5,i=f.value),"idleClasses"in f&&t(0,s=f.idleClasses),"successClasses"in f&&t(1,l=f.successClasses),"successDuration"in f&&t(6,r=f.successDuration),"class"in f&&t(2,o=f.class)},[s,l,o,a,u,i,r]}class a0 extends ye{constructor(e){super(),we(this,e,o0,r0,he,{value:5,idleClasses:0,successClasses:1,successDuration:6,class:2})}}function iu(n){let e,t,i,s,l,r,o;return{c(){e=w("div"),t=w("div"),i=w("div"),s=w("a"),l=ee(n[10]),p(s,"href",n[10]),p(s,"target","_blank"),p(s,"rel","noopener noreferrer"),p(i,"class","content txt-center txt-bold"),p(t,"class","alert alert-warning m-0"),p(e,"class","col-12")},m(a,u){k(a,e,u),y(e,t),y(t,i),y(i,s),y(s,l),r||(o=ge(Te.call(null,s,"Open in new tab")),r=!0)},p(a,u){u&1024&&ke(l,a[10]),u&1024&&p(s,"href",a[10])},d(a){a&&v(e),r=!1,o()}}}function u0(n){let e,t,i,s,l,r,o,a;return{c(){e=w("input"),i=I(),s=w("label"),l=ee("Allow comments"),p(e,"type","checkbox"),p(e,"id",t=n[29]),p(s,"for",r=n[29])},m(u,f){k(u,e,f),e.checked=n[2].allowComments,k(u,i,f),k(u,s,f),y(s,l),o||(a=H(e,"change",n[16]),o=!0)},p(u,f){f&536870912&&t!==(t=u[29])&&p(e,"id",t),f&4&&(e.checked=u[2].allowComments),f&536870912&&r!==(r=u[29])&&p(s,"for",r)},d(u){u&&(v(e),v(i),v(s)),o=!1,a()}}}function su(n){let e,t,i,s,l,r,o,a;return{c(){e=w("span"),t=w("span"),t.textContent="Change password",i=I(),s=w("i"),p(t,"class","txt"),p(s,"class",l="iconoir-nav-arrow-"+(n[5]?"up":"down")),p(e,"class",r="inline-flex m-l-10 "+(n[5]?"link-base":"link-hint"))},m(u,f){k(u,e,f),y(e,t),y(e,i),y(e,s),o||(a=H(e,"click",Be(be(n[18]))),o=!0)},p(u,f){f&32&&l!==(l="iconoir-nav-arrow-"+(u[5]?"up":"down"))&&p(s,"class",l),f&32&&r!==(r="inline-flex m-l-10 "+(u[5]?"link-base":"link-hint"))&&p(e,"class",r)},d(u){u&&v(e),o=!1,a()}}}function f0(n){let e,t,i,s,l,r,o,a,u,f=n[2].passwordProtect&&n[8]&&su(n);return{c(){e=w("input"),i=I(),s=w("label"),l=w("div"),l.textContent="Protect with password",r=I(),f&&f.c(),p(e,"type","checkbox"),p(e,"id",t=n[29]),p(l,"class","txt"),p(s,"for",o=n[29])},m(c,d){k(c,e,d),e.checked=n[2].passwordProtect,k(c,i,d),k(c,s,d),y(s,l),y(s,r),f&&f.m(s,null),a||(u=H(e,"change",n[17]),a=!0)},p(c,d){d&536870912&&t!==(t=c[29])&&p(e,"id",t),d&4&&(e.checked=c[2].passwordProtect),c[2].passwordProtect&&c[8]?f?f.p(c,d):(f=su(c),f.c(),f.m(s,null)):f&&(f.d(1),f=null),d&536870912&&o!==(o=c[29])&&p(s,"for",o)},d(c){c&&(v(e),v(i),v(s)),f&&f.d(),a=!1,u()}}}function lu(n){let e,t,i,s;return t=new Oe({props:{class:"form-field form-field-toggle p-t-xs",name:"password",$$slots:{default:[c0,({uniqueId:l})=>({29:l}),({uniqueId:l})=>l?536870912:0]},$$scope:{ctx:n}}}),{c(){e=w("div"),W(t.$$.fragment),p(e,"class","block")},m(l,r){k(l,e,r),$(t,e,null),s=!0},p(l,r){const o={};r&1610612800&&(o.$$scope={dirty:r,ctx:l}),t.$set(o)},i(l){s||(E(t.$$.fragment,l),l&&vt(()=>{s&&(i||(i=ft(e,Ot,{duration:150},!0)),i.run(1))}),s=!0)},o(l){j(t.$$.fragment,l),l&&(i||(i=ft(e,Ot,{duration:150},!1)),i.run(0)),s=!1},d(l){l&&v(e),F(t),l&&i&&i.end()}}}function c0(n){let e,t,i,s;return{c(){e=w("input"),p(e,"type","password"),p(e,"id",t=n[29]),p(e,"placeholder","Password"),p(e,"minlength","5"),e.required=!0},m(l,r){k(l,e,r),_e(e,n[6]),i||(s=H(e,"input",n[19]),i=!0)},p(l,r){r&536870912&&t!==(t=l[29])&&p(e,"id",t),r&64&&e.value!==l[6]&&_e(e,l[6])},d(l){l&&v(e),i=!1,s()}}}function d0(n){let e,t,i,s,l,r,o,a,u,f;return{c(){var c;e=w("input"),l=I(),r=w("label"),o=ee("Restrict access to prototypes"),p(e,"type","checkbox"),p(e,"id",t=n[29]),e.checked=i=((c=n[2].onlyPrototypes)==null?void 0:c.length)>0,e.disabled=s=!n[9].length,p(r,"for",a=n[29])},m(c,d){k(c,e,d),k(c,l,d),k(c,r,d),y(r,o),u||(f=H(e,"change",n[20]),u=!0)},p(c,d){var m;d&536870912&&t!==(t=c[29])&&p(e,"id",t),d&4&&i!==(i=((m=c[2].onlyPrototypes)==null?void 0:m.length)>0)&&(e.checked=i),d&512&&s!==(s=!c[9].length)&&(e.disabled=s),d&536870912&&a!==(a=c[29])&&p(r,"for",a)},d(c){c&&(v(e),v(l),v(r)),u=!1,f()}}}function ru(n){let e,t,i,s;return t=new Oe({props:{class:"form-field link-prototypes-dropdown p-t-xs",$$slots:{default:[p0]},$$scope:{ctx:n}}}),{c(){e=w("div"),W(t.$$.fragment),p(e,"class","block")},m(l,r){k(l,e,r),$(t,e,null),s=!0},p(l,r){const o={};r&1073742340&&(o.$$scope={dirty:r,ctx:l}),t.$set(o)},i(l){s||(E(t.$$.fragment,l),l&&vt(()=>{s&&(i||(i=ft(e,Ot,{duration:150},!0)),i.run(1))}),s=!0)},o(l){j(t.$$.fragment,l),l&&(i||(i=ft(e,Ot,{duration:150},!1)),i.run(0)),s=!1},d(l){l&&v(e),F(t),l&&i&&i.end()}}}function p0(n){let e,t,i;function s(r){n[21](r)}let l={items:n[9],closable:!1,multiple:!0,upside:!0,selectPlaceholder:"Select prototypes"};return n[2].onlyPrototypes!==void 0&&(l.keyOfSelected=n[2].onlyPrototypes),e=new cn({props:l}),le.push(()=>Pe(e,"keyOfSelected",s)),{c(){W(e.$$.fragment)},m(r,o){$(e,r,o),i=!0},p(r,o){const a={};o&512&&(a.items=r[9]),!t&&o&4&&(t=!0,a.keyOfSelected=r[2].onlyPrototypes,je(()=>t=!1)),e.$set(a)},i(r){i||(E(e.$$.fragment,r),i=!0)},o(r){j(e.$$.fragment,r),i=!1},d(r){F(e,r)}}}function m0(n){let e,t,i,s,l,r,o,a,u,f,c,d,m,h,_=n[2].id&&iu(n);i=new Oe({props:{class:"form-field form-field-toggle",name:"allowComments",$$slots:{default:[u0,({uniqueId:T})=>({29:T}),({uniqueId:T})=>T?536870912:0]},$$scope:{ctx:n}}}),r=new Oe({props:{class:"form-field form-field-toggle",name:"passwordProtect",$$slots:{default:[f0,({uniqueId:T})=>({29:T}),({uniqueId:T})=>T?536870912:0]},$$scope:{ctx:n}}});let b=n[2].passwordProtect&&n[5]&&lu(n);f=new Oe({props:{class:"form-field form-field-toggle",$$slots:{default:[d0,({uniqueId:T})=>({29:T}),({uniqueId:T})=>T?536870912:0]},$$scope:{ctx:n}}});let g=n[4]&&ru(n);return{c(){e=w("form"),_&&_.c(),t=I(),W(i.$$.fragment),s=I(),l=w("div"),W(r.$$.fragment),o=I(),b&&b.c(),a=I(),u=w("div"),W(f.$$.fragment),c=I(),g&&g.c(),p(l,"class","col-12"),p(u,"class","col-12"),p(e,"id",n[11]),p(e,"class","grid")},m(T,L){k(T,e,L),_&&_.m(e,null),y(e,t),$(i,e,null),y(e,s),y(e,l),$(r,l,null),y(l,o),b&&b.m(l,null),y(e,a),y(e,u),$(f,u,null),y(u,c),g&&g.m(u,null),d=!0,m||(h=H(e,"submit",be(n[12])),m=!0)},p(T,L){T[2].id?_?_.p(T,L):(_=iu(T),_.c(),_.m(e,t)):_&&(_.d(1),_=null);const O={};L&1610612740&&(O.$$scope={dirty:L,ctx:T}),i.$set(O);const C={};L&1610613028&&(C.$$scope={dirty:L,ctx:T}),r.$set(C),T[2].passwordProtect&&T[5]?b?(b.p(T,L),L&36&&E(b,1)):(b=lu(T),b.c(),E(b,1),b.m(l,null)):b&&(ae(),j(b,1,1,()=>{b=null}),ue());const S={};L&1610613268&&(S.$$scope={dirty:L,ctx:T}),f.$set(S),T[4]?g?(g.p(T,L),L&16&&E(g,1)):(g=ru(T),g.c(),E(g,1),g.m(u,null)):g&&(ae(),j(g,1,1,()=>{g=null}),ue())},i(T){d||(E(i.$$.fragment,T),E(r.$$.fragment,T),E(b),E(f.$$.fragment,T),E(g),d=!0)},o(T){j(i.$$.fragment,T),j(r.$$.fragment,T),j(b),j(f.$$.fragment,T),j(g),d=!1},d(T){T&&v(e),_&&_.d(),F(i),F(r),b&&b.d(),F(f),g&&g.d(),m=!1,h()}}}function h0(n){let e,t,i,s,l=n[2].id?"Update link":"Create link",r,o,a,u,f;return{c(){e=w("div"),t=w("button"),t.innerHTML='<i class="iconoir-arrow-left"></i>',i=I(),s=w("h5"),r=ee(l),o=I(),a=w("div"),a.textContent=" ",p(t,"type","button"),p(t,"class","btn btn-circle btn-sm btn-transparent btn-hint"),p(e,"class","flex-fill"),p(s,"class","title"),p(a,"class","flex-fill")},m(c,d){k(c,e,d),y(e,t),k(c,i,d),k(c,s,d),y(s,r),k(c,o,d),k(c,a,d),u||(f=[ge(Te.call(null,t,{position:"right",text:"Back"})),H(t,"click",n[1])],u=!0)},p(c,d){d&4&&l!==(l=c[2].id?"Update link":"Create link")&&ke(r,l)},d(c){c&&(v(e),v(i),v(s),v(o),v(a)),u=!1,pe(f)}}}function _0(n){let e,t,i,s,l=n[2].id?"Update":"Create",r,o,a,u;return{c(){e=w("button"),e.innerHTML='<span class="txt">Back</span>',t=I(),i=w("button"),s=w("span"),r=ee(l),o=ee(" link"),p(e,"type","button"),p(e,"class","btn btn-transparent m-r-auto"),p(s,"class","txt"),p(i,"type","submit"),p(i,"form",n[11]),p(i,"class","btn btn-expanded btn-primary"),i.disabled=n[7],Z(i,"btn-loading",n[7])},m(f,c){k(f,e,c),k(f,t,c),k(f,i,c),y(i,s),y(s,r),y(s,o),a||(u=H(e,"click",n[1]),a=!0)},p(f,c){c&4&&l!==(l=f[2].id?"Update":"Create")&&ke(r,l),c&128&&(i.disabled=f[7]),c&128&&Z(i,"btn-loading",f[7])},d(f){f&&(v(e),v(t),v(i)),a=!1,u()}}}function g0(n){let e,t,i;const s=[{popup:!0},{beforeHide:n[22]},n[13]];function l(o){n[24](o)}let r={$$slots:{footer:[_0],header:[h0],default:[m0]},$$scope:{ctx:n}};for(let o=0;o<s.length;o+=1)r=Me(r,s[o]);return n[0]!==void 0&&(r.active=n[0]),e=new dn({props:r}),n[23](e),le.push(()=>Pe(e,"active",l)),e.$on("show",n[25]),e.$on("hide",n[26]),{c(){W(e.$$.fragment)},m(o,a){$(e,o,a),i=!0},p(o,[a]){const u=a&8320?gt(s,[s[0],a&128&&{beforeHide:o[22]},a&8192&&It(o[13])]):{};a&1073743860&&(u.$$scope={dirty:a,ctx:o}),!t&&a&1&&(t=!0,u.active=o[0],je(()=>t=!1)),e.$set(u)},i(o){i||(E(e.$$.fragment,o),i=!0)},o(o){j(e.$$.fragment,o),i=!1},d(o){n[23](null),F(e,o)}}}function b0(n,e,t){let i,s;const l=["active","show","hide"];let r=ut(e,l),o;x(n,qt,te=>t(15,o=te));const a=tt(),u="link_upsert_"+J.randomString(5);let{active:f=!1}=e,c,d={},m=!1,h=!1,_="",b=!1,g=!1;function T(te){return t(2,d=structuredClone(te)),O(),c==null?void 0:c.show()}function L(){return c==null?void 0:c.hide()}function O(){var te;Kt({}),t(4,m=((te=d.onlyPrototypes)==null?void 0:te.length)>0),t(8,g=!!d.passwordProtect),t(5,h=!d.id||!g),t(6,_=""),t(7,b=!1)}async function C(){t(7,b=!0);try{const te=!d.id,X={project:d.project,allowComments:d.allowComments,onlyPrototypes:m?d.onlyPrototypes:[],passwordProtect:d.passwordProtect};te&&!X.passwordProtect?(X.password="pb123456",X.passwordConfirm=X.password):X.passwordProtect&&h&&(X.password=_,X.passwordConfirm=X.password),te?(t(2,d=await z.collection("links").create(X)),_t("Successfully created new project link.")):(t(2,d=await z.collection("links").update(d.id,X)),_t("Successfully updated project link.")),t(7,b=!1),L(),a("save",d)}catch(te){t(7,b=!1),te.isAbort||z.error(te)}}function S(){d.allowComments=this.checked,t(2,d)}function P(){d.passwordProtect=this.checked,t(2,d)}const M=()=>t(5,h=!h);function A(){_=this.value,t(6,_)}const D=te=>{t(4,m=te.target.checked)};function R(te){n.$$.not_equal(d.onlyPrototypes,te)&&(d.onlyPrototypes=te,t(2,d))}const Y=()=>!b;function G(te){le[te?"unshift":"push"](()=>{c=te,t(3,c)})}function B(te){f=te,t(0,f)}function N(te){$e.call(this,n,te)}function V(te){$e.call(this,n,te)}return n.$$set=te=>{e=Me(Me({},e),Zt(te)),t(13,r=ut(e,l)),"active"in te&&t(0,f=te.active)},n.$$.update=()=>{n.$$.dirty&4&&t(10,i=J.getProjectLinkURL(d)),n.$$.dirty&32768&&t(9,s=o.map(te=>({value:te.id,label:te.title}))||[])},[f,L,d,c,m,h,_,b,g,s,i,u,C,r,T,o,S,P,M,A,D,R,Y,G,B,N,V]}class w0 extends ye{constructor(e){super(),we(this,e,b0,g0,he,{active:0,show:14,hide:1})}get show(){return this.$$.ctx[14]}get hide(){return this.$$.ctx[1]}}function y0(n){let e,t,i,s,l=[{type:t=n[5].type||"text"},{value:n[4]},{disabled:n[3]},{readOnly:n[2]},n[5]],r={};for(let o=0;o<l.length;o+=1)r=Me(r,l[o]);return{c(){e=w("input"),Zn(e,r)},m(o,a){k(o,e,a),"value"in r&&(e.value=r.value),e.autofocus&&e.focus(),i||(s=H(e,"input",n[6]),i=!0)},p(o,[a]){Zn(e,r=gt(l,[a&32&&t!==(t=o[5].type||"text")&&{type:t},a&16&&e.value!==o[4]&&{value:o[4]},a&8&&{disabled:o[3]},a&4&&{readOnly:o[2]},a&32&&o[5]])),"value"in r&&(e.value=r.value)},i:Q,o:Q,d(o){o&&v(e),i=!1,s()}}}function v0(n,e,t){let i;const s=["value","separator","readonly","disabled"];let l=ut(e,s),{value:r=[]}=e,{separator:o=","}=e,{readonly:a=null}=e,{disabled:u=null}=e;const f=c=>{t(0,r=J.splitNonEmpty(c.target.value,o))};return n.$$set=c=>{e=Me(Me({},e),Zt(c)),t(5,l=ut(e,s)),"value"in c&&t(0,r=c.value),"separator"in c&&t(1,o=c.separator),"readonly"in c&&t(2,a=c.readonly),"disabled"in c&&t(3,u=c.disabled)},n.$$.update=()=>{n.$$.dirty&3&&t(4,i=J.joinNonEmpty(r,o+" "))},[r,o,a,u,i,l,f]}class k0 extends ye{constructor(e){super(),we(this,e,v0,y0,he,{value:0,separator:1,readonly:2,disabled:3})}}function ou(n){let e,t,i,s,l,r,o;return{c(){e=w("div"),t=w("div"),i=w("div"),s=w("a"),l=ee(n[7]),p(s,"href",n[7]),p(s,"target","_blank"),p(s,"rel","noopener noreferrer"),p(i,"class","content txt-center txt-bold"),p(t,"class","alert alert-warning m-0"),p(e,"class","col-12")},m(a,u){k(a,e,u),y(e,t),y(t,i),y(i,s),y(s,l),r||(o=ge(Te.call(null,s,"Open in new tab")),r=!0)},p(a,u){u&128&&ke(l,a[7]),u&128&&p(s,"href",a[7])},d(a){a&&v(e),r=!1,o()}}}function S0(n){let e,t,i,s,l,r,o,a,u;function f(d){n[12](d)}let c={id:n[21],required:!0,autofocus:!0};return n[4]!==void 0&&(c.value=n[4]),l=new k0({props:c}),le.push(()=>Pe(l,"value",f)),{c(){e=w("label"),t=ee("Email(s)"),s=I(),W(l.$$.fragment),o=I(),a=w("div"),a.textContent="Separate multiple emails with comma.",p(e,"for",i=n[21]),p(a,"class","help-block")},m(d,m){k(d,e,m),y(e,t),k(d,s,m),$(l,d,m),k(d,o,m),k(d,a,m),u=!0},p(d,m){(!u||m&2097152&&i!==(i=d[21]))&&p(e,"for",i);const h={};m&2097152&&(h.id=d[21]),!r&&m&16&&(r=!0,h.value=d[4],je(()=>r=!1)),l.$set(h)},i(d){u||(E(l.$$.fragment,d),u=!0)},o(d){j(l.$$.fragment,d),u=!1},d(d){d&&(v(e),v(s),v(o),v(a)),F(l,d)}}}function T0(n){let e,t,i,s,l,r,o,a,u;return{c(){e=w("label"),t=ee("Additional message"),s=I(),l=w("textarea"),p(e,"for",i=n[21]),p(l,"id",r=n[21]),p(l,"rows","3"),p(l,"placeholder",o=n[2].passwordProtected?"eg. The password is...":"")},m(f,c){k(f,e,c),y(e,t),k(f,s,c),k(f,l,c),_e(l,n[5]),a||(u=H(l,"input",n[13]),a=!0)},p(f,c){c&2097152&&i!==(i=f[21])&&p(e,"for",i),c&2097152&&r!==(r=f[21])&&p(l,"id",r),c&4&&o!==(o=f[2].passwordProtected?"eg. The password is...":"")&&p(l,"placeholder",o),c&32&&_e(l,f[5])},d(f){f&&(v(e),v(s),v(l)),a=!1,u()}}}function O0(n){let e,t,i,s,l,r,o,a,u=n[2].id&&ou(n);return i=new Oe({props:{class:"form-field required",name:"emails",$$slots:{default:[S0,({uniqueId:f})=>({21:f}),({uniqueId:f})=>f?2097152:0]},$$scope:{ctx:n}}}),l=new Oe({props:{class:"form-field",name:"message",$$slots:{default:[T0,({uniqueId:f})=>({21:f}),({uniqueId:f})=>f?2097152:0]},$$scope:{ctx:n}}}),{c(){e=w("form"),u&&u.c(),t=I(),W(i.$$.fragment),s=I(),W(l.$$.fragment),p(e,"id",n[8]),p(e,"class","grid grid-sm")},m(f,c){k(f,e,c),u&&u.m(e,null),y(e,t),$(i,e,null),y(e,s),$(l,e,null),r=!0,o||(a=H(e,"submit",be(n[9])),o=!0)},p(f,c){f[2].id?u?u.p(f,c):(u=ou(f),u.c(),u.m(e,t)):u&&(u.d(1),u=null);const d={};c&6291472&&(d.$$scope={dirty:c,ctx:f}),i.$set(d);const m={};c&6291492&&(m.$$scope={dirty:c,ctx:f}),l.$set(m)},i(f){r||(E(i.$$.fragment,f),E(l.$$.fragment,f),r=!0)},o(f){j(i.$$.fragment,f),j(l.$$.fragment,f),r=!1},d(f){f&&v(e),u&&u.d(),F(i),F(l),o=!1,a()}}}function C0(n){let e,t,i,s,l,r,o,a;return{c(){e=w("div"),t=w("button"),t.innerHTML='<i class="iconoir-arrow-left"></i>',i=I(),s=w("h5"),s.textContent="Share project link",l=I(),r=w("div"),r.textContent=" ",p(t,"type","button"),p(t,"class","btn btn-circle btn-sm btn-transparent btn-hint"),p(e,"class","flex-fill"),p(s,"class","title"),p(r,"class","flex-fill")},m(u,f){k(u,e,f),y(e,t),k(u,i,f),k(u,s,f),k(u,l,f),k(u,r,f),o||(a=[ge(Te.call(null,t,{position:"right",text:"Back"})),H(t,"click",n[1])],o=!0)},p:Q,d(u){u&&(v(e),v(i),v(s),v(l),v(r)),o=!1,pe(a)}}}function E0(n){let e,t,i,s,l,r,o,a,u;return{c(){e=w("button"),t=w("span"),t.textContent="Back",i=I(),s=w("button"),l=w("i"),r=I(),o=w("span"),o.textContent="Send",p(t,"class","txt"),p(e,"type","button"),p(e,"class","btn btn-transparent m-r-auto"),p(e,"disable",n[6]),p(l,"class","iconoir-send-mail"),p(o,"class","txt"),p(s,"type","submit"),p(s,"form",n[8]),p(s,"class","btn btn-expanded-sm btn-primary"),s.disabled=n[6],Z(s,"btn-loading",n[6])},m(f,c){k(f,e,c),y(e,t),k(f,i,c),k(f,s,c),y(s,l),y(s,r),y(s,o),a||(u=H(e,"click",n[1]),a=!0)},p(f,c){c&64&&p(e,"disable",f[6]),c&64&&(s.disabled=f[6]),c&64&&Z(s,"btn-loading",f[6])},d(f){f&&(v(e),v(i),v(s)),a=!1,u()}}}function L0(n){let e,t,i;const s=[{popup:!0},{beforeHide:n[14]},n[10]];function l(o){n[16](o)}let r={$$slots:{footer:[E0],header:[C0],default:[O0]},$$scope:{ctx:n}};for(let o=0;o<s.length;o+=1)r=Me(r,s[o]);return n[0]!==void 0&&(r.active=n[0]),e=new dn({props:r}),n[15](e),le.push(()=>Pe(e,"active",l)),e.$on("show",n[17]),e.$on("hide",n[18]),{c(){W(e.$$.fragment)},m(o,a){$(e,o,a),i=!0},p(o,[a]){const u=a&1088?gt(s,[s[0],a&64&&{beforeHide:o[14]},a&1024&&It(o[10])]):{};a&4194548&&(u.$$scope={dirty:a,ctx:o}),!t&&a&1&&(t=!0,u.active=o[0],je(()=>t=!1)),e.$set(u)},i(o){i||(E(e.$$.fragment,o),i=!0)},o(o){j(e.$$.fragment,o),i=!1},d(o){n[15](null),F(e,o)}}}function I0(n,e,t){let i;const s=["active","show","hide"];let l=ut(e,s);const r=tt(),o="share_"+J.randomString(5);let{active:a=!1}=e,u,f={},c=[],d="",m=!1;function h(A=null){return b(),t(2,f=A?structuredClone(A):{}),u==null?void 0:u.show()}function _(){return u==null?void 0:u.hide()}function b(){Kt({}),t(6,m=!1),t(4,c=[]),t(5,d="")}async function g(){t(6,m=!0);try{await z.send("/api/pr/share/"+encodeURIComponent(f.id),{method:"POST",body:{emails:c,message:d}}),t(6,m=!1),_(),r("submit"),_t("Successfully shared the project link!")}catch(A){A.isAbort||(t(6,m=!1),z.error(A))}}function T(A){c=A,t(4,c)}function L(){d=this.value,t(5,d)}const O=()=>!m;function C(A){le[A?"unshift":"push"](()=>{u=A,t(3,u)})}function S(A){a=A,t(0,a)}function P(A){$e.call(this,n,A)}function M(A){$e.call(this,n,A)}return n.$$set=A=>{e=Me(Me({},e),Zt(A)),t(10,l=ut(e,s)),"active"in A&&t(0,a=A.active)},n.$$.update=()=>{n.$$.dirty&4&&t(7,i=J.getProjectLinkURL(f))},[a,_,f,u,c,d,m,i,o,g,l,h,T,L,O,C,S,P,M]}class j0 extends ye{constructor(e){super(),we(this,e,I0,L0,he,{active:0,show:11,hide:1})}get show(){return this.$$.ctx[11]}get hide(){return this.$$.ctx[1]}}function au(n,e,t){const i=n.slice();i[29]=e[t];const s=J.getProjectLinkURL(i[29]);return i[30]=s,i}function P0(n){let e=[],t=new Map,i,s,l=Ee(n[7]);const r=a=>a[29].id;for(let a=0;a<l.length;a+=1){let u=au(n,l,a),f=r(u);t.set(f,e[a]=fu(f,u))}let o=null;return l.length||(o=uu()),{c(){for(let a=0;a<e.length;a+=1)e[a].c();i=Ne(),o&&o.c()},m(a,u){for(let f=0;f<e.length;f+=1)e[f]&&e[f].m(a,u);k(a,i,u),o&&o.m(a,u),s=!0},p(a,u){u[0]&2272&&(l=Ee(a[7]),ae(),e=kt(e,u,r,1,a,l,t,i.parentNode,jt,fu,i,au),ue(),!l.length&&o?o.p(a,u):l.length?o&&(o.d(1),o=null):(o=uu(),o.c(),o.m(i.parentNode,i)))},i(a){if(!s){for(let u=0;u<l.length;u+=1)E(e[u]);s=!0}},o(a){for(let u=0;u<e.length;u+=1)j(e[u]);s=!1},d(a){a&&v(i);for(let u=0;u<e.length;u+=1)e[u].d(a);o&&o.d(a)}}}function N0(n){let e;return{c(){e=w("div"),e.innerHTML='<div class="skeleton-loader"></div>',p(e,"class","project-link")},m(t,i){k(t,e,i)},p:Q,i:Q,o:Q,d(t){t&&v(e)}}}function uu(n){let e;return{c(){e=w("div"),e.textContent=`Create project links that you can send to your clients and teammates for feedback.
                `,p(e,"class","block txt-center txt-hint")},m(t,i){k(t,e,i)},p:Q,d(t){t&&v(e)}}}function fu(n,e){let t,i,s,l=e[30]+"",r,o,a,u,f,c,d,m,h,_,b,g,T,L,O,C,S,P,M,A,D,R,Y,G,B,N,V,te;u=new a0({props:{class:"m-l-5",value:e[30]}});function X(){return e[14](e[29])}function U(){return e[15](e[29])}function ce(){return e[16](e[29])}return{key:n,first:null,c(){var oe;t=w("div"),i=w("div"),s=w("a"),r=ee(l),a=I(),W(u.$$.fragment),f=I(),c=w("div"),d=w("span"),m=ee("Comments"),_=I(),b=w("span"),g=ee("Password"),L=I(),O=w("span"),C=ee("Restricted"),P=I(),M=w("nav"),A=w("button"),A.innerHTML='<i class="iconoir-share-android"></i>',D=I(),R=w("button"),R.innerHTML='<i class="iconoir-settings"></i>',Y=I(),G=w("button"),G.innerHTML='<i class="iconoir-trash"></i>',B=I(),p(s,"href",o=e[30]),p(s,"target","_blank"),p(s,"rel","noopener noreferrer"),p(s,"class","url"),p(d,"class",h="meta-item label-sm label label-"+(e[29].allowComments?"success":"disabled")),p(b,"class",T="meta-item label-sm label label-"+(e[29].passwordProtect?"success":"disabled")),p(O,"class",S="meta-item label-sm label label-"+((oe=e[29].onlyPrototypes)!=null&&oe.length?"success":"disabled")),p(c,"class","meta"),p(i,"class","content"),p(A,"type","button"),p(A,"class","ctrl-item btn btn-sm btn-circle btn-transparent btn-hint"),p(R,"type","button"),p(R,"class","ctrl-item btn btn-sm btn-circle btn-transparent btn-hint"),p(G,"type","button"),p(G,"class","ctrl-item btn btn-sm btn-circle btn-transparent btn-hint"),p(M,"class","ctrls"),p(t,"class","project-link"),this.first=t},m(oe,de){k(oe,t,de),y(t,i),y(i,s),y(s,r),y(i,a),$(u,i,null),y(i,f),y(i,c),y(c,d),y(d,m),y(c,_),y(c,b),y(b,g),y(c,L),y(c,O),y(O,C),y(t,P),y(t,M),y(M,A),y(M,D),y(M,R),y(M,Y),y(M,G),y(t,B),N=!0,V||(te=[ge(Te.call(null,s,{position:"top",text:"Open in new tab"})),ge(Te.call(null,A,"Share")),H(A,"click",X),ge(Te.call(null,R,"Settings")),H(R,"click",U),ge(Te.call(null,G,"Delete")),H(G,"click",ce)],V=!0)},p(oe,de){var xe;e=oe,(!N||de[0]&128)&&l!==(l=e[30]+"")&&ke(r,l),(!N||de[0]&128&&o!==(o=e[30]))&&p(s,"href",o);const Ce={};de[0]&128&&(Ce.value=e[30]),u.$set(Ce),(!N||de[0]&128&&h!==(h="meta-item label-sm label label-"+(e[29].allowComments?"success":"disabled")))&&p(d,"class",h),(!N||de[0]&128&&T!==(T="meta-item label-sm label label-"+(e[29].passwordProtect?"success":"disabled")))&&p(b,"class",T),(!N||de[0]&128&&S!==(S="meta-item label-sm label label-"+((xe=e[29].onlyPrototypes)!=null&&xe.length?"success":"disabled")))&&p(O,"class",S)},i(oe){N||(E(u.$$.fragment,oe),N=!0)},o(oe){j(u.$$.fragment,oe),N=!1},d(oe){oe&&v(t),F(u),V=!1,pe(te)}}}function A0(n){let e,t,i,s;const l=[N0,P0],r=[];function o(a,u){return a[8]?0:1}return t=o(n),i=r[t]=l[t](n),{c(){e=w("div"),i.c(),p(e,"class","project-links-list")},m(a,u){k(a,e,u),r[t].m(e,null),s=!0},p(a,u){let f=t;t=o(a),t===f?r[t].p(a,u):(ae(),j(r[f],1,1,()=>{r[f]=null}),ue(),i=r[t],i?i.p(a,u):(i=r[t]=l[t](a),i.c()),E(i,1),i.m(e,null))},i(a){s||(E(i),s=!0)},o(a){j(i),s=!1},d(a){a&&v(e),r[t].d()}}}function D0(n){let e;return{c(){e=w("h5"),e.textContent="Project links",p(e,"class","block txt-center")},m(t,i){k(t,e,i)},p:Q,d(t){t&&v(e)}}}function M0(n){let e,t,i,s,l,r,o,a;return{c(){e=w("button"),e.innerHTML='<span class="txt">Close</span>',t=I(),i=w("button"),s=w("i"),l=I(),r=w("span"),r.textContent="New link",p(e,"type","button"),p(e,"class","btn btn-transparent m-r-auto"),p(s,"class","iconoir-plus"),p(r,"class","txt"),p(i,"type","button"),p(i,"class","btn btn-expanded btn-primary"),i.disabled=n[8]},m(u,f){k(u,e,f),k(u,t,f),k(u,i,f),y(i,s),y(i,l),y(i,r),o||(a=[H(e,"click",n[13]),H(i,"click",function(){var c,d;Qe((c=n[6])==null?void 0:c.show({project:n[10].id,allowComments:!0}))&&((d=n[6])==null||d.show({project:n[10].id,allowComments:!0}).apply(this,arguments))})],o=!0)},p(u,f){n=u,f[0]&256&&(i.disabled=n[8])},d(u){u&&(v(e),v(t),v(i)),o=!1,pe(a)}}}function R0(n){let e,t,i,s,l,r,o,a,u;function f(b){n[18](b)}let c={popup:!0,class:n[9]?"temp-hide":"",$$slots:{footer:[M0],header:[D0],default:[A0]},$$scope:{ctx:n}};n[0]!==void 0&&(c.active=n[0]),e=new dn({props:c}),n[17](e),le.push(()=>Pe(e,"active",f)),e.$on("show",n[19]),e.$on("hide",n[20]);function d(b){n[22](b)}let m={};n[2]!==void 0&&(m.active=n[2]),s=new w0({props:m}),n[21](s),le.push(()=>Pe(s,"active",d)),s.$on("save",n[23]);function h(b){n[25](b)}let _={};return n[3]!==void 0&&(_.active=n[3]),o=new j0({props:_}),n[24](o),le.push(()=>Pe(o,"active",h)),{c(){W(e.$$.fragment),i=I(),W(s.$$.fragment),r=I(),W(o.$$.fragment)},m(b,g){$(e,b,g),k(b,i,g),$(s,b,g),k(b,r,g),$(o,b,g),u=!0},p(b,g){const T={};g[0]&512&&(T.class=b[9]?"temp-hide":""),g[0]&1504|g[1]&4&&(T.$$scope={dirty:g,ctx:b}),!t&&g[0]&1&&(t=!0,T.active=b[0],je(()=>t=!1)),e.$set(T);const L={};!l&&g[0]&4&&(l=!0,L.active=b[2],je(()=>l=!1)),s.$set(L);const O={};!a&&g[0]&8&&(a=!0,O.active=b[3],je(()=>a=!1)),o.$set(O)},i(b){u||(E(e.$$.fragment,b),E(s.$$.fragment,b),E(o.$$.fragment,b),u=!0)},o(b){j(e.$$.fragment,b),j(s.$$.fragment,b),j(o.$$.fragment,b),u=!1},d(b){b&&(v(i),v(r)),n[17](null),F(e,b),n[21](null),F(s,b),n[24](null),F(o,b)}}}const cu="list_links";function H0(n,e,t){let i;x(n,un,V=>t(10,i=V));const s=tt();let{active:l=!1}=e,r,o,a,u=!1,f=!1,c=[{id:1},{id:2}],d=!1,m=!1;function h(){return b(),r==null?void 0:r.show()}function _(){return z.cancelRequest(cu),r==null?void 0:r.hide()}async function b(){t(8,d=!0);try{t(7,c=await z.collection("links").getFullList({filter:`project='${i==null?void 0:i.id}'`,requestKey:cu}))}catch(V){V.isAbort||z.error(V)}t(8,d=!1)}function g(V){Lt("Do you really want to delete the selected project link?",()=>T(V))}async function T(V){if(V!=null&&V.id)try{await z.collection("links").delete(V.id),J.removeByKey(c,"id",V.id),t(7,c),_t("Successfully deleted project link."),s("delete",V)}catch(te){te.isAbort||z.error(te)}}Yt(()=>{_()});const L=()=>_(),O=V=>o==null?void 0:o.show(V),C=V=>a==null?void 0:a.show(V),S=V=>g(V);function P(V){le[V?"unshift":"push"](()=>{r=V,t(4,r)})}function M(V){l=V,t(0,l)}function A(V){$e.call(this,n,V)}function D(V){$e.call(this,n,V)}function R(V){le[V?"unshift":"push"](()=>{a=V,t(6,a)})}function Y(V){u=V,t(2,u)}const G=V=>{J.pushOrReplaceObject(c,V.detail),t(7,c)};function B(V){le[V?"unshift":"push"](()=>{o=V,t(5,o)})}function N(V){f=V,t(3,f)}return n.$$set=V=>{"active"in V&&t(0,l=V.active)},n.$$.update=()=>{n.$$.dirty[0]&12&&t(9,m=u||f)},[l,_,u,f,r,o,a,c,d,m,i,g,h,L,O,C,S,P,M,A,D,R,Y,G,B,N]}class U0 extends ye{constructor(e){super(),we(this,e,H0,R0,he,{active:0,show:12,hide:1},null,[-1,-1])}get show(){return this.$$.ctx[12]}get hide(){return this.$$.ctx[1]}}function du(n){let e;return{c(){e=w("div"),e.innerHTML='<span class="loader loader-lg"></span>',p(e,"class","block txt-center")},m(t,i){k(t,e,i)},d(t){t&&v(e)}}}function q0(n){let e,t,i,s,l,r,o=n[7]&&du();return i=new hb({props:{projectId:n[0].projectId,initialPrototypeId:n[6]}}),l=new zb({}),{c(){var a;o&&o.c(),e=I(),t=w("div"),W(i.$$.fragment),s=I(),W(l.$$.fragment),p(t,"class","screens-list-wrapper svelte-1y0govx"),Z(t,"hidden",n[7]||!((a=n[2])!=null&&a.id))},m(a,u){o&&o.m(a,u),k(a,e,u),k(a,t,u),$(i,t,null),y(t,s),$(l,t,null),r=!0},p(a,u){var c;a[7]?o||(o=du(),o.c(),o.m(e.parentNode,e)):o&&(o.d(1),o=null);const f={};u&1&&(f.projectId=a[0].projectId),u&64&&(f.initialPrototypeId=a[6]),i.$set(f),(!r||u&132)&&Z(t,"hidden",a[7]||!((c=a[2])!=null&&c.id))},i(a){r||(E(i.$$.fragment,a),E(l.$$.fragment,a),r=!0)},o(a){j(i.$$.fragment,a),j(l.$$.fragment,a),r=!1},d(a){a&&(v(e),v(t)),o&&o.d(a),F(i),F(l)}}}function $0(n){let e;return{c(){e=w("div"),p(e,"class","breadcrumb-item")},m(t,i){k(t,e,i)},p:Q,i:Q,o:Q,d(t){t&&v(e)}}}function F0(n){let e,t,i,s;function l(o){n[11](o)}let r={collection:"projects"};return n[2]!==void 0&&(r.model=n[2]),t=new rr({props:r}),le.push(()=>Pe(t,"model",l)),{c(){e=w("div"),W(t.$$.fragment),p(e,"class","breadcrumb-item entrance-left")},m(o,a){k(o,e,a),$(t,e,null),s=!0},p(o,a){const u={};!i&&a&4&&(i=!0,u.model=o[2],je(()=>i=!1)),t.$set(u)},i(o){s||(E(t.$$.fragment,o),s=!0)},o(o){j(t.$$.fragment,o),s=!1},d(o){o&&v(e),F(t)}}}function pu(n){let e,t,i,s,l,r;return{c(){e=w("div"),t=w("button"),t.innerHTML='<i class="iconoir-user-plus"></i>',i=I(),s=w("button"),s.innerHTML='<i class="iconoir-internet txt-base"></i>',p(t,"type","button"),p(t,"class","menu-item"),p(s,"type","button"),p(s,"class","menu-item"),p(e,"class","header-menu entrance-left")},m(o,a){k(o,e,a),y(e,t),y(e,i),y(e,s),l||(r=[ge(Te.call(null,t,"Project owners")),H(t,"click",n[12]),ge(Te.call(null,s,"Share")),H(s,"click",n[13])],l=!0)},p:Q,d(o){o&&v(e),l=!1,pe(r)}}}function W0(n){var _;let e,t,i,s,l,r,o,a,u,f;const c=[F0,$0],d=[];function m(b,g){var T;return(T=b[2])!=null&&T.id?0:1}s=m(n),l=d[s]=c[s](n);let h=((_=n[2])==null?void 0:_.id)&&pu(n);return{c(){e=w("nav"),t=w("a"),t.textContent="Projects",i=I(),l.c(),r=I(),h&&h.c(),o=Ne(),p(t,"href","/projects"),p(t,"class","breadcrumb-item"),p(e,"class","breadcrumbs svelte-1y0govx")},m(b,g){k(b,e,g),y(e,t),y(e,i),d[s].m(e,null),k(b,r,g),h&&h.m(b,g),k(b,o,g),a=!0,u||(f=ge(Si.call(null,t)),u=!0)},p(b,g){var L;let T=s;s=m(b),s===T?d[s].p(b,g):(ae(),j(d[T],1,1,()=>{d[T]=null}),ue(),l=d[s],l?l.p(b,g):(l=d[s]=c[s](b),l.c()),E(l,1),l.m(e,null)),(L=b[2])!=null&&L.id?h?h.p(b,g):(h=pu(b),h.c(),h.m(o.parentNode,o)):h&&(h.d(1),h=null)},i(b){a||(E(l),a=!0)},o(b){j(l),a=!1},d(b){b&&(v(e),v(r),v(o)),d[s].d(),h&&h.d(b),u=!1,f()}}}function mu(n){let e;return{c(){e=w("label"),e.innerHTML='<i class="iconoir-upload-square"></i> <span class="txt">Upload screens</span>',p(e,"for","screen_uploader"),p(e,"class","btn btn-primary btn-screen-upload entrance-right")},m(t,i){k(t,e,i)},d(t){t&&v(e)}}}function V0(n){var i;let e,t=((i=n[1])==null?void 0:i.id)&&mu();return{c(){t&&t.c(),e=Ne()},m(s,l){t&&t.m(s,l),k(s,e,l)},p(s,l){var r;(r=s[1])!=null&&r.id?t||(t=mu(),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},d(s){s&&v(e),t&&t.d(s)}}}function z0(n){let e,t,i,s,l,r;e=new ji({props:{title:n[5],$$slots:{"header-right":[V0],"header-left":[W0],default:[q0]},$$scope:{ctx:n}}});let o={};i=new l0({props:o}),n[14](i);let a={};return l=new U0({props:a}),n[15](l),{c(){W(e.$$.fragment),t=I(),W(i.$$.fragment),s=I(),W(l.$$.fragment)},m(u,f){$(e,u,f),k(u,t,f),$(i,u,f),k(u,s,f),$(l,u,f),r=!0},p(u,[f]){const c={};f&32&&(c.title=u[5]),f&131295&&(c.$$scope={dirty:f,ctx:u}),e.$set(c);const d={};i.$set(d);const m={};l.$set(m)},i(u){r||(E(e.$$.fragment,u),E(i.$$.fragment,u),E(l.$$.fragment,u),r=!0)},o(u){j(e.$$.fragment,u),j(i.$$.fragment,u),j(l.$$.fragment,u),r=!1},d(u){u&&(v(t),v(s)),F(e,u),n[14](null),F(i,u),n[15](null),F(l,u)}}}function B0(n,e,t){let i,s,l,r,o;x(n,sn,O=>t(9,s=O)),x(n,Tt,O=>t(1,l=O)),x(n,oi,O=>t(10,r=O)),x(n,un,O=>t(2,o=O));let{params:a}=e,u,f,c="",d,m;async function h(O){Zs(),xl(),xh(O),ve(sn,s=!0,s);try{const C=await z.collection("projects").getOne(O);Gn(C,!0),ve(sn,s=!1,s)}catch(C){C.isAbort||(ve(sn,s=!1,s),z.error(C),C.status==404&&Bt("/"))}}Yt(()=>{$n==null||$n()});function _(O){o=O,un.set(o)}const b=()=>u==null?void 0:u.show(),g=()=>f==null?void 0:f.show();function T(O){le[O?"unshift":"push"](()=>{u=O,t(3,u)})}function L(O){le[O?"unshift":"push"](()=>{f=O,t(4,f)})}return n.$$set=O=>{"params"in O&&t(0,a=O.params)},n.$$.update=()=>{n.$$.dirty&257&&d!=a.projectId&&(t(8,d=a.projectId),t(6,m=a.prototypeId),h(d)),n.$$.dirty&4&&o!=null&&o.title&&t(5,c=o.title),n.$$.dirty&1536&&t(7,i=s||r),n.$$.dirty&2&&l!=null&&l.id&&Bt(`/projects/${l.project}/prototypes/${l.id}`)},[a,l,o,u,f,c,m,i,d,s,r,_,b,g,T,L]}class Z0 extends ye{constructor(e){super(),we(this,e,B0,z0,he,{params:0})}}const Nn=Fe([]),Pi=Fe(null),_i=Fe(!1),Un=Fe(!1),$i=Fe(!1);function Y0(){Nn.set([]),Pi.set(null),_i.set(!1),Un.set(!1)}const $t=Nt([Nn,Pi],([n,e])=>!n.length||e===null?null:n.find(t=>t.id===e));$t.set=n=>{J.isObject(n)?ki(n,!0):Pi.set(n)};function ki(n,e=!1){n&&(Nn.update(t=>(J.pushOrReplaceObject(t,n),t)),e&&Pi.set(n.id))}function Sd(n){n&&(Nn.update(e=>e.filter(t=>t.id!=n.id&&t.replyTo!=n.id)),Pi.update(e=>e==n.id?n.replyTo||null:e))}function Il(){Nn.update(n=>n.filter(e=>!!e.id)),Pi.update(n=>n===""?null:n)}const or=Nt([Nn,Ye],([n,e])=>n.filter(t=>t.screen==(e==null?void 0:e.id)).sort((t,i)=>!t.created||t.created>i.created?1:-1)),Td=Nt([or],([n])=>n.filter(e=>!e.replyTo)),Od=Nt([or],([n])=>n.filter(e=>e.id&&!e.replyTo&&!e.resolved));let rn;async function Cd(n){return rn==null||rn(),z.collection("comments").subscribe("*",e=>{e.action==="delete"?Sd(e.record):ki(e.record)},{filter:`screen.prototype="${n}"`,expand:"user"}).then(e=>(rn=e,e)).catch(e=>{console.warn("failed to init comments subscription:",e)})}async function Ed(n,e=void 0){var t;Y0(),_i.set(!0);try{const i=await z.collection("comments").getFullList({filter:`screen.prototype="${n}"`,expand:"user"});Nn.set(i),Bn(Li)===Se.comments&&e&&((t=i.find(s=>s.id==e))!=null&&t.resolved&&$i.set(!0),$t.set(e)),_i.set(!1)}catch(i){i.isAbort||(_i.set(!1),z.error(i))}}const fn=Fe([]),Fi=Fe(!1);function K0(){fn.set([]),Fi.set(!1)}function Wi(n){fn.update(e=>(J.pushOrReplaceObject(e,n),e))}function Ld(n){fn.update(e=>(J.removeByKey(e,"id",n==null?void 0:n.id),e))}const G0=Nt([fn,Ye],([n,e])=>n.filter(t=>t.screens.length&&(e==null?void 0:e.id)&&t.screens.includes(e.id)));let on;async function Id(n){return on==null||on(),z.collection("hotspotTemplates").subscribe("*",e=>{e.action==="delete"?Ld(e.record):Wi(e.record)},{filter:`prototype="${n}"`}).then(e=>(on=e,e)).catch(e=>{console.warn("failed to init templates subscription:",e)})}async function jd(n){K0(),Fi.set(!0);try{const e=await z.collection("hotspotTemplates").getFullList({filter:`prototype="${n}"`});e.sort((t,i)=>!t.created||t.created>i.created?1:-1),fn.set(e),Fi.set(!1)}catch(e){e.isAbort||(Fi.set(!1),z.error(e))}}const Xe={note:"note",screen:"screen",overlay:"overlay",back:"back",prev:"prev",next:"next",url:"url",scroll:"scroll"};Object.freeze(Xe);const bn=Fe([]),Ni=Fe(null),Vi=Fe(!1),J0=Fe(!1),pn=Fe(!1);function X0(){bn.set([]),Ni.set(null),Vi.set(!1),J0.set(!1),pn.set(!1)}const We=Nt([bn,Ni],([n,e])=>!n.length||e===null?null:n.find(t=>t.id===e));We.set=n=>{J.isObject(n)?En(n,!0):Ni.set(n)};function En(n,e=!1){n&&(bn.update(t=>(J.pushOrReplaceObject(t,n),t)),e&&Ni.set(n.id))}function Pd(n){n&&(bn.update(e=>(J.removeByKey(e,"id",n.id),e)),Ni.update(e=>e==n.id?null:e))}function jl(){bn.update(n=>n.filter(e=>!!e.id)),Ni.update(n=>n===""?null:n)}const Nd=Nt([Ye,bn,fn],([n,e,t])=>Ad(n,e,t));function Ad(n,e,t){return e.filter(i=>{var s;if(!(n!=null&&n.id))return!1;if(i.screen==n.id)return!0;for(let l of t)if(i.hotspotTemplate==l.id&&((s=l.screens)!=null&&s.includes(n.id)))return!0;return!1})}let an;async function Dd(n){return an==null||an(),z.collection("hotspots").subscribe("*",e=>{e.action=="delete"?Pd(e.record):En(e.record)},{filter:`screen.prototype="${n}" || hotspotTemplate.prototype="${n}"`}).then(e=>(an=e,e)).catch(e=>{console.warn("failed to init hotspots subscription:",e)})}async function Md(n){X0(),Vi.set(!0);try{const e=await z.collection("hotspots").getFullList({filter:`screen.prototype="${n}" || hotspotTemplate.prototype="${n}"`});bn.set(e),Vi.set(!1)}catch(e){e.isAbort||(Vi.set(!1),z.error(e))}}function hu(n,e,t){const i=n.slice();return i[9]=e[t],i}function _u(n){let e,t=[],i=new Map,s,l,r,o=Ee(n[3]);const a=u=>u[9].id;for(let u=0;u<o.length;u+=1){let f=hu(n,o,u),c=a(f);i.set(c,t[u]=gu(c,f))}return{c(){e=w("div");for(let u=0;u<t.length;u+=1)t[u].c();p(e,"class",s="screens-bar "+n[1])},m(u,f){k(u,e,f);for(let c=0;c<t.length;c+=1)t[c]&&t[c].m(e,null);r=!0},p(u,f){f&12&&(o=Ee(u[3]),ae(),t=kt(t,f,a,1,u,o,i,e,jt,gu,null,hu),ue()),(!r||f&2&&s!==(s="screens-bar "+u[1]))&&p(e,"class",s)},i(u){if(!r){for(let f=0;f<o.length;f+=1)E(t[f]);u&&vt(()=>{r&&(l||(l=ft(e,Ot,{duration:150},!0)),l.run(1))}),r=!0}},o(u){for(let f=0;f<t.length;f+=1)j(t[f]);u&&(l||(l=ft(e,Ot,{duration:150},!1)),l.run(0)),r=!1},d(u){u&&v(e);for(let f=0;f<t.length;f+=1)t[f].d();u&&l&&l.end()}}}function gu(n,e){let t,i,s,l,r,o,a,u;i=new Gt({props:{src:z.files.getURL(e[9],e[9].file,{thumb:"100x100"}),alt:e[9].title}});function f(){return e[7](e[9])}return{key:n,first:null,c(){t=w("button"),W(i.$$.fragment),s=I(),p(t,"type","button"),p(t,"data-screen-id",l=e[9].id),p(t,"class","thumb thumb-handle"),Z(t,"thumb-highlight-mode-accent",e[2].id==e[9].id),this.first=t},m(c,d){k(c,t,d),$(i,t,null),y(t,s),o=!0,a||(u=[ge(r=Te.call(null,t,{position:"top",text:e[9].title})),H(t,"click",Be(be(f)))],a=!0)},p(c,d){e=c;const m={};d&8&&(m.src=z.files.getURL(e[9],e[9].file,{thumb:"100x100"})),d&8&&(m.alt=e[9].title),i.$set(m),(!o||d&8&&l!==(l=e[9].id))&&p(t,"data-screen-id",l),r&&Qe(r.update)&&d&8&&r.update.call(null,{position:"top",text:e[9].title}),(!o||d&12)&&Z(t,"thumb-highlight-mode-accent",e[2].id==e[9].id)},i(c){o||(E(i.$$.fragment,c),o=!0)},o(c){j(i.$$.fragment,c),o=!1},d(c){c&&v(t),F(i),a=!1,pe(u)}}}function Q0(n){let e,t,i=n[0]&&_u(n);return{c(){i&&i.c(),e=Ne()},m(s,l){i&&i.m(s,l),k(s,e,l),t=!0},p(s,[l]){s[0]?i?(i.p(s,l),l&1&&E(i,1)):(i=_u(s),i.c(),E(i,1),i.m(e.parentNode,e)):i&&(ae(),j(i,1,1,()=>{i=null}),ue())},i(s){t||(E(i),t=!0)},o(s){j(i),t=!1},d(s){s&&v(e),i&&i.d(s)}}}function x0(n,e,t){let i,s;x(n,Ye,d=>t(2,i=d)),x(n,dt,d=>t(3,s=d));let{active:l=!0}=e,{class:r=""}=e;function o(){t(0,l=!0)}function a(){t(0,l=!1)}function u(){l?a():o()}async function f(){if(!l||!(i!=null&&i.id))return;await St();const d=document.querySelector(`[data-screen-id="${i.id}"]`);d&&(d.scrollIntoView(),document.activeElement&&d.parentNode.contains(document.activeElement)&&d.focus())}hn(()=>{f()});const c=d=>{ve(Ye,i=d.id,i)};return n.$$set=d=>{"active"in d&&t(0,l=d.active),"class"in d&&t(1,r=d.class)},n.$$.update=()=>{n.$$.dirty&5&&l&&i!=null&&i.id&&f()},[l,r,i,s,o,a,u,c]}class Rd extends ye{constructor(e){super(),we(this,e,x0,Q0,he,{active:0,class:1,show:4,hide:5,toggle:6})}get show(){return this.$$.ctx[4]}get hide(){return this.$$.ctx[5]}get toggle(){return this.$$.ctx[6]}}function e2(n){let e,t,i,s,l,r;const o=n[12].default,a=st(o,n,n[11],null);let u=[{class:t="draggable "+n[0]},n[5]],f={};for(let c=0;c<u.length;c+=1)f=Me(f,u[c]);return{c(){e=w("div"),a&&a.c(),Zn(e,f),Z(e,"dragging",n[4])},m(c,d){k(c,e,d),a&&a.m(e,null),n[15](e),s=!0,l||(r=[H(e,"mousedown",n[16]),H(e,"touchstart",n[2]),H(e,"click",n[13]),H(e,"keydown",n[14]),ge(i=Te.call(null,e,n[1]))],l=!0)},p(c,[d]){a&&a.p&&(!s||d&2048)&&rt(a,o,c,c[11],s?lt(o,c[11],d,null):ot(c[11]),null),Zn(e,f=gt(u,[(!s||d&1&&t!==(t="draggable "+c[0]))&&{class:t},d&32&&c[5]])),i&&Qe(i.update)&&d&2&&i.update.call(null,c[1]),Z(e,"dragging",c[4])},i(c){s||(E(a,c),s=!0)},o(c){j(a,c),s=!1},d(c){c&&v(e),a&&a.d(c),n[15](null),l=!1,pe(r)}}}function t2(n,e,t){let i;const s=["disabled","tolerance","passive","parentSelector","class","tooltip","getElem","dragInit"];let l=ut(e,s),{$$slots:r={},$$scope:o}=e;const a=tt();let{disabled:u=!1}=e,{tolerance:f=6}=e,{passive:c=!1}=e,{parentSelector:d=null}=e,{class:m=void 0}=e,{tooltip:h=null}=e,_,b=0,g=0,T=0,L=0,O=!1,C=!1,S=!1;function P(){return _}function M(N){u||!_||!N||(N.stopPropagation(),J.normalizePointerEvent(N),b=N.clientX,g=N.clientY,T=b-_.offsetLeft,L=g-_.offsetTop,document.addEventListener("touchmove",D),document.addEventListener("mousemove",D),document.addEventListener("touchend",A),document.addEventListener("mouseup",A),a("draginit",{event:N,elem:_}))}function A(N){var te;J.normalizePointerEvent(N);const V=S;(te=i==null?void 0:i.classList)==null||te.remove("child-dragging"),S&&(N.touches||N.preventDefault(),t(4,S=!1),O=!1,C=!1,_.classList.remove("no-pointer-events","dragging"),a("dragstop",{event:N,elem:_})),document.removeEventListener("touchmove",D),document.removeEventListener("mousemove",D),document.removeEventListener("touchend",A),document.removeEventListener("mouseup",A),a("dragrelease",{event:N,elem:_,dragged:V})}function D(N){J.normalizePointerEvent(N);let V=N.clientX-T,te=N.clientY-L;if(!S&&Math.abs(V-_.offsetLeft)<f&&Math.abs(te-_.offsetTop)<f)return;N.touches||N.preventDefault();let X=N.clientX-b,U=N.clientY-g;const ce={event:N,elem:_,diffX:X,diffY:U};if(S||(t(4,S=!0),_.classList.add("no-pointer-events","dragging"),i.classList.add("child-dragging"),a("dragstart",ce)),a("dragging",ce),!c){if(N.shiftKey?!O&&!C&&(Math.abs(X)>Math.abs(U)?(O=!1,C=!0):(O=!0,C=!1)):(O=!1,C=!1),!O){let oe=i.scrollWidth||i.offsetWidth;V+_.offsetWidth>oe&&(V=oe-_.offsetWidth),V=V<0?0:V,t(3,_.style.left=V+"px",_)}if(!C){let oe=i.scrollHeight||i.offsetHeight;te+_.offsetHeight>oe&&(te=oe-_.offsetHeight),te=te<0?0:te,t(3,_.style.top=te+"px",_)}}}function R(N){$e.call(this,n,N)}function Y(N){$e.call(this,n,N)}function G(N){le[N?"unshift":"push"](()=>{_=N,t(3,_)})}const B=N=>{N.button==0&&M(N)};return n.$$set=N=>{e=Me(Me({},e),Zt(N)),t(5,l=ut(e,s)),"disabled"in N&&t(6,u=N.disabled),"tolerance"in N&&t(7,f=N.tolerance),"passive"in N&&t(8,c=N.passive),"parentSelector"in N&&t(9,d=N.parentSelector),"class"in N&&t(0,m=N.class),"tooltip"in N&&t(1,h=N.tooltip),"$$scope"in N&&t(11,o=N.$$scope)},n.$$.update=()=>{n.$$.dirty&520&&(i=(_==null?void 0:_.closest(d))||(_==null?void 0:_.parentNode))},[m,h,M,_,S,l,u,f,c,d,P,o,r,R,Y,G,B]}class ar extends ye{constructor(e){super(),we(this,e,t2,e2,he,{disabled:6,tolerance:7,passive:8,parentSelector:9,class:0,tooltip:1,getElem:10,dragInit:2})}get getElem(){return this.$$.ctx[10]}get dragInit(){return this.$$.ctx[2]}}function n2(n){let e;const t=n[10].default,i=st(t,n,n[13],null);return{c(){i&&i.c()},m(s,l){i&&i.m(s,l),e=!0},p(s,l){i&&i.p&&(!e||l&8192)&&rt(i,t,s,s[13],e?lt(t,s[13],l,null):ot(s[13]),null)},i(s){e||(E(i,s),e=!0)},o(s){j(i,s),e=!1},d(s){i&&i.d(s)}}}function i2(n){let e;return{c(){e=w("span"),p(e,"class","loader loader-xs loader-danger-alt")},m(t,i){k(t,e,i)},p:Q,i:Q,o:Q,d(t){t&&v(e)}}}function s2(n){let e,t,i,s;const l=[i2,n2],r=[];function o(a,u){return a[2]?0:1}return e=o(n),t=r[e]=l[e](n),{c(){t.c(),i=Ne()},m(a,u){r[e].m(a,u),k(a,i,u),s=!0},p(a,u){let f=e;e=o(a),e===f?r[e].p(a,u):(ae(),j(r[f],1,1,()=>{r[f]=null}),ue(),t=r[e],t?t.p(a,u):(t=r[e]=l[e](a),t.c()),E(t,1),t.m(i.parentNode,i))},i(a){s||(E(t),s=!0)},o(a){j(t),s=!1},d(a){a&&v(i),r[e].d(a)}}}function l2(n){let e,t;return e=new ar({props:{disabled:n[1],class:"comment-pin "+(n[0].resolved?"resolved":"")+" "+(n[4]?"unread":""),parentSelector:".screen-preview-img-wrapper","data-comment-pin":n[0].id,style:"left: min(calc(100% - "+ms+"px), "+n[0].left*n[3]+"px); top: min(calc(100% - "+ms+"px), "+n[0].top*n[3]+"px)",$$slots:{default:[s2]},$$scope:{ctx:n}}}),e.$on("dragstop",n[11]),e.$on("click",n[12]),{c(){W(e.$$.fragment)},m(i,s){$(e,i,s),t=!0},p(i,[s]){const l={};s&2&&(l.disabled=i[1]),s&17&&(l.class="comment-pin "+(i[0].resolved?"resolved":"")+" "+(i[4]?"unread":"")),s&1&&(l["data-comment-pin"]=i[0].id),s&9&&(l.style="left: min(calc(100% - "+ms+"px), "+i[0].left*i[3]+"px); top: min(calc(100% - "+ms+"px), "+i[0].top*i[3]+"px)"),s&8196&&(l.$$scope={dirty:s,ctx:i}),e.$set(l)},i(i){t||(E(e.$$.fragment,i),t=!0)},o(i){j(e.$$.fragment,i),t=!1},d(i){F(e,i)}}}const ms=36;function r2(n,e,t){let i,s,l,r,o;x(n,gn,g=>t(8,l=g)),x(n,Vn,g=>t(9,r=g)),x(n,$t,g=>t(5,o=g));let{$$slots:a={},$$scope:u}=e,{comment:f}=e,{disabled:c=!1}=e,{scale:d=null}=e,m=!1;async function h(g){if(g&&(Object.assign(f,{left:g.offsetLeft/i,top:g.offsetTop/i}),ki(f),!!f.id)){t(2,m=!0);try{const T={left:f.left,top:f.top};await z.collection("comments").update(f.id,T),t(2,m=!1)}catch(T){T.isAbort||(z.error(T),t(2,m=!1))}}}const _=g=>{h(g.detail.elem)},b=()=>{o!=f&&Il(),ve($t,o=f,o)};return n.$$set=g=>{"comment"in g&&t(0,f=g.comment),"disabled"in g&&t(1,c=g.disabled),"scale"in g&&t(7,d=g.scale),"$$scope"in g&&t(13,u=g.$$scope)},n.$$.update=()=>{n.$$.dirty&640&&t(3,i=d===null?r:d),n.$$.dirty&257&&t(4,s=f!=null&&f.id?!!(l!=null&&l.find(g=>{var T,L;return!g.read&&(g.comment==f.id||((L=(T=g.expand)==null?void 0:T.comment)==null?void 0:L.replyTo)==f.id)})):!1)},[f,c,m,i,s,o,h,d,l,r,a,_,b,u]}class o2 extends ye{constructor(e){super(),we(this,e,r2,l2,he,{comment:0,disabled:1,scale:7})}}function bu(n){let e,t,i={class:"resize-handle",passive:!0,parentSelector:".screen-preview-img-wrapper"};return e=new ar({props:i}),n[21](e),e.$on("draginit",n[22]),e.$on("dragstart",n[23]),e.$on("dragstop",n[24]),e.$on("dragrelease",n[25]),e.$on("dragging",n[26]),{c(){W(e.$$.fragment)},m(s,l){$(e,s,l),t=!0},p(s,l){const r={};e.$set(r)},i(s){t||(E(e.$$.fragment,s),t=!0)},o(s){j(e.$$.fragment,s),t=!1},d(s){n[21](null),F(e,s)}}}function a2(n){let e,t,i=!n[1]&&bu(n);return{c(){i&&i.c(),e=Ne()},m(s,l){i&&i.m(s,l),k(s,e,l),t=!0},p(s,l){s[1]?i&&(ae(),j(i,1,1,()=>{i=null}),ue()):i?(i.p(s,l),l[0]&2&&E(i,1)):(i=bu(s),i.c(),E(i,1),i.m(e.parentNode,e))},i(s){t||(E(i),t=!0)},o(s){j(i),t=!1},d(s){s&&v(e),i&&i.d(s)}}}function u2(n){var s;let e,t,i={class:"hotspot type-"+n[0].type+" "+(n[1]?"preview":"")+" "+(((s=n[4])==null?void 0:s.id)==n[0].id?"active":"")+" "+(n[13]?"no-pointer-events":"")+" "+(n[0].hotspotTemplate?"template":""),"data-hotspot":n[0].id,parentSelector:Pl,disabled:n[13]||n[1]||n[0].disabled,style:`
        left: min(calc(100% - `+n[0].width*n[12]+"px), "+n[0].left*n[12]+`px);
        top: min(calc(100% - `+n[0].height*n[12]+"px), "+n[0].top*n[12]+`px);
        width: `+n[0].width*n[12]+`px;
        height: `+n[0].height*n[12]+`px;
    `,tooltip:n[10],$$slots:{default:[a2]},$$scope:{ctx:n}};return e=new ar({props:i}),n[27](e),e.$on("dragstart",n[28]),e.$on("dragrelease",n[29]),e.$on("dragstop",n[15]),e.$on("click",n[30]),{c(){W(e.$$.fragment)},m(l,r){$(e,l,r),t=!0},p(l,r){var a;const o={};r[0]&8211&&(o.class="hotspot type-"+l[0].type+" "+(l[1]?"preview":"")+" "+(((a=l[4])==null?void 0:a.id)==l[0].id?"active":"")+" "+(l[13]?"no-pointer-events":"")+" "+(l[0].hotspotTemplate?"template":"")),r[0]&1&&(o["data-hotspot"]=l[0].id),r[0]&8195&&(o.disabled=l[13]||l[1]||l[0].disabled),r[0]&4097&&(o.style=`
        left: min(calc(100% - `+l[0].width*l[12]+"px), "+l[0].left*l[12]+`px);
        top: min(calc(100% - `+l[0].height*l[12]+"px), "+l[0].top*l[12]+`px);
        width: `+l[0].width*l[12]+`px;
        height: `+l[0].height*l[12]+`px;
    `),r[0]&1024&&(o.tooltip=l[10]),r[0]&7163|r[1]&4194304&&(o.$$scope={dirty:r,ctx:l}),e.$set(o)},i(l){t||(E(e.$$.fragment,l),t=!0)},o(l){j(e.$$.fragment,l),t=!1},d(l){n[27](null),F(e,l)}}}let fl,cl;const Pl=".active-screen-preview-wrapper",f2=".screen-preview",hs=25;function c2(n,e,t){let i,s,l,r,o,a,u,f,c,d,m,h,_;x(n,ui,fe=>t(33,r=fe)),x(n,ai,fe=>t(34,o=fe)),x(n,Ye,fe=>t(35,a=fe)),x(n,wi,fe=>t(36,u=fe)),x(n,sd,fe=>t(37,f=fe)),x(n,vi,fe=>t(38,c=fe)),x(n,dt,fe=>t(39,d=fe)),x(n,We,fe=>t(4,m=fe)),x(n,pn,fe=>t(5,h=fe)),x(n,Vn,fe=>t(20,_=fe));const b=Pl+" .screen-preview-img img";let{hotspot:g}=e,{preview:T=!1}=e,{scale:L=null}=e,{backFunc:O=null}=e,C,S,P,M=0,A=0,D=0,R=0,Y=!1,G;function B(){var fe;t(10,G=void 0),(m==null?void 0:m.id)!=g.id&&(g.type==Xe.note?t(10,G={position:"follow",text:(fe=g.settings)==null?void 0:fe.note,hideOnClick:!1}):T||t(10,G={position:"top",text:`Ctrl + Click to follow
Shift + Click to duplicate`,delay:500,hideOnClick:!0}))}function N(fe=!1){return(!S||fe)&&(S=document.querySelector(Pl)),S}function V(){s&&Object.assign(g,{left:s.offsetLeft/i,top:s.offsetTop/i,width:s.offsetWidth/i,height:s.offsetHeight/i})}async function te(fe){var Le,re;if(s&&((re=(Le=fe==null?void 0:fe.detail)==null?void 0:Le.event)!=null&&re.altKey&&await X(),V(),En(g),!!g.id)){Y=!0;try{const Re={left:g.left,top:g.top,width:g.width,height:g.height};await z.collection("hotspots").update(g.id,Re),Y=!1}catch(Re){Re.isAbort||(z.error(Re),Y=!1)}}}async function X(){const fe=document.querySelector(b);if(!fe)return;V();const Le=J.closestFeatureEdge(fe,{x:g.left,y:g.top,w:g.width,h:g.height});t(0,g.left+=Le.x,g),t(0,g.top+=Le.y,g),t(0,g.width=Le.w,g),t(0,g.height=Le.h,g),await St()}async function U(){const fe=N().offsetWidth||1/0,Le=structuredClone(g);Le.id="hcopy"+J.randomString(10),Le.left=Le.left+Le.width,Le.disabled=!0,Le.left+Le.width>fe&&(Le.left=fe-Le.width),En(Le);try{En(await z.collection("hotspots").create(Le)),Y=!1}catch(re){re.isAbort||(z.error(re),Y=!1,Pd(Le))}}function ce(){switch(g.type){case Xe.screen:return oe();case Xe.overlay:return de();case Xe.back:return Ce();case Xe.prev:return xe();case Xe.next:return at();case Xe.url:return nt();case Xe.scroll:return ct()}}function oe(){const fe=d.find(Le=>Le.id==g.settings.screen);se(fe)}function de(){ve(vi,c=g.settings,c)}function Ce(){O?O():f!=null&&f.id&&se(f)}function xe(){const fe=El(-1);se(fe)}function at(){const fe=El(1);se(fe)}function nt(){u!=null&&u.allowHotspotsURL&&window.open(g.settings.url||"#","_blank","noopener,noreferrer")}function ct(){var fe;(fe=document.querySelector(f2))==null||fe.scrollTo({behavior:"smooth",top:g.settings.scrollTop||0,left:g.settings.scrollLeft||0})}function K(){clearTimeout(cl),clearTimeout(fl),ve(ui,r=null,r),ve(ai,o="",o)}function se(fe){if(!fe){K();return}if(!g.settings.transition){K(),ve(Ye,a=fe.id,a);return}ve(ai,o=g.settings.transition,o),ve(ui,r=fe.id,r),clearTimeout(fl),fl=setTimeout(()=>{ve(Ye,a=r==null?void 0:r.id,a),clearTimeout(cl),cl=setTimeout(()=>{ve(ai,o="",o),ve(ui,r="",r)},100)},350)}function q(fe){le[fe?"unshift":"push"](()=>{P=fe,t(3,P)})}const ne=()=>{ve(pn,h=!0,h)},He=()=>{s&&(t(6,M=s.offsetWidth),t(7,A=s.offsetHeight),t(8,D=s.offsetLeft),t(9,R=s.offsetTop))},ht=fe=>{te(fe),ve(pn,h=!1,h)},qe=fe=>{fe.detail.dragged||(ve(pn,h=!1,h),(m==null?void 0:m.id)!=(g==null?void 0:g.id)&&ve(We,m=g,m))},it=fe=>{if(!s)return;let Le=M+fe.detail.diffX,re=A+fe.detail.diffY,Re=D,et=R;const Ge=N().offsetWidth,bt=N().offsetHeight;Le<0&&(Le=-1*fe.detail.diffX,Re=D+fe.detail.diffX,Re<0&&(Re=0,Le=D)),Re+Le>=Ge&&(Le=Ge-Re,Le<hs&&(Le=hs,Re=Ge-Le)),re<0&&(re=-1*fe.detail.diffY,et=R+fe.detail.diffY,et<0&&(et=0,re=R)),et+re>=bt&&(re=bt-et,re<hs&&(re=hs,et=bt-re)),t(0,g.width=Le/i,g),t(0,g.height=re/i,g),t(0,g.left=Re/i,g),t(0,g.top=et/i,g)};function Dt(fe){le[fe?"unshift":"push"](()=>{C=fe,t(2,C)})}const Mt=()=>{ve(pn,h=!0,h)},ie=()=>{ve(pn,h=!1,h)},Ve=fe=>{if(fe.stopImmediatePropagation(),!h){if(!T&&(g!=null&&g.id)&&fe.shiftKey)return U();m!=g&&jl(),T||fe.ctrlKey?ce():ve(We,m=g,m)}};return n.$$set=fe=>{"hotspot"in fe&&t(0,g=fe.hotspot),"preview"in fe&&t(1,T=fe.preview),"scale"in fe&&t(18,L=fe.scale),"backFunc"in fe&&t(19,O=fe.backFunc)},n.$$.update=()=>{n.$$.dirty[0]&1310720&&t(12,i=L===null?_:L),n.$$.dirty[0]&9&&g.startResizing&&P&&(P.dragInit(g.startResizing),delete g.startResizing),n.$$.dirty[0]&4&&t(11,s=C==null?void 0:C.getElem()),n.$$.dirty[0]&49&&t(13,l=h||m&&m.id!=g.id),n.$$.dirty[0]&3&&(g||T)&&B()},N(!0),[g,T,C,P,m,h,M,A,D,R,G,s,i,l,N,te,U,ce,L,O,_,q,ne,He,ht,qe,it,Dt,Mt,ie,Ve]}class Ys extends ye{constructor(e){super(),we(this,e,c2,u2,he,{hotspot:0,preview:1,scale:18,backFunc:19},null,[-1,-1])}}function wu(n,e,t){const i=n.slice();return i[18]=e[t],i}function yu(n){let e,t,i,s,l,r,o=[],a=new Map,u=`${n[1].offsetTop*n[6]}px`,f=`${n[1].offsetLeft*n[6]}px`,c=`${n[1].offseRight*n[6]}px`,d=`${n[1].offsetBottom*n[6]}px`,m,h,_,b,g={src:z.files.getURL(n[0],n[0].file),alt:n[0].title,draggable:!1,loading:"eager",loaderClass:"hidden",fetchpriority:"high",scale:n[6]};s=new Gt({props:g}),n[13](s),s.$on("load",n[8]);let T=Ee(n[5]);const L=O=>O[18].id;for(let O=0;O<T.length;O+=1){let C=wu(n,T,O),S=L(C);a.set(S,o[O]=vu(S,C))}return{c(){e=w("div"),t=w("div"),i=w("div"),W(s.$$.fragment),l=I(),r=w("div");for(let O=0;O<o.length;O+=1)o[O].c();p(r,"class","hotspots"),p(i,"class","screen-overlay-offset"),Ue(i,"margin-top",u),Ue(i,"margin-left",f),Ue(i,"margin-right",c),Ue(i,"margin-bottom",d),p(t,"class",m="screen-overlay "+(n[1].fixOverlay?"fixed":"")+" transition-"+(n[1].transition||"none")+" position-"+n[1].overlayPosition),p(e,"class","screen-overlay-container")},m(O,C){k(O,e,C),y(e,t),y(t,i),$(s,i,null),y(i,l),y(i,r);for(let S=0;S<o.length;S+=1)o[S]&&o[S].m(r,null);h=!0,_||(b=H(e,"click",n[14]),_=!0)},p(O,C){const S={};C&1&&(S.src=z.files.getURL(O[0],O[0].file)),C&1&&(S.alt=O[0].title),C&64&&(S.scale=O[6]),s.$set(S),C&176&&(T=Ee(O[5]),ae(),o=kt(o,C,L,1,O,T,a,r,jt,vu,null,wu),ue()),C&66&&u!==(u=`${O[1].offsetTop*O[6]}px`)&&Ue(i,"margin-top",u),C&66&&f!==(f=`${O[1].offsetLeft*O[6]}px`)&&Ue(i,"margin-left",f),C&66&&c!==(c=`${O[1].offseRight*O[6]}px`)&&Ue(i,"margin-right",c),C&66&&d!==(d=`${O[1].offsetBottom*O[6]}px`)&&Ue(i,"margin-bottom",d),(!h||C&2&&m!==(m="screen-overlay "+(O[1].fixOverlay?"fixed":"")+" transition-"+(O[1].transition||"none")+" position-"+O[1].overlayPosition))&&p(t,"class",m)},i(O){if(!h){E(s.$$.fragment,O);for(let C=0;C<T.length;C+=1)E(o[C]);h=!0}},o(O){j(s.$$.fragment,O);for(let C=0;C<o.length;C+=1)j(o[C]);h=!1},d(O){O&&v(e),n[13](null),F(s);for(let C=0;C<o.length;C+=1)o[C].d();_=!1,b()}}}function vu(n,e){let t,i,s;return i=new Ys({props:{preview:!0,hotspot:e[18],scale:e[4],backFunc:e[7]}}),{key:n,first:null,c(){t=Ne(),W(i.$$.fragment),this.first=t},m(l,r){k(l,t,r),$(i,l,r),s=!0},p(l,r){e=l;const o={};r&32&&(o.hotspot=e[18]),r&16&&(o.scale=e[4]),i.$set(o)},i(l){s||(E(i.$$.fragment,l),s=!0)},o(l){j(i.$$.fragment,l),s=!1},d(l){l&&v(t),F(i,l)}}}function d2(n){let e,t,i,s,l=n[3]&&n[1]&&yu(n);return{c(){l&&l.c(),e=Ne()},m(r,o){l&&l.m(r,o),k(r,e,o),t=!0,i||(s=H(window,"resize",n[12]),i=!0)},p(r,[o]){r[3]&&r[1]?l?(l.p(r,o),o&10&&E(l,1)):(l=yu(r),l.c(),E(l,1),l.m(e.parentNode,e)):l&&(ae(),j(l,1,1,()=>{l=null}),ue())},i(r){t||(E(l),t=!0)},o(r){j(l),t=!1},d(r){r&&v(e),l&&l.d(r),i=!1,s()}}}function p2(n,e,t){let i,s,l,r,o,a,u;x(n,vi,C=>t(1,s=C)),x(n,dt,C=>t(16,l=C)),x(n,Ii,C=>t(9,r=C)),x(n,fn,C=>t(10,o=C)),x(n,bn,C=>t(11,a=C)),x(n,Vn,C=>t(6,u=C));let f=null,c=null,d=!1,m=null,h=null;function _(){t(0,c=s!=null&&s.screen?l.find(C=>C.id==s.screen):null),c?t(3,d=!0):b()}function b(){t(3,d=!1),s&&ve(vi,s=null,s),c&&t(0,c=null)}function g(C=250){d&&(h&&clearTimeout(h),h=setTimeout(()=>{t(4,m=f?f.widthRatio():null),h=null},C))}Yt(()=>{h&&clearTimeout(h)});const T=()=>g();function L(C){le[C?"unshift":"push"](()=>{f=C,t(2,f)})}const O=function(C){s.outsideClose&&C.target==this&&b()};return n.$$.update=()=>{n.$$.dirty&2&&s!=-1&&_(),n.$$.dirty&3073&&t(5,i=c!=null&&c.id?Ad(c,a,o):[]),n.$$.dirty&512&&r!==-1&&g()},[c,s,f,d,m,i,u,b,g,r,o,a,T,L,O]}class m2 extends ye{constructor(e){super(),we(this,e,p2,d2,he,{})}}function ku(n,e,t){const i=n.slice();return i[43]=e[t],i}function Su(n,e,t){const i=n.slice();return i[48]=e[t],i[50]=t,i}function Tu(n,e,t){const i=n.slice();return i[43]=e[t],i}function Ou(n,e,t){const i=n.slice();return i[43]=e[t],i}function Cu(n){let e,t,i,s,l=`${n[2].fixedHeader*n[12]}px`,r=`-${n[2].fixedHeader*n[12]}px`,o;return s=new Gt({props:{class:"screen-preview-img",src:z.files.getURL(n[2],n[2].file),alt:n[2].title,draggable:!1,loaderClass:"hidden",fetchpriority:"high",scale:n[4].scale,$$slots:{default:[h2]},$$scope:{ctx:n}}}),s.$on("click",n[25]),{c(){e=w("div"),t=w("div"),i=w("div"),W(s.$$.fragment),p(i,"class","fixed-screen-hotspots-wrapper"),p(t,"class","fixed-screen-overflow"),p(e,"class","fixed-screen-header"),Ue(e,"height",l),Ue(e,"margin-top",r)},m(a,u){k(a,e,u),y(e,t),y(t,i),$(s,i,null),o=!0},p(a,u){const f={};u[0]&4&&(f.src=z.files.getURL(a[2],a[2].file)),u[0]&4&&(f.alt=a[2].title),u[0]&16&&(f.scale=a[4].scale),u[0]&65536|u[1]&4194304&&(f.$$scope={dirty:u,ctx:a}),s.$set(f),u[0]&4100&&l!==(l=`${a[2].fixedHeader*a[12]}px`)&&Ue(e,"height",l),u[0]&4100&&r!==(r=`-${a[2].fixedHeader*a[12]}px`)&&Ue(e,"margin-top",r)},i(a){o||(E(s.$$.fragment,a),o=!0)},o(a){j(s.$$.fragment,a),o=!1},d(a){a&&v(e),F(s)}}}function Eu(n,e){let t,i,s;return i=new Ys({props:{preview:!0,hotspot:e[43]}}),{key:n,first:null,c(){t=Ne(),W(i.$$.fragment),this.first=t},m(l,r){k(l,t,r),$(i,l,r),s=!0},p(l,r){e=l;const o={};r[0]&65536&&(o.hotspot=e[43]),i.$set(o)},i(l){s||(E(i.$$.fragment,l),s=!0)},o(l){j(i.$$.fragment,l),s=!1},d(l){l&&v(t),F(i,l)}}}function h2(n){let e,t=[],i=new Map,s,l=Ee(n[16]);const r=o=>"header_"+o[43].id;for(let o=0;o<l.length;o+=1){let a=Ou(n,l,o),u=r(a);i.set(u,t[o]=Eu(u,a))}return{c(){e=w("div");for(let o=0;o<t.length;o+=1)t[o].c();p(e,"class","hotspots svelte-r47g7")},m(o,a){k(o,e,a);for(let u=0;u<t.length;u+=1)t[u]&&t[u].m(e,null);s=!0},p(o,a){a[0]&65536&&(l=Ee(o[16]),ae(),t=kt(t,a,r,1,o,l,i,e,jt,Eu,null,Ou),ue())},i(o){if(!s){for(let a=0;a<l.length;a+=1)E(t[a]);s=!0}},o(o){for(let a=0;a<t.length;a+=1)j(t[a]);s=!1},d(o){o&&v(e);for(let a=0;a<t.length;a+=1)t[a].d()}}}function _2(n){let e,t=[],i=new Map,s,l=Ee(n[17]);const r=o=>o[48].id;for(let o=0;o<l.length;o+=1){let a=Su(n,l,o),u=r(a);i.set(u,t[o]=Iu(u,a))}return{c(){e=w("div");for(let o=0;o<t.length;o+=1)t[o].c();p(e,"class","comment-pins svelte-r47g7")},m(o,a){k(o,e,a);for(let u=0;u<t.length;u+=1)t[u]&&t[u].m(e,null);s=!0},p(o,a){a[0]&393728&&(l=Ee(o[17]),ae(),t=kt(t,a,r,1,o,l,i,e,jt,Iu,null,Su),ue())},i(o){if(!s){for(let a=0;a<l.length;a+=1)E(t[a]);s=!0}},o(o){for(let a=0;a<t.length;a+=1)j(t[a]);s=!1},d(o){o&&v(e);for(let a=0;a<t.length;a+=1)t[a].d()}}}function g2(n){let e,t=[],i=new Map,s,l,r,o=Ee(n[16]);const a=u=>u[43].id;for(let u=0;u<o.length;u+=1){let f=Tu(n,o,u),c=a(f);i.set(c,t[u]=ju(c,f))}return l=new m2({}),{c(){e=w("div");for(let u=0;u<t.length;u+=1)t[u].c();s=I(),W(l.$$.fragment),p(e,"class","hotspots svelte-r47g7")},m(u,f){k(u,e,f);for(let c=0;c<t.length;c+=1)t[c]&&t[c].m(e,null);k(u,s,f),$(l,u,f),r=!0},p(u,f){f[0]&65538&&(o=Ee(u[16]),ae(),t=kt(t,f,a,1,u,o,i,e,jt,ju,null,Tu),ue())},i(u){if(!r){for(let f=0;f<o.length;f+=1)E(t[f]);E(l.$$.fragment,u),r=!0}},o(u){for(let f=0;f<t.length;f+=1)j(t[f]);j(l.$$.fragment,u),r=!1},d(u){u&&(v(e),v(s));for(let f=0;f<t.length;f+=1)t[f].d();F(l,u)}}}function Lu(n){let e,t;return e=new o2({props:{disabled:!n[9],comment:n[48],$$slots:{default:[b2]},$$scope:{ctx:n}}}),{c(){W(e.$$.fragment)},m(i,s){$(e,i,s),t=!0},p(i,s){const l={};s[0]&512&&(l.disabled=!i[9]),s[0]&131072&&(l.comment=i[48]),s[0]&131072|s[1]&4194304&&(l.$$scope={dirty:s,ctx:i}),e.$set(l)},i(i){t||(E(e.$$.fragment,i),t=!0)},o(i){j(e.$$.fragment,i),t=!1},d(i){F(e,i)}}}function b2(n){let e=(n[48].id?n[50]+1:"")+"",t,i;return{c(){t=ee(e),i=I()},m(s,l){k(s,t,l),k(s,i,l)},p(s,l){l[0]&131072&&e!==(e=(s[48].id?s[50]+1:"")+"")&&ke(t,e)},d(s){s&&(v(t),v(i))}}}function Iu(n,e){let t,i,s,l=(!e[48].resolved||e[18])&&Lu(e);return{key:n,first:null,c(){t=Ne(),l&&l.c(),i=Ne(),this.first=t},m(r,o){k(r,t,o),l&&l.m(r,o),k(r,i,o),s=!0},p(r,o){e=r,!e[48].resolved||e[18]?l?(l.p(e,o),o[0]&393216&&E(l,1)):(l=Lu(e),l.c(),E(l,1),l.m(i.parentNode,i)):l&&(ae(),j(l,1,1,()=>{l=null}),ue())},i(r){s||(E(l),s=!0)},o(r){j(l),s=!1},d(r){r&&(v(t),v(i)),l&&l.d(r)}}}function ju(n,e){let t,i,s;return i=new Ys({props:{hotspot:e[43],preview:e[1]==Se.preview}}),{key:n,first:null,c(){t=Ne(),W(i.$$.fragment),this.first=t},m(l,r){k(l,t,r),$(i,l,r),s=!0},p(l,r){e=l;const o={};r[0]&65536&&(o.hotspot=e[43]),r[0]&2&&(o.preview=e[1]==Se.preview),i.$set(o)},i(l){s||(E(i.$$.fragment,l),s=!0)},o(l){j(i.$$.fragment,l),s=!1},d(l){l&&v(t),F(i,l)}}}function Pu(n){let e,t,i,s,l=`${n[2].fixedFooter*n[12]}px`,r=`-${n[2].fixedFooter*n[12]}px`,o;return s=new Gt({props:{class:"screen-preview-img",src:z.files.getURL(n[2],n[2].file),alt:n[2].title,draggable:!1,loading:"eager",loaderClass:"hidden",fetchpriority:"high",scale:n[4].scale,$$slots:{default:[w2]},$$scope:{ctx:n}}}),s.$on("click",n[25]),{c(){e=w("div"),t=w("div"),i=w("div"),W(s.$$.fragment),p(i,"class","fixed-screen-hotspots-wrapper"),p(t,"class","fixed-screen-overflow"),p(e,"class","fixed-screen-footer"),Ue(e,"height",l),Ue(e,"margin-top",r)},m(a,u){k(a,e,u),y(e,t),y(t,i),$(s,i,null),o=!0},p(a,u){const f={};u[0]&4&&(f.src=z.files.getURL(a[2],a[2].file)),u[0]&4&&(f.alt=a[2].title),u[0]&16&&(f.scale=a[4].scale),u[0]&65536|u[1]&4194304&&(f.$$scope={dirty:u,ctx:a}),s.$set(f),u[0]&4100&&l!==(l=`${a[2].fixedFooter*a[12]}px`)&&Ue(e,"height",l),u[0]&4100&&r!==(r=`-${a[2].fixedFooter*a[12]}px`)&&Ue(e,"margin-top",r)},i(a){o||(E(s.$$.fragment,a),o=!0)},o(a){j(s.$$.fragment,a),o=!1},d(a){a&&v(e),F(s)}}}function Nu(n,e){let t,i,s;return i=new Ys({props:{preview:!0,hotspot:e[43]}}),{key:n,first:null,c(){t=Ne(),W(i.$$.fragment),this.first=t},m(l,r){k(l,t,r),$(i,l,r),s=!0},p(l,r){e=l;const o={};r[0]&65536&&(o.hotspot=e[43]),i.$set(o)},i(l){s||(E(i.$$.fragment,l),s=!0)},o(l){j(i.$$.fragment,l),s=!1},d(l){l&&v(t),F(i,l)}}}function w2(n){let e,t=[],i=new Map,s,l=Ee(n[16]);const r=o=>"footer_"+o[43].id;for(let o=0;o<l.length;o+=1){let a=ku(n,l,o),u=r(a);i.set(u,t[o]=Nu(u,a))}return{c(){e=w("div");for(let o=0;o<t.length;o+=1)t[o].c();p(e,"class","hotspots svelte-r47g7")},m(o,a){k(o,e,a);for(let u=0;u<t.length;u+=1)t[u]&&t[u].m(e,null);s=!0},p(o,a){a[0]&65536&&(l=Ee(o[16]),ae(),t=kt(t,a,r,1,o,l,i,e,jt,Nu,null,ku),ue())},i(o){if(!s){for(let a=0;a<l.length;a+=1)E(t[a]);s=!0}},o(o){for(let a=0;a<t.length;a+=1)j(t[a]);s=!1},d(o){o&&v(e);for(let a=0;a<t.length;a+=1)t[a].d()}}}function Au(n){let e,t,i,s,l,r,o,a,u=n[19].fixedHeader>0&&n[1]==Se.preview&&Du(n);l=new Gt({props:{class:"screen-preview-img",src:z.files.getURL(n[19],n[19].file),alt:n[19].title,loading:"eager",loaderClass:"loader",fetchpriority:"high",draggable:!1,scale:n[4].scale}}),l.$on("load",n[36]);let f=n[19].fixedFooter>0&&n[1]==Se.preview&&Mu(n);return{c(){e=w("div"),t=w("div"),u&&u.c(),i=I(),s=w("div"),W(l.$$.fragment),r=I(),f&&f.c(),p(s,"class","screen-preview-img-wrapper"),p(t,"class",o="screen-preview align-"+(n[2].alignment||"center")+" svelte-r47g7"),Z(t,"fit-to-screen",n[3]),Ue(t,"width",n[11]?`${n[11]}px`:void 0),Ue(t,"height",n[10]?`${n[10]}px`:void 0),Ue(t,"background-color",n[19].background||As),p(e,"class","transition-item new")},m(c,d){k(c,e,d),y(e,t),u&&u.m(t,null),y(t,i),y(t,s),$(l,s,null),y(t,r),f&&f.m(t,null),n[37](t),a=!0},p(c,d){c[19].fixedHeader>0&&c[1]==Se.preview?u?(u.p(c,d),d[0]&524290&&E(u,1)):(u=Du(c),u.c(),E(u,1),u.m(t,i)):u&&(ae(),j(u,1,1,()=>{u=null}),ue());const m={};d[0]&524288&&(m.src=z.files.getURL(c[19],c[19].file)),d[0]&524288&&(m.alt=c[19].title),d[0]&16&&(m.scale=c[4].scale),l.$set(m),c[19].fixedFooter>0&&c[1]==Se.preview?f?(f.p(c,d),d[0]&524290&&E(f,1)):(f=Mu(c),f.c(),E(f,1),f.m(t,null)):f&&(ae(),j(f,1,1,()=>{f=null}),ue()),(!a||d[0]&4&&o!==(o="screen-preview align-"+(c[2].alignment||"center")+" svelte-r47g7"))&&p(t,"class",o),(!a||d[0]&12)&&Z(t,"fit-to-screen",c[3]),d[0]&2048&&Ue(t,"width",c[11]?`${c[11]}px`:void 0),d[0]&1024&&Ue(t,"height",c[10]?`${c[10]}px`:void 0),d[0]&524288&&Ue(t,"background-color",c[19].background||As)},i(c){a||(E(u),E(l.$$.fragment,c),E(f),a=!0)},o(c){j(u),j(l.$$.fragment,c),j(f),a=!1},d(c){c&&v(e),u&&u.d(),F(l),f&&f.d(),n[37](null)}}}function Du(n){let e,t,i,s=`${n[19].fixedHeader*n[12]}px`,l=`-${n[19].fixedHeader*n[12]}px`,r;return i=new Gt({props:{class:"screen-preview-img",src:z.files.getURL(n[19],n[19].file),alt:n[19].title,draggable:!1,loaderClass:"hidden",fetchpriority:"high",scale:n[4].scale}}),{c(){e=w("div"),t=w("div"),W(i.$$.fragment),p(t,"class","fixed-screen-overflow"),p(e,"class","fixed-screen-header"),Ue(e,"height",s),Ue(e,"margin-top",l)},m(o,a){k(o,e,a),y(e,t),$(i,t,null),r=!0},p(o,a){const u={};a[0]&524288&&(u.src=z.files.getURL(o[19],o[19].file)),a[0]&524288&&(u.alt=o[19].title),a[0]&16&&(u.scale=o[4].scale),i.$set(u),a[0]&528384&&s!==(s=`${o[19].fixedHeader*o[12]}px`)&&Ue(e,"height",s),a[0]&528384&&l!==(l=`-${o[19].fixedHeader*o[12]}px`)&&Ue(e,"margin-top",l)},i(o){r||(E(i.$$.fragment,o),r=!0)},o(o){j(i.$$.fragment,o),r=!1},d(o){o&&v(e),F(i)}}}function Mu(n){let e,t,i,s=`${n[19].fixedFooter*n[12]}px`,l=`-${n[19].fixedFooter*n[12]}px`,r;return i=new Gt({props:{class:"screen-preview-img",src:z.files.getURL(n[19],n[19].file),alt:n[19].title,loading:"eager",loaderClass:"hidden",fetchpriority:"high",scale:n[4].scale}}),{c(){e=w("div"),t=w("div"),W(i.$$.fragment),p(t,"class","fixed-screen-overflow"),p(e,"class","fixed-screen-footer"),Ue(e,"height",s),Ue(e,"margin-top",l)},m(o,a){k(o,e,a),y(e,t),$(i,t,null),r=!0},p(o,a){const u={};a[0]&524288&&(u.src=z.files.getURL(o[19],o[19].file)),a[0]&524288&&(u.alt=o[19].title),a[0]&16&&(u.scale=o[4].scale),i.$set(u),a[0]&528384&&s!==(s=`${o[19].fixedFooter*o[12]}px`)&&Ue(e,"height",s),a[0]&528384&&l!==(l=`-${o[19].fixedFooter*o[12]}px`)&&Ue(e,"margin-top",l)},i(o){r||(E(i.$$.fragment,o),r=!0)},o(o){j(i.$$.fragment,o),r=!1},d(o){o&&v(e),F(i)}}}function y2(n){var B;let e,t,i,s,l,r,o,a,u,f,c,d,m,h,_,b,g,T,L,O,C,S=n[2].fixedHeader>0&&n[1]==Se.preview&&Cu(n);function P(N){n[32](N)}let M={class:"screen-preview-img",src:z.files.getURL(n[2],n[2].file),alt:n[2].title,loading:"eager",loaderClass:"loader",fetchpriority:"high",draggable:!1,scale:n[4].scale};n[8]!==void 0&&(M.isLoading=n[8]),a=new Gt({props:M}),le.push(()=>Pe(a,"isLoading",P)),a.$on("load",n[33]),a.$on("mousedown",n[34]),a.$on("touchstart",n[24]),a.$on("click",n[25]),a.$on("click",n[23]);const A=[g2,_2],D=[];function R(N,V){return N[1]==Se.hotspots||N[1]==Se.preview?0:N[1]==Se.comments?1:-1}~(d=R(n))&&(m=D[d]=A[d](n));let Y=n[2].fixedFooter>0&&n[1]==Se.preview&&Pu(n),G=n[13]&&((B=n[19])==null?void 0:B.id)&&Au(n);return{c(){e=w("div"),t=w("div"),i=w("div"),s=w("div"),S&&S.c(),l=I(),r=w("div"),o=w("div"),W(a.$$.fragment),c=I(),m&&m.c(),h=I(),Y&&Y.c(),b=I(),G&&G.c(),p(o,"class","tooltip-wrapper"),p(r,"class","screen-preview-img-wrapper active-screen-preview-wrapper svelte-r47g7"),Z(r,"loading",n[8]),p(s,"class",_="screen-preview align-"+(n[2].alignment||"center")+" svelte-r47g7"),Z(s,"fit-to-screen",n[3]),Ue(s,"width",n[11]?`${n[11]}px`:void 0),Ue(s,"height",n[10]?`${n[10]}px`:void 0),Ue(s,"background-color",n[2].background||As),p(i,"class","transition-item old"),p(t,"class",g="transition-container transition-"+n[13]+" svelte-r47g7"),Z(t,"active",n[13]),p(e,"class",T="screen-preview-holder "+(n[4].size?"mobile":"desktop")),Z(e,"in-transition",!!n[13]),Z(e,"hints",n[7]||n[14]),Z(e,"annotations",n[15])},m(N,V){k(N,e,V),y(e,t),y(t,i),y(i,s),S&&S.m(s,null),y(s,l),y(s,r),y(r,o),$(a,o,null),y(r,c),~d&&D[d].m(r,null),y(s,h),Y&&Y.m(s,null),n[35](s),y(t,b),G&&G.m(t,null),L=!0,O||(C=[H(window,"resize",n[31]),ge(f=Te.call(null,o,n[6]))],O=!0)},p(N,V){var U;N[2].fixedHeader>0&&N[1]==Se.preview?S?(S.p(N,V),V[0]&6&&E(S,1)):(S=Cu(N),S.c(),E(S,1),S.m(s,l)):S&&(ae(),j(S,1,1,()=>{S=null}),ue());const te={};V[0]&4&&(te.src=z.files.getURL(N[2],N[2].file)),V[0]&4&&(te.alt=N[2].title),V[0]&16&&(te.scale=N[4].scale),!u&&V[0]&256&&(u=!0,te.isLoading=N[8],je(()=>u=!1)),a.$set(te),f&&Qe(f.update)&&V[0]&64&&f.update.call(null,N[6]);let X=d;d=R(N),d===X?~d&&D[d].p(N,V):(m&&(ae(),j(D[X],1,1,()=>{D[X]=null}),ue()),~d?(m=D[d],m?m.p(N,V):(m=D[d]=A[d](N),m.c()),E(m,1),m.m(r,null)):m=null),(!L||V[0]&256)&&Z(r,"loading",N[8]),N[2].fixedFooter>0&&N[1]==Se.preview?Y?(Y.p(N,V),V[0]&6&&E(Y,1)):(Y=Pu(N),Y.c(),E(Y,1),Y.m(s,null)):Y&&(ae(),j(Y,1,1,()=>{Y=null}),ue()),(!L||V[0]&4&&_!==(_="screen-preview align-"+(N[2].alignment||"center")+" svelte-r47g7"))&&p(s,"class",_),(!L||V[0]&12)&&Z(s,"fit-to-screen",N[3]),V[0]&2048&&Ue(s,"width",N[11]?`${N[11]}px`:void 0),V[0]&1024&&Ue(s,"height",N[10]?`${N[10]}px`:void 0),V[0]&4&&Ue(s,"background-color",N[2].background||As),N[13]&&((U=N[19])!=null&&U.id)?G?(G.p(N,V),V[0]&532480&&E(G,1)):(G=Au(N),G.c(),E(G,1),G.m(t,null)):G&&(ae(),j(G,1,1,()=>{G=null}),ue()),(!L||V[0]&8192&&g!==(g="transition-container transition-"+N[13]+" svelte-r47g7"))&&p(t,"class",g),(!L||V[0]&8192)&&Z(t,"active",N[13]),(!L||V[0]&16&&T!==(T="screen-preview-holder "+(N[4].size?"mobile":"desktop")))&&p(e,"class",T),(!L||V[0]&8208)&&Z(e,"in-transition",!!N[13]),(!L||V[0]&16528)&&Z(e,"hints",N[7]||N[14]),(!L||V[0]&32784)&&Z(e,"annotations",N[15])},i(N){L||(E(S),E(a.$$.fragment,N),E(m),E(Y),E(G),L=!0)},o(N){j(S),j(a.$$.fragment,N),j(m),j(Y),j(G),L=!1},d(N){N&&v(e),S&&S.d(),F(a),~d&&D[d].d(),Y&&Y.d(),n[35](null),G&&G.d(),O=!1,pe(C)}}}const As="var(--baseColor)";function v2(n,e,t){let i,s,l,r,o,a,u,f,c,d,m,h,_,b,g,T,L,O,C,S,P;x(n,dt,q=>t(41,r=q)),x(n,Li,q=>t(1,o=q)),x(n,Ye,q=>t(2,a=q)),x(n,Vn,q=>t(12,u=q)),x(n,We,q=>t(26,f=q)),x(n,$t,q=>t(27,c=q)),x(n,Ii,q=>t(3,d=q)),x(n,Tt,q=>t(4,m=q)),x(n,Xn,q=>t(28,h=q)),x(n,un,q=>t(29,_=q)),x(n,pn,q=>t(30,b=q)),x(n,ai,q=>t(13,g=q)),x(n,Is,q=>t(14,T=q)),x(n,js,q=>t(15,L=q)),x(n,Nd,q=>t(16,O=q)),x(n,Td,q=>t(17,C=q)),x(n,$i,q=>t(18,S=q)),x(n,ui,q=>t(19,P=q));let M,A,D={},R,Y,G=!1,B=!1,N=!0;function V(){let q=m==null?void 0:m.scale;if(!a||q&&!d){ve(Vn,u=q,u);return}J.loadImage(z.files.getURL(a,a.file)).then(ne=>{!ne.success||!ne.width||(clearTimeout(R),R=setTimeout(()=>{if(!M||!(a!=null&&a.id))return;const He=q>0?ne.width*q:ne.width;M.clientWidth<He?q=M.clientWidth/ne.width||1:q||(q=1),ve(Vn,u=q,u)},0))})}function te(q,ne="",He=100){ne=ne||"default",clearTimeout(D[ne]),D[ne]=setTimeout(q,He)}function X(q,ne){ne=ne||M,ne&&(q=="left"?ne.scrollLeft=0:q=="right"?ne.scrollLeft=ne.scrollWidth:ne.scrollLeft=(ne.scrollWidth-ne.offsetWidth)/2)}function U(q){if(o!=Se.comments||c)return;q.preventDefault();const ne={id:"",left:q.offsetX/u,top:q.offsetY/u,message:"",screen:a==null?void 0:a.id};ki(ne,!0)}function ce(q){if(o!=Se.hotspots||f)return;J.normalizePointerEvent(q),q.touches||q.preventDefault();const ne={id:"",left:q.offsetX/u,top:q.offsetY/u,width:25,height:25,type:Xe.screen,settings:{},screen:a==null?void 0:a.id,startResizing:q};En(ne,!0)}function oe(){clearTimeout(B),t(7,G=!1)}function de(){o==Se.preview&&(t(7,G=!0),clearTimeout(B),B=setTimeout(()=>{t(7,G=!1)},500))}hn(()=>{for(let q of r.slice(0,50))J.loadImage(z.files.getURL(q,q.file));return()=>{clearTimeout(B),clearTimeout(R);for(let q in D)clearTimeout(D[q])}});const Ce=()=>{te(()=>{X(a==null?void 0:a.alignment,M),V()})};function xe(q){N=q,t(8,N)}const at=q=>{var ne;(ne=q.detail)==null||ne.scrollIntoView(top),X(a.alignment),te(()=>{J.triggerEvent("mainScreenLoaded")},"mainScreenLoaded")},nt=q=>{q.button==0&&ce(q)};function ct(q){le[q?"unshift":"push"](()=>{M=q,t(0,M)})}const K=()=>X(P.alignment,A);function se(q){le[q?"unshift":"push"](()=>{A=q,t(5,A)})}return n.$$.update=()=>{var q,ne,He,ht,qe,it;n.$$.dirty[0]&16&&t(11,i=((ne=(q=m==null?void 0:m.size)==null?void 0:q.split("x"))==null?void 0:ne[0])<<0),n.$$.dirty[0]&16&&t(10,s=((ht=(He=m==null?void 0:m.size)==null?void 0:He.split("x"))==null?void 0:ht[1])<<0),n.$$.dirty[0]&5&&X(a==null?void 0:a.alignment,M),n.$$.dirty[0]&13&&(d||te(()=>X(a==null?void 0:a.alignment,M),"",0)),n.$$.dirty[0]&28&&(a||m||d)&&(oe(),V()),n.$$.dirty[0]&1275068418&&(o==Se.hotspots&&!f&&!b?t(6,Y={position:"follow",text:"Click and drag to create hotspot",sub:'Hold "Alt" to snap'}):o==Se.comments&&!c?t(6,Y={position:"follow",text:"Click to leave a comment"}):t(6,Y=void 0)),n.$$.dirty[0]&805306368&&t(9,l=(h==null?void 0:h.id)&&((it=(qe=_==null?void 0:_.expand)==null?void 0:qe.users)==null?void 0:it.find(Dt=>Dt.id==h.id)))},[M,o,a,d,m,A,Y,G,N,l,s,i,u,g,T,L,O,C,S,P,V,te,X,U,ce,de,f,c,h,_,b,Ce,xe,at,nt,ct,K,se]}class Hd extends ye{constructor(e){super(),we(this,e,v2,y2,he,{},null,[-1,-1])}}function Ru(n,e,t){const i=n.slice();return i[45]=e[t][0],i[46]=e[t][1],i}function k2(n){let e;return{c(){e=w("i"),p(e,"class","iconoir-settings")},m(t,i){k(t,e,i)},d(t){t&&v(e)}}}function S2(n){let e;return{c(){e=w("div"),p(e,"class","loader loader-xs")},m(t,i){k(t,e,i)},d(t){t&&v(e)}}}function T2(n){let e,t,i,s;return{c(){e=w("input"),p(e,"type","text"),p(e,"id",t=n[44]),e.required=!0,p(e,"placeholder","Screen title")},m(l,r){k(l,e,r),_e(e,n[9].title),i||(s=H(e,"input",n[20]),i=!0)},p(l,r){r[1]&8192&&t!==(t=l[44])&&p(e,"id",t),r[0]&512&&e.value!==l[9].title&&_e(e,l[9].title)},d(l){l&&v(e),i=!1,s()}}}function Hu(n){let e,t,i;function s(){return n[22](n[45])}return{c(){e=w("button"),e.textContent=`${n[46]} `,p(e,"type","button"),p(e,"class","btn btn-sm btn-semitransparent"),Z(e,"btn-primary",n[9].alignment==n[45]||!n[9].alignment&&n[45]=="center")},m(l,r){k(l,e,r),t||(i=H(e,"click",be(s)),t=!0)},p(l,r){n=l,r[0]&1536&&Z(e,"btn-primary",n[9].alignment==n[45]||!n[9].alignment&&n[45]=="center")},d(l){l&&v(e),t=!1,i()}}}function O2(n){let e,t,i,s,l,r,o,a,u,f=Ee(Object.entries(n[10])),c=[];for(let d=0;d<f.length;d+=1)c[d]=Hu(Ru(n,f,d));return{c(){e=w("label"),t=w("span"),t.textContent="Alignment",i=I(),s=w("i"),r=I(),o=w("div");for(let d=0;d<c.length;d+=1)c[d].c();p(t,"class","txt"),p(s,"class",l="iconoir-keyframes txt-sm "+(n[6]?"txt-disabled":"link-hint")),Z(s,"no-pointer-events",n[6]),p(o,"class","btns-group btns-group-block")},m(d,m){k(d,e,m),y(e,t),y(e,i),y(e,s),k(d,r,m),k(d,o,m);for(let h=0;h<c.length;h+=1)c[h]&&c[h].m(o,null);a||(u=[ge(Te.call(null,s,"Apply to all screens")),H(s,"click",Be(be(n[21])))],a=!0)},p(d,m){if(m[0]&64&&l!==(l="iconoir-keyframes txt-sm "+(d[6]?"txt-disabled":"link-hint"))&&p(s,"class",l),m[0]&64&&Z(s,"no-pointer-events",d[6]),m[0]&17920){f=Ee(Object.entries(d[10]));let h;for(h=0;h<f.length;h+=1){const _=Ru(d,f,h);c[h]?c[h].p(_,m):(c[h]=Hu(_),c[h].c(),c[h].m(o,null))}for(;h<c.length;h+=1)c[h].d(1);c.length=f.length}},d(d){d&&(v(e),v(r),v(o)),tn(c,d),a=!1,pe(u)}}}function C2(n){let e,t,i,s,l,r,o,a,u,f,c,d,m=(n[9].background||"none")+"",h,_,b,g;return{c(){e=w("label"),t=w("span"),t.textContent="Background",i=I(),s=w("i"),o=I(),a=w("div"),u=w("input"),c=I(),d=w("label"),h=ee(m),p(t,"class","txt"),p(s,"class",l="iconoir-keyframes txt-sm "+(n[6]?"txt-disabled":"link-hint")),Z(s,"no-pointer-events",n[6]),p(e,"for",r=n[44]),p(u,"type","color"),p(u,"id",f=n[44]),Z(u,"fade",!n[9].background),p(d,"for",_=n[44]),p(d,"class","addon txt-mono"),p(a,"class","field-group")},m(T,L){k(T,e,L),y(e,t),y(e,i),y(e,s),k(T,o,L),k(T,a,L),y(a,u),_e(u,n[9].background),y(a,c),y(a,d),y(d,h),b||(g=[ge(Te.call(null,s,"Apply to all screens")),H(s,"click",Be(be(n[23]))),H(u,"input",n[24])],b=!0)},p(T,L){L[0]&64&&l!==(l="iconoir-keyframes txt-sm "+(T[6]?"txt-disabled":"link-hint"))&&p(s,"class",l),L[0]&64&&Z(s,"no-pointer-events",T[6]),L[1]&8192&&r!==(r=T[44])&&p(e,"for",r),L[1]&8192&&f!==(f=T[44])&&p(u,"id",f),L[0]&512&&_e(u,T[9].background),L[0]&512&&Z(u,"fade",!T[9].background),L[0]&512&&m!==(m=(T[9].background||"none")+"")&&ke(h,m),L[1]&8192&&_!==(_=T[44])&&p(d,"for",_)},d(T){T&&(v(e),v(o),v(a)),b=!1,pe(g)}}}function E2(n){let e,t,i,s,l,r,o,a,u,f,c;return{c(){e=w("input"),i=I(),s=w("label"),l=ee("Has fixed header"),o=I(),a=w("i"),p(e,"type","checkbox"),p(e,"id",t=n[44]),p(s,"for",r=n[44]),p(a,"class",u="iconoir-keyframes txt-sm "+(n[6]?"txt-disabled":"link-hint")),Z(a,"no-pointer-events",n[6])},m(d,m){k(d,e,m),e.checked=n[0],k(d,i,m),k(d,s,m),y(s,l),k(d,o,m),k(d,a,m),f||(c=[H(e,"change",n[25]),H(e,"change",n[26]),ge(Te.call(null,a,"Apply to all screens")),H(a,"click",Be(be(n[27])))],f=!0)},p(d,m){m[1]&8192&&t!==(t=d[44])&&p(e,"id",t),m[0]&1&&(e.checked=d[0]),m[1]&8192&&r!==(r=d[44])&&p(s,"for",r),m[0]&64&&u!==(u="iconoir-keyframes txt-sm "+(d[6]?"txt-disabled":"link-hint"))&&p(a,"class",u),m[0]&64&&Z(a,"no-pointer-events",d[6])},d(d){d&&(v(e),v(i),v(s),v(o),v(a)),f=!1,pe(c)}}}function L2(n){let e,t,i,s,l,r,o;return{c(){e=w("div"),t=w("input"),s=I(),l=w("div"),l.textContent="px",p(t,"id",i=n[44]),p(t,"type","number"),p(t,"min","0"),p(l,"class","addon"),p(e,"class","field-group")},m(a,u){k(a,e,u),y(e,t),n[28](t),_e(t,n[9].fixedHeader),y(e,s),y(e,l),r||(o=H(t,"input",n[29]),r=!0)},p(a,u){u[1]&8192&&i!==(i=a[44])&&p(t,"id",i),u[0]&512&&yt(t.value)!==a[9].fixedHeader&&_e(t,a[9].fixedHeader)},d(a){a&&v(e),n[28](null),r=!1,o()}}}function I2(n){let e,t,i,s,l,r,o,a,u,f,c;return{c(){e=w("input"),i=I(),s=w("label"),l=ee("Has fixed footer"),o=I(),a=w("i"),p(e,"type","checkbox"),p(e,"id",t=n[44]),p(s,"for",r=n[44]),p(a,"class",u="iconoir-keyframes txt-sm "+(n[6]?"txt-disabled":"link-hint")),Z(a,"no-pointer-events",n[6])},m(d,m){k(d,e,m),e.checked=n[1],k(d,i,m),k(d,s,m),y(s,l),k(d,o,m),k(d,a,m),f||(c=[H(e,"change",n[30]),H(e,"change",n[31]),ge(Te.call(null,a,"Apply to all screens")),H(a,"click",Be(be(n[32])))],f=!0)},p(d,m){m[1]&8192&&t!==(t=d[44])&&p(e,"id",t),m[0]&2&&(e.checked=d[1]),m[1]&8192&&r!==(r=d[44])&&p(s,"for",r),m[0]&64&&u!==(u="iconoir-keyframes txt-sm "+(d[6]?"txt-disabled":"link-hint"))&&p(a,"class",u),m[0]&64&&Z(a,"no-pointer-events",d[6])},d(d){d&&(v(e),v(i),v(s),v(o),v(a)),f=!1,pe(c)}}}function j2(n){let e,t,i,s,l,r,o;return{c(){e=w("div"),t=w("input"),s=I(),l=w("div"),l.textContent="px",p(t,"id",i=n[44]),p(t,"type","number"),p(t,"min","0"),p(l,"class","addon"),p(e,"class","field-group")},m(a,u){k(a,e,u),y(e,t),n[33](t),_e(t,n[9].fixedFooter),y(e,s),y(e,l),r||(o=H(t,"input",n[34]),r=!0)},p(a,u){u[1]&8192&&i!==(i=a[44])&&p(t,"id",i),u[0]&512&&yt(t.value)!==a[9].fixedFooter&&_e(t,a[9].fixedFooter)},d(a){a&&v(e),n[33](null),r=!1,o()}}}function P2(n){let e,t,i,s,l,r,o,a;return{c(){e=w("input"),i=I(),s=w("label"),l=ee("Replace screen"),p(e,"type","file"),p(e,"id",t=n[44]),p(e,"class","hidden"),p(s,"for",r=n[44]),p(s,"class","link-hint txt-sm")},m(u,f){k(u,e,f),k(u,i,f),k(u,s,f),y(s,l),o||(a=H(e,"change",n[35]),o=!0)},p(u,f){f[1]&8192&&t!==(t=u[44])&&p(e,"id",t),f[1]&8192&&r!==(r=u[44])&&p(s,"for",r)},d(u){u&&(v(e),v(i),v(s)),o=!1,a()}}}function N2(n){let e,t,i,s,l,r,o,a,u,f,c,d,m,h,_,b,g,T,L,O,C,S,P,M,A,D,R,Y,G;return i=new Oe({props:{class:"form-field required",name:"title",$$slots:{default:[T2,({uniqueId:B})=>({44:B}),({uniqueId:B})=>[0,B?8192:0]]},$$scope:{ctx:n}}}),r=new Oe({props:{class:"form-field form-field-sm",name:"alignment",$$slots:{default:[O2,({uniqueId:B})=>({44:B}),({uniqueId:B})=>[0,B?8192:0]]},$$scope:{ctx:n}}}),u=new Oe({props:{class:"form-field form-field-sm",name:"background",$$slots:{default:[C2,({uniqueId:B})=>({44:B}),({uniqueId:B})=>[0,B?8192:0]]},$$scope:{ctx:n}}}),d=new Oe({props:{class:"form-field form-field-sm form-field-toggle",$$slots:{default:[E2,({uniqueId:B})=>({44:B}),({uniqueId:B})=>[0,B?8192:0]]},$$scope:{ctx:n}}}),_=new Oe({props:{class:"form-field form-field-sm form-field-sm "+(n[0]?"":"invisible"),name:"fixedHeader",$$slots:{default:[L2,({uniqueId:B})=>({44:B}),({uniqueId:B})=>[0,B?8192:0]]},$$scope:{ctx:n}}}),T=new Oe({props:{class:"form-field form-field-sm form-field-toggle",$$slots:{default:[I2,({uniqueId:B})=>({44:B}),({uniqueId:B})=>[0,B?8192:0]]},$$scope:{ctx:n}}}),C=new Oe({props:{class:"form-field form-field-sm form-field-sm "+(n[1]?"":"invisible"),name:"fixedFooter",$$slots:{default:[j2,({uniqueId:B})=>({44:B}),({uniqueId:B})=>[0,B?8192:0]]},$$scope:{ctx:n}}}),D=new Oe({props:{class:"block",name:"file",$$slots:{default:[P2,({uniqueId:B})=>({44:B}),({uniqueId:B})=>[0,B?8192:0]]},$$scope:{ctx:n}}}),{c(){e=w("form"),t=w("div"),W(i.$$.fragment),s=I(),l=w("div"),W(r.$$.fragment),o=I(),a=w("div"),W(u.$$.fragment),f=I(),c=w("div"),W(d.$$.fragment),m=I(),h=w("div"),W(_.$$.fragment),b=I(),g=w("div"),W(T.$$.fragment),L=I(),O=w("div"),W(C.$$.fragment),S=I(),P=w("hr"),M=I(),A=w("div"),W(D.$$.fragment),p(t,"class","col-12"),p(l,"class","col-6"),p(a,"class","col-6"),p(c,"class","col-6 flex-align-self-center"),p(h,"class","col-6"),p(g,"class","col-6 flex-align-self-center"),p(O,"class","col-6"),p(A,"class","block"),p(e,"class","grid grid-sm")},m(B,N){k(B,e,N),y(e,t),$(i,t,null),y(e,s),y(e,l),$(r,l,null),y(e,o),y(e,a),$(u,a,null),y(e,f),y(e,c),$(d,c,null),y(e,m),y(e,h),$(_,h,null),y(e,b),y(e,g),$(T,g,null),y(e,L),y(e,O),$(C,O,null),y(e,S),y(e,P),y(e,M),y(e,A),$(D,A,null),n[36](e),R=!0,Y||(G=[H(e,"change",n[13]),H(e,"submit",be(n[14])),H(e,"click",Be(n[19]))],Y=!0)},p(B,N){const V={};N[0]&512|N[1]&270336&&(V.$$scope={dirty:N,ctx:B}),i.$set(V);const te={};N[0]&576|N[1]&262144&&(te.$$scope={dirty:N,ctx:B}),r.$set(te);const X={};N[0]&576|N[1]&270336&&(X.$$scope={dirty:N,ctx:B}),u.$set(X);const U={};N[0]&593|N[1]&270336&&(U.$$scope={dirty:N,ctx:B}),d.$set(U);const ce={};N[0]&1&&(ce.class="form-field form-field-sm form-field-sm "+(B[0]?"":"invisible")),N[0]&528|N[1]&270336&&(ce.$$scope={dirty:N,ctx:B}),_.$set(ce);const oe={};N[0]&610|N[1]&270336&&(oe.$$scope={dirty:N,ctx:B}),T.$set(oe);const de={};N[0]&2&&(de.class="form-field form-field-sm form-field-sm "+(B[1]?"":"invisible")),N[0]&544|N[1]&270336&&(de.$$scope={dirty:N,ctx:B}),C.$set(de);const Ce={};N[0]&768|N[1]&270336&&(Ce.$$scope={dirty:N,ctx:B}),D.$set(Ce)},i(B){R||(E(i.$$.fragment,B),E(r.$$.fragment,B),E(u.$$.fragment,B),E(d.$$.fragment,B),E(_.$$.fragment,B),E(T.$$.fragment,B),E(C.$$.fragment,B),E(D.$$.fragment,B),R=!0)},o(B){j(i.$$.fragment,B),j(r.$$.fragment,B),j(u.$$.fragment,B),j(d.$$.fragment,B),j(_.$$.fragment,B),j(T.$$.fragment,B),j(C.$$.fragment,B),j(D.$$.fragment,B),R=!1},d(B){B&&v(e),F(i),F(r),F(u),F(d),F(_),F(T),F(C),F(D),n[36](null),Y=!1,pe(G)}}}function A2(n){let e,t,i,s,l,r,o,a;function u(h,_){return h[6]?S2:k2}let f=u(n),c=f(n);function d(h){n[38](h)}let m={class:"screen-settings",focusHide:!n[8],$$slots:{default:[N2]},$$scope:{ctx:n}};return n[7]!==void 0&&(m.active=n[7]),i=new At({props:m}),n[37](i),le.push(()=>Pe(i,"active",d)),i.$on("show",n[11]),i.$on("hide",n[12]),{c(){e=w("div"),c.c(),t=I(),W(i.$$.fragment),p(e,"tabindex","0"),p(e,"class","btn btn-circle btn-hint txt-hint btn-transparent btn-screen-settings")},m(h,_){k(h,e,_),c.m(e,null),y(e,t),$(i,e,null),r=!0,o||(a=ge(l=Te.call(null,e,n[7]?void 0:{position:"top",text:"Screen settings"})),o=!0)},p(h,_){f!==(f=u(h))&&(c.d(1),c=f(h),c&&(c.c(),c.m(e,t)));const b={};_[0]&256&&(b.focusHide=!h[8]),_[0]&891|_[1]&262144&&(b.$$scope={dirty:_,ctx:h}),!s&&_[0]&128&&(s=!0,b.active=h[7],je(()=>s=!1)),i.$set(b),l&&Qe(l.update)&&_[0]&128&&l.update.call(null,h[7]?void 0:{position:"top",text:"Screen settings"})},i(h){r||(E(i.$$.fragment,h),r=!0)},o(h){j(i.$$.fragment,h),r=!1},d(h){h&&v(e),c.d(),n[37](null),F(i),o=!1,a()}}}function D2(n,e,t){let i,s,l,r;x(n,dt,ne=>t(41,s=ne)),x(n,Ye,ne=>t(9,l=ne)),x(n,Bs,ne=>t(18,r=ne));const o=tt(),a={left:"Left",center:"Center",right:"Right"};let u,f,c,d,m=!1,h=!1,_=!1,b=!1,g=!1,T;function L(){u==null||u.show()}function O(){u==null||u.hide()}P();function C(){Kt({}),t(8,g=!1),P()}function S(){(i||l.id&&f&&!f.reportValidity())&&L()}function P(){t(0,_=l.fixedHeader>0),t(1,b=l.fixedFooter>0)}function M(){clearTimeout(T),T=setTimeout(A,100)}async function A(){if(f!=null&&f.reportValidity()){t(6,m=!0);try{const ne=await z.collection("screens").update(l.id,l);jn(ne),o("save",ne),t(6,m=!1)}catch(ne){L(),ne!=null&&ne.isAbort||(t(6,m=!1),z.error(ne))}}}async function D(ne,He){t(6,m=!0);const ht={};ht[ne]=He;try{const qe=[];for(let it of s)qe.push(z.collection("screens").update(it.id,ht,{requestKey:"bulk_update_prop_"+ne+it.id}));await Promise.all(qe).then(it=>{for(let Dt of it)jn(Dt)}),_t("Successfully bulk applied the screen setting."),t(6,m=!1)}catch(qe){qe!=null&&qe.isAbort||(t(6,m=!1),z.error(qe))}}function R(ne){$e.call(this,n,ne)}function Y(){l.title=this.value,Ye.set(l)}const G=()=>{D("alignment",l.alignment)},B=ne=>{ve(Ye,l.alignment=ne,l),A()},N=()=>{D("background",l.background)};function V(){l.background=this.value,Ye.set(l)}function te(){_=this.checked,t(0,_)}const X=ne=>{ne.target.checked&&ne.stopPropagation(),c==null||c.select()},U=()=>D("fixedHeader",l.fixedHeader);function ce(ne){le[ne?"unshift":"push"](()=>{c=ne,t(4,c)})}function oe(){l.fixedHeader=yt(this.value),Ye.set(l)}function de(){b=this.checked,t(1,b)}const Ce=ne=>{ne.target.checked&&ne.stopPropagation(),d==null||d.select()},xe=()=>D("fixedFooter",l.fixedFooter);function at(ne){le[ne?"unshift":"push"](()=>{d=ne,t(5,d)})}function nt(){l.fixedFooter=yt(this.value),Ye.set(l)}const ct=ne=>{ne.target.files.length&&(t(8,g=!0),sr(l,ne.target.files[0]).finally(()=>{t(8,g=!1)}))};function K(ne){le[ne?"unshift":"push"](()=>{f=ne,t(3,f)})}function se(ne){le[ne?"unshift":"push"](()=>{u=ne,t(2,u)})}function q(ne){h=ne,t(7,h)}return n.$$.update=()=>{n.$$.dirty[0]&262144&&(i=!J.isEmpty(r)),n.$$.dirty[0]&1&&(_||ve(Ye,l.fixedHeader=0,l)),n.$$.dirty[0]&2&&(b||ve(Ye,l.fixedFooter=0,l))},[_,b,u,f,c,d,m,h,g,l,a,C,S,M,A,D,L,O,r,R,Y,G,B,N,V,te,X,U,ce,oe,de,Ce,xe,at,nt,ct,K,se,q]}class M2 extends ye{constructor(e){super(),we(this,e,D2,A2,he,{show:16,hide:17},null,[-1,-1])}get show(){return this.$$.ctx[16]}get hide(){return this.$$.ctx[17]}}function Uu(n,e,t){var l;const i=n.slice();i[18]=e[t],i[20]=e,i[21]=t;const s=(l=i[4].filter(function(...o){return n[14](i[18],...o)}))==null?void 0:l.length;return i[19]=s,i}function R2(n){let e,t,i,s,l,r,o,a;function u(...f){return n[10](n[18],...f)}return{c(){var f;e=w("input"),s=I(),l=w("label"),p(e,"type","checkbox"),p(e,"id",t=n[22]),e.checked=i=(f=n[18].screens)==null?void 0:f.includes(n[1].id),p(l,"for",r=n[22])},m(f,c){k(f,e,c),k(f,s,c),k(f,l,c),o||(a=H(e,"change",u),o=!0)},p(f,c){var d;n=f,c&4194304&&t!==(t=n[22])&&p(e,"id",t),c&6&&i!==(i=(d=n[18].screens)==null?void 0:d.includes(n[1].id))&&(e.checked=i),c&4194304&&r!==(r=n[22])&&p(l,"for",r)},d(f){f&&(v(e),v(s),v(l)),o=!1,a()}}}function qu(n,e){let t,i,s,l,r=e[18].title+"",o,a,u,f,c=e[19]+"",d,m,h,_,b,g;i=new Oe({props:{class:"form-field form-field-toggle form-field-auto m-0",$$slots:{default:[R2,({uniqueId:C})=>({22:C}),({uniqueId:C})=>C?4194304:0]},$$scope:{ctx:e}}});function T(...C){return e[11](e[18],...C)}function L(...C){return e[12](e[18],e[20],e[21],...C)}function O(){return e[13](e[18])}return{key:n,first:null,c(){t=w("div"),W(i.$$.fragment),s=I(),l=w("span"),o=ee(r),u=I(),f=w("code"),d=ee(c),m=I(),h=w("button"),h.innerHTML='<i class="iconoir-trash txt-xs"></i>',p(l,"class","template-title"),p(l,"contenteditable","true"),p(l,"data-placeholder",a=e[18].title),p(l,"title","Edit name"),p(f,"class","txt-hint"),p(h,"type","button"),p(h,"class","btn btn-circle btn-sm btn-danger btn-transparent m-l-auto link-fade delete-btn svelte-1ysnxpb"),p(t,"class","dropdown-item"),this.first=t},m(C,S){k(C,t,S),$(i,t,null),y(t,s),y(t,l),y(l,o),y(t,u),y(t,f),y(f,d),y(t,m),y(t,h),_=!0,b||(g=[H(l,"blur",T),H(l,"keydown",q2),H(l,"input",L),ge(Te.call(null,f,"Total hotspots")),H(h,"click",be(O)),H(t,"click",Be(e[9]))],b=!0)},p(C,S){e=C;const P={};S&12582918&&(P.$$scope={dirty:S,ctx:e}),i.$set(P),(!_||S&4)&&r!==(r=e[18].title+"")&&Df(o,r),(!_||S&4&&a!==(a=e[18].title))&&p(l,"data-placeholder",a),(!_||S&20)&&c!==(c=e[19]+"")&&ke(d,c)},i(C){_||(E(i.$$.fragment,C),_=!0)},o(C){j(i.$$.fragment,C),_=!1},d(C){C&&v(t),F(i),b=!1,pe(g)}}}function H2(n){let e=[],t=new Map,i,s,l,r,o,a,u=Ee(n[2]);const f=c=>c[18].id;for(let c=0;c<u.length;c+=1){let d=Uu(n,u,c),m=f(d);t.set(m,e[c]=qu(m,d))}return{c(){for(let c=0;c<e.length;c+=1)e[c].c();i=I(),s=w("div"),l=w("button"),l.innerHTML='<i class="iconoir-plus"></i> <span class="txt">New hotspot template</span>',p(l,"type","button"),p(l,"class","btn btn-block btn-sm btn-success btn-semitransparent"),p(s,"class","block p-5"),Z(s,"m-t-5",n[2].length)},m(c,d){for(let m=0;m<e.length;m+=1)e[m]&&e[m].m(c,d);k(c,i,d),k(c,s,d),y(s,l),r=!0,o||(a=H(l,"click",n[8]),o=!0)},p(c,d){d&4194550&&(u=Ee(c[2]),ae(),e=kt(e,d,f,1,c,u,t,i.parentNode,jt,qu,i,Uu),ue()),(!r||d&4)&&Z(s,"m-t-5",c[2].length)},i(c){if(!r){for(let d=0;d<u.length;d+=1)E(e[d]);r=!0}},o(c){for(let d=0;d<e.length;d+=1)j(e[d]);r=!1},d(c){c&&(v(i),v(s));for(let d=0;d<e.length;d+=1)e[d].d(c);o=!1,a()}}}function U2(n){let e,t,i=n[3].length+"",s,l,r=n[3].length==1?"template":"templates",o,a,u,f,c,d;return c=new At({props:{class:"dropdown templates-dropdown dropdown-upside",focusHide:!1,disableHide:n[0],$$slots:{default:[H2]},$$scope:{ctx:n}}}),{c(){e=w("div"),t=w("strong"),s=ee(i),l=ee(" Applied hotspot "),o=ee(r),a=I(),u=w("i"),f=I(),W(c.$$.fragment),p(u,"class","iconoir-nav-arrow-up"),p(e,"tabindex","0"),p(e,"type","button"),p(e,"class","btn btn-sm btn-hint txt-hint btn-transparent entrance-right")},m(m,h){k(m,e,h),y(e,t),y(t,s),y(e,l),y(e,o),y(e,a),y(e,u),y(e,f),$(c,e,null),d=!0},p(m,[h]){(!d||h&8)&&i!==(i=m[3].length+"")&&ke(s,i),(!d||h&8)&&r!==(r=m[3].length==1?"template":"templates")&&ke(o,r);const _={};h&1&&(_.disableHide=m[0]),h&8388630&&(_.$$scope={dirty:h,ctx:m}),c.$set(_)},i(m){d||(E(c.$$.fragment,m),d=!0)},o(m){j(c.$$.fragment,m),d=!1},d(m){m&&v(e),F(c)}}}const q2=n=>{n.code==="Enter"&&(n.preventDefault(),n.target.blur())};function $2(n,e,t){let i,s,l,r;x(n,Ye,C=>t(1,i=C)),x(n,fn,C=>t(2,s=C)),x(n,G0,C=>t(3,l=C)),x(n,bn,C=>t(4,r=C));const o=tt();let a=!1,u=null;function f(C){clearTimeout(u),u=setTimeout(()=>{c(C)},100)}async function c(C){if(C!=null&&C.id){Wi(C);try{C=await z.collection("hotspotTemplates").update(C.id,C),o("save",C)}catch(S){S.isAbort||z.error(S)}}}function d(C){if(a||!(C!=null&&C.id))return;let S=`Do you really want to delete template "${C.title}" and all of its hotspots?`;t(0,a=!0),Lt(S,()=>m(C),()=>{setTimeout(()=>{t(0,a=!1)},0)})}async function m(C){if(C!=null&&C.id){t(0,a=!0);try{await z.collection("hotspotTemplates").delete(C.id),o("delete",C),Ld(C),t(0,a=!1)}catch(S){S.isAbort||(z.error(S),t(0,a=!1))}}}async function h(){let C="Template ",S="";for(let M=1;M<1e3&&(S=C+(s.length+M),!!s.find(A=>A.title==S));M++);let P={id:"auto_"+J.randomString(10),prototype:i.prototype,screens:[i.id],title:S};Wi(P);try{P=await z.collection("hotspotTemplates").create(P),Wi(P),o("create",P)}catch(M){M.isAbort||z.error(M)}}Yt(()=>{u&&clearTimeout(u)});function _(C){$e.call(this,n,C)}return[a,i,s,l,r,f,c,d,h,_,(C,S)=>{S.target.checked?J.pushUnique(C.screens,i.id):J.removeByValue(C.screens,i.id),c(C)},(C,S)=>{var P;(P=S.target.textContent)!=null&&P.trim()||(S.target.textContent=C.title)},(C,S,P,M)=>{var D;const A=(D=M.target.textContent)==null?void 0:D.trim();A&&A!=C.title&&(ve(fn,S[P].title=A,s),f(C))},C=>d(C),(C,S)=>S.hotspotTemplate==C.id]}class F2 extends ye{constructor(e){super(),we(this,e,$2,U2,he,{})}}function W2(n){let e,t,i,s,l,r,o,a,u,f;return{c(){e=w("input"),i=I(),s=w("label"),l=ee("Show hotspots ("),r=ee(n[4]),o=ee(")"),p(e,"type","checkbox"),p(e,"id",t=n[15]),p(s,"for",a=n[15])},m(c,d){k(c,e,d),n[8](e),e.checked=n[5],k(c,i,d),k(c,s,d),y(s,l),y(s,r),y(s,o),u||(f=H(e,"change",n[9]),u=!0)},p(c,d){d&32768&&t!==(t=c[15])&&p(e,"id",t),d&32&&(e.checked=c[5]),d&16&&ke(r,c[4]),d&32768&&a!==(a=c[15])&&p(s,"for",a)},d(c){c&&(v(e),v(i),v(s)),n[8](null),u=!1,f()}}}function V2(n){let e,t,i,s,l,r,o,a,u,f;return{c(){e=w("input"),i=I(),s=w("label"),l=ee("Show notes ("),r=ee(n[3]),o=ee(")"),p(e,"type","checkbox"),p(e,"id",t=n[15]),p(s,"for",a=n[15])},m(c,d){k(c,e,d),n[11](e),e.checked=n[6],k(c,i,d),k(c,s,d),y(s,l),y(s,r),y(s,o),u||(f=H(e,"change",n[12]),u=!0)},p(c,d){d&32768&&t!==(t=c[15])&&p(e,"id",t),d&64&&(e.checked=c[6]),d&8&&ke(r,c[3]),d&32768&&a!==(a=c[15])&&p(s,"for",a)},d(c){c&&(v(e),v(i),v(s)),n[11](null),u=!1,f()}}}function z2(n){let e,t,i,s,l,r,o,a;return t=new Oe({props:{class:"form-field form-field-sm form-field-toggle m-0",$$slots:{default:[W2,({uniqueId:u})=>({15:u}),({uniqueId:u})=>u?32768:0]},$$scope:{ctx:n}}}),l=new Oe({props:{class:"form-field form-field-sm form-field-toggle m-0",$$slots:{default:[V2,({uniqueId:u})=>({15:u}),({uniqueId:u})=>u?32768:0]},$$scope:{ctx:n}}}),{c(){e=w("div"),W(t.$$.fragment),i=I(),s=w("div"),W(l.$$.fragment),p(e,"class","dropdown-item"),p(s,"class","dropdown-item")},m(u,f){k(u,e,f),$(t,e,null),k(u,i,f),k(u,s,f),$(l,s,null),r=!0,o||(a=[H(e,"click",Be(n[10])),H(s,"click",Be(n[13]))],o=!0)},p(u,f){const c={};f&98354&&(c.$$scope={dirty:f,ctx:u}),t.$set(c);const d={};f&98380&&(d.$$scope={dirty:f,ctx:u}),l.$set(d)},i(u){r||(E(t.$$.fragment,u),E(l.$$.fragment,u),r=!0)},o(u){j(t.$$.fragment,u),j(l.$$.fragment,u),r=!1},d(u){u&&(v(e),v(i),v(s)),F(t),F(l),o=!1,pe(a)}}}function B2(n){let e,t,i,s,l,r,o,a,u;function f(d){n[14](d)}let c={class:"dropdown dropdown-upside dropdown-nowrap",$$slots:{default:[z2]},$$scope:{ctx:n}};return n[0]!==void 0&&(c.active=n[0]),s=new At({props:c}),le.push(()=>Pe(s,"active",f)),{c(){e=w("div"),t=w("i"),i=I(),W(s.$$.fragment),p(t,"class","iconoir-switch-on"),p(e,"tabindex","0"),p(e,"type","button"),p(e,"class","btn btn-circle btn-hint txt-hint btn-transparent entrance-right")},m(d,m){k(d,e,m),y(e,t),y(e,i),$(s,e,null),o=!0,a||(u=ge(r=Te.call(null,e,n[0]?void 0:{position:"top",text:"Preview options"})),a=!0)},p(d,[m]){const h={};m&65662&&(h.$$scope={dirty:m,ctx:d}),!l&&m&1&&(l=!0,h.active=d[0],je(()=>l=!1)),s.$set(h),r&&Qe(r.update)&&m&1&&r.update.call(null,d[0]?void 0:{position:"top",text:"Preview options"})},i(d){o||(E(s.$$.fragment,d),o=!0)},o(d){j(s.$$.fragment,d),o=!1},d(d){d&&v(e),F(s),a=!1,u()}}}function Z2(n,e,t){let i,s,l,r,o;x(n,Nd,T=>t(7,l=T)),x(n,Is,T=>t(5,r=T)),x(n,js,T=>t(6,o=T));let a=!1,u,f;function c(T){le[T?"unshift":"push"](()=>{u=T,t(1,u)})}function d(){r=this.checked,Is.set(r)}const m=()=>t(1,u.checked^=!0,u);function h(T){le[T?"unshift":"push"](()=>{f=T,t(2,f)})}function _(){o=this.checked,js.set(o)}const b=()=>t(2,f.checked^=!0,f);function g(T){a=T,t(0,a)}return n.$$.update=()=>{var T,L;n.$$.dirty&128&&t(4,i=((T=l==null?void 0:l.filter(O=>O.type!=Xe.note))==null?void 0:T.length)||0),n.$$.dirty&128&&t(3,s=((L=l==null?void 0:l.filter(O=>O.type==Xe.note))==null?void 0:L.length)||0)},[a,u,f,s,i,r,o,l,c,d,m,h,_,b,g]}class Ud extends ye{constructor(e){super(),we(this,e,Z2,B2,he,{})}}function $u(n,e,t){const i=n.slice();return i[13]=e[t],i[15]=t,i}function dl(n){const e=n.slice(),t=e[3].filter(function(...s){return n[11](e[13],...s)}).length||0;return e[16]=t,e}function Fu(n){let e,t,i,s,l,r,o,a,u,f,c,d,m=n[3].length&&Wu(n);function h(g,T){return g[5].length?K2:G2}let _=h(n),b=_(n);return{c(){e=w("aside"),t=w("header"),i=w("h6"),i.textContent="Screen comments",s=I(),l=w("button"),l.innerHTML='<i class="iconoir-xmark"></i>',r=I(),m&&m.c(),o=I(),a=w("div"),b.c(),p(l,"type","button"),p(l,"class","btn btn-sm btn-transparent btn-hint btn-circle close-btn"),p(t,"class","sidebar-section sidebar-header"),p(a,"class","sidebar-section sidebar-content"),p(e,"class","screen-preview-sidebar comments-sidebar")},m(g,T){k(g,e,T),y(e,t),y(t,i),y(t,s),y(t,l),y(t,r),m&&m.m(t,null),y(e,o),y(e,a),b.m(a,null),f=!0,c||(d=[ge(Te.call(null,l,{position:"left",text:"Close"})),H(l,"click",be(n[1])),H(e,"introend",J.triggerResize),H(e,"outroend",J.triggerResize)],c=!0)},p(g,T){g[3].length?m?(m.p(g,T),T&8&&E(m,1)):(m=Wu(g),m.c(),E(m,1),m.m(t,null)):m&&(ae(),j(m,1,1,()=>{m=null}),ue()),_===(_=h(g))&&b?b.p(g,T):(b.d(1),b=_(g),b&&(b.c(),b.m(a,null)))},i(g){f||(E(m),g&&vt(()=>{f&&(u||(u=ft(e,Ot,{duration:200,axis:"x"},!0)),u.run(1))}),f=!0)},o(g){j(m),g&&(u||(u=ft(e,Ot,{duration:200,axis:"x"},!1)),u.run(0)),f=!1},d(g){g&&v(e),m&&m.d(),b.d(),g&&u&&u.end(),c=!1,pe(d)}}}function Wu(n){let e,t;return e=new Oe({props:{class:"form-field form-field-toggle m-t-xs m-b-5 entrance-top",$$slots:{default:[Y2,({uniqueId:i})=>({17:i}),({uniqueId:i})=>i?131072:0]},$$scope:{ctx:n}}}),{c(){W(e.$$.fragment)},m(i,s){$(e,i,s),t=!0},p(i,s){const l={};s&393236&&(l.$$scope={dirty:s,ctx:i}),e.$set(l)},i(i){t||(E(e.$$.fragment,i),t=!0)},o(i){j(e.$$.fragment,i),t=!1},d(i){F(e,i)}}}function Y2(n){let e,t,i,s,l,r,o,a,u,f,c;return{c(){e=w("input"),s=I(),l=w("label"),r=ee("Show resolved comments ("),o=ee(n[2]),a=ee(")"),p(e,"type","checkbox"),p(e,"id",t=n[17]),e.disabled=i=n[2]==0,p(l,"for",u=n[17])},m(d,m){k(d,e,m),e.checked=n[4],k(d,s,m),k(d,l,m),y(l,r),y(l,o),y(l,a),f||(c=H(e,"change",n[10]),f=!0)},p(d,m){m&131072&&t!==(t=d[17])&&p(e,"id",t),m&4&&i!==(i=d[2]==0)&&(e.disabled=i),m&16&&(e.checked=d[4]),m&4&&ke(o,d[2]),m&131072&&u!==(u=d[17])&&p(l,"for",u)},d(d){d&&(v(e),v(s),v(l)),f=!1,c()}}}function K2(n){let e,t=[],i=new Map,s=Ee(n[3]);const l=r=>r[13].id;for(let r=0;r<s.length;r+=1){let o=$u(n,s,r),a=l(o);i.set(a,t[r]=Zu(a,o))}return{c(){e=w("div");for(let r=0;r<t.length;r+=1)t[r].c();p(e,"class","flex-list primary-comments-list entrance-top")},m(r,o){k(r,e,o);for(let a=0;a<t.length;a+=1)t[a]&&t[a].m(e,null)},p(r,o){o&88&&(s=Ee(r[3]),t=kt(t,o,l,1,r,s,i,e,zf,Zu,null,$u))},d(r){r&&v(e);for(let o=0;o<t.length;o+=1)t[o].d()}}}function G2(n){let e,t,i,s;function l(a,u){return!a[4]&&a[2]>0?X2:J2}let r=l(n),o=r(n);return{c(){e=w("div"),t=w("div"),t.innerHTML='<i class="iconoir-message-alert"></i>',i=I(),s=w("div"),o.c(),p(t,"class","icon"),p(s,"class","title txt-disabled"),p(e,"class","placeholder-block entrance-top")},m(a,u){k(a,e,u),y(e,t),y(e,i),y(e,s),o.m(s,null)},p(a,u){r!==(r=l(a))&&(o.d(1),o=r(a),o&&(o.c(),o.m(s,null)))},d(a){a&&v(e),o.d()}}}function Vu(n){let e,t,i,s,l=n[15]+1+"",r,o,a,u=J.getCommentAuthor(n[13])+"",f,c,d,m,h=n[13].message+"",_,b,g,T,L=J.relativeDate(n[13].created)+"",O,C,S,P,M,A=n[13].resolved&&zu(),D=n[16]>0&&Bu(n);function R(){return n[12](n[13])}return{c(){var Y;e=w("button"),t=w("div"),i=w("strong"),s=ee("#"),r=ee(l),o=I(),a=w("span"),f=ee(u),c=I(),A&&A.c(),d=I(),m=w("div"),_=ee(h),b=I(),g=w("div"),T=w("span"),O=ee(L),C=I(),D&&D.c(),S=I(),p(i,"class","meta-item number"),p(a,"class","meta-item txt-ellipsis"),p(t,"class","meta"),p(m,"class","content"),p(T,"class","meta-item date"),p(g,"class","meta"),p(e,"type","button"),p(e,"class","bubble primary-comment"),Z(e,"active",n[13].id==((Y=n[6])==null?void 0:Y.id))},m(Y,G){k(Y,e,G),y(e,t),y(t,i),y(i,s),y(i,r),y(t,o),y(t,a),y(a,f),y(t,c),A&&A.m(t,null),y(e,d),y(e,m),y(m,_),y(e,b),y(e,g),y(g,T),y(T,O),y(g,C),D&&D.m(g,null),y(e,S),P||(M=H(e,"click",be(R)),P=!0)},p(Y,G){var B;n=Y,G&8&&l!==(l=n[15]+1+"")&&ke(r,l),G&8&&u!==(u=J.getCommentAuthor(n[13])+"")&&ke(f,u),n[13].resolved?A||(A=zu(),A.c(),A.m(t,null)):A&&(A.d(1),A=null),G&8&&h!==(h=n[13].message+"")&&ke(_,h),G&8&&L!==(L=J.relativeDate(n[13].created)+"")&&ke(O,L),n[16]>0?D?D.p(n,G):(D=Bu(n),D.c(),D.m(g,null)):D&&(D.d(1),D=null),G&72&&Z(e,"active",n[13].id==((B=n[6])==null?void 0:B.id))},d(Y){Y&&v(e),A&&A.d(),D&&D.d(),P=!1,M()}}}function zu(n){let e,t,i;return{c(){e=w("span"),e.innerHTML='<i class="iconoir-double-check txt-success"></i>',p(e,"class","meta-item resolved m-l-auto")},m(s,l){k(s,e,l),t||(i=ge(Te.call(null,e,"Resolved")),t=!0)},d(s){s&&v(e),t=!1,i()}}}function Bu(n){let e,t=n[16]+"",i,s,l=n[16]==1?"reply":"replies",r;return{c(){e=w("span"),i=ee(t),s=I(),r=ee(l),p(e,"class","meta-item m-l-auto")},m(o,a){k(o,e,a),y(e,i),y(e,s),y(e,r)},p(o,a){a&8&&t!==(t=o[16]+"")&&ke(i,t),a&8&&l!==(l=o[16]==1?"reply":"replies")&&ke(r,l)},d(o){o&&v(e)}}}function Zu(n,e){let t,i,s=(e[4]||!e[13].resolved)&&Vu(dl(e));return{key:n,first:null,c(){t=Ne(),s&&s.c(),i=Ne(),this.first=t},m(l,r){k(l,t,r),s&&s.m(l,r),k(l,i,r)},p(l,r){e=l,e[4]||!e[13].resolved?s?s.p(dl(e),r):(s=Vu(dl(e)),s.c(),s.m(i.parentNode,i)):s&&(s.d(1),s=null)},d(l){l&&(v(t),v(i)),s&&s.d(l)}}}function J2(n){let e;return{c(){e=ee("No comments found.")},m(t,i){k(t,e,i)},d(t){t&&v(e)}}}function X2(n){let e;return{c(){e=ee("All comments have been resolved.")},m(t,i){k(t,e,i)},d(t){t&&v(e)}}}function Q2(n){let e,t,i=n[0]&&Fu(n);return{c(){i&&i.c(),e=Ne()},m(s,l){i&&i.m(s,l),k(s,e,l),t=!0},p(s,[l]){s[0]?i?(i.p(s,l),l&1&&E(i,1)):(i=Fu(s),i.c(),E(i,1),i.m(e.parentNode,e)):i&&(ae(),j(i,1,1,()=>{i=null}),ue())},i(s){t||(E(i),t=!0)},o(s){j(i),t=!1},d(s){s&&v(e),i&&i.d(s)}}}function x2(n,e,t){let i,s,l,r,o,a;x(n,$i,b=>t(4,r=b)),x(n,Td,b=>t(9,o=b)),x(n,$t,b=>t(6,a=b));let{active:u=!1}=e;function f(){u?d():c()}function c(){t(0,u=!0)}function d(){t(0,u=!1)}function m(){r=this.checked,$i.set(r)}const h=(b,g)=>g.replyTo==b.id,_=b=>{ve($t,a=b,a)};return n.$$set=b=>{"active"in b&&t(0,u=b.active)},n.$$.update=()=>{n.$$.dirty&512&&t(3,i=o==null?void 0:o.filter(b=>!!b.id)),n.$$.dirty&8&&t(2,s=i.filter(b=>b.resolved).length),n.$$.dirty&4&&s==0&&ve($i,r=!1,r),n.$$.dirty&24&&t(5,l=r?i:i.filter(b=>!b.resolved))},[u,d,s,i,r,l,a,f,c,o,m,h,_]}class qd extends ye{constructor(e){super(),we(this,e,x2,Q2,he,{active:0,toggle:7,show:8,hide:1})}get toggle(){return this.$$.ctx[7]}get show(){return this.$$.ctx[8]}get hide(){return this.$$.ctx[1]}}function ew(n){let e;const t=n[15].default,i=st(t,n,n[19],null);return{c(){i&&i.c()},m(s,l){i&&i.m(s,l),e=!0},p(s,l){i&&i.p&&(!e||l&524288)&&rt(i,t,s,s[19],e?lt(t,s[19],l,null):ot(s[19]),null)},i(s){e||(E(i,s),e=!0)},o(s){j(i,s),e=!1},d(s){i&&i.d(s)}}}function tw(n){let e,t,i,s,l,r;const o=[{class:"popover "+n[1]},{trigger:n[5]},n[8]];function a(f){n[17](f)}let u={$$slots:{default:[ew]},$$scope:{ctx:n}};for(let f=0;f<o.length;f+=1)u=Me(u,o[f]);return n[0]!==void 0&&(u.active=n[0]),t=new At({props:u}),n[16](t),le.push(()=>Pe(t,"active",a)),t.$on("show",n[6]),t.$on("hide",n[7]),{c(){e=w("div"),W(t.$$.fragment),p(e,"class","popover-container"),Z(e,"active",n[0])},m(f,c){k(f,e,c),$(t,e,null),n[18](e),s=!0,l||(r=[H(window,"resize",n[2]),H(window,"mainScreenLoaded",n[2])],l=!0)},p(f,[c]){const d=c&290?gt(o,[c&2&&{class:"popover "+f[1]},c&32&&{trigger:f[5]},c&256&&It(f[8])]):{};c&524288&&(d.$$scope={dirty:c,ctx:f}),!i&&c&1&&(i=!0,d.active=f[0],je(()=>i=!1)),t.$set(d),(!s||c&1)&&Z(e,"active",f[0])},i(f){s||(E(t.$$.fragment,f),s=!0)},o(f){j(t.$$.fragment,f),s=!1},d(f){f&&v(e),n[16](null),F(t),n[18](null),l=!1,pe(r)}}}let Hn;function nw(){return Hn=Hn||document.querySelector(".popovers"),Hn||(Hn=document.createElement("div"),Hn.classList.add("popovers"),document.body.appendChild(Hn)),Hn}function iw(n,e,t){const i=["active","vPadding","hPadding","class","show","hide","forceHide","throttleRefreshPosition","refreshPosition"];let s=ut(e,i),{$$slots:l={},$$scope:r}=e;const o=tt();let{active:a=!1}=e,{vPadding:u=0}=e,{hPadding:f=0}=e,{class:c=void 0}=e,d,m,h,_,b,g;async function T(N,V=null){t(5,h=N),_=V||document.body,m==null||m.show()}function L(){m==null||m.hide()}function O(){m==null||m.forceHide()}function C(N=100){g||(g=setTimeout(()=>{g=null,S()},N))}function S(){if(!a||!h||!d)return;const N=d.offsetWidth,V=d.offsetHeight,te=_||document.body,X=te.clientWidth,U=te.clientHeight;let ce=0,oe=0;const de=h.getBoundingClientRect();ce=de.top+u,X-(de.left+de.width+f)>=N?oe=de.left+de.width+f:de.left-f>=N?oe=de.left-f-N:(oe=de.left+de.width/2-N/2-f,ce=de.top+de.height+u),oe+N>X&&(oe=X-N),oe=oe>=0?oe:0,ce+V>U&&(ce=U-V),ce=ce>=0?ce:0,t(3,d.style.top=(ce<<0)+"px",d),t(3,d.style.left=(oe<<0)+"px",d)}async function P(){R(),await St(),S(),A(),o("show")}function M(){R(),D(),o("hide")}function A(){D(),!(!h||!d)&&(b=new MutationObserver(()=>{C(50)}),b.observe(h,{attributeFilter:["width","height","style","display"],childList:!0,subtree:!0}),b.observe(d,{attributeFilter:["width","height"],childList:!0,subtree:!0}))}function D(){b==null||b.disconnect(),b=null}function R(){clearTimeout(g),g=null}hn(()=>{nw().appendChild(d),S();const N=()=>{C(100)};return document.body.addEventListener("scroll",N,!0),()=>{document.body.removeEventListener("scroll",N,!0),R(),D(),d==null||d.remove()}});function Y(N){le[N?"unshift":"push"](()=>{m=N,t(4,m)})}function G(N){a=N,t(0,a)}function B(N){le[N?"unshift":"push"](()=>{d=N,t(3,d)})}return n.$$set=N=>{e=Me(Me({},e),Zt(N)),t(8,s=ut(e,i)),"active"in N&&t(0,a=N.active),"vPadding"in N&&t(9,u=N.vPadding),"hPadding"in N&&t(10,f=N.hPadding),"class"in N&&t(1,c=N.class),"$$scope"in N&&t(19,r=N.$$scope)},[a,c,S,d,m,h,P,M,s,u,f,T,L,O,C,l,Y,G,B,r]}class $d extends ye{constructor(e){super(),we(this,e,iw,tw,he,{active:0,vPadding:9,hPadding:10,class:1,show:11,hide:12,forceHide:13,throttleRefreshPosition:14,refreshPosition:2})}get show(){return this.$$.ctx[11]}get hide(){return this.$$.ctx[12]}get forceHide(){return this.$$.ctx[13]}get throttleRefreshPosition(){return this.$$.ctx[14]}get refreshPosition(){return this.$$.ctx[2]}}function Yu(n){let e,t,i,s,l;return s=new At({props:{class:"dropdown dropdown-sm comment-dropdown",$$slots:{default:[sw]},$$scope:{ctx:n}}}),{c(){e=w("button"),t=w("i"),i=I(),W(s.$$.fragment),p(t,"class","iconoir-more-horiz"),p(e,"type","button"),p(e,"class","btn btn-transparent btn-hint btn-xs btn-options"),p(e,"aria-label","Comment options")},m(r,o){k(r,e,o),y(e,t),y(e,i),$(s,e,null),l=!0},p(r,o){const a={};o&257&&(a.$$scope={dirty:o,ctx:r}),s.$set(a)},i(r){l||(E(s.$$.fragment,r),l=!0)},o(r){j(s.$$.fragment,r),l=!1},d(r){r&&v(e),F(s)}}}function sw(n){let e,t,i;return{c(){e=w("div"),e.innerHTML='<i class="iconoir-trash"></i> <span class="txt">Delete</span>',p(e,"class","dropdown-item link-danger")},m(s,l){k(s,e,l),t||(i=H(e,"click",n[6]),t=!0)},p:Q,d(s){s&&v(e),t=!1,i()}}}function lw(n){var D;let e,t,i,s,l,r,o,a=J.getCommentAuthor(n[0])+"",u,f,c,d=J.relativeDate(n[0].created)+"",m,h,_,b,g,T=n[0].message+"",L,O,C,S;t=new ts({props:{user:(D=n[0].expand)==null?void 0:D.user,class:"avatar"}});let P=!n[1]&&Yu(n);const M=n[5].default,A=st(M,n,n[8],null);return{c(){e=w("div"),W(t.$$.fragment),i=I(),s=w("div"),l=w("div"),r=w("div"),o=w("small"),u=ee(a),f=I(),c=w("small"),m=ee(d),h=I(),P&&P.c(),_=I(),b=w("div"),g=w("div"),L=ee(T),O=I(),A&&A.c(),p(o,"class","name"),p(c,"class","txt-xs txt-hint date"),p(r,"class","inline-flex flex-row-gap-0"),p(l,"class","row"),p(g,"class","message"),p(b,"class","row"),p(s,"class","content"),p(e,"class",C="list-item "+(n[0].replyTo?"reply":"primary")),Z(e,"unread",!1)},m(R,Y){k(R,e,Y),$(t,e,null),y(e,i),y(e,s),y(s,l),y(l,r),y(r,o),y(o,u),y(r,f),y(r,c),y(c,m),y(l,h),P&&P.m(l,null),y(s,_),y(s,b),y(b,g),y(g,L),y(s,O),A&&A.m(s,null),n[7](e),S=!0},p(R,[Y]){var B;const G={};Y&1&&(G.user=(B=R[0].expand)==null?void 0:B.user),t.$set(G),(!S||Y&1)&&a!==(a=J.getCommentAuthor(R[0])+"")&&ke(u,a),(!S||Y&1)&&d!==(d=J.relativeDate(R[0].created)+"")&&ke(m,d),R[1]?P&&(ae(),j(P,1,1,()=>{P=null}),ue()):P?(P.p(R,Y),Y&2&&E(P,1)):(P=Yu(R),P.c(),E(P,1),P.m(l,null)),(!S||Y&1)&&T!==(T=R[0].message+"")&&ke(L,T),A&&A.p&&(!S||Y&256)&&rt(A,M,R,R[8],S?lt(M,R[8],Y,null):ot(R[8]),null),(!S||Y&1&&C!==(C="list-item "+(R[0].replyTo?"reply":"primary")))&&p(e,"class",C),(!S||Y&1)&&Z(e,"unread",!1)},i(R){S||(E(t.$$.fragment,R),E(P),E(A,R),S=!0)},o(R){j(t.$$.fragment,R),j(P),j(A,R),S=!1},d(R){R&&v(e),F(t),P&&P.d(),A&&A.d(R),n[7](null)}}}function rw(n,e,t){let i,s;x(n,Un,b=>t(9,i=b)),x(n,$t,b=>t(4,s=b));let{$$slots:l={},$$scope:r}=e;const o=tt();let{comment:a}=e,{readonly:u=!1}=e,f;async function c(){await St(),f==null||f.scrollIntoView({block:"nearest",inline:"nearest"})}function d(){if(!(a!=null&&a.id)||u)return;let b="Do you really want to delete the selected comment?";a.replyTo||(b="Do you really want to delete the selected comment and all of its replies?"),ve(Un,i=!0,i),Lt(b,async()=>m(),()=>{setTimeout(()=>{ve(Un,i=!1,i)},0)})}async function m(){if(!(!(a!=null&&a.id)||u)){ve(Un,i=!0,i);try{await z.collection("comments").delete(a.id),o("delete",a),Sd(a)}catch(b){b.isAbort||z.error(b)}ve(Un,i=!1,i)}}const h=()=>d();function _(b){le[b?"unshift":"push"](()=>{f=b,t(2,f)})}return n.$$set=b=>{"comment"in b&&t(0,a=b.comment),"readonly"in b&&t(1,u=b.readonly),"$$scope"in b&&t(8,r=b.$$scope)},n.$$.update=()=>{n.$$.dirty&21&&f&&(s==null?void 0:s.id)==a.id&&c()},[a,u,f,d,s,l,h,_,r]}class ow extends ye{constructor(e){super(),we(this,e,rw,lw,he,{comment:0,readonly:1})}}function Ku(n,e,t){const i=n.slice();return i[22]=e[t],i[23]=e,i[24]=t,i}function Gu(n){let e,t=Ee(n[3]),i=[];for(let s=0;s<t.length;s+=1)i[s]=Ju(Ku(n,t,s));return{c(){e=w("div");for(let s=0;s<i.length;s+=1)i[s].c();p(e,"class","dropdown dropdown-sm collaborators-dropdown")},m(s,l){k(s,e,l);for(let r=0;r<i.length;r+=1)i[r]&&i[r].m(e,null)},p(s,l){if(l&30){t=Ee(s[3]);let r;for(r=0;r<t.length;r+=1){const o=Ku(s,t,r);i[r]?i[r].p(o,l):(i[r]=Ju(o),i[r].c(),i[r].m(e,null))}for(;r<i.length;r+=1)i[r].d(1);i.length=t.length}},d(s){s&&v(e),tn(i,s)}}}function Ju(n){let e,t,i=n[22].label+"",s,l,r=n[24],o,a;const u=()=>n[10](e,r),f=()=>n[10](null,r);function c(){return n[11](n[24])}return{c(){e=w("div"),t=ee("+"),s=ee(i),l=I(),p(e,"class","dropdown-item"),Z(e,"focused",n[24]==n[1])},m(d,m){k(d,e,m),y(e,t),y(e,s),y(e,l),u(),o||(a=H(e,"click",be(c)),o=!0)},p(d,m){n=d,m&8&&i!==(i=n[22].label+"")&&ke(s,i),r!==n[24]&&(f(),r=n[24],u()),m&2&&Z(e,"focused",n[24]==n[1])},d(d){d&&v(e),f(),o=!1,a()}}}function aw(n){let e,t=n[0]&&Gu(n);return{c(){t&&t.c(),e=Ne()},m(i,s){t&&t.m(i,s),k(i,e,s)},p(i,[s]){i[0]?t?t.p(i,s):(t=Gu(i),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},i:Q,o:Q,d(i){i&&v(e),t&&t.d(i)}}}function uw(n,e,t){const i=tt();let{input:s}=e,{list:l=[]}=e,{triggers:r=["+","@"]}=e,o=!1,a=0,u=[],f=[];function c(){o||(t(0,o=!0),t(1,a=0),i("show"))}function d(){o&&(t(0,o=!1),i("hide"))}function m(A){A=typeof A<"u"?A:a;let D=g();if(!D.word||!s||!f[A])return;let R=s.value;t(5,s.value=R.substring(0,D.start)+r[0]+f[A].value+R.substring(D.end+1)+" ",s),s.dispatchEvent(new Event("input")),s.focus(),d()}function h(){a<=0?t(1,a=f.length-1):t(1,a--,a),b()}function _(){a>=f.length-1?t(1,a=0):t(1,a++,a),b()}function b(){var A;(A=u[a])==null||A.scrollIntoView({block:"nearest"})}function g(){const A=typeof s.selectionStart<"u"?s.selectionStart:s.value.length;return J.getWordInfoAt(s.value,A-1)}function T(){var D;const A=g();d(),A.word&&r.indexOf((D=A.word)==null?void 0:D[0])>=0&&(t(3,f=L(A.word.substring(1))),f.length&&c())}function L(A){if(A=(A||"").toLowerCase().replace(/\s+/g,""),!A)return l;const D=[];for(let R=l.length-1;R>=0;R--)(l[R].value+l[R].label||"").toLowerCase().replace(/\s+/g,"").indexOf(A)>=0&&D.push(l[R]);return D}function O(A){if(!o)return;let D=A.code;D=="Enter"?(A.preventDefault(),m()):D=="ArrowUp"?(A.preventDefault(),h()):D=="ArrowDown"&&(A.preventDefault(),_())}function C(){s==null||s.removeEventListener("input",T),s==null||s.removeEventListener("keydown",O)}function S(){C(),s.addEventListener("input",T),s.addEventListener("keydown",O)}Yt(()=>{C()});function P(A,D){le[A?"unshift":"push"](()=>{u[D]=A,t(2,u)})}const M=A=>m(A);return n.$$set=A=>{"input"in A&&t(5,s=A.input),"list"in A&&t(6,l=A.list),"triggers"in A&&t(7,r=A.triggers)},n.$$.update=()=>{n.$$.dirty&32&&s&&S()},[o,a,u,f,m,s,l,r,c,d,P,M]}class fw extends ye{constructor(e){super(),we(this,e,uw,aw,he,{input:5,list:6,triggers:7,show:8,hide:9})}get show(){return this.$$.ctx[8]}get hide(){return this.$$.ctx[9]}}function Xu(n,e,t){const i=n.slice();return i[42]=e[t][0],i[43]=e[t][1],i}function Qu(n,e,t){const i=n.slice();return i[46]=e[t],i}function xu(n){let e,t;return e=new Oe({props:{class:"form-field form-field-toggle form-field-sm resolved-checkbox",$$slots:{default:[cw,({uniqueId:i})=>({41:i}),({uniqueId:i})=>[0,i?1024:0]]},$$scope:{ctx:n}}}),{c(){W(e.$$.fragment)},m(i,s){$(e,i,s),t=!0},p(i,s){const l={};s[0]&16|s[1]&263168&&(l.$$scope={dirty:s,ctx:i}),e.$set(l)},i(i){t||(E(e.$$.fragment,i),t=!0)},o(i){j(e.$$.fragment,i),t=!1},d(i){F(e,i)}}}function cw(n){let e,t,i,s,l,r,o,a,u;return{c(){var f;e=w("input"),s=I(),l=w("label"),r=ee("Mark as resolved"),p(e,"type","checkbox"),p(e,"id",t=n[41]),e.checked=i=(f=n[4])==null?void 0:f.resolved,p(l,"for",o=n[41])},m(f,c){k(f,e,c),k(f,s,c),k(f,l,c),y(l,r),a||(u=H(e,"change",n[24]),a=!0)},p(f,c){var d;c[1]&1024&&t!==(t=f[41])&&p(e,"id",t),c[0]&16&&i!==(i=(d=f[4])==null?void 0:d.resolved)&&(e.checked=i),c[1]&1024&&o!==(o=f[41])&&p(l,"for",o)},d(f){f&&(v(e),v(s),v(l)),a=!1,u()}}}function ef(n){let e,t,i=Ee(n[7]),s=[];for(let r=0;r<i.length;r+=1)s[r]=tf(Qu(n,i,r));const l=r=>j(s[r],1,1,()=>{s[r]=null});return{c(){e=w("div");for(let r=0;r<s.length;r+=1)s[r].c();p(e,"class","list comments-list")},m(r,o){k(r,e,o);for(let a=0;a<s.length;a+=1)s[a]&&s[a].m(e,null);t=!0},p(r,o){if(o[0]&136){i=Ee(r[7]);let a;for(a=0;a<i.length;a+=1){const u=Qu(r,i,a);s[a]?(s[a].p(u,o),E(s[a],1)):(s[a]=tf(u),s[a].c(),E(s[a],1),s[a].m(e,null))}for(ae(),a=i.length;a<s.length;a+=1)l(a);ue()}},i(r){if(!t){for(let o=0;o<i.length;o+=1)E(s[o]);t=!0}},o(r){s=s.filter(Boolean);for(let o=0;o<s.length;o+=1)j(s[o]);t=!1},d(r){r&&v(e),tn(s,r)}}}function tf(n){let e,t;return e=new ow({props:{readonly:!n[3],comment:n[46]}}),{c(){W(e.$$.fragment)},m(i,s){$(e,i,s),t=!0},p(i,s){const l={};s[0]&8&&(l.readonly=!i[3]),s[0]&128&&(l.comment=i[46]),e.$set(l)},i(i){t||(E(e.$$.fragment,i),t=!0)},o(i){j(e.$$.fragment,i),t=!1},d(i){F(e,i)}}}function nf(n){let e,t;return e=new Oe({props:{class:"form-field",name:"guestEmail",inlineError:!0,$$slots:{default:[dw,({uniqueId:i})=>({41:i}),({uniqueId:i})=>[0,i?1024:0]]},$$scope:{ctx:n}}}),{c(){W(e.$$.fragment)},m(i,s){$(e,i,s),t=!0},p(i,s){const l={};s[0]&18|s[1]&263168&&(l.$$scope={dirty:s,ctx:i}),e.$set(l)},i(i){t||(E(e.$$.fragment,i),t=!0)},o(i){j(e.$$.fragment,i),t=!1},d(i){F(e,i)}}}function dw(n){let e,t,i,s,l,r,o,a,u,f;return{c(){var c;e=w("div"),t=w("label"),i=w("i"),l=I(),r=w("input"),p(i,"class","iconoir-mail"),p(t,"class","addon"),p(t,"for",s=n[41]),p(r,"type","email"),p(r,"id",o=n[41]),p(r,"placeholder","Your email"),r.autofocus=a=!n[1]&&!((c=n[4])!=null&&c.id)?!0:null,p(e,"class","field-group")},m(c,d){var m;k(c,e,d),y(e,t),y(t,i),y(e,l),y(e,r),_e(r,n[1]),!n[1]&&!((m=n[4])!=null&&m.id)&&r.focus(),u||(f=H(r,"input",n[25]),u=!0)},p(c,d){var m;d[1]&1024&&s!==(s=c[41])&&p(t,"for",s),d[1]&1024&&o!==(o=c[41])&&p(r,"id",o),d[0]&18&&a!==(a=!c[1]&&!((m=c[4])!=null&&m.id)?!0:null)&&(r.autofocus=a),d[0]&2&&r.value!==c[1]&&_e(r,c[1])},d(c){c&&v(e),u=!1,f()}}}function sf(n){let e,t=n[43]+"",i,s,l,r;function o(){return n[29](n[43])}return{c(){e=w("button"),i=ee(t),s=I(),p(e,"type","button"),p(e,"title",n[42]),p(e,"class","emoji closable")},m(a,u){k(a,e,u),y(e,i),y(e,s),l||(r=H(e,"click",be(o)),l=!0)},p(a,u){n=a},d(a){a&&v(e),l=!1,r()}}}function pw(n){let e,t=Ee(Object.entries(n[11])),i=[];for(let s=0;s<t.length;s+=1)i[s]=sf(Xu(n,t,s));return{c(){for(let s=0;s<i.length;s+=1)i[s].c();e=Ne()},m(s,l){for(let r=0;r<i.length;r+=1)i[r]&&i[r].m(s,l);k(s,e,l)},p(s,l){if(l[0]&2049){t=Ee(Object.entries(s[11]));let r;for(r=0;r<t.length;r+=1){const o=Xu(s,t,r);i[r]?i[r].p(o,l):(i[r]=sf(o),i[r].c(),i[r].m(e.parentNode,e))}for(;r<i.length;r+=1)i[r].d(1);i.length=t.length}},d(s){s&&v(e),tn(i,s)}}}function mw(n){let e,t,i,s,l,r,o,a,u,f,c,d,m,h;return u=new At({props:{class:"dropdown emojis-dropdown",$$slots:{default:[pw]},$$scope:{ctx:n}}}),{c(){var _;e=w("textarea"),s=I(),l=w("div"),r=w("button"),o=w("i"),a=I(),W(u.$$.fragment),f=I(),c=w("button"),c.innerHTML='<i class="iconoir-send"></i>',p(e,"id",t=n[41]),e.autofocus=i=!n[9]&&!((_=n[4])!=null&&_.id)?!0:null,p(e,"placeholder","Write a comment (@ to mention)"),p(o,"class","iconoir-emoji"),p(r,"type","button"),p(r,"class","btn btn-transparent btn-hint btn-sm btn-circle"),r.disabled=n[2],p(c,"type","button"),p(c,"class","btn btn-transparent btn-hint btn-sm btn-circle"),Z(c,"btn-loading",n[2]),p(l,"class","ctrls")},m(_,b){var g;k(_,e,b),n[26](e),_e(e,n[0]),k(_,s,b),k(_,l,b),y(l,r),y(r,o),y(r,a),$(u,r,null),y(l,f),y(l,c),d=!0,!n[9]&&!((g=n[4])!=null&&g.id)&&e.focus(),m||(h=[H(e,"input",n[27]),H(e,"keydown",n[28]),ge(Te.call(null,r,{position:"right",text:"Emojis"})),ge(Te.call(null,c,{position:"right",text:"Send (Ctrl + Enter)"})),H(c,"click",be(n[13]))],m=!0)},p(_,b){var T;(!d||b[1]&1024&&t!==(t=_[41]))&&p(e,"id",t),(!d||b[0]&528&&i!==(i=!_[9]&&!((T=_[4])!=null&&T.id)?!0:null))&&(e.autofocus=i),b[0]&1&&_e(e,_[0]);const g={};b[0]&1|b[1]&262144&&(g.$$scope={dirty:b,ctx:_}),u.$set(g),(!d||b[0]&4)&&(r.disabled=_[2]),(!d||b[0]&4)&&Z(c,"btn-loading",_[2])},i(_){d||(E(u.$$.fragment,_),d=!0)},o(_){j(u.$$.fragment,_),d=!1},d(_){_&&(v(e),v(s),v(l)),n[26](null),F(u),m=!1,pe(h)}}}function hw(n){var d;let e,t,i,s,l,r,o,a,u=((d=n[4])==null?void 0:d.id)&&xu(n),f=n[7].length&&ef(n),c=n[9]&&nf(n);return l=new Oe({props:{class:"form-field",name:"message",inlineError:!0,$$slots:{default:[mw,({uniqueId:m})=>({41:m}),({uniqueId:m})=>[0,m?1024:0]]},$$scope:{ctx:n}}}),o=new fw({props:{input:n[6],list:n[8]}}),o.$on("hide",n[30]),o.$on("show",n[31]),{c(){u&&u.c(),e=I(),f&&f.c(),t=I(),i=w("div"),c&&c.c(),s=I(),W(l.$$.fragment),r=I(),W(o.$$.fragment),p(i,"class","comment-form")},m(m,h){u&&u.m(m,h),k(m,e,h),f&&f.m(m,h),k(m,t,h),k(m,i,h),c&&c.m(i,null),y(i,s),$(l,i,null),y(i,r),$(o,i,null),a=!0},p(m,h){var g;(g=m[4])!=null&&g.id?u?(u.p(m,h),h[0]&16&&E(u,1)):(u=xu(m),u.c(),E(u,1),u.m(e.parentNode,e)):u&&(ae(),j(u,1,1,()=>{u=null}),ue()),m[7].length?f?(f.p(m,h),h[0]&128&&E(f,1)):(f=ef(m),f.c(),E(f,1),f.m(t.parentNode,t)):f&&(ae(),j(f,1,1,()=>{f=null}),ue()),m[9]?c?(c.p(m,h),h[0]&512&&E(c,1)):(c=nf(m),c.c(),E(c,1),c.m(i,s)):c&&(ae(),j(c,1,1,()=>{c=null}),ue());const _={};h[0]&597|h[1]&263168&&(_.$$scope={dirty:h,ctx:m}),l.$set(_);const b={};h[0]&64&&(b.input=m[6]),h[0]&256&&(b.list=m[8]),o.$set(b)},i(m){a||(E(u),E(f),E(c),E(l.$$.fragment,m),E(o.$$.fragment,m),a=!0)},o(m){j(u),j(f),j(c),j(l.$$.fragment,m),j(o.$$.fragment,m),a=!1},d(m){m&&(v(e),v(t),v(i)),u&&u.d(m),f&&f.d(m),c&&c.d(),F(l),F(o)}}}function _w(n){let e,t;const i=[{class:"comments-popover"},{disableHide:!n[10]},{escHide:n[10]},{vPadding:0},{hPadding:5},n[15]];let s={$$slots:{default:[hw]},$$scope:{ctx:n}};for(let l=0;l<i.length;l+=1)s=Me(s,i[l]);return e=new $d({props:s}),n[32](e),e.$on("hide",n[12]),{c(){W(e.$$.fragment)},m(l,r){$(e,l,r),t=!0},p(l,r){const o=r[0]&33792?gt(i,[i[0],r[0]&1024&&{disableHide:!l[10]},r[0]&1024&&{escHide:l[10]},i[3],i[4],r[0]&32768&&It(l[15])]):{};r[0]&1023|r[1]&262144&&(o.$$scope={dirty:r,ctx:l}),e.$set(o)},i(l){t||(E(e.$$.fragment,l),t=!0)},o(l){j(e.$$.fragment,l),t=!1},d(l){n[32](null),F(e,l)}}}const lf="guestEmail";function gw(n,e,t){let i,s,l,r,o,a;const u=["viewport"];let f=ut(e,u),c,d,m,h,_,b,g,T;x(n,Xn,se=>t(18,c=se)),x(n,Nn,se=>t(34,d=se)),x(n,un,se=>t(19,m=se)),x(n,gn,se=>t(35,h=se)),x(n,$t,se=>t(20,_=se)),x(n,Ye,se=>t(21,b=se)),x(n,Un,se=>t(22,g=se)),x(n,or,se=>t(23,T=se));const L=tt(),O={"+1":"👍","-1":"👎",ok:"👌",pray:"🙏",smile:"🙂",confused:"😕",thinking:"🤔",joy:"😂",hooray:"🎉",watching:"👀",love:"❤️",poop:"💩"};let{viewport:C=null}=e,S,P,M="",A="",D=[],R=!1,Y=[];async function G(se){if(!se){S==null||S.forceHide();return}await St();const q=se.replyTo||se.id,ne=document.querySelector(`[data-comment-pin="${q}"]`);if(!ne){S==null||S.forceHide();return}N(),ne.scrollIntoView({block:"nearest",inline:"nearest"}),U(),S==null||S.show(ne,C),X()}function B(){Il(),ve($t,_=null,_)}function N(se=!1){Kt({}),t(1,A=A||window.localStorage.getItem(lf)||""),se?t(0,M=""):t(0,M=(""+M).trim()),t(2,R=!1)}async function V(){if(!l)return;t(2,R=!0);const se={screen:i==null?void 0:i.screen,left:i==null?void 0:i.left,top:i==null?void 0:i.top,replyTo:i==null?void 0:i.id,message:(""+M).trim()};o?se.user=c.id:c.email?se.guestEmail=c.email:se.guestEmail=A;try{const q=await z.collection("comments").create(se,{expand:"user"});N(!0),await St(),Il(),ki(q,!0),L("create",q)}catch(q){if(q.isAbort)return;se.guestEmail&&J.isEmpty(q.response.data)&&(q.response.data={guestEmail:{code:"invalid_guestEmail",message:"The guest email is invalid or it matches with one of project owners."}}),z.error(q),t(2,R=!1)}}async function te(se=!0){if(!(R&&!i)){t(2,R=!0);try{const q=await z.collection("comments").update(i.id,{resolved:se},{expand:"user"});t(2,R=!1),await St(),se&&(S==null||S.forceHide()),ki(q),L("resolved",q)}catch(q){q.isAbort||(z.error(q),t(2,R=!1))}}}async function X(){if(!o)return;const se=D.map(He=>He.id),q=h.filter(He=>se.includes(He.comment)),ne=[];for(let He of q)lr(He),ne.push(z.collection("notifications").update(He.id,{read:!0}));return Promise.allSettled(ne)}function U(){var ne,He,ht;t(8,Y=[]);const se=[],q=(((ne=m==null?void 0:m.expand)==null?void 0:ne.users)||[]).slice();for(const qe of d)(He=qe.expand)!=null&&He.user?J.pushOrReplaceObject(q,(ht=qe.expand)==null?void 0:ht.user):qe.guestEmail&&J.pushUnique(se,qe.guestEmail);for(const qe of q){if(qe.id==(c==null?void 0:c.id))continue;const it=qe.name||qe.email;Y.push({label:qe.username+(it?` (${it})`:""),value:qe.username})}for(const qe of se)qe==A||qe==(c==null?void 0:c.email)||Y.push({label:qe,value:qe})}const ce=se=>{te(se.target.checked)};function oe(){A=this.value,t(1,A)}function de(se){le[se?"unshift":"push"](()=>{P=se,t(6,P)})}function Ce(){M=this.value,t(0,M)}const xe=se=>{se.ctrlKey&&se.code==="Enter"&&(se.preventDefault(),V())},at=se=>{t(0,M+=se)},nt=async()=>{await St(),S==null||S.refreshPosition()},ct=async()=>{await St(),S==null||S.refreshPosition()};function K(se){le[se?"unshift":"push"](()=>{S=se,t(5,S)})}return n.$$set=se=>{e=Me(Me({},e),Zt(se)),t(15,f=ut(e,u)),"viewport"in se&&t(16,C=se.viewport)},n.$$.update=()=>{var se,q;n.$$.dirty[0]&9437184&&t(4,i=T.find(ne=>ne.id&&ne.id==(_==null?void 0:_.replyTo))||_),n.$$.dirty[0]&8388624&&t(17,s=i!=null&&i.id?T.filter(ne=>ne.replyTo===i.id):[]),n.$$.dirty[0]&131088&&t(7,D=i!=null&&i.id?[i].concat(s):[]),n.$$.dirty[0]&5&&(l=!R&&M!=""),n.$$.dirty[0]&4194308&&t(10,r=!R&&!g),n.$$.dirty[0]&3145728&&b&&G(_),n.$$.dirty[0]&786432&&t(3,o=(c==null?void 0:c.id)&&((q=(se=m==null?void 0:m.expand)==null?void 0:se.users)==null?void 0:q.find(ne=>ne.id==c.id))),n.$$.dirty[0]&262152&&t(9,a=!o&&!(c!=null&&c.email)),n.$$.dirty[0]&2&&A&&window.localStorage.setItem(lf,A)},[M,A,R,o,i,S,P,D,Y,a,r,O,B,V,te,f,C,s,c,m,_,b,g,T,ce,oe,de,Ce,xe,at,nt,ct,K]}class Fd extends ye{constructor(e){super(),we(this,e,gw,_w,he,{viewport:16},null,[-1,-1])}}function bw(n){let e,t,i,s,l,r;return t=new Gt({props:{src:z.files.getURL(n[0],n[0].file,{thumb:"100x100t"}),alt:n[0].title}}),{c(){e=w("div"),W(t.$$.fragment),p(e,"class","thumb thumb-handle")},m(o,a){k(o,e,a),$(t,e,null),s=!0,l||(r=ge(i=Te.call(null,e,n[0].title)),l=!0)},p(o,[a]){const u={};a&1&&(u.src=z.files.getURL(o[0],o[0].file,{thumb:"100x100t"})),a&1&&(u.alt=o[0].title),t.$set(u),i&&Qe(i.update)&&a&1&&i.update.call(null,o[0].title)},i(o){s||(E(t.$$.fragment,o),s=!0)},o(o){j(t.$$.fragment,o),s=!1},d(o){o&&v(e),F(t),l=!1,r()}}}function ww(n,e,t){let{item:i={}}=e;return n.$$set=s=>{"item"in s&&t(0,i=s.item)},[i]}class yw extends ye{constructor(e){super(),we(this,e,ww,bw,he,{item:0})}}function vw(n){let e,t,i,s,l=n[0].title+"",r,o;return t=new Gt({props:{src:z.files.getURL(n[0],n[0].file,{thumb:"100x100t"}),alt:n[0].title}}),{c(){e=w("div"),W(t.$$.fragment),i=I(),s=w("span"),r=ee(l),p(e,"class","thumb thumb-xs"),p(s,"class","txt title m-l-5")},m(a,u){k(a,e,u),$(t,e,null),k(a,i,u),k(a,s,u),y(s,r),o=!0},p(a,[u]){const f={};u&1&&(f.src=z.files.getURL(a[0],a[0].file,{thumb:"100x100t"})),u&1&&(f.alt=a[0].title),t.$set(f),(!o||u&1)&&l!==(l=a[0].title+"")&&ke(r,l)},i(a){o||(E(t.$$.fragment,a),o=!0)},o(a){j(t.$$.fragment,a),o=!1},d(a){a&&(v(e),v(i),v(s)),F(t)}}}function kw(n,e,t){let{item:i={}}=e;return n.$$set=s=>{"item"in s&&t(0,i=s.item)},[i]}class Sw extends ye{constructor(e){super(),we(this,e,kw,vw,he,{item:0})}}function Tw(n){let e,t,i,s,l,r,o;const a=[{id:n[6]},{searchable:!0},{class:"screens-select"},{items:n[3]},{noOptionsText:"No screens found"},{selectPlaceholder:"- Select screen -"},{labelComponent:Sw},{optionComponent:yw},{selectionKey:"id"},n[4]];function u(c){n[5](c)}let f={};for(let c=0;c<a.length;c+=1)f=Me(f,a[c]);return n[0]!==void 0&&(f.keyOfSelected=n[0]),l=new cn({props:f}),le.push(()=>Pe(l,"keyOfSelected",u)),{c(){e=w("label"),t=ee(n[1]),s=I(),W(l.$$.fragment),p(e,"for",i=n[6])},m(c,d){k(c,e,d),y(e,t),k(c,s,d),$(l,c,d),o=!0},p(c,d){(!o||d&2)&&ke(t,c[1]),(!o||d&64&&i!==(i=c[6]))&&p(e,"for",i);const m=d&88?gt(a,[d&64&&{id:c[6]},a[1],a[2],d&8&&{items:c[3]},a[4],a[5],a[6],a[7],a[8],d&16&&It(c[4])]):{};!r&&d&1&&(r=!0,m.keyOfSelected=c[0],je(()=>r=!1)),l.$set(m)},i(c){o||(E(l.$$.fragment,c),o=!0)},o(c){j(l.$$.fragment,c),o=!1},d(c){c&&(v(e),v(s)),F(l,c)}}}function Ow(n){let e,t;return e=new Oe({props:{class:"form-field required "+n[2],name:"settings.screen",$$slots:{default:[Tw,({uniqueId:i})=>({6:i}),({uniqueId:i})=>i?64:0]},$$scope:{ctx:n}}}),{c(){W(e.$$.fragment)},m(i,s){$(e,i,s),t=!0},p(i,[s]){const l={};s&4&&(l.class="form-field required "+i[2]),s&219&&(l.$$scope={dirty:s,ctx:i}),e.$set(l)},i(i){t||(E(e.$$.fragment,i),t=!0)},o(i){j(e.$$.fragment,i),t=!1},d(i){F(e,i)}}}function Cw(n,e,t){const i=["value","label","class"];let s=ut(e,i),l;x(n,dt,f=>t(3,l=f));let{value:r}=e,{label:o="Screen"}=e,{class:a=""}=e;function u(f){r=f,t(0,r),t(3,l)}return n.$$set=f=>{e=Me(Me({},e),Zt(f)),t(4,s=ut(e,i)),"value"in f&&t(0,r=f.value),"label"in f&&t(1,o=f.label),"class"in f&&t(2,a=f.class)},n.$$.update=()=>{n.$$.dirty&9&&!r&&l.length&&t(0,r=l[0].id)},[r,o,a,l,s,u]}class Wd extends ye{constructor(e){super(),we(this,e,Cw,Ow,he,{value:0,label:1,class:2})}}function Ew(n){let e,t,i,s,l,r,o;function a(f){n[4](f)}let u={class:"duo-columns-dropdown",id:n[5],items:n[3]};return n[0]!==void 0&&(u.keyOfSelected=n[0]),l=new cn({props:u}),le.push(()=>Pe(l,"keyOfSelected",a)),{c(){e=w("label"),t=ee(n[1]),s=I(),W(l.$$.fragment),p(e,"for",i=n[5])},m(f,c){k(f,e,c),y(e,t),k(f,s,c),$(l,f,c),o=!0},p(f,c){(!o||c&2)&&ke(t,f[1]),(!o||c&32&&i!==(i=f[5]))&&p(e,"for",i);const d={};c&32&&(d.id=f[5]),!r&&c&1&&(r=!0,d.keyOfSelected=f[0],je(()=>r=!1)),l.$set(d)},i(f){o||(E(l.$$.fragment,f),o=!0)},o(f){j(l.$$.fragment,f),o=!1},d(f){f&&(v(e),v(s)),F(l,f)}}}function Lw(n){let e,t;return e=new Oe({props:{class:"form-field "+n[2],name:"settings.transition",$$slots:{default:[Ew,({uniqueId:i})=>({5:i}),({uniqueId:i})=>i?32:0]},$$scope:{ctx:n}}}),{c(){W(e.$$.fragment)},m(i,s){$(e,i,s),t=!0},p(i,[s]){const l={};s&4&&(l.class="form-field "+i[2]),s&99&&(l.$$scope={dirty:s,ctx:i}),e.$set(l)},i(i){t||(E(e.$$.fragment,i),t=!0)},o(i){j(e.$$.fragment,i),t=!1},d(i){F(e,i)}}}function Iw(n,e,t){const i=[{value:"",label:"None",icon:"iconoir-position-align"},{value:"fade",label:"Fade",icon:"iconoir-center-align"},{value:"slide-left",label:"Slide left",icon:"iconoir-align-left-box"},{value:"slide-right",label:"Slide right",icon:"iconoir-align-right-box"},{value:"slide-top",label:"Slide up",icon:"iconoir-align-top-box"},{value:"slide-bottom",label:"Slide down",icon:"iconoir-align-bottom-box"}];let{value:s=""}=e,{label:l="Transitions"}=e,{class:r=""}=e;function o(a){s=a,t(0,s)}return n.$$set=a=>{"value"in a&&t(0,s=a.value),"label"in a&&t(1,l=a.label),"class"in a&&t(2,r=a.class)},n.$$.update=()=>{n.$$.dirty&1&&(typeof s>"u"||s===null)&&t(0,s="")},[s,l,r,i,o]}class ss extends ye{constructor(e){super(),we(this,e,Iw,Lw,he,{value:0,label:1,class:2})}}function jw(n){let e,t,i,s,l,r,o;function a(f){n[4](f)}let u={class:"duo-columns-dropdown",id:n[5],items:n[3]};return n[0]!==void 0&&(u.keyOfSelected=n[0]),l=new cn({props:u}),le.push(()=>Pe(l,"keyOfSelected",a)),{c(){e=w("label"),t=ee(n[1]),s=I(),W(l.$$.fragment),p(e,"for",i=n[5])},m(f,c){k(f,e,c),y(e,t),k(f,s,c),$(l,f,c),o=!0},p(f,c){(!o||c&2)&&ke(t,f[1]),(!o||c&32&&i!==(i=f[5]))&&p(e,"for",i);const d={};c&32&&(d.id=f[5]),!r&&c&1&&(r=!0,d.keyOfSelected=f[0],je(()=>r=!1)),l.$set(d)},i(f){o||(E(l.$$.fragment,f),o=!0)},o(f){j(l.$$.fragment,f),o=!1},d(f){f&&(v(e),v(s)),F(l,f)}}}function Pw(n){let e,t;return e=new Oe({props:{class:"form-field required "+n[2],name:"settings.overlayPosition",$$slots:{default:[jw,({uniqueId:i})=>({5:i}),({uniqueId:i})=>i?32:0]},$$scope:{ctx:n}}}),{c(){W(e.$$.fragment)},m(i,s){$(e,i,s),t=!0},p(i,[s]){const l={};s&4&&(l.class="form-field required "+i[2]),s&99&&(l.$$scope={dirty:s,ctx:i}),e.$set(l)},i(i){t||(E(e.$$.fragment,i),t=!0)},o(i){j(e.$$.fragment,i),t=!1},d(i){F(e,i)}}}function Nw(n,e,t){const i=[{value:"top-left",label:"Top Left",icon:"iconoir-border-tl"},{value:"top-right",label:"Top Right",icon:"iconoir-border-tr"},{value:"bottom-left",label:"Bottom Left",icon:"iconoir-border-bl"},{value:"bottom-right",label:"Bottom Right",icon:"iconoir-border-br"},{value:"top-center",label:"Top Center",icon:"iconoir-border-top"},{value:"bottom-center",label:"Bottom Center",icon:"iconoir-border-bottom"},{value:"centered",label:"Centered",icon:"iconoir-border-inner"}];let{value:s}=e,{label:l="Position"}=e,{class:r=void 0}=e;function o(a){s=a,t(0,s)}return n.$$set=a=>{"value"in a&&t(0,s=a.value),"label"in a&&t(1,l=a.label),"class"in a&&t(2,r=a.class)},n.$$.update=()=>{n.$$.dirty&1&&(s||t(0,s="centered"))},[s,l,r,i,o]}class Aw extends ye{constructor(e){super(),we(this,e,Nw,Pw,he,{value:0,label:1,class:2})}}function rf(n){var te;let e,t,i,s,l,r,o,a,u,f,c,d,m,h,_,b,g,T,L,O,C,S=n[4].id?"Save":"Create",P,M,A,D,R;i=new Oe({props:{class:"form-field hotspot-type-select",name:"type",$$slots:{default:[Dw,({uniqueId:X})=>({54:X}),({uniqueId:X})=>[0,X?8388608:0]]},$$scope:{ctx:n}}});const Y=[Ww,Fw,$w,qw,Uw,Hw,Rw,Mw],G=[];function B(X,U){return X[4].type==Xe.note?0:X[4].type==Xe.screen?1:X[4].type==Xe.overlay?2:X[4].type==Xe.back?3:X[4].type==Xe.next?4:X[4].type==Xe.prev?5:X[4].type==Xe.url?6:X[4].type==Xe.scroll?7:-1}~(l=B(n))&&(r=G[l]=Y[l](n)),u=new Oe({props:{class:"form-field form-field-toggle",name:"template",$$slots:{default:[Jw,({uniqueId:X})=>({54:X}),({uniqueId:X})=>[0,X?8388608:0]]},$$scope:{ctx:n}}});let N=n[4].hotspotTemplate&&of(n),V=((te=n[4])==null?void 0:te.id)&&uf(n);return{c(){e=w("form"),t=w("div"),W(i.$$.fragment),s=I(),r&&r.c(),o=I(),a=w("div"),W(u.$$.fragment),f=I(),N&&N.c(),c=I(),d=w("hr"),m=I(),h=w("footer"),_=w("button"),b=w("span"),b.textContent="Cancel",T=I(),V&&V.c(),L=I(),O=w("button"),C=w("span"),P=ee(S),p(a,"class","col-12"),p(t,"class","grid grid-sm"),p(b,"class","txt"),p(_,"type","button"),p(_,"class","btn btn-sm btn-transparent"),_.disabled=g=n[0]||n[1],p(C,"class","txt"),p(O,"type","submit"),p(O,"class","btn btn-sm btn-primary btn-expanded-sm m-l-auto"),O.disabled=M=n[0]||n[1],Z(O,"btn-loading",n[0]),p(h,"class","flex flex-gap-10")},m(X,U){k(X,e,U),y(e,t),$(i,t,null),y(t,s),~l&&G[l].m(t,null),y(t,o),y(t,a),$(u,a,null),y(a,f),N&&N.m(a,null),y(e,c),y(e,d),y(e,m),y(e,h),y(h,_),y(_,b),y(h,T),V&&V.m(h,null),y(h,L),y(h,O),y(O,C),y(C,P),A=!0,D||(R=[H(_,"click",Be(n[43])),H(e,"submit",be(n[12]))],D=!0)},p(X,U){var Ce;const ce={};U[0]&144|U[1]&25165824&&(ce.$$scope={dirty:U,ctx:X}),i.$set(ce);let oe=l;l=B(X),l===oe?~l&&G[l].p(X,U):(r&&(ae(),j(G[oe],1,1,()=>{G[oe]=null}),ue()),~l?(r=G[l],r?r.p(X,U):(r=G[l]=Y[l](X),r.c()),E(r,1),r.m(t,o)):r=null);const de={};U[0]&280|U[1]&25165824&&(de.$$scope={dirty:U,ctx:X}),u.$set(de),X[4].hotspotTemplate?N?(N.p(X,U),U[0]&16&&E(N,1)):(N=of(X),N.c(),E(N,1),N.m(a,null)):N&&(ae(),j(N,1,1,()=>{N=null}),ue()),(!A||U[0]&3&&g!==(g=X[0]||X[1]))&&(_.disabled=g),(Ce=X[4])!=null&&Ce.id?V?V.p(X,U):(V=uf(X),V.c(),V.m(h,L)):V&&(V.d(1),V=null),(!A||U[0]&16)&&S!==(S=X[4].id?"Save":"Create")&&ke(P,S),(!A||U[0]&3&&M!==(M=X[0]||X[1]))&&(O.disabled=M),(!A||U[0]&1)&&Z(O,"btn-loading",X[0])},i(X){A||(E(i.$$.fragment,X),E(r),E(u.$$.fragment,X),E(N),A=!0)},o(X){j(i.$$.fragment,X),j(r),j(u.$$.fragment,X),j(N),A=!1},d(X){X&&v(e),F(i),~l&&G[l].d(),F(u),N&&N.d(),V&&V.d(),D=!1,pe(R)}}}function Dw(n){let e,t,i;function s(r){n[20](r)}let l={id:n[54],items:n[7]};return n[4].type!==void 0&&(l.keyOfSelected=n[4].type),e=new cn({props:l}),le.push(()=>Pe(e,"keyOfSelected",s)),{c(){W(e.$$.fragment)},m(r,o){$(e,r,o),i=!0},p(r,o){const a={};o[1]&8388608&&(a.id=r[54]),o[0]&128&&(a.items=r[7]),!t&&o[0]&16&&(t=!0,a.keyOfSelected=r[4].type,je(()=>t=!1)),e.$set(a)},i(r){i||(E(e.$$.fragment,r),i=!0)},o(r){j(e.$$.fragment,r),i=!1},d(r){F(e,r)}}}function Mw(n){let e,t,i,s,l,r;return t=new Oe({props:{class:"form-field required",name:"settings.scrollTop",$$slots:{default:[Vw,({uniqueId:o})=>({54:o}),({uniqueId:o})=>[0,o?8388608:0]]},$$scope:{ctx:n}}}),l=new Oe({props:{class:"form-field required",name:"settings.scrollLeft",$$slots:{default:[zw,({uniqueId:o})=>({54:o}),({uniqueId:o})=>[0,o?8388608:0]]},$$scope:{ctx:n}}}),{c(){e=w("div"),W(t.$$.fragment),i=I(),s=w("div"),W(l.$$.fragment),p(e,"class","col-6"),p(s,"class","col-6")},m(o,a){k(o,e,a),$(t,e,null),k(o,i,a),k(o,s,a),$(l,s,null),r=!0},p(o,a){const u={};a[0]&16|a[1]&25165824&&(u.$$scope={dirty:a,ctx:o}),t.$set(u);const f={};a[0]&16|a[1]&25165824&&(f.$$scope={dirty:a,ctx:o}),l.$set(f)},i(o){r||(E(t.$$.fragment,o),E(l.$$.fragment,o),r=!0)},o(o){j(t.$$.fragment,o),j(l.$$.fragment,o),r=!1},d(o){o&&(v(e),v(i),v(s)),F(t),F(l)}}}function Rw(n){let e,t;return e=new Oe({props:{class:"form-field required",name:"settings.url",$$slots:{default:[Bw,({uniqueId:i})=>({54:i}),({uniqueId:i})=>[0,i?8388608:0]]},$$scope:{ctx:n}}}),{c(){W(e.$$.fragment)},m(i,s){$(e,i,s),t=!0},p(i,s){const l={};s[0]&16|s[1]&25165824&&(l.$$scope={dirty:s,ctx:i}),e.$set(l)},i(i){t||(E(e.$$.fragment,i),t=!0)},o(i){j(e.$$.fragment,i),t=!1},d(i){F(e,i)}}}function Hw(n){let e,t,i;function s(r){n[35](r)}let l={};return n[4].settings.transition!==void 0&&(l.value=n[4].settings.transition),e=new ss({props:l}),le.push(()=>Pe(e,"value",s)),{c(){W(e.$$.fragment)},m(r,o){$(e,r,o),i=!0},p(r,o){const a={};!t&&o[0]&16&&(t=!0,a.value=r[4].settings.transition,je(()=>t=!1)),e.$set(a)},i(r){i||(E(e.$$.fragment,r),i=!0)},o(r){j(e.$$.fragment,r),i=!1},d(r){F(e,r)}}}function Uw(n){let e,t,i;function s(r){n[34](r)}let l={};return n[4].settings.transition!==void 0&&(l.value=n[4].settings.transition),e=new ss({props:l}),le.push(()=>Pe(e,"value",s)),{c(){W(e.$$.fragment)},m(r,o){$(e,r,o),i=!0},p(r,o){const a={};!t&&o[0]&16&&(t=!0,a.value=r[4].settings.transition,je(()=>t=!1)),e.$set(a)},i(r){i||(E(e.$$.fragment,r),i=!0)},o(r){j(e.$$.fragment,r),i=!1},d(r){F(e,r)}}}function qw(n){let e,t,i;function s(r){n[33](r)}let l={};return n[4].settings.transition!==void 0&&(l.value=n[4].settings.transition),e=new ss({props:l}),le.push(()=>Pe(e,"value",s)),{c(){W(e.$$.fragment)},m(r,o){$(e,r,o),i=!0},p(r,o){const a={};!t&&o[0]&16&&(t=!0,a.value=r[4].settings.transition,je(()=>t=!1)),e.$set(a)},i(r){i||(E(e.$$.fragment,r),i=!0)},o(r){j(e.$$.fragment,r),i=!1},d(r){F(e,r)}}}function $w(n){let e,t,i,s,l,r,o,a,u,f,c,d,m,h,_;function b(S){n[24](S)}let g={};n[4].settings.screen!==void 0&&(g.value=n[4].settings.screen),e=new Wd({props:g}),le.push(()=>Pe(e,"value",b));function T(S){n[25](S)}let L={};n[4].settings.overlayPosition!==void 0&&(L.value=n[4].settings.overlayPosition),s=new Aw({props:L}),le.push(()=>Pe(s,"value",T)),o=new Oe({props:{class:"form-field",$$slots:{default:[Zw,({uniqueId:S})=>({54:S}),({uniqueId:S})=>[0,S?8388608:0]]},$$scope:{ctx:n}}});function O(S){n[30](S)}let C={};return n[4].settings.transition!==void 0&&(C.value=n[4].settings.transition),u=new ss({props:C}),le.push(()=>Pe(u,"value",O)),d=new Oe({props:{class:"form-field form-field-toggle",name:"settings.fixOverlay",$$slots:{default:[Yw,({uniqueId:S})=>({54:S}),({uniqueId:S})=>[0,S?8388608:0]]},$$scope:{ctx:n}}}),h=new Oe({props:{class:"form-field form-field-toggle",name:"settings.outsideClose",$$slots:{default:[Kw,({uniqueId:S})=>({54:S}),({uniqueId:S})=>[0,S?8388608:0]]},$$scope:{ctx:n}}}),{c(){W(e.$$.fragment),i=I(),W(s.$$.fragment),r=I(),W(o.$$.fragment),a=I(),W(u.$$.fragment),c=I(),W(d.$$.fragment),m=I(),W(h.$$.fragment)},m(S,P){$(e,S,P),k(S,i,P),$(s,S,P),k(S,r,P),$(o,S,P),k(S,a,P),$(u,S,P),k(S,c,P),$(d,S,P),k(S,m,P),$(h,S,P),_=!0},p(S,P){const M={};!t&&P[0]&16&&(t=!0,M.value=S[4].settings.screen,je(()=>t=!1)),e.$set(M);const A={};!l&&P[0]&16&&(l=!0,A.value=S[4].settings.overlayPosition,je(()=>l=!1)),s.$set(A);const D={};P[0]&16|P[1]&25165824&&(D.$$scope={dirty:P,ctx:S}),o.$set(D);const R={};!f&&P[0]&16&&(f=!0,R.value=S[4].settings.transition,je(()=>f=!1)),u.$set(R);const Y={};P[0]&16|P[1]&25165824&&(Y.$$scope={dirty:P,ctx:S}),d.$set(Y);const G={};P[0]&16|P[1]&25165824&&(G.$$scope={dirty:P,ctx:S}),h.$set(G)},i(S){_||(E(e.$$.fragment,S),E(s.$$.fragment,S),E(o.$$.fragment,S),E(u.$$.fragment,S),E(d.$$.fragment,S),E(h.$$.fragment,S),_=!0)},o(S){j(e.$$.fragment,S),j(s.$$.fragment,S),j(o.$$.fragment,S),j(u.$$.fragment,S),j(d.$$.fragment,S),j(h.$$.fragment,S),_=!1},d(S){S&&(v(i),v(r),v(a),v(c),v(m)),F(e,S),F(s,S),F(o,S),F(u,S),F(d,S),F(h,S)}}}function Fw(n){let e,t,i,s,l,r;function o(c){n[22](c)}let a={};n[4].settings.screen!==void 0&&(a.value=n[4].settings.screen),e=new Wd({props:a}),le.push(()=>Pe(e,"value",o));function u(c){n[23](c)}let f={};return n[4].settings.transition!==void 0&&(f.value=n[4].settings.transition),s=new ss({props:f}),le.push(()=>Pe(s,"value",u)),{c(){W(e.$$.fragment),i=I(),W(s.$$.fragment)},m(c,d){$(e,c,d),k(c,i,d),$(s,c,d),r=!0},p(c,d){const m={};!t&&d[0]&16&&(t=!0,m.value=c[4].settings.screen,je(()=>t=!1)),e.$set(m);const h={};!l&&d[0]&16&&(l=!0,h.value=c[4].settings.transition,je(()=>l=!1)),s.$set(h)},i(c){r||(E(e.$$.fragment,c),E(s.$$.fragment,c),r=!0)},o(c){j(e.$$.fragment,c),j(s.$$.fragment,c),r=!1},d(c){c&&v(i),F(e,c),F(s,c)}}}function Ww(n){let e,t;return e=new Oe({props:{class:"form-field required",name:"settings.note",$$slots:{default:[Gw,({uniqueId:i})=>({54:i}),({uniqueId:i})=>[0,i?8388608:0]]},$$scope:{ctx:n}}}),{c(){W(e.$$.fragment)},m(i,s){$(e,i,s),t=!0},p(i,s){const l={};s[0]&16|s[1]&25165824&&(l.$$scope={dirty:s,ctx:i}),e.$set(l)},i(i){t||(E(e.$$.fragment,i),t=!0)},o(i){j(e.$$.fragment,i),t=!1},d(i){F(e,i)}}}function Vw(n){let e,t,i,s,l,r,o,a,u,f,c,d,m;return{c(){e=w("label"),t=ee("Vertical position"),s=I(),l=w("div"),r=w("input"),a=I(),u=w("label"),f=ee("px"),p(e,"for",i=n[54]),p(r,"type","number"),p(r,"id",o=n[54]),p(r,"min","0"),r.required=!0,p(u,"for",c=n[54]),p(u,"class","addon"),p(l,"class","field-group")},m(h,_){k(h,e,_),y(e,t),k(h,s,_),k(h,l,_),y(l,r),_e(r,n[4].settings.scrollTop),y(l,a),y(l,u),y(u,f),d||(m=H(r,"input",n[37]),d=!0)},p(h,_){_[1]&8388608&&i!==(i=h[54])&&p(e,"for",i),_[1]&8388608&&o!==(o=h[54])&&p(r,"id",o),_[0]&16&&yt(r.value)!==h[4].settings.scrollTop&&_e(r,h[4].settings.scrollTop),_[1]&8388608&&c!==(c=h[54])&&p(u,"for",c)},d(h){h&&(v(e),v(s),v(l)),d=!1,m()}}}function zw(n){let e,t,i,s,l,r,o,a,u,f,c,d,m;return{c(){e=w("label"),t=ee("Horizontal position"),s=I(),l=w("div"),r=w("input"),a=I(),u=w("label"),f=ee("px"),p(e,"for",i=n[54]),p(r,"type","number"),p(r,"id",o=n[54]),p(r,"min","0"),r.required=!0,p(u,"for",c=n[54]),p(u,"class","addon"),p(l,"class","field-group")},m(h,_){k(h,e,_),y(e,t),k(h,s,_),k(h,l,_),y(l,r),_e(r,n[4].settings.scrollLeft),y(l,a),y(l,u),y(u,f),d||(m=H(r,"input",n[38]),d=!0)},p(h,_){_[1]&8388608&&i!==(i=h[54])&&p(e,"for",i),_[1]&8388608&&o!==(o=h[54])&&p(r,"id",o),_[0]&16&&yt(r.value)!==h[4].settings.scrollLeft&&_e(r,h[4].settings.scrollLeft),_[1]&8388608&&c!==(c=h[54])&&p(u,"for",c)},d(h){h&&(v(e),v(s),v(l)),d=!1,m()}}}function Bw(n){let e,t,i,s,l,r,o,a,u;return{c(){e=w("label"),t=ee("URL"),s=I(),l=w("div"),r=w("input"),p(e,"for",i=n[54]),p(r,"type","text"),p(r,"id",o=n[54]),r.required=!0,p(r,"placeholder","eg. https://google.com"),p(l,"class","field-group")},m(f,c){k(f,e,c),y(e,t),k(f,s,c),k(f,l,c),y(l,r),_e(r,n[4].settings.url),a||(u=H(r,"input",n[36]),a=!0)},p(f,c){c[1]&8388608&&i!==(i=f[54])&&p(e,"for",i),c[1]&8388608&&o!==(o=f[54])&&p(r,"id",o),c[0]&16&&r.value!==f[4].settings.url&&_e(r,f[4].settings.url)},d(f){f&&(v(e),v(s),v(l)),a=!1,u()}}}function Zw(n){let e,t,i,s,l,r,o,a,u,f,c,d,m,h,_,b,g,T,L,O,C,S,P,M,A,D,R,Y,G,B,N,V,te,X,U;return{c(){e=w("label"),t=ee("Offset "),i=w("span"),i.textContent="(px)",l=I(),r=w("div"),o=w("label"),a=ee("T"),f=I(),c=w("input"),m=I(),h=w("label"),_=ee("B"),g=I(),T=w("input"),O=I(),C=w("label"),S=ee("L"),M=I(),A=w("input"),R=I(),Y=w("label"),G=ee("R"),N=I(),V=w("input"),p(i,"class","txt-hint"),p(e,"for",s=n[54]),p(o,"for",u=n[54]+"_t"),p(o,"class","addon"),p(o,"title","Top offset"),p(c,"type","number"),p(c,"id",d=n[54]+"_t"),p(h,"for",b=n[54]+"_b"),p(h,"class","addon"),p(h,"title","Bottom offset"),p(T,"type","number"),p(T,"id",L=n[54]+"_b"),p(C,"for",P=n[54]+"_l"),p(C,"class","addon"),p(C,"title","Left offset"),p(A,"type","number"),p(A,"id",D=n[54]+"_l"),p(Y,"for",B=n[54]+"_r"),p(Y,"class","addon"),p(Y,"title","Right offset"),p(V,"type","number"),p(V,"id",te=n[54]+"_r"),p(r,"class","field-group")},m(ce,oe){k(ce,e,oe),y(e,t),y(e,i),k(ce,l,oe),k(ce,r,oe),y(r,o),y(o,a),y(r,f),y(r,c),_e(c,n[4].settings.offsetTop),y(r,m),y(r,h),y(h,_),y(r,g),y(r,T),_e(T,n[4].settings.offsetBottom),y(r,O),y(r,C),y(C,S),y(r,M),y(r,A),_e(A,n[4].settings.offsetLeft),y(r,R),y(r,Y),y(Y,G),y(r,N),y(r,V),_e(V,n[4].settings.offsetRight),X||(U=[H(c,"input",n[26]),H(T,"input",n[27]),H(A,"input",n[28]),H(V,"input",n[29])],X=!0)},p(ce,oe){oe[1]&8388608&&s!==(s=ce[54])&&p(e,"for",s),oe[1]&8388608&&u!==(u=ce[54]+"_t")&&p(o,"for",u),oe[1]&8388608&&d!==(d=ce[54]+"_t")&&p(c,"id",d),oe[0]&16&&yt(c.value)!==ce[4].settings.offsetTop&&_e(c,ce[4].settings.offsetTop),oe[1]&8388608&&b!==(b=ce[54]+"_b")&&p(h,"for",b),oe[1]&8388608&&L!==(L=ce[54]+"_b")&&p(T,"id",L),oe[0]&16&&yt(T.value)!==ce[4].settings.offsetBottom&&_e(T,ce[4].settings.offsetBottom),oe[1]&8388608&&P!==(P=ce[54]+"_l")&&p(C,"for",P),oe[1]&8388608&&D!==(D=ce[54]+"_l")&&p(A,"id",D),oe[0]&16&&yt(A.value)!==ce[4].settings.offsetLeft&&_e(A,ce[4].settings.offsetLeft),oe[1]&8388608&&B!==(B=ce[54]+"_r")&&p(Y,"for",B),oe[1]&8388608&&te!==(te=ce[54]+"_r")&&p(V,"id",te),oe[0]&16&&yt(V.value)!==ce[4].settings.offsetRight&&_e(V,ce[4].settings.offsetRight)},d(ce){ce&&(v(e),v(l),v(r)),X=!1,pe(U)}}}function Yw(n){let e,t,i,s,l,r,o,a;return{c(){e=w("input"),i=I(),s=w("label"),l=ee("Fix position of overlay"),p(e,"type","checkbox"),p(e,"id",t=n[54]),p(s,"for",r=n[54])},m(u,f){k(u,e,f),e.checked=n[4].settings.fixOverlay,k(u,i,f),k(u,s,f),y(s,l),o||(a=H(e,"change",n[31]),o=!0)},p(u,f){f[1]&8388608&&t!==(t=u[54])&&p(e,"id",t),f[0]&16&&(e.checked=u[4].settings.fixOverlay),f[1]&8388608&&r!==(r=u[54])&&p(s,"for",r)},d(u){u&&(v(e),v(i),v(s)),o=!1,a()}}}function Kw(n){let e,t,i,s,l,r,o,a;return{c(){e=w("input"),i=I(),s=w("label"),l=ee("Close on outside click"),p(e,"type","checkbox"),p(e,"id",t=n[54]),p(s,"for",r=n[54])},m(u,f){k(u,e,f),e.checked=n[4].settings.outsideClose,k(u,i,f),k(u,s,f),y(s,l),o||(a=H(e,"change",n[32]),o=!0)},p(u,f){f[1]&8388608&&t!==(t=u[54])&&p(e,"id",t),f[0]&16&&(e.checked=u[4].settings.outsideClose),f[1]&8388608&&r!==(r=u[54])&&p(s,"for",r)},d(u){u&&(v(e),v(i),v(s)),o=!1,a()}}}function Gw(n){let e,t,i,s,l,r;return{c(){e=w("textarea"),i=I(),s=w("div"),s.textContent="The note will be visible in Preview mode on hover.",p(e,"id",t=n[54]),e.required=!0,p(s,"class","help-block")},m(o,a){k(o,e,a),_e(e,n[4].settings.note),k(o,i,a),k(o,s,a),l||(r=H(e,"input",n[21]),l=!0)},p(o,a){a[1]&8388608&&t!==(t=o[54])&&p(e,"id",t),a[0]&16&&_e(e,o[4].settings.note)},d(o){o&&(v(e),v(i),v(s)),l=!1,r()}}}function Jw(n){let e,t,i,s,l,r,o,a,u,f,c;return{c(){e=w("input"),s=I(),l=w("label"),r=w("span"),r.textContent="Include in template",o=I(),a=w("i"),p(e,"type","checkbox"),p(e,"id",t=n[54]),e.checked=i=!!n[4].hotspotTemplate,p(r,"class","txt"),p(a,"class","iconoir-info-circle link-hint"),p(l,"for",u=n[54])},m(d,m){k(d,e,m),k(d,s,m),k(d,l,m),y(l,r),y(l,o),y(l,a),f||(c=[H(e,"change",n[39]),ge(Te.call(null,a,"Reuse the hotspot in other screens"))],f=!0)},p(d,m){m[1]&8388608&&t!==(t=d[54])&&p(e,"id",t),m[0]&16&&i!==(i=!!d[4].hotspotTemplate)&&(e.checked=i),m[1]&8388608&&u!==(u=d[54])&&p(l,"for",u)},d(d){d&&(v(e),v(s),v(l)),f=!1,pe(c)}}}function of(n){let e,t,i,s,l,r;i=new Oe({props:{class:"form-field form-field-sm",$$slots:{default:[Xw,({uniqueId:a})=>({54:a}),({uniqueId:a})=>[0,a?8388608:0]]},$$scope:{ctx:n}}});let o=n[4].hotspotTemplate==Ds&&af(n);return{c(){e=w("div"),t=w("div"),W(i.$$.fragment),s=I(),o&&o.c(),p(t,"class","template-form svelte-1gupuaj"),p(e,"class","block p-t-xs")},m(a,u){k(a,e,u),y(e,t),$(i,t,null),y(t,s),o&&o.m(t,null),r=!0},p(a,u){const f={};u[0]&272|u[1]&25165824&&(f.$$scope={dirty:u,ctx:a}),i.$set(f),a[4].hotspotTemplate==Ds?o?(o.p(a,u),u[0]&16&&E(o,1)):(o=af(a),o.c(),E(o,1),o.m(t,null)):o&&(ae(),j(o,1,1,()=>{o=null}),ue())},i(a){r||(E(i.$$.fragment,a),E(o),a&&vt(()=>{r&&(l||(l=ft(e,Ot,{duration:150},!0)),l.run(1))}),r=!0)},o(a){j(i.$$.fragment,a),j(o),a&&(l||(l=ft(e,Ot,{duration:150},!1)),l.run(0)),r=!1},d(a){a&&v(e),F(i),o&&o.d(),a&&l&&l.end()}}}function Xw(n){let e,t,i;function s(r){n[40](r)}let l={id:n[54],items:n[8],upside:!0};return n[4].hotspotTemplate!==void 0&&(l.keyOfSelected=n[4].hotspotTemplate),e=new cn({props:l}),le.push(()=>Pe(e,"keyOfSelected",s)),{c(){W(e.$$.fragment)},m(r,o){$(e,r,o),i=!0},p(r,o){const a={};o[1]&8388608&&(a.id=r[54]),o[0]&256&&(a.items=r[8]),!t&&o[0]&16&&(t=!0,a.keyOfSelected=r[4].hotspotTemplate,je(()=>t=!1)),e.$set(a)},i(r){i||(E(e.$$.fragment,r),i=!0)},o(r){j(e.$$.fragment,r),i=!1},d(r){F(e,r)}}}function af(n){let e,t,i,s;return t=new Oe({props:{class:"form-field form-field-sm m-t-10",name:"title",$$slots:{default:[Qw,({uniqueId:l})=>({54:l}),({uniqueId:l})=>[0,l?8388608:0]]},$$scope:{ctx:n}}}),{c(){e=w("div"),W(t.$$.fragment)},m(l,r){k(l,e,r),$(t,e,null),s=!0},p(l,r){const o={};r[0]&68|r[1]&25165824&&(o.$$scope={dirty:r,ctx:l}),t.$set(o)},i(l){s||(E(t.$$.fragment,l),l&&vt(()=>{s&&(i||(i=ft(e,Ot,{duration:150},!0)),i.run(1))}),s=!0)},o(l){j(t.$$.fragment,l),l&&(i||(i=ft(e,Ot,{duration:150},!1)),i.run(0)),s=!1},d(l){l&&v(e),F(t),l&&i&&i.end()}}}function Qw(n){let e,t,i,s;return{c(){e=w("input"),p(e,"type","text"),p(e,"id",t=n[54]),p(e,"placeholder","Template name *")},m(l,r){k(l,e,r),n[41](e),_e(e,n[6]),i||(s=H(e,"input",n[42]),i=!0)},p(l,r){r[1]&8388608&&t!==(t=l[54])&&p(e,"id",t),r[0]&64&&e.value!==l[6]&&_e(e,l[6])},d(l){l&&v(e),n[41](null),i=!1,s()}}}function uf(n){let e,t,i,s,l;return{c(){e=w("button"),t=w("i"),p(t,"class","iconoir-trash txt-sm"),p(e,"type","button"),p(e,"class","btn btn-sm btn-circle btn-transparent btn-danger fade"),e.disabled=i=n[0]||n[1]},m(r,o){k(r,e,o),y(e,t),s||(l=[ge(Te.call(null,e,"Delete hotspot")),H(e,"click",Be(n[13]))],s=!0)},p(r,o){o[0]&3&&i!==(i=r[0]||r[1])&&(e.disabled=i)},d(r){r&&v(e),s=!1,pe(l)}}}function xw(n){let e,t,i=n[4]&&rf(n);return{c(){i&&i.c(),e=Ne()},m(s,l){i&&i.m(s,l),k(s,e,l),t=!0},p(s,l){s[4]?i?(i.p(s,l),l[0]&16&&E(i,1)):(i=rf(s),i.c(),E(i,1),i.m(e.parentNode,e)):i&&(ae(),j(i,1,1,()=>{i=null}),ue())},i(s){t||(E(i),t=!0)},o(s){j(i),t=!1},d(s){s&&v(e),i&&i.d(s)}}}function ey(n){let e,t;const i=[{class:"hotspots-popover "+(n[10]?"resizing":"")},{disableHide:!n[9]},{vPadding:0},{hPadding:5},{closableToggle:!1},n[14]];let s={$$slots:{default:[xw]},$$scope:{ctx:n}};for(let l=0;l<i.length;l+=1)s=Me(s,i[l]);return e=new $d({props:s}),n[44](e),e.$on("hide",n[11]),{c(){W(e.$$.fragment)},m(l,r){$(e,l,r),t=!0},p(l,r){const o=r[0]&17920?gt(i,[r[0]&1024&&{class:"hotspots-popover "+(l[10]?"resizing":"")},r[0]&512&&{disableHide:!l[9]},i[2],i[3],i[4],r[0]&16384&&It(l[14])]):{};r[0]&511|r[1]&16777216&&(o.$$scope={dirty:r,ctx:l}),e.$set(o)},i(l){t||(E(e.$$.fragment,l),t=!0)},o(l){j(e.$$.fragment,l),t=!1},d(l){n[44](null),F(e,l)}}}const Ds="@newTemplate";function ty(n,e,t){let i,s;const l=["viewport"];let r=ut(e,l),o,a,u,f,c,d;x(n,We,re=>t(4,o=re)),x(n,Ye,re=>t(17,a=re)),x(n,Tt,re=>t(45,u=re)),x(n,fn,re=>t(18,f=re)),x(n,pn,re=>t(10,c=re)),x(n,wi,re=>t(19,d=re));const m=tt(),h=[{value:Xe.note,label:"Link to: Note"},{value:Xe.screen,label:"Link to: Screen"},{value:Xe.overlay,label:"Link to: Screen as overlay"},{value:Xe.back,label:"Link to: Back (last visited screen)"},{value:Xe.prev,label:"Link to: Prev screen in series"},{value:Xe.next,label:"Link to: Next screen in series"},{value:Xe.scroll,label:"Link to: Position (scroll to)"}],_=h.concat({value:Xe.url,label:"Link to: URL"});let{viewport:b=null}=e,g,T=!1,L=!1,O="",C,S=null,P=h,M="";async function A(){if(!o||c){g==null||g.forceHide();return}const re=document.querySelector(`[data-hotspot="${o.id}"]`);if(!re){g==null||g.forceHide();return}re.scrollIntoView({block:"nearest",inline:"nearest"}),D(),await St(),g==null||g.show(re,b)}function D(){Kt({}),t(6,O=""),t(0,T=!1),t(1,L=!1),t(16,M=""),o&&(!o.screen&&(a!=null&&a.id)&&ve(We,o.screen=a.id,o),ve(We,o.settings=o.settings||{},o),t(3,S=R()),Y())}function R(){if(!o)return null;const re=Object.assign({},o);return re.settings=structuredClone(o.settings||{}),re}function Y(){if(!o)return null;t(16,M=o.type),!o.id&&o.type==Xe.overlay&&(ve(We,o.settings=o.settings||{},o),ve(We,o.settings.fixOverlay=!0,o),ve(We,o.settings.outsideClose=!0,o))}function G(){o!=null&&o.id&&S&&En(S),t(3,S=null),ve(We,o=null,o),jl()}async function B(){var re;if(!(T||!o)){t(0,T=!0);try{const Re=R();if(Re.hotspotTemplate){Re.screen=null;let Ge=f.find(bt=>bt.id==Re.hotspotTemplate);Ge?(re=Ge.screens)!=null&&re.includes(a.id)||(Ge=await z.collection("hotspotTemplates").update(Ge.id,{"screens+":a.id})):(Ge=await z.collection("hotspotTemplates").create({title:O,prototype:u.id,screens:[a.id]}),Re.hotspotTemplate=Ge.id),Wi(Ge)}else Re.screen=a.id;let et;o!=null&&o.id?et=await z.collection("hotspots").update(o.id,Re):et=await z.collection("hotspots").create(Re),t(3,S=et),En(et),jl(),g==null||g.forceHide(),m("save",et),t(0,T=!1)}catch(Re){Re.isAbort||(z.error(Re),t(0,T=!1))}}}function N(){if(L||!(o!=null&&o.id))return;let re="Do you really want to delete the selected hotspot?";t(1,L=!0),Lt(re,V,()=>{setTimeout(()=>{t(1,L=!1)},0)})}async function V(){if(o!=null&&o.id){t(1,L=!0);try{await z.collection("hotspots").delete(o.id),m("delete",S),ve(We,o=null,o),t(1,L=!1)}catch(re){re.isAbort||(z.error(re),t(1,L=!1))}}}function te(re){n.$$.not_equal(o.type,re)&&(o.type=re,We.set(o))}function X(){o.settings.note=this.value,We.set(o)}function U(re){n.$$.not_equal(o.settings.screen,re)&&(o.settings.screen=re,We.set(o))}function ce(re){n.$$.not_equal(o.settings.transition,re)&&(o.settings.transition=re,We.set(o))}function oe(re){n.$$.not_equal(o.settings.screen,re)&&(o.settings.screen=re,We.set(o))}function de(re){n.$$.not_equal(o.settings.overlayPosition,re)&&(o.settings.overlayPosition=re,We.set(o))}function Ce(){o.settings.offsetTop=yt(this.value),We.set(o)}function xe(){o.settings.offsetBottom=yt(this.value),We.set(o)}function at(){o.settings.offsetLeft=yt(this.value),We.set(o)}function nt(){o.settings.offsetRight=yt(this.value),We.set(o)}function ct(re){n.$$.not_equal(o.settings.transition,re)&&(o.settings.transition=re,We.set(o))}function K(){o.settings.fixOverlay=this.checked,We.set(o)}function se(){o.settings.outsideClose=this.checked,We.set(o)}function q(re){n.$$.not_equal(o.settings.transition,re)&&(o.settings.transition=re,We.set(o))}function ne(re){n.$$.not_equal(o.settings.transition,re)&&(o.settings.transition=re,We.set(o))}function He(re){n.$$.not_equal(o.settings.transition,re)&&(o.settings.transition=re,We.set(o))}function ht(){o.settings.url=this.value,We.set(o)}function qe(){o.settings.scrollTop=yt(this.value),We.set(o)}function it(){o.settings.scrollLeft=yt(this.value),We.set(o)}const Dt=re=>{var Re;re.target.checked?o.hotspotTemplate||ve(We,o.hotspotTemplate=(S==null?void 0:S.hotspotTemplate)||((Re=s==null?void 0:s[0])==null?void 0:Re.value),o):ve(We,o.hotspotTemplate="",o)};function Mt(re){n.$$.not_equal(o.hotspotTemplate,re)&&(o.hotspotTemplate=re,We.set(o))}function ie(re){le[re?"unshift":"push"](()=>{C=re,t(2,C)})}function Ve(){O=this.value,t(6,O)}const fe=()=>{g==null||g.hide()};function Le(re){le[re?"unshift":"push"](()=>{g=re,t(5,g)})}return n.$$set=re=>{e=Me(Me({},e),Zt(re)),t(14,r=ut(e,l)),"viewport"in re&&t(15,b=re.viewport)},n.$$.update=()=>{n.$$.dirty[0]&524288&&(d!=null&&d.allowHotspotsURL?t(7,P=_):t(7,P=h)),n.$$.dirty[0]&131096&&a&&(S==null?void 0:S.id)!=(o==null?void 0:o.id)&&A(),n.$$.dirty[0]&3&&t(9,i=!T&&!L),n.$$.dirty[0]&262144&&t(8,s=f.map(re=>({value:re.id,label:re.title})).concat([{value:Ds,label:"+ New template"}])),n.$$.dirty[0]&20&&(o==null?void 0:o.hotspotTemplate)===Ds&&setTimeout(()=>{C==null||C.focus()},50),n.$$.dirty[0]&65552&&o&&M!=o.type&&Y()},[T,L,C,S,o,g,O,P,s,i,c,G,B,N,r,b,M,a,f,d,te,X,U,ce,oe,de,Ce,xe,at,nt,ct,K,se,q,ne,He,ht,qe,it,Dt,Mt,ie,Ve,fe,Le]}class ny extends ye{constructor(e){super(),we(this,e,ty,ey,he,{viewport:15},null,[-1,-1])}}function iy(n){var ur,fr;let e,t,i,s,l,r,o,a,u,f,c,d,m,h,_,b=((ur=n[1])==null?void 0:ur.title)+"",g,T,L,O=Ps(n[1])+"",C,S,P=n[0].length+"",M,A,D,R,Y,G,B,N,V,te,X,U,ce,oe,de,Ce,xe,at,nt,ct,K,se,q,ne,He,ht,qe,it,Dt,Mt,ie,Ve,fe;o=new Hd({});let Le=n[12]===Se.comments&&ff(n),re=n[17].length&&cf(n),Re=n[12]==Se.hotspots&&!n[14]&&df(),et=n[12]==Se.comments&&!n[16]&&pf(n),Ge=n[12]==Se.preview&&mf(),bt=((fr=n[3])==null?void 0:fr.scale)!=0&&hf(n);return it=new M2({}),Mt=new Rd({props:{active:n[5]}}),{c(){var Ie;e=w("div"),t=w("div"),i=w("div"),i.innerHTML='<i class="iconoir-nav-arrow-left"></i>',s=I(),l=w("div"),l.innerHTML='<i class="iconoir-nav-arrow-right"></i>',r=I(),W(o.$$.fragment),a=I(),Le&&Le.c(),u=I(),f=w("nav"),c=w("div"),d=w("button"),d.innerHTML='<i class="iconoir-xmark"></i>',m=I(),h=w("button"),_=w("span"),g=ee(b),L=ee(`
                    (`),C=ee(O),S=ee(" of "),M=ee(P),A=ee(`)
                    `),D=w("i"),G=I(),B=w("div"),N=w("button"),V=w("i"),X=I(),U=w("button"),ce=w("i"),de=I(),Ce=w("button"),xe=w("i"),at=I(),re&&re.c(),ct=I(),K=w("button"),K.innerHTML='<i class="iconoir-more-vert"></i>',se=I(),q=w("div"),Re&&Re.c(),ne=I(),et&&et.c(),He=I(),Ge&&Ge.c(),ht=I(),bt&&bt.c(),qe=I(),W(it.$$.fragment),Dt=I(),W(Mt.$$.fragment),p(i,"class","screen-preview-nav-ctrl left"),Z(i,"disabled",n[10]),p(l,"class","screen-preview-nav-ctrl right"),Z(l,"disabled",n[9]),p(t,"class","screen-preview-nav-wrapper"),p(e,"class","screen-preview-container entrance-fade"),p(d,"type","button"),p(d,"class","btn btn-circle btn-transparent btn-hint txt-hint"),p(_,"class","screen-title-trim"),p(_,"title",T=(Ie=n[1])==null?void 0:Ie.title),p(D,"class",R="iconoir-nav-arrow-"+(n[5]?"up":"down")),p(h,"type","button"),p(h,"class",Y="btn btn-sm btn-hint txt-hint "+(n[5]?"btn-semitransparent":"btn-transparent")),p(c,"class","controls-group group-left"),p(V,"class","iconoir-play"),p(N,"class",te="btn btn-circle "+(n[12]==Se.preview?"btn-primary btn-transparent":"btn-hint btn-transparent txt-hint")),p(ce,"class","iconoir-square-3d-corner-to-corner"),p(U,"class",oe="btn btn-circle "+(n[12]==Se.hotspots?"btn-success btn-transparent":"btn-hint btn-transparent txt-hint")),Z(U,"btn-loading",n[14]||n[15]),p(xe,"class","iconoir-message-text"),p(Ce,"class",nt="btn btn-circle "+(n[12]==Se.comments?"btn-danger btn-transparent":"btn-hint btn-transparent txt-hint")),Z(Ce,"btn-loading",n[16]),p(K,"type","button"),p(K,"class","btn btn-circle btn-hint txt-hint btn-transparent responsive-show"),Z(K,"active",n[6]),p(B,"class","controls-group group-center"),p(q,"class","controls-group group-right responsive-hide"),p(f,"class","controls-bar"),Z(f,"show-responsive-controls",n[6])},m(Ie,Je){k(Ie,e,Je),y(e,t),y(t,i),y(t,s),y(t,l),y(t,r),$(o,t,null),n[32](t),y(e,a),Le&&Le.m(e,null),k(Ie,u,Je),k(Ie,f,Je),y(f,c),y(c,d),y(c,m),y(c,h),y(h,_),y(_,g),y(h,L),y(h,C),y(h,S),y(h,M),y(h,A),y(h,D),y(f,G),y(f,B),y(B,N),y(N,V),y(B,X),y(B,U),y(U,ce),y(B,de),y(B,Ce),y(Ce,xe),y(Ce,at),re&&re.m(Ce,null),y(B,ct),y(B,K),y(f,se),y(f,q),Re&&Re.m(q,null),y(q,ne),et&&et.m(q,null),y(q,He),Ge&&Ge.m(q,null),y(q,ht),bt&&bt.m(q,null),y(q,qe),$(it,q,null),k(Ie,Dt,Je),$(Mt,Ie,Je),ie=!0,Ve||(fe=[H(i,"click",be(n[30])),H(l,"click",be(n[31])),H(t,"drop",be(n[33])),H(t,"dragover",Be(be(n[29]))),H(d,"click",n[20]),ge(Te.call(null,d,{position:"top",text:"Back to listing"})),H(h,"click",be(n[21])),ge(Te.call(null,N,{position:"top",text:"Preview mode",sub:"P"})),H(N,"click",be(n[35])),ge(Te.call(null,U,{position:"top",text:"Hotspots mode",sub:"H"})),H(U,"click",be(n[36])),ge(Te.call(null,Ce,{position:"top",text:"Comments mode",sub:"C"})),H(Ce,"click",be(n[37])),ge(Te.call(null,K,{position:"top",text:"More options"})),H(K,"click",n[38]),H(f,"click",be(n[40]))],Ve=!0)},p(Ie,Je){var dr,pr,mr;(!ie||Je[0]&1024)&&Z(i,"disabled",Ie[10]),(!ie||Je[0]&512)&&Z(l,"disabled",Ie[9]),Ie[12]===Se.comments?Le?(Le.p(Ie,Je),Je[0]&4096&&E(Le,1)):(Le=ff(Ie),Le.c(),E(Le,1),Le.m(e,null)):Le&&(ae(),j(Le,1,1,()=>{Le=null}),ue()),(!ie||Je[0]&2)&&b!==(b=((dr=Ie[1])==null?void 0:dr.title)+"")&&ke(g,b),(!ie||Je[0]&2&&T!==(T=(pr=Ie[1])==null?void 0:pr.title))&&p(_,"title",T),(!ie||Je[0]&2)&&O!==(O=Ps(Ie[1])+"")&&ke(C,O),(!ie||Je[0]&1)&&P!==(P=Ie[0].length+"")&&ke(M,P),(!ie||Je[0]&32&&R!==(R="iconoir-nav-arrow-"+(Ie[5]?"up":"down")))&&p(D,"class",R),(!ie||Je[0]&32&&Y!==(Y="btn btn-sm btn-hint txt-hint "+(Ie[5]?"btn-semitransparent":"btn-transparent")))&&p(h,"class",Y),(!ie||Je[0]&4096&&te!==(te="btn btn-circle "+(Ie[12]==Se.preview?"btn-primary btn-transparent":"btn-hint btn-transparent txt-hint")))&&p(N,"class",te),(!ie||Je[0]&4096&&oe!==(oe="btn btn-circle "+(Ie[12]==Se.hotspots?"btn-success btn-transparent":"btn-hint btn-transparent txt-hint")))&&p(U,"class",oe),(!ie||Je[0]&53248)&&Z(U,"btn-loading",Ie[14]||Ie[15]),Ie[17].length?re?re.p(Ie,Je):(re=cf(Ie),re.c(),re.m(Ce,null)):re&&(re.d(1),re=null),(!ie||Je[0]&4096&&nt!==(nt="btn btn-circle "+(Ie[12]==Se.comments?"btn-danger btn-transparent":"btn-hint btn-transparent txt-hint")))&&p(Ce,"class",nt),(!ie||Je[0]&69632)&&Z(Ce,"btn-loading",Ie[16]),(!ie||Je[0]&64)&&Z(K,"active",Ie[6]),Ie[12]==Se.hotspots&&!Ie[14]?Re?Je[0]&20480&&E(Re,1):(Re=df(),Re.c(),E(Re,1),Re.m(q,ne)):Re&&(ae(),j(Re,1,1,()=>{Re=null}),ue()),Ie[12]==Se.comments&&!Ie[16]?et?et.p(Ie,Je):(et=pf(Ie),et.c(),et.m(q,He)):et&&(et.d(1),et=null),Ie[12]==Se.preview?Ge?Je[0]&4096&&E(Ge,1):(Ge=mf(),Ge.c(),E(Ge,1),Ge.m(q,ht)):Ge&&(ae(),j(Ge,1,1,()=>{Ge=null}),ue()),((mr=Ie[3])==null?void 0:mr.scale)!=0?bt?bt.p(Ie,Je):(bt=hf(Ie),bt.c(),bt.m(q,qe)):bt&&(bt.d(1),bt=null),(!ie||Je[0]&64)&&Z(f,"show-responsive-controls",Ie[6]);const cr={};Je[0]&32&&(cr.active=Ie[5]),Mt.$set(cr)},i(Ie){ie||(E(o.$$.fragment,Ie),E(Le),E(Re),E(Ge),E(it.$$.fragment,Ie),E(Mt.$$.fragment,Ie),ie=!0)},o(Ie){j(o.$$.fragment,Ie),j(Le),j(Re),j(Ge),j(it.$$.fragment,Ie),j(Mt.$$.fragment,Ie),ie=!1},d(Ie){Ie&&(v(e),v(u),v(f),v(Dt)),F(o),n[32](null),Le&&Le.d(),re&&re.d(),Re&&Re.d(),et&&et.d(),Ge&&Ge.d(),bt&&bt.d(),F(it),F(Mt,Ie),Ve=!1,pe(fe)}}}function sy(n){let e;return{c(){e=w("span"),p(e,"class","loader loader-lg m-t-auto m-b-auto")},m(t,i){k(t,e,i)},p:Q,i:Q,o:Q,d(t){t&&v(e)}}}function ff(n){let e,t,i={};return e=new qd({props:i}),n[34](e),{c(){W(e.$$.fragment)},m(s,l){$(e,s,l),t=!0},p(s,l){const r={};e.$set(r)},i(s){t||(E(e.$$.fragment,s),t=!0)},o(s){j(e.$$.fragment,s),t=!1},d(s){n[34](null),F(e,s)}}}function cf(n){let e,t=n[17].length+"",i,s;return{c(){e=w("sub"),i=ee(t),p(e,"class",s="sub "+(n[18].length?"sub-warning":n[12]==Se.comments?"sub-danger":"sub-secondary-alt")),p(e,"title","Unresolved comments")},m(l,r){k(l,e,r),y(e,i)},p(l,r){r[0]&131072&&t!==(t=l[17].length+"")&&ke(i,t),r[0]&266240&&s!==(s="sub "+(l[18].length?"sub-warning":l[12]==Se.comments?"sub-danger":"sub-secondary-alt"))&&p(e,"class",s)},d(l){l&&v(e)}}}function df(n){let e,t;return e=new F2({}),{c(){W(e.$$.fragment)},m(i,s){$(e,i,s),t=!0},i(i){t||(E(e.$$.fragment,i),t=!0)},o(i){j(e.$$.fragment,i),t=!1},d(i){F(e,i)}}}function pf(n){let e,t,i;return{c(){e=w("button"),e.innerHTML='<span class="txt">Comments panel</span>',p(e,"type","button"),p(e,"class","btn btn-sm btn-transparent btn-danger entrance-right")},m(s,l){k(s,e,l),t||(i=H(e,"click",be(n[39])),t=!0)},p:Q,d(s){s&&v(e),t=!1,i()}}}function mf(n){let e,t;return e=new Ud({}),{c(){W(e.$$.fragment)},m(i,s){$(e,i,s),t=!0},i(i){t||(E(e.$$.fragment,i),t=!0)},o(i){j(e.$$.fragment,i),t=!1},d(i){F(e,i)}}}function hf(n){let e,t,i,s,l;return{c(){e=w("button"),t=w("i"),p(t,"class","iconoir-scale-frame-reduce"),p(e,"class",i="btn btn-circle btn-hint btn-transparent "+(n[19]?"txt-warning":"txt-hint"))},m(r,o){k(r,e,o),y(e,t),s||(l=[ge(Te.call(null,e,{position:"top",text:"Toggle fit to screen"})),H(e,"click",be(rd))],s=!0)},p(r,o){o[0]&524288&&i!==(i="btn btn-circle btn-hint btn-transparent "+(r[19]?"txt-warning":"txt-hint"))&&p(e,"class",i)},d(r){r&&v(e),s=!1,pe(l)}}}function ly(n){let e,t,i,s;const l=[sy,iy],r=[];function o(a,u){return a[11]?1:0}return e=o(n),t=r[e]=l[e](n),{c(){t.c(),i=Ne()},m(a,u){r[e].m(a,u),k(a,i,u),s=!0},p(a,u){let f=e;e=o(a),e===f?r[e].p(a,u):(ae(),j(r[f],1,1,()=>{r[f]=null}),ue(),t=r[e],t?t.p(a,u):(t=r[e]=l[e](a),t.c()),E(t,1),t.m(i.parentNode,i))},i(a){s||(E(t),s=!0)},o(a){j(t),s=!1},d(a){a&&v(i),r[e].d(a)}}}function ry(n){let e,t,i,s,l,r,o,a;return e=new ji({props:{fullpage:!0,class:"screen-preview-layout screen-preview-mode-"+n[12]+" "+(n[12]==Se.comments&&n[2]?"screen-preview-comment-popover-active":"")+" "+(n[12]==Se.hotspots&&n[13]?"screen-preview-hotspot-popover-active":""),header:!1,footer:!1,title:n[4],$$slots:{default:[ly]},$$scope:{ctx:n}}}),i=new Fd({props:{viewport:n[8]}}),l=new ny({props:{viewport:n[8]}}),{c(){W(e.$$.fragment),t=I(),W(i.$$.fragment),s=I(),W(l.$$.fragment)},m(u,f){$(e,u,f),k(u,t,f),$(i,u,f),k(u,s,f),$(l,u,f),r=!0,o||(a=H(window,"keydown",n[22]),o=!0)},p(u,f){const c={};f[0]&12292&&(c.class="screen-preview-layout screen-preview-mode-"+u[12]+" "+(u[12]==Se.comments&&u[2]?"screen-preview-comment-popover-active":"")+" "+(u[12]==Se.hotspots&&u[13]?"screen-preview-hotspot-popover-active":"")),f[0]&16&&(c.title=u[4]),f[0]&1040363|f[1]&4096&&(c.$$scope={dirty:f,ctx:u}),e.$set(c);const d={};f[0]&256&&(d.viewport=u[8]),i.$set(d);const m={};f[0]&256&&(m.viewport=u[8]),l.$set(m)},i(u){r||(E(e.$$.fragment,u),E(i.$$.fragment,u),E(l.$$.fragment,u),r=!0)},o(u){j(e.$$.fragment,u),j(i.$$.fragment,u),j(l.$$.fragment,u),r=!1},d(u){u&&(v(t),v(s)),F(e,u),F(i,u),F(l,u),o=!1,a()}}}const oy=".toggler-container > .active";function ay(n,e,t){let i,s,l,r,o,a,u,f,c,d,m,h,_,b,g,T,L,O;x(n,dt,q=>t(0,o=q)),x(n,Ye,q=>t(1,a=q)),x(n,$t,q=>t(2,u=q)),x(n,Tt,q=>t(3,f=q)),x(n,un,q=>t(27,c=q)),x(n,Yf,q=>t(28,d=q)),x(n,Li,q=>t(12,m=q)),x(n,We,q=>t(13,h=q)),x(n,Fi,q=>t(14,_=q)),x(n,Vi,q=>t(15,b=q)),x(n,_i,q=>t(16,g=q)),x(n,Od,q=>t(17,T=q)),x(n,ad,q=>t(18,L=q)),x(n,Ii,q=>t(19,O=q));const C=J.getHashQueryParams();let{params:S}=e,P="",M=!1,A=!1,D=!1,R,Y,G=S.screenId;ir(),od(),B(S.prototypeId,S.screenId);async function B(q,ne){if(!(!q||!ne)){Zs(),xl(),tr(),t(24,M=!0);try{Cd(q),Dd(q),Id(q),nr(q),jd(q),Md(q);const He=await z.collection("prototypes").getOne(q,{expand:"project.users,screens_via_prototype"});yi(He,!0),Gn(He.expand.project,!0),ve(Ye,a=ne,a),ve(dt,o=J.sortItemsByIds(He.expand.screens_via_prototype,He.screensOrder),o),Ed(q,C.commentId),t(24,M=!1)}catch(He){He.isAbort||(t(24,M=!1),z.error(He))}}}function N(){gi(`/projects/${S==null?void 0:S.projectId}/prototypes/${S.prototypeId}`)}function V(){t(5,A=!A)}function te(q){if(!(q.altKey||q.ctrlKey||J.isInput(q.target)||document.querySelector(oy))){if(q.code==="Escape"&&A){q.preventDefault(),t(5,A=!1);return}if(q.code==="ArrowLeft"){q.preventDefault(),Tn(-1);return}if(q.code==="ArrowRight"){q.preventDefault(),Tn(1);return}if(q.code==="KeyP"){q.preventDefault(),Wt(Se.preview);return}if(q.code==="KeyH"){q.preventDefault(),Wt(Se.hotspots);return}if(q.code==="KeyC"){q.preventDefault(),Wt(Se.comments);return}}}Yt(()=>{Rt==null||Rt(),rn==null||rn(),an==null||an(),on==null||on()});function X(q){$e.call(this,n,q)}const U=()=>Tn(-1),ce=()=>Tn(1);function oe(q){le[q?"unshift":"push"](()=>{Y=q,t(8,Y)})}const de=q=>{q.dataTransfer.files.length&&sr(a,q.dataTransfer.files[0])};function Ce(q){le[q?"unshift":"push"](()=>{R=q,t(7,R)})}const xe=()=>Wt(Se.preview),at=()=>Wt(Se.hotspots),nt=()=>Wt(Se.comments),ct=()=>t(6,D=!D),K=()=>R==null?void 0:R.toggle(),se=()=>{document.activeElement.blur()};return n.$$set=q=>{"params"in q&&t(23,S=q.params)},n.$$.update=()=>{n.$$.dirty[0]&41943042&&a&&G==a.id&&S.screenId!=G&&(t(25,G=S.screenId),ve(Ye,a=S.screenId,a)),n.$$.dirty[0]&134217738&&t(4,P=[a==null?void 0:a.title,f==null?void 0:f.title,c==null?void 0:c.title].filter(Boolean).join(" - ")),n.$$.dirty[0]&301989898&&a&&a.id!=G&&(t(25,G=a.id),gi(`/projects/${f.project}/prototypes/${f.id}/screens/${a.id}?${d}`)),n.$$.dirty[0]&150994954&&t(11,i=!M&&!!(c!=null&&c.id)&&!!(f!=null&&f.id)&&!!(a!=null&&a.id)),n.$$.dirty[0]&3&&t(26,s=o.findIndex(q=>q.id==(a==null?void 0:a.id))),n.$$.dirty[0]&67108864&&t(10,l=s===0),n.$$.dirty[0]&67108865&&t(9,r=o.length-1===s),n.$$.dirty[0]&4&&J.replaceHashQueryParams({commentId:(u==null?void 0:u.id)||null})},[o,a,u,f,P,A,D,R,Y,r,l,i,m,h,_,b,g,T,L,O,N,V,te,S,M,G,s,c,d,X,U,ce,oe,de,Ce,xe,at,nt,ct,K,se]}class uy extends ye{constructor(e){super(),we(this,e,ay,ry,he,{params:23},null,[-1,-1])}}function fy(n){let e,t,i;const s=[{searchable:!0},{class:"prototypes-select"},{dropdownClass:"dropdown-right"},{noOptionsText:"No prototypes found"},{selectPlaceholder:"- Select prototype -"},{items:n[1]},n[2]];function l(o){n[4](o)}let r={};for(let o=0;o<s.length;o+=1)r=Me(r,s[o]);return n[0]!==void 0&&(r.keyOfSelected=n[0]),e=new cn({props:r}),le.push(()=>Pe(e,"keyOfSelected",l)),{c(){W(e.$$.fragment)},m(o,a){$(e,o,a),i=!0},p(o,[a]){const u=a&6?gt(s,[s[0],s[1],s[2],s[3],s[4],a&2&&{items:o[1]},a&4&&It(o[2])]):{};!t&&a&1&&(t=!0,u.keyOfSelected=o[0],je(()=>t=!1)),e.$set(u)},i(o){i||(E(e.$$.fragment,o),i=!0)},o(o){j(e.$$.fragment,o),i=!1},d(o){F(e,o)}}}function cy(n,e,t){let i;const s=["value"];let l=ut(e,s),r;x(n,qt,u=>t(3,r=u));let{value:o}=e;function a(u){o=u,t(0,o)}return n.$$set=u=>{e=Me(Me({},e),Zt(u)),t(2,l=ut(e,s)),"value"in u&&t(0,o=u.value)},n.$$.update=()=>{n.$$.dirty&8&&t(1,i=r.map(u=>({value:u.id,label:u.title,icon:J.getPrototypeIcon(u)})))},[o,i,l,r,a]}class dy extends ye{constructor(e){super(),we(this,e,cy,fy,he,{value:0})}}function py(n){let e,t,i,s,l,r,o,a;return{c(){e=w("label"),t=ee("Additional details"),s=I(),l=w("textarea"),p(e,"for",i=n[16]),p(l,"id",r=n[16]),p(l,"rows","3")},m(u,f){k(u,e,f),y(e,t),k(u,s,f),k(u,l,f),_e(l,n[3]),o||(a=H(l,"input",n[9]),o=!0)},p(u,f){f&65536&&i!==(i=u[16])&&p(e,"for",i),f&65536&&r!==(r=u[16])&&p(l,"id",r),f&8&&_e(l,u[3])},d(u){u&&(v(e),v(s),v(l)),o=!1,a()}}}function my(n){let e,t,i,s,l;return t=new Oe({props:{class:"form-field m-0",name:"message",$$slots:{default:[py,({uniqueId:r})=>({16:r}),({uniqueId:r})=>r?65536:0]},$$scope:{ctx:n}}}),{c(){e=w("form"),W(t.$$.fragment),p(e,"id",n[5])},m(r,o){k(r,e,o),$(t,e,null),i=!0,s||(l=H(e,"submit",be(n[6])),s=!0)},p(r,o){const a={};o&196616&&(a.$$scope={dirty:o,ctx:r}),t.$set(a)},i(r){i||(E(t.$$.fragment,r),i=!0)},o(r){j(t.$$.fragment,r),i=!1},d(r){r&&v(e),F(t),s=!1,l()}}}function hy(n){let e;return{c(){e=w("h5"),e.textContent="Report this design for spam or abusive content",p(e,"class","block txt-center")},m(t,i){k(t,e,i)},p:Q,d(t){t&&v(e)}}}function _y(n){let e,t,i,s,l,r,o;return{c(){e=w("button"),t=w("span"),t.textContent="Close",i=I(),s=w("button"),l=w("span"),l.textContent="Report",p(t,"class","txt"),p(e,"type","button"),p(e,"class","btn btn-transparent m-r-auto"),e.disabled=n[4],p(l,"class","txt"),p(s,"form",n[5]),p(s,"type","submit"),p(s,"class","btn btn-expanded-sm btn-primary"),s.disabled=n[4],Z(s,"btn-loading",n[4])},m(a,u){k(a,e,u),y(e,t),k(a,i,u),k(a,s,u),y(s,l),r||(o=H(e,"click",n[8]),r=!0)},p(a,u){u&16&&(e.disabled=a[4]),u&16&&(s.disabled=a[4]),u&16&&Z(s,"btn-loading",a[4])},d(a){a&&(v(e),v(i),v(s)),r=!1,o()}}}function gy(n){let e,t,i;function s(r){n[11](r)}let l={popup:!0,$$slots:{footer:[_y],header:[hy],default:[my]},$$scope:{ctx:n}};return n[0]!==void 0&&(l.active=n[0]),e=new dn({props:l}),n[10](e),le.push(()=>Pe(e,"active",s)),e.$on("show",n[12]),e.$on("hide",n[13]),{c(){W(e.$$.fragment)},m(r,o){$(e,r,o),i=!0},p(r,[o]){const a={};o&131096&&(a.$$scope={dirty:o,ctx:r}),!t&&o&1&&(t=!0,a.active=r[0],je(()=>t=!1)),e.$set(a)},i(r){i||(E(e.$$.fragment,r),i=!0)},o(r){j(e.$$.fragment,r),i=!1},d(r){n[10](null),F(e,r)}}}function by(n,e,t){const i=tt(),s="report_"+J.randomString(5);let{active:l=!1}=e,r,o="",a=!1;function u(){return c(),r==null?void 0:r.show()}function f(){return r==null?void 0:r.hide()}function c(){Kt({}),t(3,o="")}async function d(){if(!a){t(4,a=!0);try{await z.send("/api/pr/report",{method:"POST",body:{message:o}}),i("submit"),_t("Thank you, we will investigate and remove the project if found inappropriate.",5e3),Bt("/")}catch(L){L.isAbort||z.error(L)}t(4,a=!1)}}Yt(()=>{f()});const m=()=>f();function h(){o=this.value,t(3,o)}function _(L){le[L?"unshift":"push"](()=>{r=L,t(2,r)})}function b(L){l=L,t(0,l)}function g(L){$e.call(this,n,L)}function T(L){$e.call(this,n,L)}return n.$$set=L=>{"active"in L&&t(0,l=L.active)},[l,f,r,o,a,s,d,u,m,h,_,b,g,T]}class wy extends ye{constructor(e){super(),we(this,e,by,gy,he,{active:0,show:7,hide:1})}get show(){return this.$$.ctx[7]}get hide(){return this.$$.ctx[1]}}function yy(n){let e,t,i=n[3].title+"",s,l,r,o,a,u,f,c,d;return{c(){e=w("div"),t=w("p"),s=ee(i),l=I(),r=w("button"),r.innerHTML='<i class="iconoir-warning-triangle-solid"></i> <span class="txt">Report design</span>',o=I(),a=w("hr"),u=I(),f=w("p"),f.innerHTML=`Presented with
                <a href="https://presentator.io" target="_blank" rel="noopener noreferrer">Presentator</a>`,p(t,"class","txt-bold"),p(r,"type","button"),p(r,"class","btn btn-xs btn-transparent btn-danger m-t-xs"),p(a,"class","m-t-xs m-b-xs"),p(f,"class","txt-xs txt-hint"),p(e,"class","content")},m(m,h){k(m,e,h),y(e,t),y(t,s),y(e,l),y(e,r),y(e,o),y(e,a),y(e,u),y(e,f),c||(d=H(r,"click",Be(n[7])),c=!0)},p(m,h){h&8&&i!==(i=m[3].title+"")&&ke(s,i)},d(m){m&&v(e),c=!1,d()}}}function vy(n){let e,t,i,s,l,r,o,a,u,f,c;function d(_){n[9](_)}let m={class:"dropdown dropdown-right dropdown-upside project-info-dropdown",$$slots:{default:[yy]},$$scope:{ctx:n}};n[2]!==void 0&&(m.active=n[2]),s=new At({props:m}),n[8](s),le.push(()=>Pe(s,"active",d));let h={};return a=new wy({props:h}),n[10](a),{c(){e=w("div"),t=w("i"),i=I(),W(s.$$.fragment),o=I(),W(a.$$.fragment),p(t,"class","iconoir-info-circle"),p(e,"tabindex","0"),p(e,"class","btn btn-circle btn-hint txt-hint btn-transparent project-info-btn")},m(_,b){k(_,e,b),y(e,t),y(e,i),$(s,e,null),k(_,o,b),$(a,_,b),u=!0,f||(c=[ge(r=Te.call(null,e,n[2]?void 0:{position:"top-right",text:"Project info"})),H(e,"click",Be(n[6]))],f=!0)},p(_,[b]){const g={};b&2058&&(g.$$scope={dirty:b,ctx:_}),!l&&b&4&&(l=!0,g.active=_[2],je(()=>l=!1)),s.$set(g),r&&Qe(r.update)&&b&4&&r.update.call(null,_[2]?void 0:{position:"top-right",text:"Project info"});const T={};a.$set(T)},i(_){u||(E(s.$$.fragment,_),E(a.$$.fragment,_),u=!0)},o(_){j(s.$$.fragment,_),j(a.$$.fragment,_),u=!1},d(_){_&&(v(e),v(o)),n[8](null),F(s),n[10](null),F(a,_),f=!1,pe(c)}}}function ky(n,e,t){let i;x(n,un,h=>t(3,i=h));let s,l,r=!1;function o(){s==null||s.show()}function a(){s==null||s.hide()}function u(h){$e.call(this,n,h)}const f=()=>l==null?void 0:l.show();function c(h){le[h?"unshift":"push"](()=>{s=h,t(0,s)})}function d(h){r=h,t(2,r)}function m(h){le[h?"unshift":"push"](()=>{l=h,t(1,l)})}return[s,l,r,i,o,a,u,f,c,d,m]}class Sy extends ye{constructor(e){super(),we(this,e,ky,vy,he,{show:4,hide:5})}get show(){return this.$$.ctx[4]}get hide(){return this.$$.ctx[5]}}function Ty(n){let e,t,i,s,l,r,o,a,u,f,c;o=new Hd({});let d=n[4]===Se.comments&&_f(n);return{c(){e=w("div"),t=w("div"),i=w("div"),i.innerHTML='<i class="iconoir-nav-arrow-left"></i>',s=I(),l=w("div"),l.innerHTML='<i class="iconoir-nav-arrow-right"></i>',r=I(),W(o.$$.fragment),a=I(),d&&d.c(),p(i,"class","screen-preview-nav-ctrl left"),Z(i,"disabled",n[11]),p(l,"class","screen-preview-nav-ctrl right"),Z(l,"disabled",n[10]),p(t,"class","screen-preview-nav-wrapper"),Z(t,"discreet",!n[6]),p(e,"class","screen-preview-container entrance-fade")},m(m,h){k(m,e,h),y(e,t),y(t,i),y(t,s),y(t,l),y(t,r),$(o,t,null),n[31](t),y(e,a),d&&d.m(e,null),u=!0,f||(c=[H(i,"click",be(n[29])),H(l,"click",be(n[30]))],f=!0)},p(m,h){(!u||h[0]&2048)&&Z(i,"disabled",m[11]),(!u||h[0]&1024)&&Z(l,"disabled",m[10]),(!u||h[0]&64)&&Z(t,"discreet",!m[6]),m[4]===Se.comments?d?(d.p(m,h),h[0]&16&&E(d,1)):(d=_f(m),d.c(),E(d,1),d.m(e,null)):d&&(ae(),j(d,1,1,()=>{d=null}),ue())},i(m){u||(E(o.$$.fragment,m),E(d),u=!0)},o(m){j(o.$$.fragment,m),j(d),u=!1},d(m){m&&v(e),F(o),n[31](null),d&&d.d(),f=!1,pe(c)}}}function Oy(n){let e;return{c(){e=w("div"),e.innerHTML='<div class="placeholder-block"><figure class="icon"><i class="iconoir-media-image-list"></i></figure> <h5 class="title txt-hint">The prototype doesn&#39;t have any screens yet.</h5></div>',p(e,"class","wrapper wrapper-sm m-t-auto m-b-auto")},m(t,i){k(t,e,i)},p:Q,i:Q,o:Q,d(t){t&&v(e)}}}function Cy(n){let e;return{c(){e=w("span"),p(e,"class","loader loader-lg m-t-auto m-b-auto")},m(t,i){k(t,e,i)},p:Q,i:Q,o:Q,d(t){t&&v(e)}}}function _f(n){let e,t,i={};return e=new qd({props:i}),n[32](e),{c(){W(e.$$.fragment)},m(s,l){$(e,s,l),t=!0},p(s,l){const r={};e.$set(r)},i(s){t||(E(e.$$.fragment,s),t=!0)},o(s){j(e.$$.fragment,s),t=!1},d(s){n[32](null),F(e,s)}}}function gf(n){var h,_;let e,t,i,s,l,r,o,a,u,f,c=((h=n[2])==null?void 0:h.id)&&bf(n),d=((_=n[2])==null?void 0:_.id)&&vf(n),m=n[17].length>1&&Of(n);return r=new Sy({}),{c(){e=w("nav"),c&&c.c(),t=I(),i=w("div"),d&&d.c(),s=I(),m&&m.c(),l=I(),W(r.$$.fragment),p(i,"class","controls-group group-right responsive-hide"),p(e,"class","controls-bar"),Z(e,"show-responsive-controls",n[7])},m(b,g){k(b,e,g),c&&c.m(e,null),y(e,t),y(e,i),d&&d.m(i,null),y(i,s),m&&m.m(i,null),y(i,l),$(r,i,null),a=!0,u||(f=H(e,"click",be(n[38])),u=!0)},p(b,g){var T,L;(T=b[2])!=null&&T.id?c?c.p(b,g):(c=bf(b),c.c(),c.m(e,t)):c&&(c.d(1),c=null),(L=b[2])!=null&&L.id?d?(d.p(b,g),g[0]&4&&E(d,1)):(d=vf(b),d.c(),E(d,1),d.m(i,s)):d&&(ae(),j(d,1,1,()=>{d=null}),ue()),b[17].length>1?m?(m.p(b,g),g[0]&131072&&E(m,1)):(m=Of(b),m.c(),E(m,1),m.m(i,l)):m&&(ae(),j(m,1,1,()=>{m=null}),ue()),(!a||g[0]&128)&&Z(e,"show-responsive-controls",b[7])},i(b){a||(E(d),E(m),E(r.$$.fragment,b),b&&vt(()=>{a&&(o||(o=ft(e,Ot,{duration:150},!0)),o.run(1))}),a=!0)},o(b){j(d),j(m),j(r.$$.fragment,b),b&&(o||(o=ft(e,Ot,{duration:150},!1)),o.run(0)),a=!1},d(b){b&&v(e),c&&c.d(),d&&d.d(),m&&m.d(),F(r),b&&o&&o.end(),u=!1,f()}}}function bf(n){var Y,G;let e,t,i,s=((Y=n[2])==null?void 0:Y.title)+"",l,r,o,a=Ps(n[2])+"",u,f,c=n[3].length+"",d,m,h,_,b,g,T,L,O,C,S,P,M,A,D,R=((G=n[0])==null?void 0:G.allowComments)&&wf(n);return{c(){var B;e=w("div"),t=w("button"),i=w("span"),l=ee(s),o=ee(`
                        (`),u=ee(a),f=ee(" of "),d=ee(c),m=ee(`)
                        `),h=w("i"),g=I(),T=w("div"),L=w("button"),O=w("i"),S=I(),R&&R.c(),P=I(),M=w("button"),M.innerHTML='<i class="iconoir-more-vert"></i>',p(i,"class","screen-title-trim"),p(i,"title",r=(B=n[2])==null?void 0:B.title),p(h,"class",_="iconoir-nav-arrow-"+(n[5]?"up":"down")),p(t,"type","button"),p(t,"class",b="btn btn-sm btn-hint txt-hint "+(n[5]?"btn-semitransparent":"btn-transparent")),p(e,"class","controls-group group-left"),p(O,"class","iconoir-play"),p(L,"class",C="btn btn-circle "+(n[4]==Se.preview?"btn-primary btn-transparent":"btn-hint btn-transparent txt-hint")),p(M,"type","button"),p(M,"class","btn btn-circle btn-hint txt-hint btn-transparent responsive-show"),Z(M,"active",n[7]),p(T,"class","controls-group group-center")},m(B,N){k(B,e,N),y(e,t),y(t,i),y(i,l),y(t,o),y(t,u),y(t,f),y(t,d),y(t,m),y(t,h),k(B,g,N),k(B,T,N),y(T,L),y(L,O),y(T,S),R&&R.m(T,null),y(T,P),y(T,M),A||(D=[H(t,"click",be(n[19])),ge(Te.call(null,L,{position:"top",text:"Preview mode",sub:"P"})),H(L,"click",be(n[33])),ge(Te.call(null,M,{position:"top",text:"More options"})),H(M,"click",n[35])],A=!0)},p(B,N){var V,te,X;N[0]&4&&s!==(s=((V=B[2])==null?void 0:V.title)+"")&&ke(l,s),N[0]&4&&r!==(r=(te=B[2])==null?void 0:te.title)&&p(i,"title",r),N[0]&4&&a!==(a=Ps(B[2])+"")&&ke(u,a),N[0]&8&&c!==(c=B[3].length+"")&&ke(d,c),N[0]&32&&_!==(_="iconoir-nav-arrow-"+(B[5]?"up":"down"))&&p(h,"class",_),N[0]&32&&b!==(b="btn btn-sm btn-hint txt-hint "+(B[5]?"btn-semitransparent":"btn-transparent"))&&p(t,"class",b),N[0]&16&&C!==(C="btn btn-circle "+(B[4]==Se.preview?"btn-primary btn-transparent":"btn-hint btn-transparent txt-hint"))&&p(L,"class",C),(X=B[0])!=null&&X.allowComments?R?R.p(B,N):(R=wf(B),R.c(),R.m(T,P)):R&&(R.d(1),R=null),N[0]&128&&Z(M,"active",B[7])},d(B){B&&(v(e),v(g),v(T)),R&&R.d(),A=!1,pe(D)}}}function wf(n){let e,t,i,s,l,r,o=n[14].length&&yf(n);return{c(){e=w("button"),t=w("i"),i=I(),o&&o.c(),p(t,"class","iconoir-message-text"),p(e,"class",s="btn btn-circle "+(n[4]==Se.comments?"btn-danger btn-transparent":"btn-hint btn-transparent txt-hint")),Z(e,"btn-loading",n[13])},m(a,u){k(a,e,u),y(e,t),y(e,i),o&&o.m(e,null),l||(r=[ge(Te.call(null,e,{position:"top",text:"Comments mode",sub:"C"})),H(e,"click",be(n[34]))],l=!0)},p(a,u){a[14].length?o?o.p(a,u):(o=yf(a),o.c(),o.m(e,null)):o&&(o.d(1),o=null),u[0]&16&&s!==(s="btn btn-circle "+(a[4]==Se.comments?"btn-danger btn-transparent":"btn-hint btn-transparent txt-hint"))&&p(e,"class",s),u[0]&8208&&Z(e,"btn-loading",a[13])},d(a){a&&v(e),o&&o.d(),l=!1,pe(r)}}}function yf(n){let e,t=n[14].length+"",i,s;return{c(){e=w("sub"),i=ee(t),p(e,"class",s="sub "+(n[15].length?"sub-warning":n[4]==Se.comments?"sub-danger":"sub-secondary-alt")),p(e,"title","Unread comments")},m(l,r){k(l,e,r),y(e,i)},p(l,r){r[0]&16384&&t!==(t=l[14].length+"")&&ke(i,t),r[0]&32784&&s!==(s="sub "+(l[15].length?"sub-warning":l[4]==Se.comments?"sub-danger":"sub-secondary-alt"))&&p(e,"class",s)},d(l){l&&v(e)}}}function vf(n){var a;let e,t,i,s,l=((a=n[0])==null?void 0:a.allowComments)&&n[4]==Se.comments&&!n[13]&&kf(n),r=n[4]==Se.preview&&Sf(),o=n[1].scale!=0&&Tf(n);return{c(){l&&l.c(),e=I(),r&&r.c(),t=I(),o&&o.c(),i=Ne()},m(u,f){l&&l.m(u,f),k(u,e,f),r&&r.m(u,f),k(u,t,f),o&&o.m(u,f),k(u,i,f),s=!0},p(u,f){var c;(c=u[0])!=null&&c.allowComments&&u[4]==Se.comments&&!u[13]?l?l.p(u,f):(l=kf(u),l.c(),l.m(e.parentNode,e)):l&&(l.d(1),l=null),u[4]==Se.preview?r?f[0]&16&&E(r,1):(r=Sf(),r.c(),E(r,1),r.m(t.parentNode,t)):r&&(ae(),j(r,1,1,()=>{r=null}),ue()),u[1].scale!=0?o?o.p(u,f):(o=Tf(u),o.c(),o.m(i.parentNode,i)):o&&(o.d(1),o=null)},i(u){s||(E(r),s=!0)},o(u){j(r),s=!1},d(u){u&&(v(e),v(t),v(i)),l&&l.d(u),r&&r.d(u),o&&o.d(u)}}}function kf(n){let e,t,i;return{c(){e=w("button"),e.innerHTML='<span class="txt">Comments panel</span>',p(e,"type","button"),p(e,"class","btn btn-sm btn-transparent btn-danger entrance-right")},m(s,l){k(s,e,l),t||(i=H(e,"click",be(n[36])),t=!0)},p:Q,d(s){s&&v(e),t=!1,i()}}}function Sf(n){let e,t;return e=new Ud({}),{c(){W(e.$$.fragment)},m(i,s){$(e,i,s),t=!0},i(i){t||(E(e.$$.fragment,i),t=!0)},o(i){j(e.$$.fragment,i),t=!1},d(i){F(e,i)}}}function Tf(n){let e,t,i,s,l;return{c(){e=w("button"),t=w("i"),p(t,"class","iconoir-scale-frame-reduce"),p(e,"class",i="btn btn-circle btn-hint btn-transparent "+(n[16]?"txt-warning":"txt-hint"))},m(r,o){k(r,e,o),y(e,t),s||(l=[ge(Te.call(null,e,{position:"top",text:"Toggle fit to screen"})),H(e,"click",be(rd))],s=!0)},p(r,o){o[0]&65536&&i!==(i="btn btn-circle btn-hint btn-transparent "+(r[16]?"txt-warning":"txt-hint"))&&p(e,"class",i)},d(r){r&&v(e),s=!1,pe(l)}}}function Of(n){let e,t,i,s;function l(o){n[37](o)}let r={upside:!0,searchable:!1};return n[18]!==void 0&&(r.value=n[18]),t=new dy({props:r}),le.push(()=>Pe(t,"value",l)),{c(){e=w("div"),W(t.$$.fragment),p(e,"class","form-field form-field-sm")},m(o,a){k(o,e,a),$(t,e,null),s=!0},p(o,a){const u={};!i&&a[0]&262144&&(i=!0,u.value=o[18],je(()=>i=!1)),t.$set(u)},i(o){s||(E(t.$$.fragment,o),s=!0)},o(o){j(t.$$.fragment,o),s=!1},d(o){o&&v(e),F(t)}}}function Ey(n){let e,t,i,s,l,r=n[6]?"Hide":"Show",o,a,u,f,c,d,m,h,_;const b=[Cy,Oy,Ty],g=[];function T(O,C){var S;return O[12]?(S=O[2])!=null&&S.id?2:1:0}e=T(n),t=g[e]=b[e](n);let L=n[6]&&gf(n);return f=new Rd({props:{active:n[5]}}),d=new Fd({props:{viewport:n[9]}}),{c(){t.c(),i=I(),s=w("div"),l=w("div"),o=ee(r),a=I(),L&&L.c(),u=I(),W(f.$$.fragment),c=I(),W(d.$$.fragment),p(l,"class","controls-bar-toggle"),Z(l,"active",n[6]),p(s,"class","controls-bar-wrapper")},m(O,C){g[e].m(O,C),k(O,i,C),k(O,s,C),y(s,l),y(l,o),y(s,a),L&&L.m(s,null),k(O,u,C),$(f,O,C),k(O,c,C),$(d,O,C),m=!0,h||(_=[H(window,"keydown",n[21]),H(l,"click",be(n[20]))],h=!0)},p(O,C){let S=e;e=T(O),e===S?g[e].p(O,C):(ae(),j(g[S],1,1,()=>{g[S]=null}),ue(),t=g[e],t?t.p(O,C):(t=g[e]=b[e](O),t.c()),E(t,1),t.m(i.parentNode,i)),(!m||C[0]&64)&&r!==(r=O[6]?"Hide":"Show")&&ke(o,r),(!m||C[0]&64)&&Z(l,"active",O[6]),O[6]?L?(L.p(O,C),C[0]&64&&E(L,1)):(L=gf(O),L.c(),E(L,1),L.m(s,null)):L&&(ae(),j(L,1,1,()=>{L=null}),ue());const P={};C[0]&32&&(P.active=O[5]),f.$set(P);const M={};C[0]&512&&(M.viewport=O[9]),d.$set(M)},i(O){m||(E(t),E(L),E(f.$$.fragment,O),E(d.$$.fragment,O),m=!0)},o(O){j(t),j(L),j(f.$$.fragment,O),j(d.$$.fragment,O),m=!1},d(O){O&&(v(i),v(s),v(u),v(c)),g[e].d(O),L&&L.d(),F(f,O),F(d,O),h=!1,pe(_)}}}const Ly=".toggler-container > .active";function Iy(n,e,t){let i,s,l,r,o,a,u,f,c,d,m,h,_,b,g,T;x(n,Yf,K=>t(27,o=K)),x(n,Tt,K=>t(1,a=K)),x(n,Ye,K=>t(2,u=K)),x(n,dt,K=>t(3,f=K)),x(n,$t,K=>t(28,c=K)),x(n,Li,K=>t(4,d=K)),x(n,_i,K=>t(13,m=K)),x(n,Od,K=>t(14,h=K)),x(n,ad,K=>t(15,_=K)),x(n,Ii,K=>t(16,b=K)),x(n,qt,K=>t(17,g=K)),x(n,Yn,K=>t(18,T=K));const L=J.getHashQueryParams();let{link:O}=e,{params:C}=e,S=!1,P=!1,M=!0,A=!1,D,R,Y="",G="";ir(),od();async function B(){t(23,S=!0),await St(),tr();try{const K=a.id;Dd(K),Id(K),nr(K),O!=null&&O.allowComments&&Cd(K),jd(K),Md(K);const se=await z.collection("screens").getFullList({filter:`prototype="${K}"`});ve(Ye,u=C.screenId,u),ve(dt,f=J.sortItemsByIds(se,a.screensOrder),f),O!=null&&O.allowComments&&Ed(K,L.commentId),u!=null&&u.id||Bt(`/${O.username}/prototypes/${a.id}?${o}`),t(23,S=!1)}catch(K){K.isAbort||(t(23,S=!1),z.error(K))}}function N(){t(5,P=!P)}function V(){t(6,M=!M),M||(t(5,P=!1),D==null||D.hide())}function te(K){if(!(K.altKey||K.ctrlKey||J.isInput(K.target)||document.querySelector(Ly))){if(K.code==="Escape"&&P){K.preventDefault(),t(5,P=!1);return}if(K.code==="ArrowLeft"){K.preventDefault(),Tn(-1);return}if(K.code==="ArrowRight"){K.preventDefault(),Tn(1);return}if(K.code==="KeyP"){K.preventDefault(),Wt(Se.preview);return}if(K.code==="KeyC"&&(O!=null&&O.allowComments)){K.preventDefault(),Wt(Se.comments);return}}}Yt(()=>{rn==null||rn(),Rt==null||Rt(),an==null||an(),on==null||on()});const X=()=>Tn(-1),U=()=>Tn(1);function ce(K){le[K?"unshift":"push"](()=>{R=K,t(9,R)})}function oe(K){le[K?"unshift":"push"](()=>{D=K,t(8,D)})}const de=()=>Wt(Se.preview),Ce=()=>Wt(Se.comments),xe=()=>t(7,A=!A),at=()=>D==null?void 0:D.toggle();function nt(K){T=K,Yn.set(T)}const ct=()=>{document.activeElement.blur()};return n.$$set=K=>{"link"in K&&t(0,O=K.link),"params"in K&&t(22,C=K.params)},n.$$.update=()=>{n.$$.dirty[0]&17&&!(O!=null&&O.allowComments)&&d==Se.comments&&Wt(Se.preview),n.$$.dirty[0]&33554434&&a&&G!=(a==null?void 0:a.id)&&(t(25,G=a.id),B()),n.$$.dirty[0]&20971524&&u&&Y==u.id&&C.screenId!=Y&&(t(24,Y=C.screenId),ve(Ye,u=C.screenId,u)),n.$$.dirty[0]&150994951&&u&&u.id!=Y&&(t(24,Y=u.id),gi(`/${O.username}/prototypes/${a.id}/screens/${u.id}?${o}`)),n.$$.dirty[0]&8388610&&t(12,i=!S&&!!(a!=null&&a.id)),n.$$.dirty[0]&12&&t(26,s=f.findIndex(K=>K.id==(u==null?void 0:u.id))),n.$$.dirty[0]&67108864&&t(11,l=s===0),n.$$.dirty[0]&67108872&&t(10,r=f.length-1===s),n.$$.dirty[0]&268435456&&J.replaceHashQueryParams({commentId:(c==null?void 0:c.id)||null})},[O,a,u,f,d,P,M,A,D,R,r,l,i,m,h,_,b,g,T,N,V,te,C,S,Y,G,s,o,c,X,U,ce,oe,de,Ce,xe,at,nt,ct]}class jy extends ye{constructor(e){super(),we(this,e,Iy,Ey,he,{link:0,params:22},null,[-1,-1])}}function Py(n){let e,t;return e=new jy({props:{link:n[1],params:n[0].groups}}),{c(){W(e.$$.fragment)},m(i,s){$(e,i,s),t=!0},p(i,s){const l={};s&2&&(l.link=i[1]),s&1&&(l.params=i[0].groups),e.$set(l)},i(i){t||(E(e.$$.fragment,i),t=!0)},o(i){j(e.$$.fragment,i),t=!1},d(i){F(e,i)}}}function Ny(n){let e;return{c(){e=w("div"),e.innerHTML='<div class="placeholder-block"><figure class="icon"><i class="iconoir-pen-tablet"></i></figure> <h5 class="title txt-hint">The project doesn&#39;t have any prototypes yet.</h5></div>',p(e,"class","wrapper wrapper-sm m-t-auto m-b-auto")},m(t,i){k(t,e,i)},p:Q,i:Q,o:Q,d(t){t&&v(e)}}}function Ay(n){let e;return{c(){e=w("span"),p(e,"class","loader m-t-auto m-b-auto")},m(t,i){k(t,e,i)},p:Q,i:Q,o:Q,d(t){t&&v(e)}}}function Dy(n){let e,t,i,s,l,r,o,a,u,f,c,d,m,h,_;return a=new Oe({props:{class:"form-field form-field-lg",name:"password",$$slots:{default:[My,({uniqueId:b})=>({15:b}),({uniqueId:b})=>b?32768:0]},$$scope:{ctx:n}}}),{c(){e=w("div"),t=I(),i=w("div"),s=w("div"),l=w("h4"),l.textContent="The project link is password protected",r=I(),o=w("form"),W(a.$$.fragment),u=I(),f=w("button"),f.innerHTML='<span class="txt">View project</span> <i class="iconoir-arrow-right"></i>',c=I(),d=w("div"),p(e,"class","flex-fill"),p(l,"class","m-b-base"),p(f,"type","submit"),p(f,"class","btn btn-block btn-lg btn-primary btn-next"),Z(f,"btn-disabled",n[4]),Z(f,"btn-loading",n[4]),p(o,"class","panel-content"),p(s,"class","panel"),p(i,"class","wrapper wrapper-sm m-b-base entrance-top"),p(d,"class","flex-fill")},m(b,g){k(b,e,g),k(b,t,g),k(b,i,g),y(i,s),y(s,l),y(s,r),y(s,o),$(a,o,null),y(o,u),y(o,f),k(b,c,g),k(b,d,g),m=!0,h||(_=H(o,"submit",be(n[14])),h=!0)},p(b,g){const T={};g&98308&&(T.$$scope={dirty:g,ctx:b}),a.$set(T),(!m||g&16)&&Z(f,"btn-disabled",b[4]),(!m||g&16)&&Z(f,"btn-loading",b[4])},i(b){m||(E(a.$$.fragment,b),m=!0)},o(b){j(a.$$.fragment,b),m=!1},d(b){b&&(v(e),v(t),v(i),v(c),v(d)),F(a),h=!1,_()}}}function My(n){let e,t,i,s,l,r,o,a,u;return{c(){e=w("div"),t=w("label"),i=w("i"),l=I(),r=w("input"),p(i,"class","iconoir-lock"),p(t,"for",s=n[15]),p(t,"class","addon prefix"),r.required=!0,r.autofocus=!0,p(r,"type","password"),p(r,"id",o=n[15]),p(r,"placeholder","Password"),p(e,"class","field-group m-b-10")},m(f,c){k(f,e,c),y(e,t),y(t,i),y(e,l),y(e,r),_e(r,n[2]),r.focus(),a||(u=[ge(Te.call(null,t,{position:"left",text:"Password"})),H(r,"input",n[13])],a=!0)},p(f,c){c&32768&&s!==(s=f[15])&&p(t,"for",s),c&32768&&o!==(o=f[15])&&p(r,"id",o),c&4&&r.value!==f[2]&&_e(r,f[2])},d(f){f&&v(e),a=!1,pe(u)}}}function Ry(n){let e,t,i,s;const l=[Dy,Ay,Ny,Py],r=[];function o(a,u){return a[3]?0:a[4]?1:a[6].length?3:2}return e=o(n),t=r[e]=l[e](n),{c(){t.c(),i=Ne()},m(a,u){r[e].m(a,u),k(a,i,u),s=!0},p(a,u){let f=e;e=o(a),e===f?r[e].p(a,u):(ae(),j(r[f],1,1,()=>{r[f]=null}),ue(),t=r[e],t?t.p(a,u):(t=r[e]=l[e](a),t.c()),E(t,1),t.m(i.parentNode,i))},i(a){s||(E(t),s=!0)},o(a){j(t),s=!1},d(a){a&&v(i),r[e].d(a)}}}function Hy(n){let e,t;return e=new ji({props:{fullpage:!0,class:"screen-preview-layout screen-preview-mode-"+n[7]+" "+(n[7]==Se.comments&&n[8]?"screen-preview-comment-popover-active":""),header:!1,footer:!1,title:n[5],$$slots:{default:[Ry]},$$scope:{ctx:n}}}),{c(){W(e.$$.fragment)},m(i,s){$(e,i,s),t=!0},p(i,[s]){const l={};s&384&&(l.class="screen-preview-layout screen-preview-mode-"+i[7]+" "+(i[7]==Se.comments&&i[8]?"screen-preview-comment-popover-active":"")),s&32&&(l.title=i[5]),s&65631&&(l.$$scope={dirty:s,ctx:i}),e.$set(l)},i(i){t||(E(e.$$.fragment,i),t=!0)},o(i){j(e.$$.fragment,i),t=!1},d(i){F(e,i)}}}function Uy(n,e,t){let i,s,l,r,o,a,u;x(n,qt,T=>t(6,s=T)),x(n,Tt,T=>t(10,l=T)),x(n,un,T=>t(11,r=T)),x(n,Ye,T=>t(12,o=T)),x(n,Li,T=>t(7,a=T)),x(n,$t,T=>t(8,u=T));let{params:f}=e,c,d=" ",m=!1,h=!0;_();async function _(){var L,O,C,S,P,M,A,D,R,Y,G;t(4,h=!0),Zs(),xl();const T=Hh(f.groups.linkSlug);try{const B={expand:"project.users,project.prototypes_via_project"};if(T.authStore.isValid&&((L=T.authStore.record)==null?void 0:L.collectionName)=="links"&&((O=T.authStore.record)==null?void 0:O.username)==f.groups.linkSlug)try{const N=await T.collection("links").authRefresh(B);t(1,c=N.record)}catch{T.authStore.clear();const V=await T.collection("links").authWithPassword(f.groups.linkSlug,d,B);t(1,c=V.record)}else{const N=await T.collection("links").authWithPassword(f.groups.linkSlug,d,B);t(1,c=N.record)}(!z.authStore.isValid||!((M=(S=(C=c.expand)==null?void 0:C.project)==null?void 0:S.users)!=null&&M.includes((P=z.authStore.record)==null?void 0:P.id)))&&z.initStore(f.groups.linkSlug),Gn((A=c.expand)==null?void 0:A.project),ve(qt,s=((Y=(R=(D=c.expand)==null?void 0:D.project)==null?void 0:R.expand)==null?void 0:Y.prototypes_via_project)||[],s),s.find(N=>N.id==f.groups.prototypeId)?ve(Tt,l=f.groups.prototypeId,l):ve(Tt,l=(G=s[s.length-1])==null?void 0:G.id,l),t(3,m=!1),t(4,h=!1)}catch(B){if(B.isAbort)return;t(2,d=""),t(4,h=!1),m?Yl("Invalid password."):t(3,m=!0)}}function b(){d=this.value,t(2,d)}const g=()=>_();return n.$$set=T=>{"params"in T&&t(0,f=T.params)},n.$$.update=()=>{n.$$.dirty&7168&&t(5,i=[o?"Preview "+o.title:null,l==null?void 0:l.title,r==null?void 0:r.title].filter(Boolean).join(" - "))},[f,c,d,m,h,i,s,a,u,_,l,r,o,b,g]}class qy extends ye{constructor(e){super(),we(this,e,Uy,Hy,he,{params:0})}}const Jt=new Map;Jt.set("/login",nn({component:U_,conditions:[n=>!z.authStore.isValid]}));Jt.set("/register",nn({component:X_,conditions:[n=>!z.authStore.isValid]}));Jt.set("/confirm-verification/:token",nn({asyncComponent:()=>Us(()=>import("./PageConfirmVerification-_LTy3Azv.js"),[],import.meta.url)}));Jt.set("/forgotten-password",nn({asyncComponent:()=>Us(()=>import("./PageRequestPasswordReset-Btq-EOUR.js"),[],import.meta.url),conditions:[n=>!z.authStore.isValid]}));Jt.set("/confirm-password-reset/:token",nn({asyncComponent:()=>Us(()=>import("./PageConfirmPasswordReset-BcGgB9cY.js"),[],import.meta.url)}));Jt.set("/confirm-email-change/:token",nn({asyncComponent:()=>Us(()=>import("./PageConfirmEmailChange-DP9d3U5J.js"),[],import.meta.url)}));Jt.set("/projects",nn({component:xg,conditions:[n=>z.authStore.isValid]}));Jt.set("/projects/:projectId/prototypes/:prototypeId?",nn({component:Z0,conditions:[n=>z.authStore.isValid]}));Jt.set("/projects/:projectId/prototypes/:prototypeId/screens/:screenId?",nn({component:uy,conditions:[n=>z.authStore.isValid]}));Jt.set(/^\/(?<linkSlug>[\w\.\-]+)(\/?|(\/prototypes\/(?<prototypeId>\w+)(\/screens\/(?<screenId>\w+))?))$/,nn({component:qy}));Jt.set("*",nn({component:qh}));function Cf(n,e,t){const i=n.slice();return i[2]=e[t],i}function $y(n){let e;return{c(){e=w("i"),p(e,"class","iconoir-warning-triangle")},m(t,i){k(t,e,i)},d(t){t&&v(e)}}}function Fy(n){let e;return{c(){e=w("i"),p(e,"class","iconoir-warning-circle")},m(t,i){k(t,e,i)},d(t){t&&v(e)}}}function Wy(n){let e;return{c(){e=w("i"),p(e,"class","iconoir-check-circle")},m(t,i){k(t,e,i)},d(t){t&&v(e)}}}function Vy(n){let e;return{c(){e=w("i"),p(e,"class","iconoir-info-circle")},m(t,i){k(t,e,i)},d(t){t&&v(e)}}}function Ef(n,e){let t,i,s,l,r=e[2].message+"",o,a,u,f,c,d,m,h=Q,_,b,g;function T(S,P){return S[2].type==="info"?Vy:S[2].type==="success"?Wy:S[2].type==="warning"?Fy:$y}let L=T(e),O=L(e);function C(){return e[1](e[2])}return{key:n,first:null,c(){t=w("div"),i=w("div"),O.c(),s=I(),l=w("div"),o=ee(r),a=I(),u=w("button"),u.innerHTML='<i class="iconoir-xmark"></i>',f=I(),p(i,"class","icon"),p(l,"class","content"),p(u,"type","button"),p(u,"class","close"),p(t,"class","alert txt-break"),Z(t,"alert-info",e[2].type=="info"),Z(t,"alert-success",e[2].type=="success"),Z(t,"alert-danger",e[2].type=="error"),Z(t,"alert-warning",e[2].type=="warning"),this.first=t},m(S,P){k(S,t,P),y(t,i),O.m(i,null),y(t,s),y(t,l),y(l,o),y(t,a),y(t,u),y(t,f),_=!0,b||(g=H(u,"click",be(C)),b=!0)},p(S,P){e=S,L!==(L=T(e))&&(O.d(1),O=L(e),O&&(O.c(),O.m(i,null))),(!_||P&1)&&r!==(r=e[2].message+"")&&ke(o,r),(!_||P&1)&&Z(t,"alert-info",e[2].type=="info"),(!_||P&1)&&Z(t,"alert-success",e[2].type=="success"),(!_||P&1)&&Z(t,"alert-danger",e[2].type=="error"),(!_||P&1)&&Z(t,"alert-warning",e[2].type=="warning")},r(){m=t.getBoundingClientRect()},f(){Hf(t),h(),Uf(t,m)},a(){h(),h=Rf(t,m,yd,{duration:150})},i(S){_||(S&&vt(()=>{_&&(d&&d.end(1),c=Wf(t,Ot,{duration:150}),c.start())}),_=!0)},o(S){c&&c.invalidate(),S&&(d=Vf(t,Sl,{duration:150})),_=!1},d(S){S&&v(t),O.d(),S&&d&&d.end(),b=!1,g()}}}function zy(n){let e,t=[],i=new Map,s,l=Ee(n[0]);const r=o=>o[2].message;for(let o=0;o<l.length;o+=1){let a=Cf(n,l,o),u=r(a);i.set(u,t[o]=Ef(u,a))}return{c(){e=w("div");for(let o=0;o<t.length;o+=1)t[o].c();p(e,"class","toasts-wrapper")},m(o,a){k(o,e,a);for(let u=0;u<t.length;u+=1)t[u]&&t[u].m(e,null);s=!0},p(o,[a]){if(a&1){l=Ee(o[0]),ae();for(let u=0;u<t.length;u+=1)t[u].r();t=kt(t,a,r,1,o,l,i,e,Bf,Ef,null,Cf);for(let u=0;u<t.length;u+=1)t[u].a();ue()}},i(o){if(!s){for(let a=0;a<l.length;a+=1)E(t[a]);s=!0}},o(o){for(let a=0;a<t.length;a+=1)j(t[a]);s=!1},d(o){o&&v(e);for(let a=0;a<t.length;a+=1)t[a].d()}}}function By(n,e,t){let i;return x(n,zs,l=>t(0,i=l)),[i,l=>ed(l)]}class Zy extends ye{constructor(e){super(),we(this,e,By,zy,he,{})}}function Yy(n){var s;let e,t=((s=n[1])==null?void 0:s.text)+"",i;return{c(){e=w("h4"),i=ee(t),p(e,"class","block center txt-break"),p(e,"slot","header")},m(l,r){k(l,e,r),y(e,i)},p(l,r){var o;r&2&&t!==(t=((o=l[1])==null?void 0:o.text)+"")&&ke(i,t)},d(l){l&&v(e)}}}function Ky(n){let e,t,i,s,l,r,o,a,u,f;return{c(){e=w("div"),t=w("div"),i=w("button"),s=w("span"),s.textContent="No",l=I(),r=w("div"),o=w("button"),a=w("span"),a.textContent="Yes",p(s,"class","txt"),i.autofocus=!0,p(i,"type","button"),p(i,"class","btn btn-semitransparent btn-block"),i.disabled=n[2],p(t,"class","col-6"),p(a,"class","txt"),p(o,"type","button"),p(o,"class","btn btn-warning btn-block"),o.disabled=n[2],Z(o,"btn-loading",n[2]),p(r,"class","col-6"),p(e,"class","grid")},m(c,d){k(c,e,d),y(e,t),y(t,i),y(i,s),y(e,l),y(e,r),y(r,o),y(o,a),i.focus(),u||(f=[H(i,"click",n[4]),H(o,"click",n[5])],u=!0)},p(c,d){d&4&&(i.disabled=c[2]),d&4&&(o.disabled=c[2]),d&4&&Z(o,"btn-loading",c[2])},d(c){c&&v(e),u=!1,pe(f)}}}function Gy(n){let e,t,i={class:"confirm-popup hide-content overlay-panel-sm",overlayClose:!n[2],escHide:!n[2],btnClose:!1,popup:!0,$$slots:{footer:[Ky],header:[Yy]},$$scope:{ctx:n}};return e=new dn({props:i}),n[6](e),e.$on("hide",n[7]),{c(){W(e.$$.fragment)},m(s,l){$(e,s,l),t=!0},p(s,[l]){const r={};l&4&&(r.overlayClose=!s[2]),l&4&&(r.escHide=!s[2]),l&271&&(r.$$scope={dirty:l,ctx:s}),e.$set(r)},i(s){t||(E(e.$$.fragment,s),t=!0)},o(s){j(e.$$.fragment,s),t=!1},d(s){n[6](null),F(e,s)}}}function Jy(n,e,t){let i;x(n,er,c=>t(1,i=c));let s,l=!1,r=!1;const o=()=>{t(3,r=!1),s==null||s.hide()},a=async()=>{i!=null&&i.yesCallback&&(t(2,l=!0),await Promise.resolve(i.yesCallback()),t(2,l=!1)),t(3,r=!0),s==null||s.hide()};function u(c){le[c?"unshift":"push"](()=>{s=c,t(0,s)})}const f=async()=>{!r&&(i!=null&&i.noCallback)&&i.noCallback(),await St(),t(3,r=!1),id()};return n.$$.update=()=>{n.$$.dirty&3&&i!=null&&i.text&&(t(3,r=!1),s==null||s.show())},[s,i,l,r,o,a,u,f]}class Xy extends ye{constructor(e){super(),we(this,e,Jy,Gy,he,{})}}function Qy(n){let e,t,i,s,l,r;return e=new hp({props:{routes:Jt}}),e.$on("routeLoading",n[0]),e.$on("conditionsFailed",n[1]),i=new Zy({}),l=new Xy({}),{c(){W(e.$$.fragment),t=I(),W(i.$$.fragment),s=I(),W(l.$$.fragment)},m(o,a){$(e,o,a),k(o,t,a),$(i,o,a),k(o,s,a),$(l,o,a),r=!0},p:Q,i(o){r||(E(e.$$.fragment,o),E(i.$$.fragment,o),E(l.$$.fragment,o),r=!0)},o(o){j(e.$$.fragment,o),j(i.$$.fragment,o),j(l.$$.fragment,o),r=!1},d(o){o&&(v(t),v(s)),F(e,o),F(i,o),F(l,o)}}}function xy(n,e,t){let i;x(n,wi,a=>t(3,i=a));let s;function l(a){a.detail.location!==s&&(s=a.detail.location,Kt({}),id())}function r(){z.authStore.isValid||z.rememberPath(),Bt("/")}async function o(){try{ve(wi,i=await z.send("/api/pr/options"),i)}catch(a){console.log("failed to load options:",a)}}return o(),hn(()=>{z.authStore.onChange(a=>{a?n1():Fn==null||Fn()})}),[l,r]}class ev extends ye{constructor(e){super(),we(this,e,xy,Qy,he,{})}}new ev({target:document.getElementById("app")});export{ee as A,ke as B,Q as C,_e as D,Te as E,Oe as F,pi as G,ji as L,ye as S,j as a,_t as b,W as c,F as d,Bt as e,Xl as f,w as g,I as h,we as i,p as j,k,y as l,$ as m,v as n,H as o,z as p,be as q,Ki as r,he as s,E as t,ge as u,Si as v,ae as w,ue as x,pe as y,Z as z};
