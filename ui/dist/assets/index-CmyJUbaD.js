var zd=Object.defineProperty;var Bd=(n,e,t)=>e in n?zd(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var Jl=(n,e,t)=>Bd(n,typeof e!="symbol"?e+"":e,t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))i(l);new MutationObserver(l=>{for(const s of l)if(s.type==="childList")for(const r of s.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&i(r)}).observe(document,{childList:!0,subtree:!0});function t(l){const s={};return l.integrity&&(s.integrity=l.integrity),l.referrerPolicy&&(s.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?s.credentials="include":l.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(l){if(l.ep)return;l.ep=!0;const s=t(l);fetch(l.href,s)}})();function Q(){}const Qi=n=>n;function Ue(n,e){for(const t in e)n[t]=e[t];return n}function jf(n){return n()}function br(){return Object.create(null)}function me(n){n.forEach(jf)}function et(n){return typeof n=="function"}function _e(n,e){return n!=n?e==e:n!==e||n&&typeof n=="object"||typeof n=="function"}let ol;function Zn(n,e){return n===e?!0:(ol||(ol=document.createElement("a")),ol.href=e,n===ol.href)}function Zd(n){return Object.keys(n).length===0}function Ds(n,...e){if(n==null){for(const i of e)i(void 0);return Q}const t=n.subscribe(...e);return t.unsubscribe?()=>t.unsubscribe():t}function Yn(n){let e;return Ds(n,t=>e=t)(),e}function ee(n,e,t){n.$$.on_destroy.push(Ds(e,t))}function st(n,e,t,i){if(n){const l=Pf(n,e,t,i);return n[0](l)}}function Pf(n,e,t,i){return n[1]&&i?Ue(t.ctx.slice(),n[1](i(e))):t.ctx}function rt(n,e,t,i){if(n[2]&&i){const l=n[2](i(t));if(e.dirty===void 0)return l;if(typeof l=="object"){const s=[],r=Math.max(e.dirty.length,l.length);for(let o=0;o<r;o+=1)s[o]=e.dirty[o]|l[o];return s}return e.dirty|l}return e.dirty}function ot(n,e,t,i,l,s){if(l){const r=Pf(e,t,i,s);n.p(r,l)}}function at(n){if(n.ctx.length>32){const e=[],t=n.ctx.length/32;for(let i=0;i<t;i++)e[i]=-1;return e}return-1}function Kt(n){const e={};for(const t in n)t[0]!=="$"&&(e[t]=n[t]);return e}function ft(n,e){const t={};e=new Set(e);for(const i in n)!e.has(i)&&i[0]!=="$"&&(t[i]=n[i]);return t}function wr(n){return n??""}function ke(n,e,t){return n.set(t),e}function be(n){return n&&et(n.destroy)?n.destroy:Q}function yr(n){const e=typeof n=="string"&&n.match(/^\s*(-?[\d.]+)([^\s]*)\s*$/);return e?[parseFloat(e[1]),e[2]||"px"]:[n,"px"]}const Yd=["",!0,1,"true","contenteditable"],Nf=typeof window<"u";let Hl=Nf?()=>window.performance.now():()=>Date.now(),Ms=Nf?n=>requestAnimationFrame(n):Q;const pi=new Set;function Af(n){pi.forEach(e=>{e.c(n)||(pi.delete(e),e.f())}),pi.size!==0&&Ms(Af)}function Ul(n){let e;return pi.size===0&&Ms(Af),{promise:new Promise(t=>{pi.add(e={c:n,f:t})}),abort(){pi.delete(e)}}}function y(n,e){n.appendChild(e)}function Df(n){if(!n)return document;const e=n.getRootNode?n.getRootNode():n.ownerDocument;return e&&e.host?e:n.ownerDocument}function Kd(n){const e=w("style");return e.textContent="/* empty */",Gd(Df(n),e),e.sheet}function Gd(n,e){return y(n.head||n,e),e.sheet}function k(n,e,t){n.insertBefore(e,t||null)}function v(n){n.parentNode&&n.parentNode.removeChild(n)}function ln(n,e){for(let t=0;t<n.length;t+=1)n[t]&&n[t].d(e)}function w(n){return document.createElement(n)}function te(n){return document.createTextNode(n)}function I(){return te(" ")}function De(){return te("")}function H(n,e,t,i){return n.addEventListener(e,t,i),()=>n.removeEventListener(e,t,i)}function we(n){return function(e){return e.preventDefault(),n.call(this,e)}}function Ze(n){return function(e){return e.stopPropagation(),n.call(this,e)}}function p(n,e,t){t==null?n.removeAttribute(e):n.getAttribute(e)!==t&&n.setAttribute(e,t)}const Jd=["width","height"];function Kn(n,e){const t=Object.getOwnPropertyDescriptors(n.__proto__);for(const i in e)e[i]==null?n.removeAttribute(i):i==="style"?n.style.cssText=e[i]:i==="__value"?n.value=n[i]=e[i]:t[i]&&t[i].set&&Jd.indexOf(i)===-1?n[i]=e[i]:p(n,i,e[i])}function Xd(n,e){Object.keys(e).forEach(t=>{Qd(n,t,e[t])})}function Qd(n,e,t){const i=e.toLowerCase();i in n?n[i]=typeof n[i]=="boolean"&&t===""?!0:t:e in n?n[e]=typeof n[e]=="boolean"&&t===""?!0:t:p(n,e,t)}function Sl(n){return/-/.test(n)?Xd:Kn}function Mf(n){let e;return{p(...t){e=t,e.forEach(i=>n.push(i))},r(){e.forEach(t=>n.splice(n.indexOf(t),1))}}}function vt(n){return n===""?null:+n}function xd(n){return Array.from(n.childNodes)}function Se(n,e){e=""+e,n.data!==e&&(n.data=e)}function Rf(n,e){e=""+e,n.wholeText!==e&&(n.data=e)}function ep(n,e,t){~Yd.indexOf(t)?Rf(n,e):Se(n,e)}function ge(n,e){n.value=e??""}function qe(n,e,t,i){t==null?n.style.removeProperty(e):n.style.setProperty(e,t,"")}function B(n,e,t){n.classList.toggle(e,!!t)}function Hf(n,e,{bubbles:t=!1,cancelable:i=!1}={}){return new CustomEvent(n,{detail:e,bubbles:t,cancelable:i})}function jn(n,e){return new n(e)}const Tl=new Map;let Ol=0;function tp(n){let e=5381,t=n.length;for(;t--;)e=(e<<5)-e^n.charCodeAt(t);return e>>>0}function np(n,e){const t={stylesheet:Kd(e),rules:{}};return Tl.set(n,t),t}function Zi(n,e,t,i,l,s,r,o=0){const a=16.666/i;let u=`{
`;for(let b=0;b<=1;b+=a){const g=e+(t-e)*s(b);u+=b*100+`%{${r(g,1-g)}}
`}const f=u+`100% {${r(t,1-t)}}
}`,c=`__svelte_${tp(f)}_${o}`,d=Df(n),{stylesheet:m,rules:h}=Tl.get(d)||np(d,n);h[c]||(h[c]=!0,m.insertRule(`@keyframes ${c} ${f}`,m.cssRules.length));const _=n.style.animation||"";return n.style.animation=`${_?`${_}, `:""}${c} ${i}ms linear ${l}ms 1 both`,Ol+=1,c}function Yi(n,e){const t=(n.style.animation||"").split(", "),i=t.filter(e?s=>s.indexOf(e)<0:s=>s.indexOf("__svelte")===-1),l=t.length-i.length;l&&(n.style.animation=i.join(", "),Ol-=l,Ol||ip())}function ip(){Ms(()=>{Ol||(Tl.forEach(n=>{const{ownerNode:e}=n.stylesheet;e&&v(e)}),Tl.clear())})}function Uf(n,e,t,i){if(!e)return Q;const l=n.getBoundingClientRect();if(e.left===l.left&&e.right===l.right&&e.top===l.top&&e.bottom===l.bottom)return Q;const{delay:s=0,duration:r=300,easing:o=Qi,start:a=Hl()+s,end:u=a+r,tick:f=Q,css:c}=t(n,{from:e,to:l},i);let d=!0,m=!1,h;function _(){c&&(h=Zi(n,0,1,r,s,o,c)),s||(m=!0)}function b(){c&&Yi(n,h),d=!1}return Ul(g=>{if(!m&&g>=a&&(m=!0),m&&g>=u&&(f(1,0),b()),!d)return!1;if(m){const T=g-a,L=0+1*o(T/r);f(L,1-L)}return!0}),_(),f(0,1),b}function qf(n){const e=getComputedStyle(n);if(e.position!=="absolute"&&e.position!=="fixed"){const{width:t,height:i}=e,l=n.getBoundingClientRect();n.style.position="absolute",n.style.width=t,n.style.height=i,$f(n,l)}}function $f(n,e){const t=n.getBoundingClientRect();if(e.left!==t.left||e.top!==t.top){const i=getComputedStyle(n),l=i.transform==="none"?"":i.transform;n.style.transform=`${l} translate(${e.left-t.left}px, ${e.top-t.top}px)`}}let Ki;function $i(n){Ki=n}function ql(){if(!Ki)throw new Error("Function called outside component initialization");return Ki}function gn(n){ql().$$.on_mount.push(n)}function lp(n){ql().$$.after_update.push(n)}function Gt(n){ql().$$.on_destroy.push(n)}function it(){const n=ql();return(e,t,{cancelable:i=!1}={})=>{const l=n.$$.callbacks[e];if(l){const s=Hf(e,t,{cancelable:i});return l.slice().forEach(r=>{r.call(n,s)}),!s.defaultPrevented}return!0}}function $e(n,e){const t=n.$$.callbacks[e.type];t&&t.slice().forEach(i=>i.call(this,e))}const ri=[],le=[];let mi=[];const hs=[],Ff=Promise.resolve();let _s=!1;function Wf(){_s||(_s=!0,Ff.then(Vf))}function Ot(){return Wf(),Ff}function kt(n){mi.push(n)}function Ne(n){hs.push(n)}const Xl=new Set;let ei=0;function Vf(){if(ei!==0)return;const n=Ki;do{try{for(;ei<ri.length;){const e=ri[ei];ei++,$i(e),sp(e.$$)}}catch(e){throw ri.length=0,ei=0,e}for($i(null),ri.length=0,ei=0;le.length;)le.pop()();for(let e=0;e<mi.length;e+=1){const t=mi[e];Xl.has(t)||(Xl.add(t),t())}mi.length=0}while(ri.length);for(;hs.length;)hs.pop()();_s=!1,Xl.clear(),$i(n)}function sp(n){if(n.fragment!==null){n.update(),me(n.before_update);const e=n.dirty;n.dirty=[-1],n.fragment&&n.fragment.p(n.ctx,e),n.after_update.forEach(kt)}}function rp(n){const e=[],t=[];mi.forEach(i=>n.indexOf(i)===-1?e.push(i):t.push(i)),t.forEach(i=>i()),mi=e}let Mi;function Rs(){return Mi||(Mi=Promise.resolve(),Mi.then(()=>{Mi=null})),Mi}function zn(n,e,t){n.dispatchEvent(Hf(`${e?"intro":"outro"}${t}`))}const bl=new Set;let on;function ae(){on={r:0,c:[],p:on}}function ue(){on.r||me(on.c),on=on.p}function E(n,e){n&&n.i&&(bl.delete(n),n.i(e))}function j(n,e,t,i){if(n&&n.o){if(bl.has(n))return;bl.add(n),on.c.push(()=>{bl.delete(n),i&&(t&&n.d(1),i())}),n.o(e)}else i&&i()}const Hs={duration:0};function zf(n,e,t){const i={direction:"in"};let l=e(n,t,i),s=!1,r,o,a=0;function u(){r&&Yi(n,r)}function f(){const{delay:d=0,duration:m=300,easing:h=Qi,tick:_=Q,css:b}=l||Hs;b&&(r=Zi(n,0,1,m,d,h,b,a++)),_(0,1);const g=Hl()+d,T=g+m;o&&o.abort(),s=!0,kt(()=>zn(n,!0,"start")),o=Ul(L=>{if(s){if(L>=T)return _(1,0),zn(n,!0,"end"),u(),s=!1;if(L>=g){const O=h((L-g)/m);_(O,1-O)}}return s})}let c=!1;return{start(){c||(c=!0,Yi(n),et(l)?(l=l(i),Rs().then(f)):f())},invalidate(){c=!1},end(){s&&(u(),s=!1)}}}function Bf(n,e,t){const i={direction:"out"};let l=e(n,t,i),s=!0,r;const o=on;o.r+=1;let a;function u(){const{delay:f=0,duration:c=300,easing:d=Qi,tick:m=Q,css:h}=l||Hs;h&&(r=Zi(n,1,0,c,f,d,h));const _=Hl()+f,b=_+c;kt(()=>zn(n,!1,"start")),"inert"in n&&(a=n.inert,n.inert=!0),Ul(g=>{if(s){if(g>=b)return m(0,1),zn(n,!1,"end"),--o.r||me(o.c),!1;if(g>=_){const T=d((g-_)/c);m(1-T,T)}}return s})}return et(l)?Rs().then(()=>{l=l(i),u()}):u(),{end(f){f&&"inert"in n&&(n.inert=a),f&&l.tick&&l.tick(1,0),s&&(r&&Yi(n,r),s=!1)}}}function ct(n,e,t,i){let s=e(n,t,{direction:"both"}),r=i?0:1,o=null,a=null,u=null,f;function c(){u&&Yi(n,u)}function d(h,_){const b=h.b-r;return _*=Math.abs(b),{a:r,b:h.b,d:b,duration:_,start:h.start,end:h.start+_,group:h.group}}function m(h){const{delay:_=0,duration:b=300,easing:g=Qi,tick:T=Q,css:L}=s||Hs,O={start:Hl()+_,b:h};h||(O.group=on,on.r+=1),"inert"in n&&(h?f!==void 0&&(n.inert=f):(f=n.inert,n.inert=!0)),o||a?a=O:(L&&(c(),u=Zi(n,r,h,b,_,g,L)),h&&T(0,1),o=d(O,b),kt(()=>zn(n,h,"start")),Ul(C=>{if(a&&C>a.start&&(o=d(a,b),a=null,zn(n,o.b,"start"),L&&(c(),u=Zi(n,r,o.b,o.duration,0,g,s.css))),o){if(C>=o.end)T(r=o.b,1-r),zn(n,o.b,"end"),a||(o.b?c():--o.group.r||me(o.group.c)),o=null;else if(C>=o.start){const S=C-o.start;r=o.a+o.d*g(S/o.duration),T(r,1-r)}}return!!(o||a)}))}return{run(h){et(s)?Rs().then(()=>{s=s({direction:h?"in":"out"}),m(h)}):m(h)},end(){c(),o=a=null}}}function Le(n){return(n==null?void 0:n.length)!==void 0?n:Array.from(n)}function Zf(n,e){n.d(1),e.delete(n.key)}function At(n,e){j(n,1,1,()=>{e.delete(n.key)})}function Yf(n,e){n.f(),At(n,e)}function St(n,e,t,i,l,s,r,o,a,u,f,c){let d=n.length,m=s.length,h=d;const _={};for(;h--;)_[n[h].key]=h;const b=[],g=new Map,T=new Map,L=[];for(h=m;h--;){const P=c(l,s,h),R=t(P);let A=r.get(R);A?L.push(()=>A.p(P,e)):(A=u(R,P),A.c()),g.set(R,b[h]=A),R in _&&T.set(R,Math.abs(h-_[R]))}const O=new Set,C=new Set;function S(P){E(P,1),P.m(o,f),r.set(P.key,P),f=P.first,m--}for(;d&&m;){const P=b[m-1],R=n[d-1],A=P.key,D=R.key;P===R?(f=P.first,d--,m--):g.has(D)?!r.has(A)||O.has(A)?S(P):C.has(D)?d--:T.get(A)>T.get(D)?(C.add(A),S(P)):(O.add(D),d--):(a(R,r),d--)}for(;d--;){const P=n[d];g.has(P.key)||a(P,r)}for(;m;)S(b[m-1]);return me(L),b}function gt(n,e){const t={},i={},l={$$scope:1};let s=n.length;for(;s--;){const r=n[s],o=e[s];if(o){for(const a in r)a in o||(i[a]=1);for(const a in o)l[a]||(t[a]=o[a],l[a]=1);n[s]=o}else for(const a in r)l[a]=1}for(const r in i)r in t||(t[r]=void 0);return t}function Nt(n){return typeof n=="object"&&n!==null?n:{}}function Ae(n,e,t){const i=n.$$.props[e];i!==void 0&&(n.$$.bound[i]=t,t(n.$$.ctx[i]))}function F(n){n&&n.c()}function q(n,e,t){const{fragment:i,after_update:l}=n.$$;i&&i.m(e,t),kt(()=>{const s=n.$$.on_mount.map(jf).filter(et);n.$$.on_destroy?n.$$.on_destroy.push(...s):me(s),n.$$.on_mount=[]}),l.forEach(kt)}function $(n,e){const t=n.$$;t.fragment!==null&&(rp(t.after_update),me(t.on_destroy),t.fragment&&t.fragment.d(e),t.on_destroy=t.fragment=null,t.ctx=[])}function op(n,e){n.$$.dirty[0]===-1&&(ri.push(n),Wf(),n.$$.dirty.fill(0)),n.$$.dirty[e/31|0]|=1<<e%31}function ye(n,e,t,i,l,s,r=null,o=[-1]){const a=Ki;$i(n);const u=n.$$={fragment:null,ctx:[],props:s,update:Q,not_equal:l,bound:br(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(a?a.$$.context:[])),callbacks:br(),dirty:o,skip_bound:!1,root:e.target||a.$$.root};r&&r(u.root);let f=!1;if(u.ctx=t?t(n,e.props||{},(c,d,...m)=>{const h=m.length?m[0]:d;return u.ctx&&l(u.ctx[c],u.ctx[c]=h)&&(!u.skip_bound&&u.bound[c]&&u.bound[c](h),f&&op(n,c)),d}):[],u.update(),f=!0,me(u.before_update),u.fragment=i?i(u.ctx):!1,e.target){if(e.hydrate){const c=xd(e.target);u.fragment&&u.fragment.l(c),c.forEach(v)}else u.fragment&&u.fragment.c();e.intro&&E(n.$$.fragment),q(n,e.target,e.anchor),Vf()}$i(a)}class ve{constructor(){Jl(this,"$$");Jl(this,"$$set")}$destroy(){$(this,1),this.$destroy=Q}$on(e,t){if(!et(t))return Q;const i=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return i.push(t),()=>{const l=i.indexOf(t);l!==-1&&i.splice(l,1)}}$set(e){this.$$set&&!Zd(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const ap="4";typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(ap);const ti=[];function Kf(n,e){return{subscribe:Fe(n,e).subscribe}}function Fe(n,e=Q){let t;const i=new Set;function l(o){if(_e(n,o)&&(n=o,t)){const a=!ti.length;for(const u of i)u[1](),ti.push(u,n);if(a){for(let u=0;u<ti.length;u+=2)ti[u][0](ti[u+1]);ti.length=0}}}function s(o){l(o(n))}function r(o,a=Q){const u=[o,a];return i.add(u),i.size===1&&(t=e(l,s)||Q),o(n),()=>{i.delete(u),i.size===0&&t&&(t(),t=null)}}return{set:l,update:s,subscribe:r}}function Mt(n,e,t){const i=!Array.isArray(n),l=i?[n]:n;if(!l.every(Boolean))throw new Error("derived() expects stores as input, got a falsy value");const s=e.length<2;return Kf(t,(r,o)=>{let a=!1;const u=[];let f=0,c=Q;const d=()=>{if(f)return;c();const h=e(i?u[0]:u,r,o);s?r(h):c=et(h)?h:Q},m=l.map((h,_)=>Ds(h,b=>{u[_]=b,f&=~(1<<_),a&&d()},()=>{f|=1<<_}));return a=!0,d(),function(){me(m),c(),a=!1}})}function up(n,e){if(n instanceof RegExp)return{keys:!1,pattern:n};var t,i,l,s,r=[],o="",a=n.split("/");for(a[0]||a.shift();l=a.shift();)t=l[0],t==="*"?(r.push("wild"),o+="/(.*)"):t===":"?(i=l.indexOf("?",1),s=l.indexOf(".",1),r.push(l.substring(1,~i?i:~s?s:l.length)),o+=~i&&!~s?"(?:/([^/]+?))?":"/([^/]+?)",~s&&(o+=(~i?"?":"")+"\\"+l.substring(s))):o+="/"+l;return{keys:r,pattern:new RegExp("^"+o+"/?$","i")}}function fp(n){let e,t,i;const l=[n[2]];var s=n[0];function r(o,a){let u={};for(let f=0;f<l.length;f+=1)u=Ue(u,l[f]);return a!==void 0&&a&4&&(u=Ue(u,gt(l,[Nt(o[2])]))),{props:u}}return s&&(e=jn(s,r(n)),e.$on("routeEvent",n[7])),{c(){e&&F(e.$$.fragment),t=De()},m(o,a){e&&q(e,o,a),k(o,t,a),i=!0},p(o,a){if(a&1&&s!==(s=o[0])){if(e){ae();const u=e;j(u.$$.fragment,1,0,()=>{$(u,1)}),ue()}s?(e=jn(s,r(o,a)),e.$on("routeEvent",o[7]),F(e.$$.fragment),E(e.$$.fragment,1),q(e,t.parentNode,t)):e=null}else if(s){const u=a&4?gt(l,[Nt(o[2])]):{};e.$set(u)}},i(o){i||(e&&E(e.$$.fragment,o),i=!0)},o(o){e&&j(e.$$.fragment,o),i=!1},d(o){o&&v(t),e&&$(e,o)}}}function cp(n){let e,t,i;const l=[{params:n[1]},n[2]];var s=n[0];function r(o,a){let u={};for(let f=0;f<l.length;f+=1)u=Ue(u,l[f]);return a!==void 0&&a&6&&(u=Ue(u,gt(l,[a&2&&{params:o[1]},a&4&&Nt(o[2])]))),{props:u}}return s&&(e=jn(s,r(n)),e.$on("routeEvent",n[6])),{c(){e&&F(e.$$.fragment),t=De()},m(o,a){e&&q(e,o,a),k(o,t,a),i=!0},p(o,a){if(a&1&&s!==(s=o[0])){if(e){ae();const u=e;j(u.$$.fragment,1,0,()=>{$(u,1)}),ue()}s?(e=jn(s,r(o,a)),e.$on("routeEvent",o[6]),F(e.$$.fragment),E(e.$$.fragment,1),q(e,t.parentNode,t)):e=null}else if(s){const u=a&6?gt(l,[a&2&&{params:o[1]},a&4&&Nt(o[2])]):{};e.$set(u)}},i(o){i||(e&&E(e.$$.fragment,o),i=!0)},o(o){e&&j(e.$$.fragment,o),i=!1},d(o){o&&v(t),e&&$(e,o)}}}function dp(n){let e,t,i,l;const s=[cp,fp],r=[];function o(a,u){return a[1]?0:1}return e=o(n),t=r[e]=s[e](n),{c(){t.c(),i=De()},m(a,u){r[e].m(a,u),k(a,i,u),l=!0},p(a,[u]){let f=e;e=o(a),e===f?r[e].p(a,u):(ae(),j(r[f],1,1,()=>{r[f]=null}),ue(),t=r[e],t?t.p(a,u):(t=r[e]=s[e](a),t.c()),E(t,1),t.m(i.parentNode,i))},i(a){l||(E(t),l=!0)},o(a){j(t),l=!1},d(a){a&&v(i),r[e].d(a)}}}function vr(){const n=window.location.href.indexOf("#/");let e=n>-1?window.location.href.substr(n+1):"/";const t=e.indexOf("?");let i="";return t>-1&&(i=e.substr(t+1),e=e.substr(0,t)),{location:e,querystring:i}}const Us=Kf(null,function(e){e(vr());const t=()=>{e(vr())};return window.addEventListener("hashchange",t,!1),function(){window.removeEventListener("hashchange",t,!1)}});Mt(Us,n=>n.location);const Gf=Mt(Us,n=>n.querystring),kr=Fe(void 0);async function wi(n){if(!n||n.length<1||n.charAt(0)!="/"&&n.indexOf("#/")!==0)throw Error("Invalid parameter location");await Ot(),history.replaceState({...history.state,__svelte_spa_router_scrollX:window.scrollX,__svelte_spa_router_scrollY:window.scrollY},void 0),window.location.hash=(n.charAt(0)=="#"?"":"#")+n}async function Yt(n){if(!n||n.length<1||n.charAt(0)!="/"&&n.indexOf("#/")!==0)throw Error("Invalid parameter location");await Ot();const e=(n.charAt(0)=="#"?"":"#")+n;try{const t={...history.state};delete t.__svelte_spa_router_scrollX,delete t.__svelte_spa_router_scrollY,window.history.replaceState(t,void 0,e)}catch{console.warn("Caught exception while replacing the current page. If you're running this in the Svelte REPL, please note that the `replace` method might not work in this environment.")}window.dispatchEvent(new Event("hashchange"))}function Oi(n,e){if(e=Tr(e),!n||!n.tagName||n.tagName.toLowerCase()!="a")throw Error('Action "link" can only be used with <a> tags');return Sr(n,e),{update(t){t=Tr(t),Sr(n,t)}}}function pp(n){n?window.scrollTo(n.__svelte_spa_router_scrollX,n.__svelte_spa_router_scrollY):window.scrollTo(0,0)}function Sr(n,e){let t=e.href||n.getAttribute("href");if(t&&t.charAt(0)=="/")t="#"+t;else if(!t||t.length<2||t.slice(0,2)!="#/")throw Error('Invalid value for "href" attribute: '+t);n.setAttribute("href",t),n.addEventListener("click",i=>{i.preventDefault(),e.disabled||mp(i.currentTarget.getAttribute("href"))})}function Tr(n){return n&&typeof n=="string"?{href:n}:n||{}}function mp(n){history.replaceState({...history.state,__svelte_spa_router_scrollX:window.scrollX,__svelte_spa_router_scrollY:window.scrollY},void 0),window.location.hash=n}function hp(n,e,t){let{routes:i={}}=e,{prefix:l=""}=e,{restoreScrollState:s=!1}=e;class r{constructor(C,S){if(!S||typeof S!="function"&&(typeof S!="object"||S._sveltesparouter!==!0))throw Error("Invalid component object");if(!C||typeof C=="string"&&(C.length<1||C.charAt(0)!="/"&&C.charAt(0)!="*")||typeof C=="object"&&!(C instanceof RegExp))throw Error('Invalid value for "path" argument - strings must start with / or *');const{pattern:P,keys:R}=up(C);this.path=C,typeof S=="object"&&S._sveltesparouter===!0?(this.component=S.component,this.conditions=S.conditions||[],this.userData=S.userData,this.props=S.props||{}):(this.component=()=>Promise.resolve(S),this.conditions=[],this.props={}),this._pattern=P,this._keys=R}match(C){if(l){if(typeof l=="string")if(C.startsWith(l))C=C.substr(l.length)||"/";else return null;else if(l instanceof RegExp){const A=C.match(l);if(A&&A[0])C=C.substr(A[0].length)||"/";else return null}}const S=this._pattern.exec(C);if(S===null)return null;if(this._keys===!1)return S;const P={};let R=0;for(;R<this._keys.length;){try{P[this._keys[R]]=decodeURIComponent(S[R+1]||"")||null}catch{P[this._keys[R]]=null}R++}return P}async checkConditions(C){for(let S=0;S<this.conditions.length;S++)if(!await this.conditions[S](C))return!1;return!0}}const o=[];i instanceof Map?i.forEach((O,C)=>{o.push(new r(C,O))}):Object.keys(i).forEach(O=>{o.push(new r(O,i[O]))});let a=null,u=null,f={};const c=it();async function d(O,C){await Ot(),c(O,C)}let m=null,h=null;s&&(h=O=>{O.state&&(O.state.__svelte_spa_router_scrollY||O.state.__svelte_spa_router_scrollX)?m=O.state:m=null},window.addEventListener("popstate",h),lp(()=>{pp(m)}));let _=null,b=null;const g=Us.subscribe(async O=>{_=O;let C=0;for(;C<o.length;){const S=o[C].match(O.location);if(!S){C++;continue}const P={route:o[C].path,location:O.location,querystring:O.querystring,userData:o[C].userData,params:S&&typeof S=="object"&&Object.keys(S).length?S:null};if(!await o[C].checkConditions(P)){t(0,a=null),b=null,d("conditionsFailed",P);return}d("routeLoading",Object.assign({},P));const R=o[C].component;if(b!=R){R.loading?(t(0,a=R.loading),b=R,t(1,u=R.loadingParams),t(2,f={}),d("routeLoaded",Object.assign({},P,{component:a,name:a.name,params:u}))):(t(0,a=null),b=null);const A=await R();if(O!=_)return;t(0,a=A&&A.default||A),b=R}S&&typeof S=="object"&&Object.keys(S).length?t(1,u=S):t(1,u=null),t(2,f=o[C].props),d("routeLoaded",Object.assign({},P,{component:a,name:a.name,params:u})).then(()=>{kr.set(u)});return}t(0,a=null),b=null,kr.set(void 0)});Gt(()=>{g(),h&&window.removeEventListener("popstate",h)});function T(O){$e.call(this,n,O)}function L(O){$e.call(this,n,O)}return n.$$set=O=>{"routes"in O&&t(3,i=O.routes),"prefix"in O&&t(4,l=O.prefix),"restoreScrollState"in O&&t(5,s=O.restoreScrollState)},n.$$.update=()=>{n.$$.dirty&32&&(history.scrollRestoration=s?"manual":"auto")},[a,u,f,i,l,s,T,L]}class _p extends ve{constructor(e){super(),ye(this,e,hp,dp,_e,{routes:3,prefix:4,restoreScrollState:5})}}const gp="modulepreload",bp=function(n,e){return new URL(n,e).href},Or={},$l=function(e,t,i){let l=Promise.resolve();if(t&&t.length>0){const r=document.getElementsByTagName("link"),o=document.querySelector("meta[property=csp-nonce]"),a=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));l=Promise.allSettled(t.map(u=>{if(u=bp(u,i),u in Or)return;Or[u]=!0;const f=u.endsWith(".css"),c=f?'[rel="stylesheet"]':"";if(!!i)for(let h=r.length-1;h>=0;h--){const _=r[h];if(_.href===u&&(!f||_.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${u}"]${c}`))return;const m=document.createElement("link");if(m.rel=f?"stylesheet":gp,f||(m.as="script"),m.crossOrigin="",m.href=u,a&&m.setAttribute("nonce",a),document.head.appendChild(m),f)return new Promise((h,_)=>{m.addEventListener("load",h),m.addEventListener("error",()=>_(new Error(`Unable to preload CSS for ${u}`)))})}))}function s(r){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=r,window.dispatchEvent(o),!o.defaultPrevented)throw r}return l.then(r=>{for(const o of r||[])o.status==="rejected"&&s(o.reason);return e().catch(s)})};function sn(n){if(!n)throw Error("Parameter args is required");if(!n.component==!n.asyncComponent)throw Error("One and only one of component and asyncComponent is required");if(n.component&&(n.asyncComponent=()=>Promise.resolve(n.component)),typeof n.asyncComponent!="function")throw Error("Parameter asyncComponent must be a function");if(n.conditions){Array.isArray(n.conditions)||(n.conditions=[n.conditions]);for(let t=0;t<n.conditions.length;t++)if(!n.conditions[t]||typeof n.conditions[t]!="function")throw Error("Invalid parameter conditions["+t+"]")}return n.loadingComponent&&(n.asyncComponent.loading=n.loadingComponent,n.asyncComponent.loadingParams=n.loadingParams||void 0),{component:n.asyncComponent,userData:n.userData,conditions:n.conditions&&n.conditions.length?n.conditions:void 0,props:n.props&&Object.keys(n.props).length?n.props:{},_sveltesparouter:!0}}class qt extends Error{constructor(e){var t,i,l,s;super("ClientResponseError"),this.url="",this.status=0,this.response={},this.isAbort=!1,this.originalError=null,Object.setPrototypeOf(this,qt.prototype),e!==null&&typeof e=="object"&&(this.url=typeof e.url=="string"?e.url:"",this.status=typeof e.status=="number"?e.status:0,this.isAbort=!!e.isAbort,this.originalError=e.originalError,e.response!==null&&typeof e.response=="object"?this.response=e.response:e.data!==null&&typeof e.data=="object"?this.response=e.data:this.response={}),this.originalError||e instanceof qt||(this.originalError=e),typeof DOMException<"u"&&e instanceof DOMException&&(this.isAbort=!0),this.name="ClientResponseError "+this.status,this.message=(t=this.response)==null?void 0:t.message,this.message||(this.isAbort?this.message="The request was autocancelled. You can find more info in https://github.com/pocketbase/js-sdk#auto-cancellation.":(s=(l=(i=this.originalError)==null?void 0:i.cause)==null?void 0:l.message)!=null&&s.includes("ECONNREFUSED ::1")?this.message="Failed to connect to the PocketBase server. Try changing the SDK URL from localhost to 127.0.0.1 (https://github.com/pocketbase/js-sdk/issues/21).":this.message="Something went wrong while processing your request.")}get data(){return this.response}toJSON(){return{...this}}}const al=/^[\u0009\u0020-\u007e\u0080-\u00ff]+$/;function wp(n,e){const t={};if(typeof n!="string")return t;const i=Object.assign({},{}).decode||yp;let l=0;for(;l<n.length;){const s=n.indexOf("=",l);if(s===-1)break;let r=n.indexOf(";",l);if(r===-1)r=n.length;else if(r<s){l=n.lastIndexOf(";",s-1)+1;continue}const o=n.slice(l,s).trim();if(t[o]===void 0){let a=n.slice(s+1,r).trim();a.charCodeAt(0)===34&&(a=a.slice(1,-1));try{t[o]=i(a)}catch{t[o]=a}}l=r+1}return t}function Cr(n,e,t){const i=Object.assign({},t||{}),l=i.encode||vp;if(!al.test(n))throw new TypeError("argument name is invalid");const s=l(e);if(s&&!al.test(s))throw new TypeError("argument val is invalid");let r=n+"="+s;if(i.maxAge!=null){const o=i.maxAge-0;if(isNaN(o)||!isFinite(o))throw new TypeError("option maxAge is invalid");r+="; Max-Age="+Math.floor(o)}if(i.domain){if(!al.test(i.domain))throw new TypeError("option domain is invalid");r+="; Domain="+i.domain}if(i.path){if(!al.test(i.path))throw new TypeError("option path is invalid");r+="; Path="+i.path}if(i.expires){if(!function(a){return Object.prototype.toString.call(a)==="[object Date]"||a instanceof Date}(i.expires)||isNaN(i.expires.valueOf()))throw new TypeError("option expires is invalid");r+="; Expires="+i.expires.toUTCString()}if(i.httpOnly&&(r+="; HttpOnly"),i.secure&&(r+="; Secure"),i.priority)switch(typeof i.priority=="string"?i.priority.toLowerCase():i.priority){case"low":r+="; Priority=Low";break;case"medium":r+="; Priority=Medium";break;case"high":r+="; Priority=High";break;default:throw new TypeError("option priority is invalid")}if(i.sameSite)switch(typeof i.sameSite=="string"?i.sameSite.toLowerCase():i.sameSite){case!0:r+="; SameSite=Strict";break;case"lax":r+="; SameSite=Lax";break;case"strict":r+="; SameSite=Strict";break;case"none":r+="; SameSite=None";break;default:throw new TypeError("option sameSite is invalid")}return r}function yp(n){return n.indexOf("%")!==-1?decodeURIComponent(n):n}function vp(n){return encodeURIComponent(n)}const kp=typeof navigator<"u"&&navigator.product==="ReactNative"||typeof global<"u"&&global.HermesInternal;let Jf;function hi(n){if(n)try{const e=decodeURIComponent(Jf(n.split(".")[1]).split("").map(function(t){return"%"+("00"+t.charCodeAt(0).toString(16)).slice(-2)}).join(""));return JSON.parse(e)||{}}catch{}return{}}function Xf(n,e=0){let t=hi(n);return!(Object.keys(t).length>0&&(!t.exp||t.exp-e>Date.now()/1e3))}Jf=typeof atob!="function"||kp?n=>{let e=String(n).replace(/=+$/,"");if(e.length%4==1)throw new Error("'atob' failed: The string to be decoded is not correctly encoded.");for(var t,i,l=0,s=0,r="";i=e.charAt(s++);~i&&(t=l%4?64*t+i:i,l++%4)?r+=String.fromCharCode(255&t>>(-2*l&6)):0)i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(i);return r}:atob;const Er="pb_auth";class qs{constructor(){this.baseToken="",this.baseModel=null,this._onChangeCallbacks=[]}get token(){return this.baseToken}get record(){return this.baseModel}get model(){return this.baseModel}get isValid(){return!Xf(this.token)}get isSuperuser(){var t,i;let e=hi(this.token);return e.type=="auth"&&(((t=this.record)==null?void 0:t.collectionName)=="_superusers"||!((i=this.record)!=null&&i.collectionName)&&e.collectionId=="pbc_3142635823")}get isAdmin(){return console.warn("Please replace pb.authStore.isAdmin with pb.authStore.isSuperuser OR simply check the value of pb.authStore.record?.collectionName"),this.isSuperuser}get isAuthRecord(){return console.warn("Please replace pb.authStore.isAuthRecord with !pb.authStore.isSuperuser OR simply check the value of pb.authStore.record?.collectionName"),hi(this.token).type=="auth"&&!this.isSuperuser}save(e,t){this.baseToken=e||"",this.baseModel=t||null,this.triggerChange()}clear(){this.baseToken="",this.baseModel=null,this.triggerChange()}loadFromCookie(e,t=Er){const i=wp(e||"")[t]||"";let l={};try{l=JSON.parse(i),(typeof l===null||typeof l!="object"||Array.isArray(l))&&(l={})}catch{}this.save(l.token||"",l.record||l.model||null)}exportToCookie(e,t=Er){var a,u;const i={secure:!0,sameSite:!0,httpOnly:!0,path:"/"},l=hi(this.token);i.expires=l!=null&&l.exp?new Date(1e3*l.exp):new Date("1970-01-01"),e=Object.assign({},i,e);const s={token:this.token,record:this.record?JSON.parse(JSON.stringify(this.record)):null};let r=Cr(t,JSON.stringify(s),e);const o=typeof Blob<"u"?new Blob([r]).size:r.length;if(s.record&&o>4096){s.record={id:(a=s.record)==null?void 0:a.id,email:(u=s.record)==null?void 0:u.email};const f=["collectionId","collectionName","verified"];for(const c in this.record)f.includes(c)&&(s.record[c]=this.record[c]);r=Cr(t,JSON.stringify(s),e)}return r}onChange(e,t=!1){return this._onChangeCallbacks.push(e),t&&e(this.token,this.record),()=>{for(let i=this._onChangeCallbacks.length-1;i>=0;i--)if(this._onChangeCallbacks[i]==e)return delete this._onChangeCallbacks[i],void this._onChangeCallbacks.splice(i,1)}}triggerChange(){for(const e of this._onChangeCallbacks)e&&e(this.token,this.record)}}class Qf extends qs{constructor(e="pocketbase_auth"){super(),this.storageFallback={},this.storageKey=e,this._bindStorageEvent()}get token(){return(this._storageGet(this.storageKey)||{}).token||""}get record(){const e=this._storageGet(this.storageKey)||{};return e.record||e.model||null}get model(){return this.record}save(e,t){this._storageSet(this.storageKey,{token:e,record:t}),super.save(e,t)}clear(){this._storageRemove(this.storageKey),super.clear()}_storageGet(e){if(typeof window<"u"&&(window!=null&&window.localStorage)){const t=window.localStorage.getItem(e)||"";try{return JSON.parse(t)}catch{return t}}return this.storageFallback[e]}_storageSet(e,t){if(typeof window<"u"&&(window!=null&&window.localStorage)){let i=t;typeof t!="string"&&(i=JSON.stringify(t)),window.localStorage.setItem(e,i)}else this.storageFallback[e]=t}_storageRemove(e){var t;typeof window<"u"&&(window!=null&&window.localStorage)&&((t=window.localStorage)==null||t.removeItem(e)),delete this.storageFallback[e]}_bindStorageEvent(){typeof window<"u"&&(window!=null&&window.localStorage)&&window.addEventListener&&window.addEventListener("storage",e=>{if(e.key!=this.storageKey)return;const t=this._storageGet(this.storageKey)||{};super.save(t.token||"",t.record||t.model||null)})}}class An{constructor(e){this.client=e}}class Sp extends An{async getAll(e){return e=Object.assign({method:"GET"},e),this.client.send("/api/settings",e)}async update(e,t){return t=Object.assign({method:"PATCH",body:e},t),this.client.send("/api/settings",t)}async testS3(e="storage",t){return t=Object.assign({method:"POST",body:{filesystem:e}},t),this.client.send("/api/settings/test/s3",t).then(()=>!0)}async testEmail(e,t,i,l){return l=Object.assign({method:"POST",body:{email:t,template:i,collection:e}},l),this.client.send("/api/settings/test/email",l).then(()=>!0)}async generateAppleClientSecret(e,t,i,l,s,r){return r=Object.assign({method:"POST",body:{clientId:e,teamId:t,keyId:i,privateKey:l,duration:s}},r),this.client.send("/api/settings/apple/generate-client-secret",r)}}const Tp=["requestKey","$cancelKey","$autoCancel","fetch","headers","body","query","params","cache","credentials","headers","integrity","keepalive","method","mode","redirect","referrer","referrerPolicy","signal","window"];function $s(n){if(n){n.query=n.query||{};for(let e in n)Tp.includes(e)||(n.query[e]=n[e],delete n[e])}}function xf(n){const e=[];for(const t in n){if(n[t]===null)continue;const i=n[t],l=encodeURIComponent(t);if(Array.isArray(i))for(const s of i)e.push(l+"="+encodeURIComponent(s));else i instanceof Date?e.push(l+"="+encodeURIComponent(i.toISOString())):typeof i!==null&&typeof i=="object"?e.push(l+"="+encodeURIComponent(JSON.stringify(i))):e.push(l+"="+encodeURIComponent(i))}return e.join("&")}class ec extends An{constructor(){super(...arguments),this.clientId="",this.eventSource=null,this.subscriptions={},this.lastSentSubscriptions=[],this.maxConnectTimeout=15e3,this.reconnectAttempts=0,this.maxReconnectAttempts=1/0,this.predefinedReconnectIntervals=[200,300,500,1e3,1200,1500,2e3],this.pendingConnects=[]}get isConnected(){return!!this.eventSource&&!!this.clientId&&!this.pendingConnects.length}async subscribe(e,t,i){var r;if(!e)throw new Error("topic must be set.");let l=e;if(i){$s(i=Object.assign({},i));const o="options="+encodeURIComponent(JSON.stringify({query:i.query,headers:i.headers}));l+=(l.includes("?")?"&":"?")+o}const s=function(o){const a=o;let u;try{u=JSON.parse(a==null?void 0:a.data)}catch{}t(u||{})};return this.subscriptions[l]||(this.subscriptions[l]=[]),this.subscriptions[l].push(s),this.isConnected?this.subscriptions[l].length===1?await this.submitSubscriptions():(r=this.eventSource)==null||r.addEventListener(l,s):await this.connect(),async()=>this.unsubscribeByTopicAndListener(e,s)}async unsubscribe(e){var i;let t=!1;if(e){const l=this.getSubscriptionsByTopic(e);for(let s in l)if(this.hasSubscriptionListeners(s)){for(let r of this.subscriptions[s])(i=this.eventSource)==null||i.removeEventListener(s,r);delete this.subscriptions[s],t||(t=!0)}}else this.subscriptions={};this.hasSubscriptionListeners()?t&&await this.submitSubscriptions():this.disconnect()}async unsubscribeByPrefix(e){var i;let t=!1;for(let l in this.subscriptions)if((l+"?").startsWith(e)){t=!0;for(let s of this.subscriptions[l])(i=this.eventSource)==null||i.removeEventListener(l,s);delete this.subscriptions[l]}t&&(this.hasSubscriptionListeners()?await this.submitSubscriptions():this.disconnect())}async unsubscribeByTopicAndListener(e,t){var s;let i=!1;const l=this.getSubscriptionsByTopic(e);for(let r in l){if(!Array.isArray(this.subscriptions[r])||!this.subscriptions[r].length)continue;let o=!1;for(let a=this.subscriptions[r].length-1;a>=0;a--)this.subscriptions[r][a]===t&&(o=!0,delete this.subscriptions[r][a],this.subscriptions[r].splice(a,1),(s=this.eventSource)==null||s.removeEventListener(r,t));o&&(this.subscriptions[r].length||delete this.subscriptions[r],i||this.hasSubscriptionListeners(r)||(i=!0))}this.hasSubscriptionListeners()?i&&await this.submitSubscriptions():this.disconnect()}hasSubscriptionListeners(e){var t,i;if(this.subscriptions=this.subscriptions||{},e)return!!((t=this.subscriptions[e])!=null&&t.length);for(let l in this.subscriptions)if((i=this.subscriptions[l])!=null&&i.length)return!0;return!1}async submitSubscriptions(){if(this.clientId)return this.addAllSubscriptionListeners(),this.lastSentSubscriptions=this.getNonEmptySubscriptionKeys(),this.client.send("/api/realtime",{method:"POST",body:{clientId:this.clientId,subscriptions:this.lastSentSubscriptions},requestKey:this.getSubscriptionsCancelKey()}).catch(e=>{if(!(e!=null&&e.isAbort))throw e})}getSubscriptionsCancelKey(){return"realtime_"+this.clientId}getSubscriptionsByTopic(e){const t={};e=e.includes("?")?e:e+"?";for(let i in this.subscriptions)(i+"?").startsWith(e)&&(t[i]=this.subscriptions[i]);return t}getNonEmptySubscriptionKeys(){const e=[];for(let t in this.subscriptions)this.subscriptions[t].length&&e.push(t);return e}addAllSubscriptionListeners(){if(this.eventSource){this.removeAllSubscriptionListeners();for(let e in this.subscriptions)for(let t of this.subscriptions[e])this.eventSource.addEventListener(e,t)}}removeAllSubscriptionListeners(){if(this.eventSource)for(let e in this.subscriptions)for(let t of this.subscriptions[e])this.eventSource.removeEventListener(e,t)}async connect(){if(!(this.reconnectAttempts>0))return new Promise((e,t)=>{this.pendingConnects.push({resolve:e,reject:t}),this.pendingConnects.length>1||this.initConnect()})}initConnect(){this.disconnect(!0),clearTimeout(this.connectTimeoutId),this.connectTimeoutId=setTimeout(()=>{this.connectErrorHandler(new Error("EventSource connect took too long."))},this.maxConnectTimeout),this.eventSource=new EventSource(this.client.buildURL("/api/realtime")),this.eventSource.onerror=e=>{this.connectErrorHandler(new Error("Failed to establish realtime connection."))},this.eventSource.addEventListener("PB_CONNECT",e=>{const t=e;this.clientId=t==null?void 0:t.lastEventId,this.submitSubscriptions().then(async()=>{let i=3;for(;this.hasUnsentSubscriptions()&&i>0;)i--,await this.submitSubscriptions()}).then(()=>{for(let l of this.pendingConnects)l.resolve();this.pendingConnects=[],this.reconnectAttempts=0,clearTimeout(this.reconnectTimeoutId),clearTimeout(this.connectTimeoutId);const i=this.getSubscriptionsByTopic("PB_CONNECT");for(let l in i)for(let s of i[l])s(e)}).catch(i=>{this.clientId="",this.connectErrorHandler(i)})})}hasUnsentSubscriptions(){const e=this.getNonEmptySubscriptionKeys();if(e.length!=this.lastSentSubscriptions.length)return!0;for(const t of e)if(!this.lastSentSubscriptions.includes(t))return!0;return!1}connectErrorHandler(e){if(clearTimeout(this.connectTimeoutId),clearTimeout(this.reconnectTimeoutId),!this.clientId&&!this.reconnectAttempts||this.reconnectAttempts>this.maxReconnectAttempts){for(let i of this.pendingConnects)i.reject(new qt(e));return this.pendingConnects=[],void this.disconnect()}this.disconnect(!0);const t=this.predefinedReconnectIntervals[this.reconnectAttempts]||this.predefinedReconnectIntervals[this.predefinedReconnectIntervals.length-1];this.reconnectAttempts++,this.reconnectTimeoutId=setTimeout(()=>{this.initConnect()},t)}disconnect(e=!1){var t;if(clearTimeout(this.connectTimeoutId),clearTimeout(this.reconnectTimeoutId),this.removeAllSubscriptionListeners(),this.client.cancelRequest(this.getSubscriptionsCancelKey()),(t=this.eventSource)==null||t.close(),this.eventSource=null,this.clientId="",!e){this.reconnectAttempts=0;for(let i of this.pendingConnects)i.resolve();this.pendingConnects=[]}}}class tc extends An{decode(e){return e}async getFullList(e,t){if(typeof e=="number")return this._getFullList(e,t);let i=500;return(t=Object.assign({},e,t)).batch&&(i=t.batch,delete t.batch),this._getFullList(i,t)}async getList(e=1,t=30,i){return(i=Object.assign({method:"GET"},i)).query=Object.assign({page:e,perPage:t},i.query),this.client.send(this.baseCrudPath,i).then(l=>{var s;return l.items=((s=l.items)==null?void 0:s.map(r=>this.decode(r)))||[],l})}async getFirstListItem(e,t){return(t=Object.assign({requestKey:"one_by_filter_"+this.baseCrudPath+"_"+e},t)).query=Object.assign({filter:e,skipTotal:1},t.query),this.getList(1,1,t).then(i=>{var l;if(!((l=i==null?void 0:i.items)!=null&&l.length))throw new qt({status:404,response:{code:404,message:"The requested resource wasn't found.",data:{}}});return i.items[0]})}async getOne(e,t){if(!e)throw new qt({url:this.client.buildURL(this.baseCrudPath+"/"),status:404,response:{code:404,message:"Missing required record id.",data:{}}});return t=Object.assign({method:"GET"},t),this.client.send(this.baseCrudPath+"/"+encodeURIComponent(e),t).then(i=>this.decode(i))}async create(e,t){return t=Object.assign({method:"POST",body:e},t),this.client.send(this.baseCrudPath,t).then(i=>this.decode(i))}async update(e,t,i){return i=Object.assign({method:"PATCH",body:t},i),this.client.send(this.baseCrudPath+"/"+encodeURIComponent(e),i).then(l=>this.decode(l))}async delete(e,t){return t=Object.assign({method:"DELETE"},t),this.client.send(this.baseCrudPath+"/"+encodeURIComponent(e),t).then(()=>!0)}_getFullList(e=500,t){(t=t||{}).query=Object.assign({skipTotal:1},t.query);let i=[],l=async s=>this.getList(s,e||500,t).then(r=>{const o=r.items;return i=i.concat(o),o.length==r.perPage?l(s+1):i});return l(1)}}function vn(n,e,t,i){const l=i!==void 0;return l||t!==void 0?l?(console.warn(n),e.body=Object.assign({},e.body,t),e.query=Object.assign({},e.query,i),e):Object.assign(e,t):e}function Ql(n){var e;(e=n._resetAutoRefresh)==null||e.call(n)}class Op extends tc{constructor(e,t){super(e),this.collectionIdOrName=t}get baseCrudPath(){return this.baseCollectionPath+"/records"}get baseCollectionPath(){return"/api/collections/"+encodeURIComponent(this.collectionIdOrName)}get isSuperusers(){return this.collectionIdOrName=="_superusers"||this.collectionIdOrName=="_pbc_2773867675"}async subscribe(e,t,i){if(!e)throw new Error("Missing topic.");if(!t)throw new Error("Missing subscription callback.");return this.client.realtime.subscribe(this.collectionIdOrName+"/"+e,t,i)}async unsubscribe(e){return e?this.client.realtime.unsubscribe(this.collectionIdOrName+"/"+e):this.client.realtime.unsubscribeByPrefix(this.collectionIdOrName)}async getFullList(e,t){if(typeof e=="number")return super.getFullList(e,t);const i=Object.assign({},e,t);return super.getFullList(i)}async getList(e=1,t=30,i){return super.getList(e,t,i)}async getFirstListItem(e,t){return super.getFirstListItem(e,t)}async getOne(e,t){return super.getOne(e,t)}async create(e,t){return super.create(e,t)}async update(e,t,i){return super.update(e,t,i).then(l=>{var s,r,o;if(((s=this.client.authStore.record)==null?void 0:s.id)===(l==null?void 0:l.id)&&(((r=this.client.authStore.record)==null?void 0:r.collectionId)===this.collectionIdOrName||((o=this.client.authStore.record)==null?void 0:o.collectionName)===this.collectionIdOrName)){let a=Object.assign({},this.client.authStore.record.expand),u=Object.assign({},this.client.authStore.record,l);a&&(u.expand=Object.assign(a,l.expand)),this.client.authStore.save(this.client.authStore.token,u)}return l})}async delete(e,t){return super.delete(e,t).then(i=>{var l,s,r;return!i||((l=this.client.authStore.record)==null?void 0:l.id)!==e||((s=this.client.authStore.record)==null?void 0:s.collectionId)!==this.collectionIdOrName&&((r=this.client.authStore.record)==null?void 0:r.collectionName)!==this.collectionIdOrName||this.client.authStore.clear(),i})}authResponse(e){const t=this.decode((e==null?void 0:e.record)||{});return this.client.authStore.save(e==null?void 0:e.token,t),Object.assign({},e,{token:(e==null?void 0:e.token)||"",record:t})}async listAuthMethods(e){return e=Object.assign({method:"GET",fields:"mfa,otp,password,oauth2"},e),this.client.send(this.baseCollectionPath+"/auth-methods",e)}async authWithPassword(e,t,i){let l;i=Object.assign({method:"POST",body:{identity:e,password:t}},i),this.isSuperusers&&(l=i.autoRefreshThreshold,delete i.autoRefreshThreshold,i.autoRefresh||Ql(this.client));let s=await this.client.send(this.baseCollectionPath+"/auth-with-password",i);return s=this.authResponse(s),l&&this.isSuperusers&&function(o,a,u,f){Ql(o);const c=o.beforeSend,d=o.authStore.record,m=o.authStore.onChange((h,_)=>{(!h||(_==null?void 0:_.id)!=(d==null?void 0:d.id)||(_!=null&&_.collectionId||d!=null&&d.collectionId)&&(_==null?void 0:_.collectionId)!=(d==null?void 0:d.collectionId))&&Ql(o)});o._resetAutoRefresh=function(){m(),o.beforeSend=c,delete o._resetAutoRefresh},o.beforeSend=async(h,_)=>{var L;const b=o.authStore.token;if((L=_.query)!=null&&L.autoRefresh)return c?c(h,_):{url:h,sendOptions:_};let g=o.authStore.isValid;if(g&&Xf(o.authStore.token,a))try{await u()}catch{g=!1}g||await f();const T=_.headers||{};for(let O in T)if(O.toLowerCase()=="authorization"&&b==T[O]&&o.authStore.token){T[O]=o.authStore.token;break}return _.headers=T,c?c(h,_):{url:h,sendOptions:_}}}(this.client,l,()=>this.authRefresh({autoRefresh:!0}),()=>this.authWithPassword(e,t,Object.assign({autoRefresh:!0},i))),s}async authWithOAuth2Code(e,t,i,l,s,r,o){let a={method:"POST",body:{provider:e,code:t,codeVerifier:i,redirectURL:l,createData:s}};return a=vn("This form of authWithOAuth2Code(provider, code, codeVerifier, redirectURL, createData?, body?, query?) is deprecated. Consider replacing it with authWithOAuth2Code(provider, code, codeVerifier, redirectURL, createData?, options?).",a,r,o),this.client.send(this.baseCollectionPath+"/auth-with-oauth2",a).then(u=>this.authResponse(u))}authWithOAuth2(...e){if(e.length>1||typeof(e==null?void 0:e[0])=="string")return console.warn("PocketBase: This form of authWithOAuth2() is deprecated and may get removed in the future. Please replace with authWithOAuth2Code() OR use the authWithOAuth2() realtime form as shown in https://pocketbase.io/docs/authentication/#oauth2-integration."),this.authWithOAuth2Code((e==null?void 0:e[0])||"",(e==null?void 0:e[1])||"",(e==null?void 0:e[2])||"",(e==null?void 0:e[3])||"",(e==null?void 0:e[4])||{},(e==null?void 0:e[5])||{},(e==null?void 0:e[6])||{});const t=(e==null?void 0:e[0])||{};let i=null;t.urlCallback||(i=Lr(void 0));const l=new ec(this.client);function s(){i==null||i.close(),l.unsubscribe()}const r={},o=t.requestKey;return o&&(r.requestKey=o),this.listAuthMethods(r).then(a=>{var d;const u=a.oauth2.providers.find(m=>m.name===t.provider);if(!u)throw new qt(new Error(`Missing or invalid provider "${t.provider}".`));const f=this.client.buildURL("/api/oauth2-redirect"),c=o?(d=this.client.cancelControllers)==null?void 0:d[o]:void 0;return c&&(c.signal.onabort=()=>{s()}),new Promise(async(m,h)=>{var _;try{await l.subscribe("@oauth2",async L=>{var C;const O=l.clientId;try{if(!L.state||O!==L.state)throw new Error("State parameters don't match.");if(L.error||!L.code)throw new Error("OAuth2 redirect error or missing code: "+L.error);const S=Object.assign({},t);delete S.provider,delete S.scopes,delete S.createData,delete S.urlCallback,(C=c==null?void 0:c.signal)!=null&&C.onabort&&(c.signal.onabort=null);const P=await this.authWithOAuth2Code(u.name,L.code,u.codeVerifier,f,t.createData,S);m(P)}catch(S){h(new qt(S))}s()});const b={state:l.clientId};(_=t.scopes)!=null&&_.length&&(b.scope=t.scopes.join(" "));const g=this._replaceQueryParams(u.authURL+f,b);await(t.urlCallback||function(L){i?i.location.href=L:i=Lr(L)})(g)}catch(b){s(),h(new qt(b))}})}).catch(a=>{throw s(),a})}async authRefresh(e,t){let i={method:"POST"};return i=vn("This form of authRefresh(body?, query?) is deprecated. Consider replacing it with authRefresh(options?).",i,e,t),this.client.send(this.baseCollectionPath+"/auth-refresh",i).then(l=>this.authResponse(l))}async requestPasswordReset(e,t,i){let l={method:"POST",body:{email:e}};return l=vn("This form of requestPasswordReset(email, body?, query?) is deprecated. Consider replacing it with requestPasswordReset(email, options?).",l,t,i),this.client.send(this.baseCollectionPath+"/request-password-reset",l).then(()=>!0)}async confirmPasswordReset(e,t,i,l,s){let r={method:"POST",body:{token:e,password:t,passwordConfirm:i}};return r=vn("This form of confirmPasswordReset(token, password, passwordConfirm, body?, query?) is deprecated. Consider replacing it with confirmPasswordReset(token, password, passwordConfirm, options?).",r,l,s),this.client.send(this.baseCollectionPath+"/confirm-password-reset",r).then(()=>!0)}async requestVerification(e,t,i){let l={method:"POST",body:{email:e}};return l=vn("This form of requestVerification(email, body?, query?) is deprecated. Consider replacing it with requestVerification(email, options?).",l,t,i),this.client.send(this.baseCollectionPath+"/request-verification",l).then(()=>!0)}async confirmVerification(e,t,i){let l={method:"POST",body:{token:e}};return l=vn("This form of confirmVerification(token, body?, query?) is deprecated. Consider replacing it with confirmVerification(token, options?).",l,t,i),this.client.send(this.baseCollectionPath+"/confirm-verification",l).then(()=>{const s=hi(e),r=this.client.authStore.record;return r&&!r.verified&&r.id===s.id&&r.collectionId===s.collectionId&&(r.verified=!0,this.client.authStore.save(this.client.authStore.token,r)),!0})}async requestEmailChange(e,t,i){let l={method:"POST",body:{newEmail:e}};return l=vn("This form of requestEmailChange(newEmail, body?, query?) is deprecated. Consider replacing it with requestEmailChange(newEmail, options?).",l,t,i),this.client.send(this.baseCollectionPath+"/request-email-change",l).then(()=>!0)}async confirmEmailChange(e,t,i,l){let s={method:"POST",body:{token:e,password:t}};return s=vn("This form of confirmEmailChange(token, password, body?, query?) is deprecated. Consider replacing it with confirmEmailChange(token, password, options?).",s,i,l),this.client.send(this.baseCollectionPath+"/confirm-email-change",s).then(()=>{const r=hi(e),o=this.client.authStore.record;return o&&o.id===r.id&&o.collectionId===r.collectionId&&this.client.authStore.clear(),!0})}async listExternalAuths(e,t){return this.client.collection("_externalAuths").getFullList(Object.assign({},t,{filter:this.client.filter("recordRef = {:id}",{id:e})}))}async unlinkExternalAuth(e,t,i){const l=await this.client.collection("_externalAuths").getFirstListItem(this.client.filter("recordRef = {:recordId} && provider = {:provider}",{recordId:e,provider:t}));return this.client.collection("_externalAuths").delete(l.id,i).then(()=>!0)}async requestOTP(e,t){return t=Object.assign({method:"POST",body:{email:e}},t),this.client.send(this.baseCollectionPath+"/request-otp",t)}async authWithOTP(e,t,i){return i=Object.assign({method:"POST",body:{otpId:e,password:t}},i),this.client.send(this.baseCollectionPath+"/auth-with-otp",i).then(l=>this.authResponse(l))}async impersonate(e,t,i){(i=Object.assign({method:"POST",body:{duration:t}},i)).headers=i.headers||{},i.headers.Authorization||(i.headers.Authorization=this.client.authStore.token);const l=new bn(this.client.baseURL,new qs,this.client.lang),s=await l.send(this.baseCollectionPath+"/impersonate/"+encodeURIComponent(e),i);return l.authStore.save(s==null?void 0:s.token,this.decode((s==null?void 0:s.record)||{})),l}_replaceQueryParams(e,t={}){let i=e,l="";e.indexOf("?")>=0&&(i=e.substring(0,e.indexOf("?")),l=e.substring(e.indexOf("?")+1));const s={},r=l.split("&");for(const o of r){if(o=="")continue;const a=o.split("=");s[decodeURIComponent(a[0].replace(/\+/g," "))]=decodeURIComponent((a[1]||"").replace(/\+/g," "))}for(let o in t)t.hasOwnProperty(o)&&(t[o]==null?delete s[o]:s[o]=t[o]);l="";for(let o in s)s.hasOwnProperty(o)&&(l!=""&&(l+="&"),l+=encodeURIComponent(o.replace(/%20/g,"+"))+"="+encodeURIComponent(s[o].replace(/%20/g,"+")));return l!=""?i+"?"+l:i}}function Lr(n){if(typeof window>"u"||!(window!=null&&window.open))throw new qt(new Error("Not in a browser context - please pass a custom urlCallback function."));let e=1024,t=768,i=window.innerWidth,l=window.innerHeight;e=e>i?i:e,t=t>l?l:t;let s=i/2-e/2,r=l/2-t/2;return window.open(n,"popup_window","width="+e+",height="+t+",top="+r+",left="+s+",resizable,menubar=no")}class Cp extends tc{get baseCrudPath(){return"/api/collections"}async import(e,t=!1,i){return i=Object.assign({method:"PUT",body:{collections:e,deleteMissing:t}},i),this.client.send(this.baseCrudPath+"/import",i).then(()=>!0)}async getScaffolds(e){return e=Object.assign({method:"GET"},e),this.client.send(this.baseCrudPath+"/meta/scaffolds",e)}async truncate(e,t){return t=Object.assign({method:"DELETE"},t),this.client.send(this.baseCrudPath+"/"+encodeURIComponent(e)+"/truncate",t).then(()=>!0)}}class Ep extends An{async getList(e=1,t=30,i){return(i=Object.assign({method:"GET"},i)).query=Object.assign({page:e,perPage:t},i.query),this.client.send("/api/logs",i)}async getOne(e,t){if(!e)throw new qt({url:this.client.buildURL("/api/logs/"),status:404,response:{code:404,message:"Missing required log id.",data:{}}});return t=Object.assign({method:"GET"},t),this.client.send("/api/logs/"+encodeURIComponent(e),t)}async getStats(e){return e=Object.assign({method:"GET"},e),this.client.send("/api/logs/stats",e)}}class Lp extends An{async check(e){return e=Object.assign({method:"GET"},e),this.client.send("/api/health",e)}}class Ip extends An{getUrl(e,t,i={}){return console.warn("Please replace pb.files.getUrl() with pb.files.getURL()"),this.getURL(e,t,i)}getURL(e,t,i={}){if(!t||!(e!=null&&e.id)||!(e!=null&&e.collectionId)&&!(e!=null&&e.collectionName))return"";const l=[];l.push("api"),l.push("files"),l.push(encodeURIComponent(e.collectionId||e.collectionName)),l.push(encodeURIComponent(e.id)),l.push(encodeURIComponent(t));let s=this.client.buildURL(l.join("/"));if(Object.keys(i).length){i.download===!1&&delete i.download;const r=new URLSearchParams(i);s+=(s.includes("?")?"&":"?")+r}return s}async getToken(e){return e=Object.assign({method:"POST"},e),this.client.send("/api/files/token",e).then(t=>(t==null?void 0:t.token)||"")}}class jp extends An{async getFullList(e){return e=Object.assign({method:"GET"},e),this.client.send("/api/backups",e)}async create(e,t){return t=Object.assign({method:"POST",body:{name:e}},t),this.client.send("/api/backups",t).then(()=>!0)}async upload(e,t){return t=Object.assign({method:"POST",body:e},t),this.client.send("/api/backups/upload",t).then(()=>!0)}async delete(e,t){return t=Object.assign({method:"DELETE"},t),this.client.send(`/api/backups/${encodeURIComponent(e)}`,t).then(()=>!0)}async restore(e,t){return t=Object.assign({method:"POST"},t),this.client.send(`/api/backups/${encodeURIComponent(e)}/restore`,t).then(()=>!0)}getDownloadUrl(e,t){return console.warn("Please replace pb.backups.getDownloadUrl() with pb.backups.getDownloadURL()"),this.getDownloadURL(e,t)}getDownloadURL(e,t){return this.client.buildURL(`/api/backups/${encodeURIComponent(t)}?token=${encodeURIComponent(e)}`)}}function gs(n){return typeof Blob<"u"&&n instanceof Blob||typeof File<"u"&&n instanceof File||n!==null&&typeof n=="object"&&n.uri&&(typeof navigator<"u"&&navigator.product==="ReactNative"||typeof global<"u"&&global.HermesInternal)}function Ir(n){return n&&(n.constructor.name==="FormData"||typeof FormData<"u"&&n instanceof FormData)}function jr(n){for(const e in n){const t=Array.isArray(n[e])?n[e]:[n[e]];for(const i of t)if(gs(i))return!0}return!1}class Pp extends An{constructor(){super(...arguments),this.requests=[],this.subs={}}collection(e){return this.subs[e]||(this.subs[e]=new Np(this.requests,e)),this.subs[e]}async send(e){const t=new FormData,i=[];for(let l=0;l<this.requests.length;l++){const s=this.requests[l];if(i.push({method:s.method,url:s.url,headers:s.headers,body:s.json}),s.files)for(let r in s.files){const o=s.files[r]||[];for(let a of o)t.append("requests."+l+"."+r,a)}}return t.append("@jsonPayload",JSON.stringify({requests:i})),e=Object.assign({method:"POST",body:t},e),this.client.send("/api/batch",e)}}class Np{constructor(e,t){this.requests=[],this.requests=e,this.collectionIdOrName=t}upsert(e,t){t=Object.assign({body:e||{}},t);const i={method:"PUT",url:"/api/collections/"+encodeURIComponent(this.collectionIdOrName)+"/records"};this.prepareRequest(i,t),this.requests.push(i)}create(e,t){t=Object.assign({body:e||{}},t);const i={method:"POST",url:"/api/collections/"+encodeURIComponent(this.collectionIdOrName)+"/records"};this.prepareRequest(i,t),this.requests.push(i)}update(e,t,i){i=Object.assign({body:t||{}},i);const l={method:"PATCH",url:"/api/collections/"+encodeURIComponent(this.collectionIdOrName)+"/records/"+encodeURIComponent(e)};this.prepareRequest(l,i),this.requests.push(l)}delete(e,t){t=Object.assign({},t);const i={method:"DELETE",url:"/api/collections/"+encodeURIComponent(this.collectionIdOrName)+"/records/"+encodeURIComponent(e)};this.prepareRequest(i,t),this.requests.push(i)}prepareRequest(e,t){if($s(t),e.headers=t.headers,e.json={},e.files={},t.query!==void 0){const i=xf(t.query);i&&(e.url+=(e.url.includes("?")?"&":"?")+i)}for(const i in t.body){const l=t.body[i];if(gs(l))e.files[i]=e.files[i]||[],e.files[i].push(l);else if(Array.isArray(l)){const s=[],r=[];for(const o of l)gs(o)?s.push(o):r.push(o);if(s.length>0&&s.length==l.length){e.files[i]=e.files[i]||[];for(let o of s)e.files[i].push(o)}else if(e.json[i]=r,s.length>0){let o=i;i.startsWith("+")||i.endsWith("+")||(o+="+"),e.files[o]=e.files[o]||[];for(let a of s)e.files[o].push(a)}}else e.json[i]=l}}}class bn{get baseUrl(){return this.baseURL}set baseUrl(e){this.baseURL=e}constructor(e="/",t,i="en-US"){this.cancelControllers={},this.recordServices={},this.enableAutoCancellation=!0,this.baseURL=e,this.lang=i,t?this.authStore=t:typeof window<"u"&&window.Deno?this.authStore=new qs:this.authStore=new Qf,this.collections=new Cp(this),this.files=new Ip(this),this.logs=new Ep(this),this.settings=new Sp(this),this.realtime=new ec(this),this.health=new Lp(this),this.backups=new jp(this)}get admins(){return this.collection("_superusers")}createBatch(){return new Pp(this)}collection(e){return this.recordServices[e]||(this.recordServices[e]=new Op(this,e)),this.recordServices[e]}autoCancellation(e){return this.enableAutoCancellation=!!e,this}cancelRequest(e){return this.cancelControllers[e]&&(this.cancelControllers[e].abort(),delete this.cancelControllers[e]),this}cancelAllRequests(){for(let e in this.cancelControllers)this.cancelControllers[e].abort();return this.cancelControllers={},this}filter(e,t){if(!t)return e;for(let i in t){let l=t[i];switch(typeof l){case"boolean":case"number":l=""+l;break;case"string":l="'"+l.replace(/'/g,"\\'")+"'";break;default:l=l===null?"null":l instanceof Date?"'"+l.toISOString().replace("T"," ")+"'":"'"+JSON.stringify(l).replace(/'/g,"\\'")+"'"}e=e.replaceAll("{:"+i+"}",l)}return e}getFileUrl(e,t,i={}){return console.warn("Please replace pb.getFileUrl() with pb.files.getURL()"),this.files.getURL(e,t,i)}buildUrl(e){return console.warn("Please replace pb.buildUrl() with pb.buildURL()"),this.buildURL(e)}buildURL(e){var i;let t=this.baseURL;return typeof window>"u"||!window.location||t.startsWith("https://")||t.startsWith("http://")||(t=(i=window.location.origin)!=null&&i.endsWith("/")?window.location.origin.substring(0,window.location.origin.length-1):window.location.origin||"",this.baseURL.startsWith("/")||(t+=window.location.pathname||"/",t+=t.endsWith("/")?"":"/"),t+=this.baseURL),e&&(t+=t.endsWith("/")?"":"/",t+=e.startsWith("/")?e.substring(1):e),t}async send(e,t){t=this.initSendOptions(e,t);let i=this.buildURL(e);if(this.beforeSend){const l=Object.assign({},await this.beforeSend(i,t));l.url!==void 0||l.options!==void 0?(i=l.url||i,t=l.options||t):Object.keys(l).length&&(t=l,console!=null&&console.warn&&console.warn("Deprecated format of beforeSend return: please use `return { url, options }`, instead of `return options`."))}if(t.query!==void 0){const l=xf(t.query);l&&(i+=(i.includes("?")?"&":"?")+l),delete t.query}return this.getHeader(t.headers,"Content-Type")=="application/json"&&t.body&&typeof t.body!="string"&&(t.body=JSON.stringify(t.body)),(t.fetch||fetch)(i,t).then(async l=>{let s={};try{s=await l.json()}catch{}if(this.afterSend&&(s=await this.afterSend(l,s,t)),l.status>=400)throw new qt({url:l.url,status:l.status,data:s});return s}).catch(l=>{throw new qt(l)})}initSendOptions(e,t){if((t=Object.assign({method:"GET"},t)).body=function(l){if(typeof FormData>"u"||l===void 0||typeof l!="object"||l===null||Ir(l)||!jr(l))return l;const s=new FormData;for(const r in l){const o=l[r];if(typeof o!="object"||jr({data:o})){const a=Array.isArray(o)?o:[o];for(let u of a)s.append(r,u)}else{let a={};a[r]=o,s.append("@jsonPayload",JSON.stringify(a))}}return s}(t.body),$s(t),t.query=Object.assign({},t.params,t.query),t.requestKey===void 0&&(t.$autoCancel===!1||t.query.$autoCancel===!1?t.requestKey=null:(t.$cancelKey||t.query.$cancelKey)&&(t.requestKey=t.$cancelKey||t.query.$cancelKey)),delete t.$autoCancel,delete t.query.$autoCancel,delete t.$cancelKey,delete t.query.$cancelKey,this.getHeader(t.headers,"Content-Type")!==null||Ir(t.body)||(t.headers=Object.assign({},t.headers,{"Content-Type":"application/json"})),this.getHeader(t.headers,"Accept-Language")===null&&(t.headers=Object.assign({},t.headers,{"Accept-Language":this.lang})),this.authStore.token&&this.getHeader(t.headers,"Authorization")===null&&(t.headers=Object.assign({},t.headers,{Authorization:this.authStore.token})),this.enableAutoCancellation&&t.requestKey!==null){const i=t.requestKey||(t.method||"GET")+e;delete t.requestKey,this.cancelRequest(i);const l=new AbortController;this.cancelControllers[i]=l,t.signal=l.signal}return t}getHeader(e,t){e=e||{},t=t.toLowerCase();for(let i in e)if(i.toLowerCase()==t)return e[i];return null}}class Qn extends Error{}class Ap extends Qn{constructor(e){super(`Invalid DateTime: ${e.toMessage()}`)}}class Dp extends Qn{constructor(e){super(`Invalid Interval: ${e.toMessage()}`)}}class Mp extends Qn{constructor(e){super(`Invalid Duration: ${e.toMessage()}`)}}class ai extends Qn{}class nc extends Qn{constructor(e){super(`Invalid unit ${e}`)}}class It extends Qn{}class kn extends Qn{constructor(){super("Zone is an abstract class")}}const he="numeric",nn="short",$t="long",Cl={year:he,month:he,day:he},ic={year:he,month:nn,day:he},Rp={year:he,month:nn,day:he,weekday:nn},lc={year:he,month:$t,day:he},sc={year:he,month:$t,day:he,weekday:$t},rc={hour:he,minute:he},oc={hour:he,minute:he,second:he},ac={hour:he,minute:he,second:he,timeZoneName:nn},uc={hour:he,minute:he,second:he,timeZoneName:$t},fc={hour:he,minute:he,hourCycle:"h23"},cc={hour:he,minute:he,second:he,hourCycle:"h23"},dc={hour:he,minute:he,second:he,hourCycle:"h23",timeZoneName:nn},pc={hour:he,minute:he,second:he,hourCycle:"h23",timeZoneName:$t},mc={year:he,month:he,day:he,hour:he,minute:he},hc={year:he,month:he,day:he,hour:he,minute:he,second:he},_c={year:he,month:nn,day:he,hour:he,minute:he},gc={year:he,month:nn,day:he,hour:he,minute:he,second:he},Hp={year:he,month:nn,day:he,weekday:nn,hour:he,minute:he},bc={year:he,month:$t,day:he,hour:he,minute:he,timeZoneName:nn},wc={year:he,month:$t,day:he,hour:he,minute:he,second:he,timeZoneName:nn},yc={year:he,month:$t,day:he,weekday:$t,hour:he,minute:he,timeZoneName:$t},vc={year:he,month:$t,day:he,weekday:$t,hour:he,minute:he,second:he,timeZoneName:$t};class xi{get type(){throw new kn}get name(){throw new kn}get ianaName(){return this.name}get isUniversal(){throw new kn}offsetName(e,t){throw new kn}formatOffset(e,t){throw new kn}offset(e){throw new kn}equals(e){throw new kn}get isValid(){throw new kn}}let xl=null;class Fl extends xi{static get instance(){return xl===null&&(xl=new Fl),xl}get type(){return"system"}get name(){return new Intl.DateTimeFormat().resolvedOptions().timeZone}get isUniversal(){return!1}offsetName(e,{format:t,locale:i}){return jc(e,t,i)}formatOffset(e,t){return Fi(this.offset(e),t)}offset(e){return-new Date(e).getTimezoneOffset()}equals(e){return e.type==="system"}get isValid(){return!0}}let wl={};function Up(n){return wl[n]||(wl[n]=new Intl.DateTimeFormat("en-US",{hour12:!1,timeZone:n,year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",era:"short"})),wl[n]}const qp={year:0,month:1,day:2,era:3,hour:4,minute:5,second:6};function $p(n,e){const t=n.format(e).replace(/\u200E/g,""),i=/(\d+)\/(\d+)\/(\d+) (AD|BC),? (\d+):(\d+):(\d+)/.exec(t),[,l,s,r,o,a,u,f]=i;return[r,l,s,o,a,u,f]}function Fp(n,e){const t=n.formatToParts(e),i=[];for(let l=0;l<t.length;l++){const{type:s,value:r}=t[l],o=qp[s];s==="era"?i[o]=r:He(o)||(i[o]=parseInt(r,10))}return i}let ul={};class _n extends xi{static create(e){return ul[e]||(ul[e]=new _n(e)),ul[e]}static resetCache(){ul={},wl={}}static isValidSpecifier(e){return this.isValidZone(e)}static isValidZone(e){if(!e)return!1;try{return new Intl.DateTimeFormat("en-US",{timeZone:e}).format(),!0}catch{return!1}}constructor(e){super(),this.zoneName=e,this.valid=_n.isValidZone(e)}get type(){return"iana"}get name(){return this.zoneName}get isUniversal(){return!1}offsetName(e,{format:t,locale:i}){return jc(e,t,i,this.name)}formatOffset(e,t){return Fi(this.offset(e),t)}offset(e){const t=new Date(e);if(isNaN(t))return NaN;const i=Up(this.name);let[l,s,r,o,a,u,f]=i.formatToParts?Fp(i,t):$p(i,t);o==="BC"&&(l=-Math.abs(l)+1);const d=Vl({year:l,month:s,day:r,hour:a===24?0:a,minute:u,second:f,millisecond:0});let m=+t;const h=m%1e3;return m-=h>=0?h:1e3+h,(d-m)/(60*1e3)}equals(e){return e.type==="iana"&&e.name===this.name}get isValid(){return this.valid}}let Pr={};function Wp(n,e={}){const t=JSON.stringify([n,e]);let i=Pr[t];return i||(i=new Intl.ListFormat(n,e),Pr[t]=i),i}let bs={};function ws(n,e={}){const t=JSON.stringify([n,e]);let i=bs[t];return i||(i=new Intl.DateTimeFormat(n,e),bs[t]=i),i}let ys={};function Vp(n,e={}){const t=JSON.stringify([n,e]);let i=ys[t];return i||(i=new Intl.NumberFormat(n,e),ys[t]=i),i}let vs={};function zp(n,e={}){const{base:t,...i}=e,l=JSON.stringify([n,i]);let s=vs[l];return s||(s=new Intl.RelativeTimeFormat(n,e),vs[l]=s),s}let Hi=null;function Bp(){return Hi||(Hi=new Intl.DateTimeFormat().resolvedOptions().locale,Hi)}let Nr={};function Zp(n){let e=Nr[n];if(!e){const t=new Intl.Locale(n);e="getWeekInfo"in t?t.getWeekInfo():t.weekInfo,Nr[n]=e}return e}function Yp(n){const e=n.indexOf("-x-");e!==-1&&(n=n.substring(0,e));const t=n.indexOf("-u-");if(t===-1)return[n];{let i,l;try{i=ws(n).resolvedOptions(),l=n}catch{const a=n.substring(0,t);i=ws(a).resolvedOptions(),l=a}const{numberingSystem:s,calendar:r}=i;return[l,s,r]}}function Kp(n,e,t){return(t||e)&&(n.includes("-u-")||(n+="-u"),t&&(n+=`-ca-${t}`),e&&(n+=`-nu-${e}`)),n}function Gp(n){const e=[];for(let t=1;t<=12;t++){const i=Me.utc(2009,t,1);e.push(n(i))}return e}function Jp(n){const e=[];for(let t=1;t<=7;t++){const i=Me.utc(2016,11,13+t);e.push(n(i))}return e}function fl(n,e,t,i){const l=n.listingMode();return l==="error"?null:l==="en"?t(e):i(e)}function Xp(n){return n.numberingSystem&&n.numberingSystem!=="latn"?!1:n.numberingSystem==="latn"||!n.locale||n.locale.startsWith("en")||new Intl.DateTimeFormat(n.intl).resolvedOptions().numberingSystem==="latn"}class Qp{constructor(e,t,i){this.padTo=i.padTo||0,this.floor=i.floor||!1;const{padTo:l,floor:s,...r}=i;if(!t||Object.keys(r).length>0){const o={useGrouping:!1,...i};i.padTo>0&&(o.minimumIntegerDigits=i.padTo),this.inf=Vp(e,o)}}format(e){if(this.inf){const t=this.floor?Math.floor(e):e;return this.inf.format(t)}else{const t=this.floor?Math.floor(e):Bs(e,3);return yt(t,this.padTo)}}}class xp{constructor(e,t,i){this.opts=i,this.originalZone=void 0;let l;if(this.opts.timeZone)this.dt=e;else if(e.zone.type==="fixed"){const r=-1*(e.offset/60),o=r>=0?`Etc/GMT+${r}`:`Etc/GMT${r}`;e.offset!==0&&_n.create(o).valid?(l=o,this.dt=e):(l="UTC",this.dt=e.offset===0?e:e.setZone("UTC").plus({minutes:e.offset}),this.originalZone=e.zone)}else e.zone.type==="system"?this.dt=e:e.zone.type==="iana"?(this.dt=e,l=e.zone.name):(l="UTC",this.dt=e.setZone("UTC").plus({minutes:e.offset}),this.originalZone=e.zone);const s={...this.opts};s.timeZone=s.timeZone||l,this.dtf=ws(t,s)}format(){return this.originalZone?this.formatToParts().map(({value:e})=>e).join(""):this.dtf.format(this.dt.toJSDate())}formatToParts(){const e=this.dtf.formatToParts(this.dt.toJSDate());return this.originalZone?e.map(t=>{if(t.type==="timeZoneName"){const i=this.originalZone.offsetName(this.dt.ts,{locale:this.dt.locale,format:this.opts.timeZoneName});return{...t,value:i}}else return t}):e}resolvedOptions(){return this.dtf.resolvedOptions()}}class em{constructor(e,t,i){this.opts={style:"long",...i},!t&&Lc()&&(this.rtf=zp(e,i))}format(e,t){return this.rtf?this.rtf.format(e,t):Sm(t,e,this.opts.numeric,this.opts.style!=="long")}formatToParts(e,t){return this.rtf?this.rtf.formatToParts(e,t):[]}}const tm={firstDay:1,minimalDays:4,weekend:[6,7]};class Je{static fromOpts(e){return Je.create(e.locale,e.numberingSystem,e.outputCalendar,e.weekSettings,e.defaultToEN)}static create(e,t,i,l,s=!1){const r=e||ht.defaultLocale,o=r||(s?"en-US":Bp()),a=t||ht.defaultNumberingSystem,u=i||ht.defaultOutputCalendar,f=ks(l)||ht.defaultWeekSettings;return new Je(o,a,u,f,r)}static resetCache(){Hi=null,bs={},ys={},vs={}}static fromObject({locale:e,numberingSystem:t,outputCalendar:i,weekSettings:l}={}){return Je.create(e,t,i,l)}constructor(e,t,i,l,s){const[r,o,a]=Yp(e);this.locale=r,this.numberingSystem=t||o||null,this.outputCalendar=i||a||null,this.weekSettings=l,this.intl=Kp(this.locale,this.numberingSystem,this.outputCalendar),this.weekdaysCache={format:{},standalone:{}},this.monthsCache={format:{},standalone:{}},this.meridiemCache=null,this.eraCache={},this.specifiedLocale=s,this.fastNumbersCached=null}get fastNumbers(){return this.fastNumbersCached==null&&(this.fastNumbersCached=Xp(this)),this.fastNumbersCached}listingMode(){const e=this.isEnglish(),t=(this.numberingSystem===null||this.numberingSystem==="latn")&&(this.outputCalendar===null||this.outputCalendar==="gregory");return e&&t?"en":"intl"}clone(e){return!e||Object.getOwnPropertyNames(e).length===0?this:Je.create(e.locale||this.specifiedLocale,e.numberingSystem||this.numberingSystem,e.outputCalendar||this.outputCalendar,ks(e.weekSettings)||this.weekSettings,e.defaultToEN||!1)}redefaultToEN(e={}){return this.clone({...e,defaultToEN:!0})}redefaultToSystem(e={}){return this.clone({...e,defaultToEN:!1})}months(e,t=!1){return fl(this,e,Ac,()=>{const i=t?{month:e,day:"numeric"}:{month:e},l=t?"format":"standalone";return this.monthsCache[l][e]||(this.monthsCache[l][e]=Gp(s=>this.extract(s,i,"month"))),this.monthsCache[l][e]})}weekdays(e,t=!1){return fl(this,e,Rc,()=>{const i=t?{weekday:e,year:"numeric",month:"long",day:"numeric"}:{weekday:e},l=t?"format":"standalone";return this.weekdaysCache[l][e]||(this.weekdaysCache[l][e]=Jp(s=>this.extract(s,i,"weekday"))),this.weekdaysCache[l][e]})}meridiems(){return fl(this,void 0,()=>Hc,()=>{if(!this.meridiemCache){const e={hour:"numeric",hourCycle:"h12"};this.meridiemCache=[Me.utc(2016,11,13,9),Me.utc(2016,11,13,19)].map(t=>this.extract(t,e,"dayperiod"))}return this.meridiemCache})}eras(e){return fl(this,e,Uc,()=>{const t={era:e};return this.eraCache[e]||(this.eraCache[e]=[Me.utc(-40,1,1),Me.utc(2017,1,1)].map(i=>this.extract(i,t,"era"))),this.eraCache[e]})}extract(e,t,i){const l=this.dtFormatter(e,t),s=l.formatToParts(),r=s.find(o=>o.type.toLowerCase()===i);return r?r.value:null}numberFormatter(e={}){return new Qp(this.intl,e.forceSimple||this.fastNumbers,e)}dtFormatter(e,t={}){return new xp(e,this.intl,t)}relFormatter(e={}){return new em(this.intl,this.isEnglish(),e)}listFormatter(e={}){return Wp(this.intl,e)}isEnglish(){return this.locale==="en"||this.locale.toLowerCase()==="en-us"||new Intl.DateTimeFormat(this.intl).resolvedOptions().locale.startsWith("en-us")}getWeekSettings(){return this.weekSettings?this.weekSettings:Ic()?Zp(this.locale):tm}getStartOfWeek(){return this.getWeekSettings().firstDay}getMinDaysInFirstWeek(){return this.getWeekSettings().minimalDays}getWeekendDays(){return this.getWeekSettings().weekend}equals(e){return this.locale===e.locale&&this.numberingSystem===e.numberingSystem&&this.outputCalendar===e.outputCalendar}toString(){return`Locale(${this.locale}, ${this.numberingSystem}, ${this.outputCalendar})`}}let es=null;class Dt extends xi{static get utcInstance(){return es===null&&(es=new Dt(0)),es}static instance(e){return e===0?Dt.utcInstance:new Dt(e)}static parseSpecifier(e){if(e){const t=e.match(/^utc(?:([+-]\d{1,2})(?::(\d{2}))?)?$/i);if(t)return new Dt(zl(t[1],t[2]))}return null}constructor(e){super(),this.fixed=e}get type(){return"fixed"}get name(){return this.fixed===0?"UTC":`UTC${Fi(this.fixed,"narrow")}`}get ianaName(){return this.fixed===0?"Etc/UTC":`Etc/GMT${Fi(-this.fixed,"narrow")}`}offsetName(){return this.name}formatOffset(e,t){return Fi(this.fixed,t)}get isUniversal(){return!0}offset(){return this.fixed}equals(e){return e.type==="fixed"&&e.fixed===this.fixed}get isValid(){return!0}}class nm extends xi{constructor(e){super(),this.zoneName=e}get type(){return"invalid"}get name(){return this.zoneName}get isUniversal(){return!1}offsetName(){return null}formatOffset(){return""}offset(){return NaN}equals(){return!1}get isValid(){return!1}}function On(n,e){if(He(n)||n===null)return e;if(n instanceof xi)return n;if(am(n)){const t=n.toLowerCase();return t==="default"?e:t==="local"||t==="system"?Fl.instance:t==="utc"||t==="gmt"?Dt.utcInstance:Dt.parseSpecifier(t)||_n.create(n)}else return En(n)?Dt.instance(n):typeof n=="object"&&"offset"in n&&typeof n.offset=="function"?n:new nm(n)}const Fs={arab:"[٠-٩]",arabext:"[۰-۹]",bali:"[᭐-᭙]",beng:"[০-৯]",deva:"[०-९]",fullwide:"[０-９]",gujr:"[૦-૯]",hanidec:"[〇|一|二|三|四|五|六|七|八|九]",khmr:"[០-៩]",knda:"[೦-೯]",laoo:"[໐-໙]",limb:"[᥆-᥏]",mlym:"[൦-൯]",mong:"[᠐-᠙]",mymr:"[၀-၉]",orya:"[୦-୯]",tamldec:"[௦-௯]",telu:"[౦-౯]",thai:"[๐-๙]",tibt:"[༠-༩]",latn:"\\d"},Ar={arab:[1632,1641],arabext:[1776,1785],bali:[6992,7001],beng:[2534,2543],deva:[2406,2415],fullwide:[65296,65303],gujr:[2790,2799],khmr:[6112,6121],knda:[3302,3311],laoo:[3792,3801],limb:[6470,6479],mlym:[3430,3439],mong:[6160,6169],mymr:[4160,4169],orya:[2918,2927],tamldec:[3046,3055],telu:[3174,3183],thai:[3664,3673],tibt:[3872,3881]},im=Fs.hanidec.replace(/[\[|\]]/g,"").split("");function lm(n){let e=parseInt(n,10);if(isNaN(e)){e="";for(let t=0;t<n.length;t++){const i=n.charCodeAt(t);if(n[t].search(Fs.hanidec)!==-1)e+=im.indexOf(n[t]);else for(const l in Ar){const[s,r]=Ar[l];i>=s&&i<=r&&(e+=i-s)}}return parseInt(e,10)}else return e}let oi={};function sm(){oi={}}function xt({numberingSystem:n},e=""){const t=n||"latn";return oi[t]||(oi[t]={}),oi[t][e]||(oi[t][e]=new RegExp(`${Fs[t]}${e}`)),oi[t][e]}let Dr=()=>Date.now(),Mr="system",Rr=null,Hr=null,Ur=null,qr=60,$r,Fr=null;class ht{static get now(){return Dr}static set now(e){Dr=e}static set defaultZone(e){Mr=e}static get defaultZone(){return On(Mr,Fl.instance)}static get defaultLocale(){return Rr}static set defaultLocale(e){Rr=e}static get defaultNumberingSystem(){return Hr}static set defaultNumberingSystem(e){Hr=e}static get defaultOutputCalendar(){return Ur}static set defaultOutputCalendar(e){Ur=e}static get defaultWeekSettings(){return Fr}static set defaultWeekSettings(e){Fr=ks(e)}static get twoDigitCutoffYear(){return qr}static set twoDigitCutoffYear(e){qr=e%100}static get throwOnInvalid(){return $r}static set throwOnInvalid(e){$r=e}static resetCaches(){Je.resetCache(),_n.resetCache(),Me.resetCache(),sm()}}class tn{constructor(e,t){this.reason=e,this.explanation=t}toMessage(){return this.explanation?`${this.reason}: ${this.explanation}`:this.reason}}const kc=[0,31,59,90,120,151,181,212,243,273,304,334],Sc=[0,31,60,91,121,152,182,213,244,274,305,335];function Bt(n,e){return new tn("unit out of range",`you specified ${e} (of type ${typeof e}) as a ${n}, which is invalid`)}function Ws(n,e,t){const i=new Date(Date.UTC(n,e-1,t));n<100&&n>=0&&i.setUTCFullYear(i.getUTCFullYear()-1900);const l=i.getUTCDay();return l===0?7:l}function Tc(n,e,t){return t+(el(n)?Sc:kc)[e-1]}function Oc(n,e){const t=el(n)?Sc:kc,i=t.findIndex(s=>s<e),l=e-t[i];return{month:i+1,day:l}}function Vs(n,e){return(n-e+7)%7+1}function El(n,e=4,t=1){const{year:i,month:l,day:s}=n,r=Tc(i,l,s),o=Vs(Ws(i,l,s),t);let a=Math.floor((r-o+14-e)/7),u;return a<1?(u=i-1,a=Gi(u,e,t)):a>Gi(i,e,t)?(u=i+1,a=1):u=i,{weekYear:u,weekNumber:a,weekday:o,...Bl(n)}}function Wr(n,e=4,t=1){const{weekYear:i,weekNumber:l,weekday:s}=n,r=Vs(Ws(i,1,e),t),o=_i(i);let a=l*7+s-r-7+e,u;a<1?(u=i-1,a+=_i(u)):a>o?(u=i+1,a-=_i(i)):u=i;const{month:f,day:c}=Oc(u,a);return{year:u,month:f,day:c,...Bl(n)}}function ts(n){const{year:e,month:t,day:i}=n,l=Tc(e,t,i);return{year:e,ordinal:l,...Bl(n)}}function Vr(n){const{year:e,ordinal:t}=n,{month:i,day:l}=Oc(e,t);return{year:e,month:i,day:l,...Bl(n)}}function zr(n,e){if(!He(n.localWeekday)||!He(n.localWeekNumber)||!He(n.localWeekYear)){if(!He(n.weekday)||!He(n.weekNumber)||!He(n.weekYear))throw new ai("Cannot mix locale-based week fields with ISO-based week fields");return He(n.localWeekday)||(n.weekday=n.localWeekday),He(n.localWeekNumber)||(n.weekNumber=n.localWeekNumber),He(n.localWeekYear)||(n.weekYear=n.localWeekYear),delete n.localWeekday,delete n.localWeekNumber,delete n.localWeekYear,{minDaysInFirstWeek:e.getMinDaysInFirstWeek(),startOfWeek:e.getStartOfWeek()}}else return{minDaysInFirstWeek:4,startOfWeek:1}}function rm(n,e=4,t=1){const i=Wl(n.weekYear),l=Zt(n.weekNumber,1,Gi(n.weekYear,e,t)),s=Zt(n.weekday,1,7);return i?l?s?!1:Bt("weekday",n.weekday):Bt("week",n.weekNumber):Bt("weekYear",n.weekYear)}function om(n){const e=Wl(n.year),t=Zt(n.ordinal,1,_i(n.year));return e?t?!1:Bt("ordinal",n.ordinal):Bt("year",n.year)}function Cc(n){const e=Wl(n.year),t=Zt(n.month,1,12),i=Zt(n.day,1,Ll(n.year,n.month));return e?t?i?!1:Bt("day",n.day):Bt("month",n.month):Bt("year",n.year)}function Ec(n){const{hour:e,minute:t,second:i,millisecond:l}=n,s=Zt(e,0,23)||e===24&&t===0&&i===0&&l===0,r=Zt(t,0,59),o=Zt(i,0,59),a=Zt(l,0,999);return s?r?o?a?!1:Bt("millisecond",l):Bt("second",i):Bt("minute",t):Bt("hour",e)}function He(n){return typeof n>"u"}function En(n){return typeof n=="number"}function Wl(n){return typeof n=="number"&&n%1===0}function am(n){return typeof n=="string"}function um(n){return Object.prototype.toString.call(n)==="[object Date]"}function Lc(){try{return typeof Intl<"u"&&!!Intl.RelativeTimeFormat}catch{return!1}}function Ic(){try{return typeof Intl<"u"&&!!Intl.Locale&&("weekInfo"in Intl.Locale.prototype||"getWeekInfo"in Intl.Locale.prototype)}catch{return!1}}function fm(n){return Array.isArray(n)?n:[n]}function Br(n,e,t){if(n.length!==0)return n.reduce((i,l)=>{const s=[e(l),l];return i&&t(i[0],s[0])===i[0]?i:s},null)[1]}function cm(n,e){return e.reduce((t,i)=>(t[i]=n[i],t),{})}function yi(n,e){return Object.prototype.hasOwnProperty.call(n,e)}function ks(n){if(n==null)return null;if(typeof n!="object")throw new It("Week settings must be an object");if(!Zt(n.firstDay,1,7)||!Zt(n.minimalDays,1,7)||!Array.isArray(n.weekend)||n.weekend.some(e=>!Zt(e,1,7)))throw new It("Invalid week settings");return{firstDay:n.firstDay,minimalDays:n.minimalDays,weekend:Array.from(n.weekend)}}function Zt(n,e,t){return Wl(n)&&n>=e&&n<=t}function dm(n,e){return n-e*Math.floor(n/e)}function yt(n,e=2){const t=n<0;let i;return t?i="-"+(""+-n).padStart(e,"0"):i=(""+n).padStart(e,"0"),i}function Tn(n){if(!(He(n)||n===null||n===""))return parseInt(n,10)}function Mn(n){if(!(He(n)||n===null||n===""))return parseFloat(n)}function zs(n){if(!(He(n)||n===null||n==="")){const e=parseFloat("0."+n)*1e3;return Math.floor(e)}}function Bs(n,e,t=!1){const i=10**e;return(t?Math.trunc:Math.round)(n*i)/i}function el(n){return n%4===0&&(n%100!==0||n%400===0)}function _i(n){return el(n)?366:365}function Ll(n,e){const t=dm(e-1,12)+1,i=n+(e-t)/12;return t===2?el(i)?29:28:[31,null,31,30,31,30,31,31,30,31,30,31][t-1]}function Vl(n){let e=Date.UTC(n.year,n.month-1,n.day,n.hour,n.minute,n.second,n.millisecond);return n.year<100&&n.year>=0&&(e=new Date(e),e.setUTCFullYear(n.year,n.month-1,n.day)),+e}function Zr(n,e,t){return-Vs(Ws(n,1,e),t)+e-1}function Gi(n,e=4,t=1){const i=Zr(n,e,t),l=Zr(n+1,e,t);return(_i(n)-i+l)/7}function Ss(n){return n>99?n:n>ht.twoDigitCutoffYear?1900+n:2e3+n}function jc(n,e,t,i=null){const l=new Date(n),s={hourCycle:"h23",year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"};i&&(s.timeZone=i);const r={timeZoneName:e,...s},o=new Intl.DateTimeFormat(t,r).formatToParts(l).find(a=>a.type.toLowerCase()==="timezonename");return o?o.value:null}function zl(n,e){let t=parseInt(n,10);Number.isNaN(t)&&(t=0);const i=parseInt(e,10)||0,l=t<0||Object.is(t,-0)?-i:i;return t*60+l}function Pc(n){const e=Number(n);if(typeof n=="boolean"||n===""||Number.isNaN(e))throw new It(`Invalid unit value ${n}`);return e}function Il(n,e){const t={};for(const i in n)if(yi(n,i)){const l=n[i];if(l==null)continue;t[e(i)]=Pc(l)}return t}function Fi(n,e){const t=Math.trunc(Math.abs(n/60)),i=Math.trunc(Math.abs(n%60)),l=n>=0?"+":"-";switch(e){case"short":return`${l}${yt(t,2)}:${yt(i,2)}`;case"narrow":return`${l}${t}${i>0?`:${i}`:""}`;case"techie":return`${l}${yt(t,2)}${yt(i,2)}`;default:throw new RangeError(`Value format ${e} is out of range for property format`)}}function Bl(n){return cm(n,["hour","minute","second","millisecond"])}const pm=["January","February","March","April","May","June","July","August","September","October","November","December"],Nc=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],mm=["J","F","M","A","M","J","J","A","S","O","N","D"];function Ac(n){switch(n){case"narrow":return[...mm];case"short":return[...Nc];case"long":return[...pm];case"numeric":return["1","2","3","4","5","6","7","8","9","10","11","12"];case"2-digit":return["01","02","03","04","05","06","07","08","09","10","11","12"];default:return null}}const Dc=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],Mc=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],hm=["M","T","W","T","F","S","S"];function Rc(n){switch(n){case"narrow":return[...hm];case"short":return[...Mc];case"long":return[...Dc];case"numeric":return["1","2","3","4","5","6","7"];default:return null}}const Hc=["AM","PM"],_m=["Before Christ","Anno Domini"],gm=["BC","AD"],bm=["B","A"];function Uc(n){switch(n){case"narrow":return[...bm];case"short":return[...gm];case"long":return[..._m];default:return null}}function wm(n){return Hc[n.hour<12?0:1]}function ym(n,e){return Rc(e)[n.weekday-1]}function vm(n,e){return Ac(e)[n.month-1]}function km(n,e){return Uc(e)[n.year<0?0:1]}function Sm(n,e,t="always",i=!1){const l={years:["year","yr."],quarters:["quarter","qtr."],months:["month","mo."],weeks:["week","wk."],days:["day","day","days"],hours:["hour","hr."],minutes:["minute","min."],seconds:["second","sec."]},s=["hours","minutes","seconds"].indexOf(n)===-1;if(t==="auto"&&s){const c=n==="days";switch(e){case 1:return c?"tomorrow":`next ${l[n][0]}`;case-1:return c?"yesterday":`last ${l[n][0]}`;case 0:return c?"today":`this ${l[n][0]}`}}const r=Object.is(e,-0)||e<0,o=Math.abs(e),a=o===1,u=l[n],f=i?a?u[1]:u[2]||u[1]:a?l[n][0]:n;return r?`${o} ${f} ago`:`in ${o} ${f}`}function Yr(n,e){let t="";for(const i of n)i.literal?t+=i.val:t+=e(i.val);return t}const Tm={D:Cl,DD:ic,DDD:lc,DDDD:sc,t:rc,tt:oc,ttt:ac,tttt:uc,T:fc,TT:cc,TTT:dc,TTTT:pc,f:mc,ff:_c,fff:bc,ffff:yc,F:hc,FF:gc,FFF:wc,FFFF:vc};class jt{static create(e,t={}){return new jt(e,t)}static parseFormat(e){let t=null,i="",l=!1;const s=[];for(let r=0;r<e.length;r++){const o=e.charAt(r);o==="'"?(i.length>0&&s.push({literal:l||/^\s+$/.test(i),val:i}),t=null,i="",l=!l):l||o===t?i+=o:(i.length>0&&s.push({literal:/^\s+$/.test(i),val:i}),i=o,t=o)}return i.length>0&&s.push({literal:l||/^\s+$/.test(i),val:i}),s}static macroTokenToFormatOpts(e){return Tm[e]}constructor(e,t){this.opts=t,this.loc=e,this.systemLoc=null}formatWithSystemDefault(e,t){return this.systemLoc===null&&(this.systemLoc=this.loc.redefaultToSystem()),this.systemLoc.dtFormatter(e,{...this.opts,...t}).format()}dtFormatter(e,t={}){return this.loc.dtFormatter(e,{...this.opts,...t})}formatDateTime(e,t){return this.dtFormatter(e,t).format()}formatDateTimeParts(e,t){return this.dtFormatter(e,t).formatToParts()}formatInterval(e,t){return this.dtFormatter(e.start,t).dtf.formatRange(e.start.toJSDate(),e.end.toJSDate())}resolvedOptions(e,t){return this.dtFormatter(e,t).resolvedOptions()}num(e,t=0){if(this.opts.forceSimple)return yt(e,t);const i={...this.opts};return t>0&&(i.padTo=t),this.loc.numberFormatter(i).format(e)}formatDateTimeFromString(e,t){const i=this.loc.listingMode()==="en",l=this.loc.outputCalendar&&this.loc.outputCalendar!=="gregory",s=(m,h)=>this.loc.extract(e,m,h),r=m=>e.isOffsetFixed&&e.offset===0&&m.allowZ?"Z":e.isValid?e.zone.formatOffset(e.ts,m.format):"",o=()=>i?wm(e):s({hour:"numeric",hourCycle:"h12"},"dayperiod"),a=(m,h)=>i?vm(e,m):s(h?{month:m}:{month:m,day:"numeric"},"month"),u=(m,h)=>i?ym(e,m):s(h?{weekday:m}:{weekday:m,month:"long",day:"numeric"},"weekday"),f=m=>{const h=jt.macroTokenToFormatOpts(m);return h?this.formatWithSystemDefault(e,h):m},c=m=>i?km(e,m):s({era:m},"era"),d=m=>{switch(m){case"S":return this.num(e.millisecond);case"u":case"SSS":return this.num(e.millisecond,3);case"s":return this.num(e.second);case"ss":return this.num(e.second,2);case"uu":return this.num(Math.floor(e.millisecond/10),2);case"uuu":return this.num(Math.floor(e.millisecond/100));case"m":return this.num(e.minute);case"mm":return this.num(e.minute,2);case"h":return this.num(e.hour%12===0?12:e.hour%12);case"hh":return this.num(e.hour%12===0?12:e.hour%12,2);case"H":return this.num(e.hour);case"HH":return this.num(e.hour,2);case"Z":return r({format:"narrow",allowZ:this.opts.allowZ});case"ZZ":return r({format:"short",allowZ:this.opts.allowZ});case"ZZZ":return r({format:"techie",allowZ:this.opts.allowZ});case"ZZZZ":return e.zone.offsetName(e.ts,{format:"short",locale:this.loc.locale});case"ZZZZZ":return e.zone.offsetName(e.ts,{format:"long",locale:this.loc.locale});case"z":return e.zoneName;case"a":return o();case"d":return l?s({day:"numeric"},"day"):this.num(e.day);case"dd":return l?s({day:"2-digit"},"day"):this.num(e.day,2);case"c":return this.num(e.weekday);case"ccc":return u("short",!0);case"cccc":return u("long",!0);case"ccccc":return u("narrow",!0);case"E":return this.num(e.weekday);case"EEE":return u("short",!1);case"EEEE":return u("long",!1);case"EEEEE":return u("narrow",!1);case"L":return l?s({month:"numeric",day:"numeric"},"month"):this.num(e.month);case"LL":return l?s({month:"2-digit",day:"numeric"},"month"):this.num(e.month,2);case"LLL":return a("short",!0);case"LLLL":return a("long",!0);case"LLLLL":return a("narrow",!0);case"M":return l?s({month:"numeric"},"month"):this.num(e.month);case"MM":return l?s({month:"2-digit"},"month"):this.num(e.month,2);case"MMM":return a("short",!1);case"MMMM":return a("long",!1);case"MMMMM":return a("narrow",!1);case"y":return l?s({year:"numeric"},"year"):this.num(e.year);case"yy":return l?s({year:"2-digit"},"year"):this.num(e.year.toString().slice(-2),2);case"yyyy":return l?s({year:"numeric"},"year"):this.num(e.year,4);case"yyyyyy":return l?s({year:"numeric"},"year"):this.num(e.year,6);case"G":return c("short");case"GG":return c("long");case"GGGGG":return c("narrow");case"kk":return this.num(e.weekYear.toString().slice(-2),2);case"kkkk":return this.num(e.weekYear,4);case"W":return this.num(e.weekNumber);case"WW":return this.num(e.weekNumber,2);case"n":return this.num(e.localWeekNumber);case"nn":return this.num(e.localWeekNumber,2);case"ii":return this.num(e.localWeekYear.toString().slice(-2),2);case"iiii":return this.num(e.localWeekYear,4);case"o":return this.num(e.ordinal);case"ooo":return this.num(e.ordinal,3);case"q":return this.num(e.quarter);case"qq":return this.num(e.quarter,2);case"X":return this.num(Math.floor(e.ts/1e3));case"x":return this.num(e.ts);default:return f(m)}};return Yr(jt.parseFormat(t),d)}formatDurationFromString(e,t){const i=a=>{switch(a[0]){case"S":return"millisecond";case"s":return"second";case"m":return"minute";case"h":return"hour";case"d":return"day";case"w":return"week";case"M":return"month";case"y":return"year";default:return null}},l=a=>u=>{const f=i(u);return f?this.num(a.get(f),u.length):u},s=jt.parseFormat(t),r=s.reduce((a,{literal:u,val:f})=>u?a:a.concat(f),[]),o=e.shiftTo(...r.map(i).filter(a=>a));return Yr(s,l(o))}}const qc=/[A-Za-z_+-]{1,256}(?::?\/[A-Za-z0-9_+-]{1,256}(?:\/[A-Za-z0-9_+-]{1,256})?)?/;function Ci(...n){const e=n.reduce((t,i)=>t+i.source,"");return RegExp(`^${e}$`)}function Ei(...n){return e=>n.reduce(([t,i,l],s)=>{const[r,o,a]=s(e,l);return[{...t,...r},o||i,a]},[{},null,1]).slice(0,2)}function Li(n,...e){if(n==null)return[null,null];for(const[t,i]of e){const l=t.exec(n);if(l)return i(l)}return[null,null]}function $c(...n){return(e,t)=>{const i={};let l;for(l=0;l<n.length;l++)i[n[l]]=Tn(e[t+l]);return[i,null,t+l]}}const Fc=/(?:(Z)|([+-]\d\d)(?::?(\d\d))?)/,Om=`(?:${Fc.source}?(?:\\[(${qc.source})\\])?)?`,Zs=/(\d\d)(?::?(\d\d)(?::?(\d\d)(?:[.,](\d{1,30}))?)?)?/,Wc=RegExp(`${Zs.source}${Om}`),Ys=RegExp(`(?:T${Wc.source})?`),Cm=/([+-]\d{6}|\d{4})(?:-?(\d\d)(?:-?(\d\d))?)?/,Em=/(\d{4})-?W(\d\d)(?:-?(\d))?/,Lm=/(\d{4})-?(\d{3})/,Im=$c("weekYear","weekNumber","weekDay"),jm=$c("year","ordinal"),Pm=/(\d{4})-(\d\d)-(\d\d)/,Vc=RegExp(`${Zs.source} ?(?:${Fc.source}|(${qc.source}))?`),Nm=RegExp(`(?: ${Vc.source})?`);function gi(n,e,t){const i=n[e];return He(i)?t:Tn(i)}function Am(n,e){return[{year:gi(n,e),month:gi(n,e+1,1),day:gi(n,e+2,1)},null,e+3]}function Ii(n,e){return[{hours:gi(n,e,0),minutes:gi(n,e+1,0),seconds:gi(n,e+2,0),milliseconds:zs(n[e+3])},null,e+4]}function tl(n,e){const t=!n[e]&&!n[e+1],i=zl(n[e+1],n[e+2]),l=t?null:Dt.instance(i);return[{},l,e+3]}function nl(n,e){const t=n[e]?_n.create(n[e]):null;return[{},t,e+1]}const Dm=RegExp(`^T?${Zs.source}$`),Mm=/^-?P(?:(?:(-?\d{1,20}(?:\.\d{1,20})?)Y)?(?:(-?\d{1,20}(?:\.\d{1,20})?)M)?(?:(-?\d{1,20}(?:\.\d{1,20})?)W)?(?:(-?\d{1,20}(?:\.\d{1,20})?)D)?(?:T(?:(-?\d{1,20}(?:\.\d{1,20})?)H)?(?:(-?\d{1,20}(?:\.\d{1,20})?)M)?(?:(-?\d{1,20})(?:[.,](-?\d{1,20}))?S)?)?)$/;function Rm(n){const[e,t,i,l,s,r,o,a,u]=n,f=e[0]==="-",c=a&&a[0]==="-",d=(m,h=!1)=>m!==void 0&&(h||m&&f)?-m:m;return[{years:d(Mn(t)),months:d(Mn(i)),weeks:d(Mn(l)),days:d(Mn(s)),hours:d(Mn(r)),minutes:d(Mn(o)),seconds:d(Mn(a),a==="-0"),milliseconds:d(zs(u),c)}]}const Hm={GMT:0,EDT:-4*60,EST:-5*60,CDT:-5*60,CST:-6*60,MDT:-6*60,MST:-7*60,PDT:-7*60,PST:-8*60};function Ks(n,e,t,i,l,s,r){const o={year:e.length===2?Ss(Tn(e)):Tn(e),month:Nc.indexOf(t)+1,day:Tn(i),hour:Tn(l),minute:Tn(s)};return r&&(o.second=Tn(r)),n&&(o.weekday=n.length>3?Dc.indexOf(n)+1:Mc.indexOf(n)+1),o}const Um=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|(?:([+-]\d\d)(\d\d)))$/;function qm(n){const[,e,t,i,l,s,r,o,a,u,f,c]=n,d=Ks(e,l,i,t,s,r,o);let m;return a?m=Hm[a]:u?m=0:m=zl(f,c),[d,new Dt(m)]}function $m(n){return n.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").trim()}const Fm=/^(Mon|Tue|Wed|Thu|Fri|Sat|Sun), (\d\d) (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) (\d{4}) (\d\d):(\d\d):(\d\d) GMT$/,Wm=/^(Monday|Tuesday|Wednesday|Thursday|Friday|Saturday|Sunday), (\d\d)-(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)-(\d\d) (\d\d):(\d\d):(\d\d) GMT$/,Vm=/^(Mon|Tue|Wed|Thu|Fri|Sat|Sun) (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) ( \d|\d\d) (\d\d):(\d\d):(\d\d) (\d{4})$/;function Kr(n){const[,e,t,i,l,s,r,o]=n;return[Ks(e,l,i,t,s,r,o),Dt.utcInstance]}function zm(n){const[,e,t,i,l,s,r,o]=n;return[Ks(e,o,t,i,l,s,r),Dt.utcInstance]}const Bm=Ci(Cm,Ys),Zm=Ci(Em,Ys),Ym=Ci(Lm,Ys),Km=Ci(Wc),zc=Ei(Am,Ii,tl,nl),Gm=Ei(Im,Ii,tl,nl),Jm=Ei(jm,Ii,tl,nl),Xm=Ei(Ii,tl,nl);function Qm(n){return Li(n,[Bm,zc],[Zm,Gm],[Ym,Jm],[Km,Xm])}function xm(n){return Li($m(n),[Um,qm])}function eh(n){return Li(n,[Fm,Kr],[Wm,Kr],[Vm,zm])}function th(n){return Li(n,[Mm,Rm])}const nh=Ei(Ii);function ih(n){return Li(n,[Dm,nh])}const lh=Ci(Pm,Nm),sh=Ci(Vc),rh=Ei(Ii,tl,nl);function oh(n){return Li(n,[lh,zc],[sh,rh])}const Gr="Invalid Duration",Bc={weeks:{days:7,hours:7*24,minutes:7*24*60,seconds:7*24*60*60,milliseconds:7*24*60*60*1e3},days:{hours:24,minutes:24*60,seconds:24*60*60,milliseconds:24*60*60*1e3},hours:{minutes:60,seconds:60*60,milliseconds:60*60*1e3},minutes:{seconds:60,milliseconds:60*1e3},seconds:{milliseconds:1e3}},ah={years:{quarters:4,months:12,weeks:52,days:365,hours:365*24,minutes:365*24*60,seconds:365*24*60*60,milliseconds:365*24*60*60*1e3},quarters:{months:3,weeks:13,days:91,hours:91*24,minutes:91*24*60,seconds:91*24*60*60,milliseconds:91*24*60*60*1e3},months:{weeks:4,days:30,hours:30*24,minutes:30*24*60,seconds:30*24*60*60,milliseconds:30*24*60*60*1e3},...Bc},Vt=146097/400,ni=146097/4800,uh={years:{quarters:4,months:12,weeks:Vt/7,days:Vt,hours:Vt*24,minutes:Vt*24*60,seconds:Vt*24*60*60,milliseconds:Vt*24*60*60*1e3},quarters:{months:3,weeks:Vt/28,days:Vt/4,hours:Vt*24/4,minutes:Vt*24*60/4,seconds:Vt*24*60*60/4,milliseconds:Vt*24*60*60*1e3/4},months:{weeks:ni/7,days:ni,hours:ni*24,minutes:ni*24*60,seconds:ni*24*60*60,milliseconds:ni*24*60*60*1e3},...Bc},Fn=["years","quarters","months","weeks","days","hours","minutes","seconds","milliseconds"],fh=Fn.slice(0).reverse();function Sn(n,e,t=!1){const i={values:t?e.values:{...n.values,...e.values||{}},loc:n.loc.clone(e.loc),conversionAccuracy:e.conversionAccuracy||n.conversionAccuracy,matrix:e.matrix||n.matrix};return new Be(i)}function Zc(n,e){let t=e.milliseconds??0;for(const i of fh.slice(1))e[i]&&(t+=e[i]*n[i].milliseconds);return t}function Jr(n,e){const t=Zc(n,e)<0?-1:1;Fn.reduceRight((i,l)=>{if(He(e[l]))return i;if(i){const s=e[i]*t,r=n[l][i],o=Math.floor(s/r);e[l]+=o*t,e[i]-=o*r*t}return l},null),Fn.reduce((i,l)=>{if(He(e[l]))return i;if(i){const s=e[i]%1;e[i]-=s,e[l]+=s*n[i][l]}return l},null)}function ch(n){const e={};for(const[t,i]of Object.entries(n))i!==0&&(e[t]=i);return e}class Be{constructor(e){const t=e.conversionAccuracy==="longterm"||!1;let i=t?uh:ah;e.matrix&&(i=e.matrix),this.values=e.values,this.loc=e.loc||Je.create(),this.conversionAccuracy=t?"longterm":"casual",this.invalid=e.invalid||null,this.matrix=i,this.isLuxonDuration=!0}static fromMillis(e,t){return Be.fromObject({milliseconds:e},t)}static fromObject(e,t={}){if(e==null||typeof e!="object")throw new It(`Duration.fromObject: argument expected to be an object, got ${e===null?"null":typeof e}`);return new Be({values:Il(e,Be.normalizeUnit),loc:Je.fromObject(t),conversionAccuracy:t.conversionAccuracy,matrix:t.matrix})}static fromDurationLike(e){if(En(e))return Be.fromMillis(e);if(Be.isDuration(e))return e;if(typeof e=="object")return Be.fromObject(e);throw new It(`Unknown duration argument ${e} of type ${typeof e}`)}static fromISO(e,t){const[i]=th(e);return i?Be.fromObject(i,t):Be.invalid("unparsable",`the input "${e}" can't be parsed as ISO 8601`)}static fromISOTime(e,t){const[i]=ih(e);return i?Be.fromObject(i,t):Be.invalid("unparsable",`the input "${e}" can't be parsed as ISO 8601`)}static invalid(e,t=null){if(!e)throw new It("need to specify a reason the Duration is invalid");const i=e instanceof tn?e:new tn(e,t);if(ht.throwOnInvalid)throw new Mp(i);return new Be({invalid:i})}static normalizeUnit(e){const t={year:"years",years:"years",quarter:"quarters",quarters:"quarters",month:"months",months:"months",week:"weeks",weeks:"weeks",day:"days",days:"days",hour:"hours",hours:"hours",minute:"minutes",minutes:"minutes",second:"seconds",seconds:"seconds",millisecond:"milliseconds",milliseconds:"milliseconds"}[e&&e.toLowerCase()];if(!t)throw new nc(e);return t}static isDuration(e){return e&&e.isLuxonDuration||!1}get locale(){return this.isValid?this.loc.locale:null}get numberingSystem(){return this.isValid?this.loc.numberingSystem:null}toFormat(e,t={}){const i={...t,floor:t.round!==!1&&t.floor!==!1};return this.isValid?jt.create(this.loc,i).formatDurationFromString(this,e):Gr}toHuman(e={}){if(!this.isValid)return Gr;const t=Fn.map(i=>{const l=this.values[i];return He(l)?null:this.loc.numberFormatter({style:"unit",unitDisplay:"long",...e,unit:i.slice(0,-1)}).format(l)}).filter(i=>i);return this.loc.listFormatter({type:"conjunction",style:e.listStyle||"narrow",...e}).format(t)}toObject(){return this.isValid?{...this.values}:{}}toISO(){if(!this.isValid)return null;let e="P";return this.years!==0&&(e+=this.years+"Y"),(this.months!==0||this.quarters!==0)&&(e+=this.months+this.quarters*3+"M"),this.weeks!==0&&(e+=this.weeks+"W"),this.days!==0&&(e+=this.days+"D"),(this.hours!==0||this.minutes!==0||this.seconds!==0||this.milliseconds!==0)&&(e+="T"),this.hours!==0&&(e+=this.hours+"H"),this.minutes!==0&&(e+=this.minutes+"M"),(this.seconds!==0||this.milliseconds!==0)&&(e+=Bs(this.seconds+this.milliseconds/1e3,3)+"S"),e==="P"&&(e+="T0S"),e}toISOTime(e={}){if(!this.isValid)return null;const t=this.toMillis();return t<0||t>=864e5?null:(e={suppressMilliseconds:!1,suppressSeconds:!1,includePrefix:!1,format:"extended",...e,includeOffset:!1},Me.fromMillis(t,{zone:"UTC"}).toISOTime(e))}toJSON(){return this.toISO()}toString(){return this.toISO()}[Symbol.for("nodejs.util.inspect.custom")](){return this.isValid?`Duration { values: ${JSON.stringify(this.values)} }`:`Duration { Invalid, reason: ${this.invalidReason} }`}toMillis(){return this.isValid?Zc(this.matrix,this.values):NaN}valueOf(){return this.toMillis()}plus(e){if(!this.isValid)return this;const t=Be.fromDurationLike(e),i={};for(const l of Fn)(yi(t.values,l)||yi(this.values,l))&&(i[l]=t.get(l)+this.get(l));return Sn(this,{values:i},!0)}minus(e){if(!this.isValid)return this;const t=Be.fromDurationLike(e);return this.plus(t.negate())}mapUnits(e){if(!this.isValid)return this;const t={};for(const i of Object.keys(this.values))t[i]=Pc(e(this.values[i],i));return Sn(this,{values:t},!0)}get(e){return this[Be.normalizeUnit(e)]}set(e){if(!this.isValid)return this;const t={...this.values,...Il(e,Be.normalizeUnit)};return Sn(this,{values:t})}reconfigure({locale:e,numberingSystem:t,conversionAccuracy:i,matrix:l}={}){const r={loc:this.loc.clone({locale:e,numberingSystem:t}),matrix:l,conversionAccuracy:i};return Sn(this,r)}as(e){return this.isValid?this.shiftTo(e).get(e):NaN}normalize(){if(!this.isValid)return this;const e=this.toObject();return Jr(this.matrix,e),Sn(this,{values:e},!0)}rescale(){if(!this.isValid)return this;const e=ch(this.normalize().shiftToAll().toObject());return Sn(this,{values:e},!0)}shiftTo(...e){if(!this.isValid)return this;if(e.length===0)return this;e=e.map(r=>Be.normalizeUnit(r));const t={},i={},l=this.toObject();let s;for(const r of Fn)if(e.indexOf(r)>=0){s=r;let o=0;for(const u in i)o+=this.matrix[u][r]*i[u],i[u]=0;En(l[r])&&(o+=l[r]);const a=Math.trunc(o);t[r]=a,i[r]=(o*1e3-a*1e3)/1e3}else En(l[r])&&(i[r]=l[r]);for(const r in i)i[r]!==0&&(t[s]+=r===s?i[r]:i[r]/this.matrix[s][r]);return Jr(this.matrix,t),Sn(this,{values:t},!0)}shiftToAll(){return this.isValid?this.shiftTo("years","months","weeks","days","hours","minutes","seconds","milliseconds"):this}negate(){if(!this.isValid)return this;const e={};for(const t of Object.keys(this.values))e[t]=this.values[t]===0?0:-this.values[t];return Sn(this,{values:e},!0)}get years(){return this.isValid?this.values.years||0:NaN}get quarters(){return this.isValid?this.values.quarters||0:NaN}get months(){return this.isValid?this.values.months||0:NaN}get weeks(){return this.isValid?this.values.weeks||0:NaN}get days(){return this.isValid?this.values.days||0:NaN}get hours(){return this.isValid?this.values.hours||0:NaN}get minutes(){return this.isValid?this.values.minutes||0:NaN}get seconds(){return this.isValid?this.values.seconds||0:NaN}get milliseconds(){return this.isValid?this.values.milliseconds||0:NaN}get isValid(){return this.invalid===null}get invalidReason(){return this.invalid?this.invalid.reason:null}get invalidExplanation(){return this.invalid?this.invalid.explanation:null}equals(e){if(!this.isValid||!e.isValid||!this.loc.equals(e.loc))return!1;function t(i,l){return i===void 0||i===0?l===void 0||l===0:i===l}for(const i of Fn)if(!t(this.values[i],e.values[i]))return!1;return!0}}const ii="Invalid Interval";function dh(n,e){return!n||!n.isValid?mt.invalid("missing or invalid start"):!e||!e.isValid?mt.invalid("missing or invalid end"):e<n?mt.invalid("end before start",`The end of an interval must be after its start, but you had start=${n.toISO()} and end=${e.toISO()}`):null}class mt{constructor(e){this.s=e.start,this.e=e.end,this.invalid=e.invalid||null,this.isLuxonInterval=!0}static invalid(e,t=null){if(!e)throw new It("need to specify a reason the Interval is invalid");const i=e instanceof tn?e:new tn(e,t);if(ht.throwOnInvalid)throw new Dp(i);return new mt({invalid:i})}static fromDateTimes(e,t){const i=Ri(e),l=Ri(t),s=dh(i,l);return s??new mt({start:i,end:l})}static after(e,t){const i=Be.fromDurationLike(t),l=Ri(e);return mt.fromDateTimes(l,l.plus(i))}static before(e,t){const i=Be.fromDurationLike(t),l=Ri(e);return mt.fromDateTimes(l.minus(i),l)}static fromISO(e,t){const[i,l]=(e||"").split("/",2);if(i&&l){let s,r;try{s=Me.fromISO(i,t),r=s.isValid}catch{r=!1}let o,a;try{o=Me.fromISO(l,t),a=o.isValid}catch{a=!1}if(r&&a)return mt.fromDateTimes(s,o);if(r){const u=Be.fromISO(l,t);if(u.isValid)return mt.after(s,u)}else if(a){const u=Be.fromISO(i,t);if(u.isValid)return mt.before(o,u)}}return mt.invalid("unparsable",`the input "${e}" can't be parsed as ISO 8601`)}static isInterval(e){return e&&e.isLuxonInterval||!1}get start(){return this.isValid?this.s:null}get end(){return this.isValid?this.e:null}get isValid(){return this.invalidReason===null}get invalidReason(){return this.invalid?this.invalid.reason:null}get invalidExplanation(){return this.invalid?this.invalid.explanation:null}length(e="milliseconds"){return this.isValid?this.toDuration(e).get(e):NaN}count(e="milliseconds",t){if(!this.isValid)return NaN;const i=this.start.startOf(e,t);let l;return t!=null&&t.useLocaleWeeks?l=this.end.reconfigure({locale:i.locale}):l=this.end,l=l.startOf(e,t),Math.floor(l.diff(i,e).get(e))+(l.valueOf()!==this.end.valueOf())}hasSame(e){return this.isValid?this.isEmpty()||this.e.minus(1).hasSame(this.s,e):!1}isEmpty(){return this.s.valueOf()===this.e.valueOf()}isAfter(e){return this.isValid?this.s>e:!1}isBefore(e){return this.isValid?this.e<=e:!1}contains(e){return this.isValid?this.s<=e&&this.e>e:!1}set({start:e,end:t}={}){return this.isValid?mt.fromDateTimes(e||this.s,t||this.e):this}splitAt(...e){if(!this.isValid)return[];const t=e.map(Ri).filter(r=>this.contains(r)).sort((r,o)=>r.toMillis()-o.toMillis()),i=[];let{s:l}=this,s=0;for(;l<this.e;){const r=t[s]||this.e,o=+r>+this.e?this.e:r;i.push(mt.fromDateTimes(l,o)),l=o,s+=1}return i}splitBy(e){const t=Be.fromDurationLike(e);if(!this.isValid||!t.isValid||t.as("milliseconds")===0)return[];let{s:i}=this,l=1,s;const r=[];for(;i<this.e;){const o=this.start.plus(t.mapUnits(a=>a*l));s=+o>+this.e?this.e:o,r.push(mt.fromDateTimes(i,s)),i=s,l+=1}return r}divideEqually(e){return this.isValid?this.splitBy(this.length()/e).slice(0,e):[]}overlaps(e){return this.e>e.s&&this.s<e.e}abutsStart(e){return this.isValid?+this.e==+e.s:!1}abutsEnd(e){return this.isValid?+e.e==+this.s:!1}engulfs(e){return this.isValid?this.s<=e.s&&this.e>=e.e:!1}equals(e){return!this.isValid||!e.isValid?!1:this.s.equals(e.s)&&this.e.equals(e.e)}intersection(e){if(!this.isValid)return this;const t=this.s>e.s?this.s:e.s,i=this.e<e.e?this.e:e.e;return t>=i?null:mt.fromDateTimes(t,i)}union(e){if(!this.isValid)return this;const t=this.s<e.s?this.s:e.s,i=this.e>e.e?this.e:e.e;return mt.fromDateTimes(t,i)}static merge(e){const[t,i]=e.sort((l,s)=>l.s-s.s).reduce(([l,s],r)=>s?s.overlaps(r)||s.abutsStart(r)?[l,s.union(r)]:[l.concat([s]),r]:[l,r],[[],null]);return i&&t.push(i),t}static xor(e){let t=null,i=0;const l=[],s=e.map(a=>[{time:a.s,type:"s"},{time:a.e,type:"e"}]),r=Array.prototype.concat(...s),o=r.sort((a,u)=>a.time-u.time);for(const a of o)i+=a.type==="s"?1:-1,i===1?t=a.time:(t&&+t!=+a.time&&l.push(mt.fromDateTimes(t,a.time)),t=null);return mt.merge(l)}difference(...e){return mt.xor([this].concat(e)).map(t=>this.intersection(t)).filter(t=>t&&!t.isEmpty())}toString(){return this.isValid?`[${this.s.toISO()} – ${this.e.toISO()})`:ii}[Symbol.for("nodejs.util.inspect.custom")](){return this.isValid?`Interval { start: ${this.s.toISO()}, end: ${this.e.toISO()} }`:`Interval { Invalid, reason: ${this.invalidReason} }`}toLocaleString(e=Cl,t={}){return this.isValid?jt.create(this.s.loc.clone(t),e).formatInterval(this):ii}toISO(e){return this.isValid?`${this.s.toISO(e)}/${this.e.toISO(e)}`:ii}toISODate(){return this.isValid?`${this.s.toISODate()}/${this.e.toISODate()}`:ii}toISOTime(e){return this.isValid?`${this.s.toISOTime(e)}/${this.e.toISOTime(e)}`:ii}toFormat(e,{separator:t=" – "}={}){return this.isValid?`${this.s.toFormat(e)}${t}${this.e.toFormat(e)}`:ii}toDuration(e,t){return this.isValid?this.e.diff(this.s,e,t):Be.invalid(this.invalidReason)}mapEndpoints(e){return mt.fromDateTimes(e(this.s),e(this.e))}}class cl{static hasDST(e=ht.defaultZone){const t=Me.now().setZone(e).set({month:12});return!e.isUniversal&&t.offset!==t.set({month:6}).offset}static isValidIANAZone(e){return _n.isValidZone(e)}static normalizeZone(e){return On(e,ht.defaultZone)}static getStartOfWeek({locale:e=null,locObj:t=null}={}){return(t||Je.create(e)).getStartOfWeek()}static getMinimumDaysInFirstWeek({locale:e=null,locObj:t=null}={}){return(t||Je.create(e)).getMinDaysInFirstWeek()}static getWeekendWeekdays({locale:e=null,locObj:t=null}={}){return(t||Je.create(e)).getWeekendDays().slice()}static months(e="long",{locale:t=null,numberingSystem:i=null,locObj:l=null,outputCalendar:s="gregory"}={}){return(l||Je.create(t,i,s)).months(e)}static monthsFormat(e="long",{locale:t=null,numberingSystem:i=null,locObj:l=null,outputCalendar:s="gregory"}={}){return(l||Je.create(t,i,s)).months(e,!0)}static weekdays(e="long",{locale:t=null,numberingSystem:i=null,locObj:l=null}={}){return(l||Je.create(t,i,null)).weekdays(e)}static weekdaysFormat(e="long",{locale:t=null,numberingSystem:i=null,locObj:l=null}={}){return(l||Je.create(t,i,null)).weekdays(e,!0)}static meridiems({locale:e=null}={}){return Je.create(e).meridiems()}static eras(e="short",{locale:t=null}={}){return Je.create(t,null,"gregory").eras(e)}static features(){return{relative:Lc(),localeWeek:Ic()}}}function Xr(n,e){const t=l=>l.toUTC(0,{keepLocalTime:!0}).startOf("day").valueOf(),i=t(e)-t(n);return Math.floor(Be.fromMillis(i).as("days"))}function ph(n,e,t){const i=[["years",(a,u)=>u.year-a.year],["quarters",(a,u)=>u.quarter-a.quarter+(u.year-a.year)*4],["months",(a,u)=>u.month-a.month+(u.year-a.year)*12],["weeks",(a,u)=>{const f=Xr(a,u);return(f-f%7)/7}],["days",Xr]],l={},s=n;let r,o;for(const[a,u]of i)t.indexOf(a)>=0&&(r=a,l[a]=u(n,e),o=s.plus(l),o>e?(l[a]--,n=s.plus(l),n>e&&(o=n,l[a]--,n=s.plus(l))):n=o);return[n,l,o,r]}function mh(n,e,t,i){let[l,s,r,o]=ph(n,e,t);const a=e-l,u=t.filter(c=>["hours","minutes","seconds","milliseconds"].indexOf(c)>=0);u.length===0&&(r<e&&(r=l.plus({[o]:1})),r!==l&&(s[o]=(s[o]||0)+a/(r-l)));const f=Be.fromObject(s,i);return u.length>0?Be.fromMillis(a,i).shiftTo(...u).plus(f):f}const hh="missing Intl.DateTimeFormat.formatToParts support";function Ye(n,e=t=>t){return{regex:n,deser:([t])=>e(lm(t))}}const _h=" ",Yc=`[ ${_h}]`,Kc=new RegExp(Yc,"g");function gh(n){return n.replace(/\./g,"\\.?").replace(Kc,Yc)}function Qr(n){return n.replace(/\./g,"").replace(Kc," ").toLowerCase()}function en(n,e){return n===null?null:{regex:RegExp(n.map(gh).join("|")),deser:([t])=>n.findIndex(i=>Qr(t)===Qr(i))+e}}function xr(n,e){return{regex:n,deser:([,t,i])=>zl(t,i),groups:e}}function dl(n){return{regex:n,deser:([e])=>e}}function bh(n){return n.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function wh(n,e){const t=xt(e),i=xt(e,"{2}"),l=xt(e,"{3}"),s=xt(e,"{4}"),r=xt(e,"{6}"),o=xt(e,"{1,2}"),a=xt(e,"{1,3}"),u=xt(e,"{1,6}"),f=xt(e,"{1,9}"),c=xt(e,"{2,4}"),d=xt(e,"{4,6}"),m=b=>({regex:RegExp(bh(b.val)),deser:([g])=>g,literal:!0}),_=(b=>{if(n.literal)return m(b);switch(b.val){case"G":return en(e.eras("short"),0);case"GG":return en(e.eras("long"),0);case"y":return Ye(u);case"yy":return Ye(c,Ss);case"yyyy":return Ye(s);case"yyyyy":return Ye(d);case"yyyyyy":return Ye(r);case"M":return Ye(o);case"MM":return Ye(i);case"MMM":return en(e.months("short",!0),1);case"MMMM":return en(e.months("long",!0),1);case"L":return Ye(o);case"LL":return Ye(i);case"LLL":return en(e.months("short",!1),1);case"LLLL":return en(e.months("long",!1),1);case"d":return Ye(o);case"dd":return Ye(i);case"o":return Ye(a);case"ooo":return Ye(l);case"HH":return Ye(i);case"H":return Ye(o);case"hh":return Ye(i);case"h":return Ye(o);case"mm":return Ye(i);case"m":return Ye(o);case"q":return Ye(o);case"qq":return Ye(i);case"s":return Ye(o);case"ss":return Ye(i);case"S":return Ye(a);case"SSS":return Ye(l);case"u":return dl(f);case"uu":return dl(o);case"uuu":return Ye(t);case"a":return en(e.meridiems(),0);case"kkkk":return Ye(s);case"kk":return Ye(c,Ss);case"W":return Ye(o);case"WW":return Ye(i);case"E":case"c":return Ye(t);case"EEE":return en(e.weekdays("short",!1),1);case"EEEE":return en(e.weekdays("long",!1),1);case"ccc":return en(e.weekdays("short",!0),1);case"cccc":return en(e.weekdays("long",!0),1);case"Z":case"ZZ":return xr(new RegExp(`([+-]${o.source})(?::(${i.source}))?`),2);case"ZZZ":return xr(new RegExp(`([+-]${o.source})(${i.source})?`),2);case"z":return dl(/[a-z_+-/]{1,256}?/i);case" ":return dl(/[^\S\n\r]/);default:return m(b)}})(n)||{invalidReason:hh};return _.token=n,_}const yh={year:{"2-digit":"yy",numeric:"yyyyy"},month:{numeric:"M","2-digit":"MM",short:"MMM",long:"MMMM"},day:{numeric:"d","2-digit":"dd"},weekday:{short:"EEE",long:"EEEE"},dayperiod:"a",dayPeriod:"a",hour12:{numeric:"h","2-digit":"hh"},hour24:{numeric:"H","2-digit":"HH"},minute:{numeric:"m","2-digit":"mm"},second:{numeric:"s","2-digit":"ss"},timeZoneName:{long:"ZZZZZ",short:"ZZZ"}};function vh(n,e,t){const{type:i,value:l}=n;if(i==="literal"){const a=/^\s+$/.test(l);return{literal:!a,val:a?" ":l}}const s=e[i];let r=i;i==="hour"&&(e.hour12!=null?r=e.hour12?"hour12":"hour24":e.hourCycle!=null?e.hourCycle==="h11"||e.hourCycle==="h12"?r="hour12":r="hour24":r=t.hour12?"hour12":"hour24");let o=yh[r];if(typeof o=="object"&&(o=o[s]),o)return{literal:!1,val:o}}function kh(n){return[`^${n.map(t=>t.regex).reduce((t,i)=>`${t}(${i.source})`,"")}$`,n]}function Sh(n,e,t){const i=n.match(e);if(i){const l={};let s=1;for(const r in t)if(yi(t,r)){const o=t[r],a=o.groups?o.groups+1:1;!o.literal&&o.token&&(l[o.token.val[0]]=o.deser(i.slice(s,s+a))),s+=a}return[i,l]}else return[i,{}]}function Th(n){const e=s=>{switch(s){case"S":return"millisecond";case"s":return"second";case"m":return"minute";case"h":case"H":return"hour";case"d":return"day";case"o":return"ordinal";case"L":case"M":return"month";case"y":return"year";case"E":case"c":return"weekday";case"W":return"weekNumber";case"k":return"weekYear";case"q":return"quarter";default:return null}};let t=null,i;return He(n.z)||(t=_n.create(n.z)),He(n.Z)||(t||(t=new Dt(n.Z)),i=n.Z),He(n.q)||(n.M=(n.q-1)*3+1),He(n.h)||(n.h<12&&n.a===1?n.h+=12:n.h===12&&n.a===0&&(n.h=0)),n.G===0&&n.y&&(n.y=-n.y),He(n.u)||(n.S=zs(n.u)),[Object.keys(n).reduce((s,r)=>{const o=e(r);return o&&(s[o]=n[r]),s},{}),t,i]}let ns=null;function Oh(){return ns||(ns=Me.fromMillis(1555555555555)),ns}function Ch(n,e){if(n.literal)return n;const t=jt.macroTokenToFormatOpts(n.val),i=Qc(t,e);return i==null||i.includes(void 0)?n:i}function Gc(n,e){return Array.prototype.concat(...n.map(t=>Ch(t,e)))}class Jc{constructor(e,t){if(this.locale=e,this.format=t,this.tokens=Gc(jt.parseFormat(t),e),this.units=this.tokens.map(i=>wh(i,e)),this.disqualifyingUnit=this.units.find(i=>i.invalidReason),!this.disqualifyingUnit){const[i,l]=kh(this.units);this.regex=RegExp(i,"i"),this.handlers=l}}explainFromTokens(e){if(this.isValid){const[t,i]=Sh(e,this.regex,this.handlers),[l,s,r]=i?Th(i):[null,null,void 0];if(yi(i,"a")&&yi(i,"H"))throw new ai("Can't include meridiem when specifying 24-hour format");return{input:e,tokens:this.tokens,regex:this.regex,rawMatches:t,matches:i,result:l,zone:s,specificOffset:r}}else return{input:e,tokens:this.tokens,invalidReason:this.invalidReason}}get isValid(){return!this.disqualifyingUnit}get invalidReason(){return this.disqualifyingUnit?this.disqualifyingUnit.invalidReason:null}}function Xc(n,e,t){return new Jc(n,t).explainFromTokens(e)}function Eh(n,e,t){const{result:i,zone:l,specificOffset:s,invalidReason:r}=Xc(n,e,t);return[i,l,s,r]}function Qc(n,e){if(!n)return null;const i=jt.create(e,n).dtFormatter(Oh()),l=i.formatToParts(),s=i.resolvedOptions();return l.map(r=>vh(r,n,s))}const is="Invalid DateTime",eo=864e13;function Ui(n){return new tn("unsupported zone",`the zone "${n.name}" is not supported`)}function ls(n){return n.weekData===null&&(n.weekData=El(n.c)),n.weekData}function ss(n){return n.localWeekData===null&&(n.localWeekData=El(n.c,n.loc.getMinDaysInFirstWeek(),n.loc.getStartOfWeek())),n.localWeekData}function Rn(n,e){const t={ts:n.ts,zone:n.zone,c:n.c,o:n.o,loc:n.loc,invalid:n.invalid};return new Me({...t,...e,old:t})}function xc(n,e,t){let i=n-e*60*1e3;const l=t.offset(i);if(e===l)return[i,e];i-=(l-e)*60*1e3;const s=t.offset(i);return l===s?[i,l]:[n-Math.min(l,s)*60*1e3,Math.max(l,s)]}function pl(n,e){n+=e*60*1e3;const t=new Date(n);return{year:t.getUTCFullYear(),month:t.getUTCMonth()+1,day:t.getUTCDate(),hour:t.getUTCHours(),minute:t.getUTCMinutes(),second:t.getUTCSeconds(),millisecond:t.getUTCMilliseconds()}}function yl(n,e,t){return xc(Vl(n),e,t)}function to(n,e){const t=n.o,i=n.c.year+Math.trunc(e.years),l=n.c.month+Math.trunc(e.months)+Math.trunc(e.quarters)*3,s={...n.c,year:i,month:l,day:Math.min(n.c.day,Ll(i,l))+Math.trunc(e.days)+Math.trunc(e.weeks)*7},r=Be.fromObject({years:e.years-Math.trunc(e.years),quarters:e.quarters-Math.trunc(e.quarters),months:e.months-Math.trunc(e.months),weeks:e.weeks-Math.trunc(e.weeks),days:e.days-Math.trunc(e.days),hours:e.hours,minutes:e.minutes,seconds:e.seconds,milliseconds:e.milliseconds}).as("milliseconds"),o=Vl(s);let[a,u]=xc(o,t,n.zone);return r!==0&&(a+=r,u=n.zone.offset(a)),{ts:a,o:u}}function li(n,e,t,i,l,s){const{setZone:r,zone:o}=t;if(n&&Object.keys(n).length!==0||e){const a=e||o,u=Me.fromObject(n,{...t,zone:a,specificOffset:s});return r?u:u.setZone(o)}else return Me.invalid(new tn("unparsable",`the input "${l}" can't be parsed as ${i}`))}function ml(n,e,t=!0){return n.isValid?jt.create(Je.create("en-US"),{allowZ:t,forceSimple:!0}).formatDateTimeFromString(n,e):null}function rs(n,e){const t=n.c.year>9999||n.c.year<0;let i="";return t&&n.c.year>=0&&(i+="+"),i+=yt(n.c.year,t?6:4),e?(i+="-",i+=yt(n.c.month),i+="-",i+=yt(n.c.day)):(i+=yt(n.c.month),i+=yt(n.c.day)),i}function no(n,e,t,i,l,s){let r=yt(n.c.hour);return e?(r+=":",r+=yt(n.c.minute),(n.c.millisecond!==0||n.c.second!==0||!t)&&(r+=":")):r+=yt(n.c.minute),(n.c.millisecond!==0||n.c.second!==0||!t)&&(r+=yt(n.c.second),(n.c.millisecond!==0||!i)&&(r+=".",r+=yt(n.c.millisecond,3))),l&&(n.isOffsetFixed&&n.offset===0&&!s?r+="Z":n.o<0?(r+="-",r+=yt(Math.trunc(-n.o/60)),r+=":",r+=yt(Math.trunc(-n.o%60))):(r+="+",r+=yt(Math.trunc(n.o/60)),r+=":",r+=yt(Math.trunc(n.o%60)))),s&&(r+="["+n.zone.ianaName+"]"),r}const ed={month:1,day:1,hour:0,minute:0,second:0,millisecond:0},Lh={weekNumber:1,weekday:1,hour:0,minute:0,second:0,millisecond:0},Ih={ordinal:1,hour:0,minute:0,second:0,millisecond:0},td=["year","month","day","hour","minute","second","millisecond"],jh=["weekYear","weekNumber","weekday","hour","minute","second","millisecond"],Ph=["year","ordinal","hour","minute","second","millisecond"];function Nh(n){const e={year:"year",years:"year",month:"month",months:"month",day:"day",days:"day",hour:"hour",hours:"hour",minute:"minute",minutes:"minute",quarter:"quarter",quarters:"quarter",second:"second",seconds:"second",millisecond:"millisecond",milliseconds:"millisecond",weekday:"weekday",weekdays:"weekday",weeknumber:"weekNumber",weeksnumber:"weekNumber",weeknumbers:"weekNumber",weekyear:"weekYear",weekyears:"weekYear",ordinal:"ordinal"}[n.toLowerCase()];if(!e)throw new nc(n);return e}function io(n){switch(n.toLowerCase()){case"localweekday":case"localweekdays":return"localWeekday";case"localweeknumber":case"localweeknumbers":return"localWeekNumber";case"localweekyear":case"localweekyears":return"localWeekYear";default:return Nh(n)}}function Ah(n){return kl[n]||(vl===void 0&&(vl=ht.now()),kl[n]=n.offset(vl)),kl[n]}function lo(n,e){const t=On(e.zone,ht.defaultZone);if(!t.isValid)return Me.invalid(Ui(t));const i=Je.fromObject(e);let l,s;if(He(n.year))l=ht.now();else{for(const a of td)He(n[a])&&(n[a]=ed[a]);const r=Cc(n)||Ec(n);if(r)return Me.invalid(r);const o=Ah(t);[l,s]=yl(n,o,t)}return new Me({ts:l,zone:t,loc:i,o:s})}function so(n,e,t){const i=He(t.round)?!0:t.round,l=(r,o)=>(r=Bs(r,i||t.calendary?0:2,!0),e.loc.clone(t).relFormatter(t).format(r,o)),s=r=>t.calendary?e.hasSame(n,r)?0:e.startOf(r).diff(n.startOf(r),r).get(r):e.diff(n,r).get(r);if(t.unit)return l(s(t.unit),t.unit);for(const r of t.units){const o=s(r);if(Math.abs(o)>=1)return l(o,r)}return l(n>e?-0:0,t.units[t.units.length-1])}function ro(n){let e={},t;return n.length>0&&typeof n[n.length-1]=="object"?(e=n[n.length-1],t=Array.from(n).slice(0,n.length-1)):t=Array.from(n),[e,t]}let vl,kl={};class Me{constructor(e){const t=e.zone||ht.defaultZone;let i=e.invalid||(Number.isNaN(e.ts)?new tn("invalid input"):null)||(t.isValid?null:Ui(t));this.ts=He(e.ts)?ht.now():e.ts;let l=null,s=null;if(!i)if(e.old&&e.old.ts===this.ts&&e.old.zone.equals(t))[l,s]=[e.old.c,e.old.o];else{const o=En(e.o)&&!e.old?e.o:t.offset(this.ts);l=pl(this.ts,o),i=Number.isNaN(l.year)?new tn("invalid input"):null,l=i?null:l,s=i?null:o}this._zone=t,this.loc=e.loc||Je.create(),this.invalid=i,this.weekData=null,this.localWeekData=null,this.c=l,this.o=s,this.isLuxonDateTime=!0}static now(){return new Me({})}static local(){const[e,t]=ro(arguments),[i,l,s,r,o,a,u]=t;return lo({year:i,month:l,day:s,hour:r,minute:o,second:a,millisecond:u},e)}static utc(){const[e,t]=ro(arguments),[i,l,s,r,o,a,u]=t;return e.zone=Dt.utcInstance,lo({year:i,month:l,day:s,hour:r,minute:o,second:a,millisecond:u},e)}static fromJSDate(e,t={}){const i=um(e)?e.valueOf():NaN;if(Number.isNaN(i))return Me.invalid("invalid input");const l=On(t.zone,ht.defaultZone);return l.isValid?new Me({ts:i,zone:l,loc:Je.fromObject(t)}):Me.invalid(Ui(l))}static fromMillis(e,t={}){if(En(e))return e<-eo||e>eo?Me.invalid("Timestamp out of range"):new Me({ts:e,zone:On(t.zone,ht.defaultZone),loc:Je.fromObject(t)});throw new It(`fromMillis requires a numerical input, but received a ${typeof e} with value ${e}`)}static fromSeconds(e,t={}){if(En(e))return new Me({ts:e*1e3,zone:On(t.zone,ht.defaultZone),loc:Je.fromObject(t)});throw new It("fromSeconds requires a numerical input")}static fromObject(e,t={}){e=e||{};const i=On(t.zone,ht.defaultZone);if(!i.isValid)return Me.invalid(Ui(i));const l=Je.fromObject(t),s=Il(e,io),{minDaysInFirstWeek:r,startOfWeek:o}=zr(s,l),a=ht.now(),u=He(t.specificOffset)?i.offset(a):t.specificOffset,f=!He(s.ordinal),c=!He(s.year),d=!He(s.month)||!He(s.day),m=c||d,h=s.weekYear||s.weekNumber;if((m||f)&&h)throw new ai("Can't mix weekYear/weekNumber units with year/month/day or ordinals");if(d&&f)throw new ai("Can't mix ordinal dates with month/day");const _=h||s.weekday&&!m;let b,g,T=pl(a,u);_?(b=jh,g=Lh,T=El(T,r,o)):f?(b=Ph,g=Ih,T=ts(T)):(b=td,g=ed);let L=!1;for(const D of b){const M=s[D];He(M)?L?s[D]=g[D]:s[D]=T[D]:L=!0}const O=_?rm(s,r,o):f?om(s):Cc(s),C=O||Ec(s);if(C)return Me.invalid(C);const S=_?Wr(s,r,o):f?Vr(s):s,[P,R]=yl(S,u,i),A=new Me({ts:P,zone:i,o:R,loc:l});return s.weekday&&m&&e.weekday!==A.weekday?Me.invalid("mismatched weekday",`you can't specify both a weekday of ${s.weekday} and a date of ${A.toISO()}`):A.isValid?A:Me.invalid(A.invalid)}static fromISO(e,t={}){const[i,l]=Qm(e);return li(i,l,t,"ISO 8601",e)}static fromRFC2822(e,t={}){const[i,l]=xm(e);return li(i,l,t,"RFC 2822",e)}static fromHTTP(e,t={}){const[i,l]=eh(e);return li(i,l,t,"HTTP",t)}static fromFormat(e,t,i={}){if(He(e)||He(t))throw new It("fromFormat requires an input string and a format");const{locale:l=null,numberingSystem:s=null}=i,r=Je.fromOpts({locale:l,numberingSystem:s,defaultToEN:!0}),[o,a,u,f]=Eh(r,e,t);return f?Me.invalid(f):li(o,a,i,`format ${t}`,e,u)}static fromString(e,t,i={}){return Me.fromFormat(e,t,i)}static fromSQL(e,t={}){const[i,l]=oh(e);return li(i,l,t,"SQL",e)}static invalid(e,t=null){if(!e)throw new It("need to specify a reason the DateTime is invalid");const i=e instanceof tn?e:new tn(e,t);if(ht.throwOnInvalid)throw new Ap(i);return new Me({invalid:i})}static isDateTime(e){return e&&e.isLuxonDateTime||!1}static parseFormatForOpts(e,t={}){const i=Qc(e,Je.fromObject(t));return i?i.map(l=>l?l.val:null).join(""):null}static expandFormat(e,t={}){return Gc(jt.parseFormat(e),Je.fromObject(t)).map(l=>l.val).join("")}static resetCache(){vl=void 0,kl={}}get(e){return this[e]}get isValid(){return this.invalid===null}get invalidReason(){return this.invalid?this.invalid.reason:null}get invalidExplanation(){return this.invalid?this.invalid.explanation:null}get locale(){return this.isValid?this.loc.locale:null}get numberingSystem(){return this.isValid?this.loc.numberingSystem:null}get outputCalendar(){return this.isValid?this.loc.outputCalendar:null}get zone(){return this._zone}get zoneName(){return this.isValid?this.zone.name:null}get year(){return this.isValid?this.c.year:NaN}get quarter(){return this.isValid?Math.ceil(this.c.month/3):NaN}get month(){return this.isValid?this.c.month:NaN}get day(){return this.isValid?this.c.day:NaN}get hour(){return this.isValid?this.c.hour:NaN}get minute(){return this.isValid?this.c.minute:NaN}get second(){return this.isValid?this.c.second:NaN}get millisecond(){return this.isValid?this.c.millisecond:NaN}get weekYear(){return this.isValid?ls(this).weekYear:NaN}get weekNumber(){return this.isValid?ls(this).weekNumber:NaN}get weekday(){return this.isValid?ls(this).weekday:NaN}get isWeekend(){return this.isValid&&this.loc.getWeekendDays().includes(this.weekday)}get localWeekday(){return this.isValid?ss(this).weekday:NaN}get localWeekNumber(){return this.isValid?ss(this).weekNumber:NaN}get localWeekYear(){return this.isValid?ss(this).weekYear:NaN}get ordinal(){return this.isValid?ts(this.c).ordinal:NaN}get monthShort(){return this.isValid?cl.months("short",{locObj:this.loc})[this.month-1]:null}get monthLong(){return this.isValid?cl.months("long",{locObj:this.loc})[this.month-1]:null}get weekdayShort(){return this.isValid?cl.weekdays("short",{locObj:this.loc})[this.weekday-1]:null}get weekdayLong(){return this.isValid?cl.weekdays("long",{locObj:this.loc})[this.weekday-1]:null}get offset(){return this.isValid?+this.o:NaN}get offsetNameShort(){return this.isValid?this.zone.offsetName(this.ts,{format:"short",locale:this.locale}):null}get offsetNameLong(){return this.isValid?this.zone.offsetName(this.ts,{format:"long",locale:this.locale}):null}get isOffsetFixed(){return this.isValid?this.zone.isUniversal:null}get isInDST(){return this.isOffsetFixed?!1:this.offset>this.set({month:1,day:1}).offset||this.offset>this.set({month:5}).offset}getPossibleOffsets(){if(!this.isValid||this.isOffsetFixed)return[this];const e=864e5,t=6e4,i=Vl(this.c),l=this.zone.offset(i-e),s=this.zone.offset(i+e),r=this.zone.offset(i-l*t),o=this.zone.offset(i-s*t);if(r===o)return[this];const a=i-r*t,u=i-o*t,f=pl(a,r),c=pl(u,o);return f.hour===c.hour&&f.minute===c.minute&&f.second===c.second&&f.millisecond===c.millisecond?[Rn(this,{ts:a}),Rn(this,{ts:u})]:[this]}get isInLeapYear(){return el(this.year)}get daysInMonth(){return Ll(this.year,this.month)}get daysInYear(){return this.isValid?_i(this.year):NaN}get weeksInWeekYear(){return this.isValid?Gi(this.weekYear):NaN}get weeksInLocalWeekYear(){return this.isValid?Gi(this.localWeekYear,this.loc.getMinDaysInFirstWeek(),this.loc.getStartOfWeek()):NaN}resolvedLocaleOptions(e={}){const{locale:t,numberingSystem:i,calendar:l}=jt.create(this.loc.clone(e),e).resolvedOptions(this);return{locale:t,numberingSystem:i,outputCalendar:l}}toUTC(e=0,t={}){return this.setZone(Dt.instance(e),t)}toLocal(){return this.setZone(ht.defaultZone)}setZone(e,{keepLocalTime:t=!1,keepCalendarTime:i=!1}={}){if(e=On(e,ht.defaultZone),e.equals(this.zone))return this;if(e.isValid){let l=this.ts;if(t||i){const s=e.offset(this.ts),r=this.toObject();[l]=yl(r,s,e)}return Rn(this,{ts:l,zone:e})}else return Me.invalid(Ui(e))}reconfigure({locale:e,numberingSystem:t,outputCalendar:i}={}){const l=this.loc.clone({locale:e,numberingSystem:t,outputCalendar:i});return Rn(this,{loc:l})}setLocale(e){return this.reconfigure({locale:e})}set(e){if(!this.isValid)return this;const t=Il(e,io),{minDaysInFirstWeek:i,startOfWeek:l}=zr(t,this.loc),s=!He(t.weekYear)||!He(t.weekNumber)||!He(t.weekday),r=!He(t.ordinal),o=!He(t.year),a=!He(t.month)||!He(t.day),u=o||a,f=t.weekYear||t.weekNumber;if((u||r)&&f)throw new ai("Can't mix weekYear/weekNumber units with year/month/day or ordinals");if(a&&r)throw new ai("Can't mix ordinal dates with month/day");let c;s?c=Wr({...El(this.c,i,l),...t},i,l):He(t.ordinal)?(c={...this.toObject(),...t},He(t.day)&&(c.day=Math.min(Ll(c.year,c.month),c.day))):c=Vr({...ts(this.c),...t});const[d,m]=yl(c,this.o,this.zone);return Rn(this,{ts:d,o:m})}plus(e){if(!this.isValid)return this;const t=Be.fromDurationLike(e);return Rn(this,to(this,t))}minus(e){if(!this.isValid)return this;const t=Be.fromDurationLike(e).negate();return Rn(this,to(this,t))}startOf(e,{useLocaleWeeks:t=!1}={}){if(!this.isValid)return this;const i={},l=Be.normalizeUnit(e);switch(l){case"years":i.month=1;case"quarters":case"months":i.day=1;case"weeks":case"days":i.hour=0;case"hours":i.minute=0;case"minutes":i.second=0;case"seconds":i.millisecond=0;break}if(l==="weeks")if(t){const s=this.loc.getStartOfWeek(),{weekday:r}=this;r<s&&(i.weekNumber=this.weekNumber-1),i.weekday=s}else i.weekday=1;if(l==="quarters"){const s=Math.ceil(this.month/3);i.month=(s-1)*3+1}return this.set(i)}endOf(e,t){return this.isValid?this.plus({[e]:1}).startOf(e,t).minus(1):this}toFormat(e,t={}){return this.isValid?jt.create(this.loc.redefaultToEN(t)).formatDateTimeFromString(this,e):is}toLocaleString(e=Cl,t={}){return this.isValid?jt.create(this.loc.clone(t),e).formatDateTime(this):is}toLocaleParts(e={}){return this.isValid?jt.create(this.loc.clone(e),e).formatDateTimeParts(this):[]}toISO({format:e="extended",suppressSeconds:t=!1,suppressMilliseconds:i=!1,includeOffset:l=!0,extendedZone:s=!1}={}){if(!this.isValid)return null;const r=e==="extended";let o=rs(this,r);return o+="T",o+=no(this,r,t,i,l,s),o}toISODate({format:e="extended"}={}){return this.isValid?rs(this,e==="extended"):null}toISOWeekDate(){return ml(this,"kkkk-'W'WW-c")}toISOTime({suppressMilliseconds:e=!1,suppressSeconds:t=!1,includeOffset:i=!0,includePrefix:l=!1,extendedZone:s=!1,format:r="extended"}={}){return this.isValid?(l?"T":"")+no(this,r==="extended",t,e,i,s):null}toRFC2822(){return ml(this,"EEE, dd LLL yyyy HH:mm:ss ZZZ",!1)}toHTTP(){return ml(this.toUTC(),"EEE, dd LLL yyyy HH:mm:ss 'GMT'")}toSQLDate(){return this.isValid?rs(this,!0):null}toSQLTime({includeOffset:e=!0,includeZone:t=!1,includeOffsetSpace:i=!0}={}){let l="HH:mm:ss.SSS";return(t||e)&&(i&&(l+=" "),t?l+="z":e&&(l+="ZZ")),ml(this,l,!0)}toSQL(e={}){return this.isValid?`${this.toSQLDate()} ${this.toSQLTime(e)}`:null}toString(){return this.isValid?this.toISO():is}[Symbol.for("nodejs.util.inspect.custom")](){return this.isValid?`DateTime { ts: ${this.toISO()}, zone: ${this.zone.name}, locale: ${this.locale} }`:`DateTime { Invalid, reason: ${this.invalidReason} }`}valueOf(){return this.toMillis()}toMillis(){return this.isValid?this.ts:NaN}toSeconds(){return this.isValid?this.ts/1e3:NaN}toUnixInteger(){return this.isValid?Math.floor(this.ts/1e3):NaN}toJSON(){return this.toISO()}toBSON(){return this.toJSDate()}toObject(e={}){if(!this.isValid)return{};const t={...this.c};return e.includeConfig&&(t.outputCalendar=this.outputCalendar,t.numberingSystem=this.loc.numberingSystem,t.locale=this.loc.locale),t}toJSDate(){return new Date(this.isValid?this.ts:NaN)}diff(e,t="milliseconds",i={}){if(!this.isValid||!e.isValid)return Be.invalid("created by diffing an invalid DateTime");const l={locale:this.locale,numberingSystem:this.numberingSystem,...i},s=fm(t).map(Be.normalizeUnit),r=e.valueOf()>this.valueOf(),o=r?this:e,a=r?e:this,u=mh(o,a,s,l);return r?u.negate():u}diffNow(e="milliseconds",t={}){return this.diff(Me.now(),e,t)}until(e){return this.isValid?mt.fromDateTimes(this,e):this}hasSame(e,t,i){if(!this.isValid)return!1;const l=e.valueOf(),s=this.setZone(e.zone,{keepLocalTime:!0});return s.startOf(t,i)<=l&&l<=s.endOf(t,i)}equals(e){return this.isValid&&e.isValid&&this.valueOf()===e.valueOf()&&this.zone.equals(e.zone)&&this.loc.equals(e.loc)}toRelative(e={}){if(!this.isValid)return null;const t=e.base||Me.fromObject({},{zone:this.zone}),i=e.padding?this<t?-e.padding:e.padding:0;let l=["years","months","days","hours","minutes","seconds"],s=e.unit;return Array.isArray(e.unit)&&(l=e.unit,s=void 0),so(t,this.plus(i),{...e,numeric:"always",units:l,unit:s})}toRelativeCalendar(e={}){return this.isValid?so(e.base||Me.fromObject({},{zone:this.zone}),this,{...e,numeric:"auto",units:["years","months","days"],calendary:!0}):null}static min(...e){if(!e.every(Me.isDateTime))throw new It("min requires all arguments be DateTimes");return Br(e,t=>t.valueOf(),Math.min)}static max(...e){if(!e.every(Me.isDateTime))throw new It("max requires all arguments be DateTimes");return Br(e,t=>t.valueOf(),Math.max)}static fromFormatExplain(e,t,i={}){const{locale:l=null,numberingSystem:s=null}=i,r=Je.fromOpts({locale:l,numberingSystem:s,defaultToEN:!0});return Xc(r,e,t)}static fromStringExplain(e,t,i={}){return Me.fromFormatExplain(e,t,i)}static buildFormatParser(e,t={}){const{locale:i=null,numberingSystem:l=null}=t,s=Je.fromOpts({locale:i,numberingSystem:l,defaultToEN:!0});return new Jc(s,e)}static fromFormatParser(e,t,i={}){if(He(e)||He(t))throw new It("fromFormatParser requires an input string and a format parser");const{locale:l=null,numberingSystem:s=null}=i,r=Je.fromOpts({locale:l,numberingSystem:s,defaultToEN:!0});if(!r.equals(t.locale))throw new It(`fromFormatParser called with a locale of ${r}, but the format parser was created for ${t.locale}`);const{result:o,zone:a,specificOffset:u,invalidReason:f}=t.explainFromTokens(e);return f?Me.invalid(f):li(o,a,i,`format ${t.format}`,e,u)}static get DATE_SHORT(){return Cl}static get DATE_MED(){return ic}static get DATE_MED_WITH_WEEKDAY(){return Rp}static get DATE_FULL(){return lc}static get DATE_HUGE(){return sc}static get TIME_SIMPLE(){return rc}static get TIME_WITH_SECONDS(){return oc}static get TIME_WITH_SHORT_OFFSET(){return ac}static get TIME_WITH_LONG_OFFSET(){return uc}static get TIME_24_SIMPLE(){return fc}static get TIME_24_WITH_SECONDS(){return cc}static get TIME_24_WITH_SHORT_OFFSET(){return dc}static get TIME_24_WITH_LONG_OFFSET(){return pc}static get DATETIME_SHORT(){return mc}static get DATETIME_SHORT_WITH_SECONDS(){return hc}static get DATETIME_MED(){return _c}static get DATETIME_MED_WITH_SECONDS(){return gc}static get DATETIME_MED_WITH_WEEKDAY(){return Hp}static get DATETIME_FULL(){return bc}static get DATETIME_FULL_WITH_SECONDS(){return wc}static get DATETIME_HUGE(){return yc}static get DATETIME_HUGE_WITH_SECONDS(){return vc}}function Ri(n){if(Me.isDateTime(n))return n;if(n&&n.valueOf&&En(n.valueOf()))return Me.fromJSDate(n);if(n&&typeof n=="object")return Me.fromObject(n);throw new It(`Unknown datetime argument: ${n}, of type ${typeof n}`)}const hl=[],Dh="abcdefghijklmnopqrstuvwxyz0123456789";class K{static isObject(e){return e!==null&&typeof e=="object"&&e.constructor===Object}static isEmpty(e){return typeof e>"u"||e===null||e===""||e==="00000000-0000-0000-0000-000000000000"||e==="0001-01-01 00:00:00.000Z"||e==="0001-01-01"||Array.isArray(e)&&e.length===0||K.isObject(e)&&Object.keys(e).length===0}static isInput(e){let t=e&&e.tagName?e.tagName.toLowerCase():"";return t==="input"||t==="select"||t==="textarea"||e.isContentEditable}static isFocusable(e){let t=e&&e.tagName?e.tagName.toLowerCase():"";return K.isInput(e)||t==="button"||t==="a"||t==="details"||e.tabIndex>=0}static toArray(e,t=!1){return Array.isArray(e)?e.slice():(t||!K.isEmpty(e))&&typeof e<"u"?[e]:[]}static inArray(e,t){e=Array.isArray(e)?e:[];for(let i=e.length-1;i>=0;i--)if(e[i]==t)return!0;return!1}static removeByValue(e,t){e=Array.isArray(e)?e:[];for(let i=e.length-1;i>=0;i--)if(e[i]==t){e.splice(i,1);break}}static pushUnique(e,t){K.inArray(e,t)||e.push(t)}static findByKey(e,t,i){e=Array.isArray(e)?e:[];for(let l in e)if(e[l][t]==i)return e[l];return null}static removeByKey(e,t,i){for(let l in e)e[l][t]==i&&e.splice(l,1)}static pushOrReplaceObject(e,t,i="id"){for(let l=e.length-1;l>=0;l--)if(e[l][i]==t[i]){e[l]=t;return}e.push(t)}static filterDuplicatesByKey(e,t="id"){e=Array.isArray(e)?e:[];const i={};for(const l of e)i[l[t]]=l;return Object.values(i)}static getNestedVal(e,t,i=null,l="."){let s=e||{},r=(t||"").split(l);for(const o of r){if(!K.isObject(s)&&!Array.isArray(s)||typeof s[o]>"u")return i;s=s[o]}return s}static setByPath(e,t,i,l="."){if(e===null||typeof e!="object"){console.warn("setByPath: data not an object or array.");return}let s=e,r=t.split(l),o=r.pop();for(const a of r)(!K.isObject(s)&&!Array.isArray(s)||!K.isObject(s[a])&&!Array.isArray(s[a]))&&(s[a]={}),s=s[a];s[o]=i}static deleteByPath(e,t,i="."){let l=e||{},s=(t||"").split(i),r=s.pop();for(const o of s)(!K.isObject(l)&&!Array.isArray(l)||!K.isObject(l[o])&&!Array.isArray(l[o]))&&(l[o]={}),l=l[o];Array.isArray(l)?l.splice(r,1):K.isObject(l)&&delete l[r],s.length>0&&(Array.isArray(l)&&!l.length||K.isObject(l)&&!Object.keys(l).length)&&(Array.isArray(e)&&e.length>0||K.isObject(e)&&Object.keys(e).length>0)&&K.deleteByPath(e,s.join(i),i)}static randomString(e=8,t=Dh){let i="";for(let l=0;l<e;l++)i+=t.charAt(Math.floor(Math.random()*t.length));return i}static sentenize(e,t=!0){if(typeof e!="string")return"";if(e=e.trim().split("_").join(" "),e==="")return e;if(e=e[0].toUpperCase()+e.substring(1),t){let i=e[e.length-1];i!=="."&&i!=="?"&&i!=="!"&&(e+=".")}return e}static splitNonEmpty(e,t=","){const i=(e||"").split(t),l=[];for(let s of i)s=s.trim(),K.isEmpty(s)||l.push(s);return l}static joinNonEmpty(e,t=", "){const i=[];for(let l of e)l=typeof l=="string"?l.trim():"",K.isEmpty(l)||i.push(l);return i.join(t)}static getInitials(e){if(e=(e||"").split("@")[0].trim(),e.length<=2)return e.toUpperCase();const t=e.split(/[\.\_\-\ ]/);return t.length>=2?(t[0][0]+t[1][0]).toUpperCase():e[0].toUpperCase()}static getWordInfoAt(e,t){let i=e.replace(/(\r\n|\n|\r)/gm," ").split(" "),l=0,s=0,r=0;for(let o=0;o<i.length;o++){if(s=l+o,r=s+i[o].length-1,t>=s&&t<=r)return{start:s,end:r,word:i[o]};l+=i[o].length}return{}}static getDateTime(e){if(typeof e=="string"){const t={19:"yyyy-MM-dd HH:mm:ss",23:"yyyy-MM-dd HH:mm:ss.SSS",20:"yyyy-MM-dd HH:mm:ss'Z'",24:"yyyy-MM-dd HH:mm:ss.SSS'Z'"},i=t[e.length]||t[19];return Me.fromFormat(e,i,{zone:"UTC"})}return Me.fromJSDate(e)}static formatToUTCDate(e,t="yyyy-MM-dd HH:mm:ss"){return K.getDateTime(e).toUTC().toFormat(t)}static formatToLocalDate(e,t="yyyy-MM-dd HH:mm:ss"){return K.getDateTime(e).toLocal().toFormat(t)}static relativeDate(e){return K.getDateTime(e).toRelative()}static async copyToClipboard(e){var t;if(e=""+e,!(!e.length||!((t=window==null?void 0:window.navigator)!=null&&t.clipboard)))return window.navigator.clipboard.writeText(e).catch(i=>{console.warn("Failed to copy.",i)})}static yieldToMain(){return new Promise(e=>{setTimeout(e,0)})}static isDesktopPrototype(e){return e.size==""}static getPrototypeIcon(e){return K.isDesktopPrototype(e)?"iconoir-modern-tv":"iconoir-smartphone-device"}static getUserDisplayName(e){return(e==null?void 0:e.name)||(e==null?void 0:e.email)||(e!=null&&e.username?"@"+(e==null?void 0:e.username):e==null?void 0:e.id)||""}static getCommentAuthor(e){var t;return K.getUserDisplayName((t=e==null?void 0:e.expand)==null?void 0:t.user)||(e==null?void 0:e.guestEmail)||""}static sortItemsByIds(e,t){e=e||[],t=t||[];const i=[];for(const l of t){const s=e.findIndex(r=>r.id==l);s<0||(i.push(e[s]),e.splice(s,1))}for(let l of e)i.push(l);return i}static triggerEvent(e){window.dispatchEvent(new Event(e))}static getHashQueryParams(){let e="";const t=window.location.hash.indexOf("?");return t>-1&&(e=window.location.hash.substring(t+1)),Object.fromEntries(new URLSearchParams(e))}static replaceHashQueryParams(e){e=e||{};let t="",i=window.location.hash;const l=i.indexOf("?");l>-1&&(t=i.substring(l+1),i=i.substring(0,l));const s=new URLSearchParams(t);for(let a in e){const u=e[a];u===null?s.delete(a):s.set(a,u)}t=s.toString(),t!=""&&(i+="?"+t);let r=window.location.href;const o=r.indexOf("#");o>-1&&(r=r.substring(0,o)),window.location.replace(r+i)}static getProjectLinkURL(e){let t=window.location.pathname.replace(/\/$/,"");const i=t.split("/");return i[i.length-1]=="_"&&(t=i.slice(0,i.length-1).join("/")),window.location.origin+t+"/#/"+((e==null?void 0:e.username)||"")}static generateThumb(e,t=100,i=100){return new Promise(l=>{let s=new FileReader;s.onload=function(r){let o=new Image;o.onload=function(){let a=document.createElement("canvas"),u=a.getContext("2d"),f=o.width,c=o.height;return a.width=t,a.height=i,u.drawImage(o,f>c?(f-c)/2:0,0,f>c?c:f,f>c?c:f,0,0,t,i),l(a.toDataURL(e.type))},o.src=r.target.result},s.readAsDataURL(e)})}static loadImage(e){return new Promise((t,i)=>{if(hl[e])return t({success:!0,url:e,width:hl[e].width,height:hl[e].height});let l=new Image;l.onload=()=>(hl[e]={width:l.naturalWidth,height:l.naturalHeight},t({success:!0,url:e,width:l.naturalWidth,height:l.naturalHeight})),l.onerror=()=>t({success:!1,url:e,width:0,height:0}),l.crossOrigin="Anonymous",l.src=e})}static closestFeatureEdge(e,t={},i=5){t.x=(t.x||0)<<0,t.y=(t.y||0)<<0,t.w=(t.w||e.naturalWidth)<<0,t.h=(t.h||e.naturalHeight)<<0;let l=document.createElement("canvas");l.width=t.w,l.height=t.h;let s=l.getContext("2d");s.fillStyle="white",s.fillRect(0,0,t.w,t.h),s.drawImage(e,t.x,t.y,t.w,t.h,0,0,t.w,t.h);let r=s.getImageData(0,0,t.w,t.h);for(let c=0;c<r.height;c++)for(let d=0;d<r.width;d++){let m=(d+c*r.width)*4,h=(r.data[m]+r.data[m+1]+r.data[m+2])/3;r.data[m]=h,r.data[m+1]=h,r.data[m+2]=h}let o=t.w,a=0,u=t.h,f=0;for(let c=0;c<r.height;c++)for(let d=0;d<r.width;d++){let m=(d+c*r.width)*4,h=r.data[m],_=r.data[m-4],b=r.data[m],g=r.data[m-t.w*4],T=r.data[m+t.w*4];(h>_+i||h<_-i||h>b+i||h<b-i||h>g+i||h<g-i||h>T+i||h<T-i)&&(d<o&&(o=d),d>a&&(a=d),c<u&&(u=c),c>f&&(f=c))}return o=o<t.w?o:0,u=u<t.h?u:0,a=a||t.w,f=f||t.h,{x:o,y:u,w:a-o,h:f-u}}static normalizePointerEvent(e){var t,i,l,s,r,o,a,u;typeof e.clientX>"u"&&typeof((i=(t=e.touches)==null?void 0:t[0])==null?void 0:i.clientX)<"u"&&(e.clientX=e.touches[0].clientX),typeof e.clientY>"u"&&typeof((s=(l=e.touches)==null?void 0:l[0])==null?void 0:s.clientY)<"u"&&(e.clientY=e.touches[0].clientY),typeof e.offsetX>"u"&&typeof((o=(r=e.touches)==null?void 0:r[0])==null?void 0:o.pageX)<"u"&&e.target&&(e.offsetX=e.touches[0].pageX-e.target.getBoundingClientRect().left),typeof e.offsetY>"u"&&typeof((u=(a=e.touches)==null?void 0:a[0])==null?void 0:u.pageY)<"u"&&e.target&&(e.offsetY=e.touches[0].pageY-e.target.getBoundingClientRect().top||0)}}const Zl=Fe([]);function _t(n,e=3e3){return Xs(n,"success",e)}function Gs(n,e=4e3){return Xs(n,"error",e)}function Js(n,e=4500){return Xs(n,"warning",e)}function Xs(n,e,t){t=t||4e3;const i={message:n,type:e,duration:t,timeout:setTimeout(()=>{nd(i)},t)};Zl.update(l=>(Qs(l,i.message),K.pushOrReplaceObject(l,i,"message"),l))}function nd(n){Zl.update(e=>(Qs(e,n),e))}function Ji(){Zl.update(n=>{for(let e of n)Qs(n,e);return[]})}function Qs(n,e){let t;typeof e=="string"?t=K.findByKey(n,"message",e):t=e,t&&(clearTimeout(t.timeout),K.removeByKey(n,"message",t.message))}const Yl=Fe({});function Jt(n){Yl.set(n||{})}function Mh(n){Yl.update(e=>(K.deleteByPath(e,n),e))}const xn=Fe({});function oo(n){xn.set(n||{})}const vi=Rh();function Rh(n="appOptions"){let e={};const t=window.localStorage.getItem(n);if(t)try{e=JSON.parse(t)||{},e.appURL=e.appURL||e.appUrl||"",e.termsURL=e.termsURL||e.termsUrl||"",e.allowHotspotsURL=e.allowHotspotsURL||e.allowHotspotsUrl||"",delete e.appUrl,delete e.termsUrl,delete e.allowHotspotsUrl}catch{}const i=[],l=o=>(i.push(o),o(e),()=>{const a=i.findIndex(u=>u===o);a>=0&&i.splice(a,1)}),s=o=>{e=o||{},window.localStorage.setItem(n,JSON.stringify(e)),i.forEach(a=>a(e))};return{subscribe:l,set:s,update:o=>s(o(e))}}const Ts="pr_redirect";bn.prototype.rememberPath=function(){window.localStorage.setItem(Ts,window.location.hash.slice(1))};bn.prototype.replaceWithRemembered=function(n="/"){const e=window.localStorage.getItem(Ts);e&&window.localStorage.removeItem(Ts),Yt(e||n)};bn.prototype.logout=function(n=!0){this.authStore.clear(),n&&Yt("/login")};bn.prototype.error=function(n,e=!0,t=""){if(!n||!(n instanceof Error)||n.isAbort)return;const i=(n==null?void 0:n.status)<<0,l=(n==null?void 0:n.response)||{};let s=e&&(l.message||n.message||t);if(s&&Gs(s),i==0&&console.log(n),K.isEmpty(l.data)||Jt(l.data),i===401)return this.rememberPath(),this.cancelAllRequests(),this.logout();if(i===403)return this.rememberPath(),this.cancelAllRequests(),Yt("/login")};bn.prototype.initStore=function(n=""){const e="pr_user_auth"+n;this.authStore.storageKey!=e&&(this.authStore=new Hh(e))};class Hh extends Qf{constructor(e="pr_user_auth"){super(e),this.save(this.token,this.record)}save(e,t){super.save(e,t),t&&t.collectionName=="users"&&oo(t)}clear(){var e;((e=this.record)==null?void 0:e.collectionName)=="users"&&oo(null),super.clear()}}const V=new bn("");V.initStore();if(V.authStore.isValid){const n=new bn(V.baseURL,V.authStore);n.collection(n.authStore.record.collectionName).authRefresh().catch(e=>{console.warn("Failed to refresh the authenticated record",e);const t=(e==null?void 0:e.status)<<0;(t==401||t==403)&&(n.rememberPath(),n.authStore.clear(),Yt("/login"))})}function Uh(n){const e=new bn(V.baseURL);return e.initStore(n),e}function qh(n){e();function e(){V.authStore.isValid?Yt("/projects"):V.logout()}return[]}class $h extends ve{constructor(e){super(),ye(this,e,qh,null,_e,{})}}function ao(n){let e;return{c(){e=w("span"),e.textContent="Presentator",p(e,"class","txt")},m(t,i){k(t,e,i)},d(t){t&&v(e)}}}function Fh(n){let e,t,i,l,s,r,o,a=n[0]&&ao();return{c(){e=w("a"),t=w("img"),l=I(),a&&a.c(),Zn(t.src,i="./images/logo.svg")||p(t,"src",i),p(t,"width","30"),p(t,"height","37"),p(t,"alt","Presentator logo"),p(e,"href","/"),p(e,"class",s="app-logo "+n[1]),p(e,"draggable","false")},m(u,f){k(u,e,f),y(e,t),y(e,l),a&&a.m(e,null),r||(o=be(Oi.call(null,e)),r=!0)},p(u,[f]){u[0]?a||(a=ao(),a.c(),a.m(e,null)):a&&(a.d(1),a=null),f&2&&s!==(s="app-logo "+u[1])&&p(e,"class",s)},i:Q,o:Q,d(u){u&&v(e),a&&a.d(),r=!1,o()}}}function Wh(n,e,t){let{withText:i=!0}=e,{class:l=""}=e;return n.$$set=s=>{"withText"in s&&t(0,i=s.withText),"class"in s&&t(1,l=s.class)},[i,l]}class xs extends ve{constructor(e){super(),ye(this,e,Wh,Fh,_e,{withText:0,class:1})}}function er(n){const e=n-1;return e*e*e+1}function Os(n,{delay:e=0,duration:t=400,easing:i=Qi}={}){const l=+getComputedStyle(n).opacity;return{delay:e,duration:t,easing:i,css:s=>`opacity: ${s*l}`}}function Pn(n,{delay:e=0,duration:t=400,easing:i=er,x:l=0,y:s=0,opacity:r=0}={}){const o=getComputedStyle(n),a=+o.opacity,u=o.transform==="none"?"":o.transform,f=a*(1-r),[c,d]=yr(l),[m,h]=yr(s);return{delay:e,duration:t,easing:i,css:(_,b)=>`
			transform: ${u} translate(${(1-_)*c}${d}, ${(1-_)*m}${h});
			opacity: ${a-f*b}`}}function Et(n,{delay:e=0,duration:t=400,easing:i=er,axis:l="y"}={}){const s=getComputedStyle(n),r=+s.opacity,o=l==="y"?"height":"width",a=parseFloat(s[o]),u=l==="y"?["top","bottom"]:["left","right"],f=u.map(g=>`${g[0].toUpperCase()}${g.slice(1)}`),c=parseFloat(s[`padding${f[0]}`]),d=parseFloat(s[`padding${f[1]}`]),m=parseFloat(s[`margin${f[0]}`]),h=parseFloat(s[`margin${f[1]}`]),_=parseFloat(s[`border${f[0]}Width`]),b=parseFloat(s[`border${f[1]}Width`]);return{delay:e,duration:t,easing:i,css:g=>`overflow: hidden;opacity: ${Math.min(g*20,1)*r};${o}: ${g*a}px;padding-${u[0]}: ${g*c}px;padding-${u[1]}: ${g*d}px;margin-${u[0]}: ${g*m}px;margin-${u[1]}: ${g*h}px;border-${u[0]}-width: ${g*_}px;border-${u[1]}-width: ${g*b}px;`}}function uo(n){let e,t,i;const l=n[21].default,s=st(l,n,n[20],null);return{c(){e=w("div"),s&&s.c(),p(e,"class",n[1]),B(e,"active",n[0])},m(r,o){k(r,e,o),s&&s.m(e,null),n[22](e),i=!0},p(r,o){s&&s.p&&(!i||o[0]&1048576)&&ot(s,l,r,r[20],i?rt(l,r[20],o,null):at(r[20]),null),(!i||o[0]&2)&&p(e,"class",r[1]),(!i||o[0]&3)&&B(e,"active",r[0])},i(r){i||(E(s,r),r&&kt(()=>{i&&(t||(t=ct(e,Pn,{duration:150,y:3},!0)),t.run(1))}),i=!0)},o(r){j(s,r),r&&(t||(t=ct(e,Pn,{duration:150,y:3},!1)),t.run(0)),i=!1},d(r){r&&v(e),s&&s.d(r),n[22](null),r&&t&&t.end()}}}function Vh(n){let e,t,i,l,s=n[0]&&uo(n);return{c(){e=w("div"),s&&s.c(),p(e,"class","toggler-container"),p(e,"tabindex","-1")},m(r,o){k(r,e,o),s&&s.m(e,null),n[23](e),t=!0,i||(l=[H(window,"mousedown",n[5]),H(window,"click",n[6]),H(window,"keydown",n[4]),H(window,"focusin",n[7])],i=!0)},p(r,o){r[0]?s?(s.p(r,o),o[0]&1&&E(s,1)):(s=uo(r),s.c(),E(s,1),s.m(e,null)):s&&(ae(),j(s,1,1,()=>{s=null}),ue())},i(r){t||(E(s),t=!0)},o(r){j(s),t=!1},d(r){r&&v(e),s&&s.d(),n[23](null),i=!1,me(l)}}}function zh(n,e,t){let{$$slots:i={},$$scope:l}=e,{trigger:s=void 0}=e,{active:r=!1}=e,{escHide:o=!0}=e,{focusHide:a=!0}=e,{autoScroll:u=!0}=e,{disableHide:f=!1}=e,{closableClass:c="closable"}=e,{closableToggle:d=!0}=e,{class:m=""}=e,h,_,b,g,T=!1;const L=it();function O(){f||C()}function C(){t(0,r=!1),T=!1,clearTimeout(g)}function S(){t(0,r=!0),clearTimeout(g),g=setTimeout(()=>{u&&(_!=null&&_.scrollIntoViewIfNeeded?_==null||_.scrollIntoViewIfNeeded():_!=null&&_.scrollIntoView&&(_==null||_.scrollIntoView({behavior:"smooth",block:"nearest"})))},180)}function P(){r?O():S()}function R(U){return!h||U.classList.contains(c)||(b==null?void 0:b.contains(U))&&!h.contains(U)||h.contains(U)&&U.closest&&U.closest("."+c)}function A(U){(!r||d&&R(U.target))&&(U.stopPropagation(),P())}function D(U){(U.code==="Enter"||U.code==="Space")&&(!r||R(U.target))&&P()}function M(U){r&&o&&U.code==="Escape"&&!K.isInput(U.target)&&(U.preventDefault(),O())}function Z(U){r&&!(h!=null&&h.contains(U.target))?T=!0:T&&(T=!1)}function Y(U){r&&T&&!(h!=null&&h.contains(U.target))&&!(b!=null&&b.contains(U.target))&&O()}function z(U){a&&(Z(U),Y(U))}function N(U){W(),h==null||h.addEventListener("click",A),t(19,b=U||(h==null?void 0:h.parentNode)),b==null||b.addEventListener("click",A),b==null||b.addEventListener("keydown",D)}function W(){var U;clearTimeout(g),h==null||h.removeEventListener("click",A),(U=b==null?void 0:b.classList)==null||U.remove("active"),b==null||b.removeEventListener("click",A),b==null||b.removeEventListener("keydown",D)}gn(()=>(N(),()=>W()));function ne(U){le[U?"unshift":"push"](()=>{_=U,t(3,_)})}function X(U){le[U?"unshift":"push"](()=>{h=U,t(2,h)})}return n.$$set=U=>{"trigger"in U&&t(8,s=U.trigger),"active"in U&&t(0,r=U.active),"escHide"in U&&t(9,o=U.escHide),"focusHide"in U&&t(10,a=U.focusHide),"autoScroll"in U&&t(11,u=U.autoScroll),"disableHide"in U&&t(12,f=U.disableHide),"closableClass"in U&&t(13,c=U.closableClass),"closableToggle"in U&&t(14,d=U.closableToggle),"class"in U&&t(1,m=U.class),"$$scope"in U&&t(20,l=U.$$scope)},n.$$.update=()=>{var U,de;n.$$.dirty[0]&260&&h&&N(s),n.$$.dirty[0]&524289&&(r?((U=b==null?void 0:b.classList)==null||U.add("active"),L("show")):((de=b==null?void 0:b.classList)==null||de.remove("active"),L("hide")))},[r,m,h,_,M,Z,Y,z,s,o,a,u,f,c,d,O,C,S,P,b,l,i,ne,X]}class Rt extends ve{constructor(e){super(),ye(this,e,zh,Vh,_e,{trigger:8,active:0,escHide:9,focusHide:10,autoScroll:11,disableHide:12,closableClass:13,closableToggle:14,class:1,hide:15,forceHide:16,show:17,toggle:18},null,[-1,-1])}get hide(){return this.$$.ctx[15]}get forceHide(){return this.$$.ctx[16]}get show(){return this.$$.ctx[17]}get toggle(){return this.$$.ctx[18]}}const Bh=n=>({}),fo=n=>({});function Zh(n){let e;const t=n[6].placeholder,i=st(t,n,n[5],fo),l=i||Jh(n);return{c(){l&&l.c()},m(s,r){l&&l.m(s,r),e=!0},p(s,r){i?i.p&&(!e||r&32)&&ot(i,t,s,s[5],e?rt(t,s[5],r,Bh):at(s[5]),fo):l&&l.p&&(!e||r&1)&&l.p(s,e?r:-1)},i(s){e||(E(l,s),e=!0)},o(s){j(l,s),e=!1},d(s){l&&l.d(s)}}}function Yh(n){let e,t,i;return{c(){var l,s;e=w("img"),Zn(e.src,t=n[2])||p(e,"src",t),p(e,"draggable","false"),p(e,"alt",i=(((l=n[0])==null?void 0:l.name)||((s=n[0])==null?void 0:s.username))+" avatar")},m(l,s){k(l,e,s)},p(l,s){var r,o;s&4&&!Zn(e.src,t=l[2])&&p(e,"src",t),s&1&&i!==(i=(((r=l[0])==null?void 0:r.name)||((o=l[0])==null?void 0:o.username))+" avatar")&&p(e,"alt",i)},i:Q,o:Q,d(l){l&&v(e)}}}function Kh(n){let e;return{c(){e=w("i"),p(e,"class","iconoir-user")},m(t,i){k(t,e,i)},p:Q,d(t){t&&v(e)}}}function Gh(n){let e,t=K.getInitials(n[0].name||n[0].email)+"",i;return{c(){e=w("span"),i=te(t),p(e,"class","txt")},m(l,s){k(l,e,s),y(e,i)},p(l,s){s&1&&t!==(t=K.getInitials(l[0].name||l[0].email)+"")&&Se(i,t)},d(l){l&&v(e)}}}function Jh(n){let e;function t(s,r){var o,a;return(o=s[0])!=null&&o.name||(a=s[0])!=null&&a.email?Gh:Kh}let i=t(n),l=i(n);return{c(){l.c(),e=De()},m(s,r){l.m(s,r),k(s,e,r)},p(s,r){i===(i=t(s))&&l?l.p(s,r):(l.d(1),l=i(s),l&&(l.c(),l.m(e.parentNode,e)))},d(s){s&&v(e),l.d(s)}}}function Xh(n){let e,t,i,l,s,r;const o=[Yh,Zh],a=[];function u(h,_){return h[2]?0:1}t=u(n),i=a[t]=o[t](n);const f=n[6].default,c=st(f,n,n[5],null);let d=[{class:s="thumb thumb-circle "+n[1]},n[3]],m={};for(let h=0;h<d.length;h+=1)m=Ue(m,d[h]);return{c(){e=w("figure"),i.c(),l=I(),c&&c.c(),Kn(e,m)},m(h,_){k(h,e,_),a[t].m(e,null),y(e,l),c&&c.m(e,null),r=!0},p(h,[_]){let b=t;t=u(h),t===b?a[t].p(h,_):(ae(),j(a[b],1,1,()=>{a[b]=null}),ue(),i=a[t],i?i.p(h,_):(i=a[t]=o[t](h),i.c()),E(i,1),i.m(e,l)),c&&c.p&&(!r||_&32)&&ot(c,f,h,h[5],r?rt(f,h[5],_,null):at(h[5]),null),Kn(e,m=gt(d,[(!r||_&2&&s!==(s="thumb thumb-circle "+h[1]))&&{class:s},_&8&&h[3]]))},i(h){r||(E(i),E(c,h),r=!0)},o(h){j(i),j(c,h),r=!1},d(h){h&&v(e),a[t].d(),c&&c.d(h)}}}function Qh(n,e,t){const i=["user","file","class"];let l=ft(e,i),{$$slots:s={},$$scope:r}=e,{user:o}=e,{file:a=null}=e,{class:u=""}=e,f="";async function c(){a?t(2,f=await K.generateThumb(a)):o!=null&&o.avatar?t(2,f=V.files.getURL(o,o.avatar,{thumb:"100x100"})):t(2,f="")}return n.$$set=d=>{e=Ue(Ue({},e),Kt(d)),t(3,l=ft(e,i)),"user"in d&&t(0,o=d.user),"file"in d&&t(4,a=d.file),"class"in d&&t(1,u=d.class),"$$scope"in d&&t(5,r=d.$$scope)},n.$$.update=()=>{n.$$.dirty&17&&(a||o)&&c()},[o,u,f,l,a,r,s]}class il extends ve{constructor(e){super(),ye(this,e,Qh,Xh,_e,{user:0,file:4,class:1})}}const Cs="app-tooltip";let Es,Hn;function co(n){return typeof n=="string"?{text:n,position:"bottom",hideOnClick:null}:n||{}}function Ln(){return Hn=Hn||document.querySelector("."+Cs),Hn||(Hn=document.createElement("div"),Hn.classList.add(Cs),document.body.appendChild(Hn)),Hn}function id(n,e,t=null){let i=Ln();if(!i.classList.contains("active")||!(e!=null&&e.text)){Ls();return}i.textContent=e.text,e.sub?i.dataset.sub=e.sub:delete i.dataset.sub,i.className=Cs+" active",e.class&&i.classList.add(e.class),e.position&&i.classList.add(e.position),i.style.top="0px",i.style.left="0px";let l=i.offsetHeight,s=i.offsetWidth,r=n.getBoundingClientRect(),o=0,a=0,u=5;e.position=="follow"&&t?(o=t.clientY+u,a=t.clientX+u):e.position=="left"?(o=r.top+r.height/2-l/2,a=r.left-s-u):e.position=="right"?(o=r.top+r.height/2-l/2,a=r.right+u):e.position=="top"?(o=r.top-l-u,a=r.left+r.width/2-s/2):e.position=="top-left"?(o=r.top-l-u,a=r.left):e.position=="top-right"?(o=r.top-l-u,a=r.right-s):e.position=="bottom-left"?(o=r.top+r.height+u,a=r.left):e.position=="bottom-right"?(o=r.top+r.height+u,a=r.right-s):(o=r.top+r.height+u,a=r.left+r.width/2-s/2),a+s>document.documentElement.clientWidth&&(a=document.documentElement.clientWidth-s),a=a>=0?a:0,o+l>document.documentElement.clientHeight&&(o=document.documentElement.clientHeight-l),o=o>=0?o:0,i.style.top=o+"px",i.style.left=a+"px"}function Ls(){clearTimeout(Es),Ln().classList.remove("active"),Ln().activeNode=void 0}function xh(n,e,t){Ln().activeNode=n,clearTimeout(Es);function i(){Ln().classList.add("active"),id(n,e,t)}e.delay?Es=setTimeout(i,e.delay):i()}function Oe(n,e){let t=co(e);function i(s){xh(n,t,s)}function l(s){Ls()}return!t.noAria&&t.text&&n.setAttribute("aria-description",t.text),t.position=="follow"&&n.addEventListener("mousemove",i),n.addEventListener("mouseenter",i),n.addEventListener("mouseleave",l),n.addEventListener("focusin",i),n.addEventListener("blur",l),(t.hideOnClick===!0||t.hideOnClick===null&&K.isFocusable(n))&&n.addEventListener("click",l),Ln(),{update(s){var r,o;t=co(s),!t.noAria&&t.text?n.setAttribute("aria-description",t.text):n.removeAttribute("aria-description"),t.position=="follow"?n.addEventListener("mousemove",i):n.removeEventListener("mousemove",i),(o=(r=Ln())==null?void 0:r.activeNode)!=null&&o.contains(n)&&id(n,t)},destroy(){var s,r;(r=(s=Ln())==null?void 0:s.activeNode)!=null&&r.contains(n)&&Ls(),n.removeEventListener("mousemove",i),n.removeEventListener("mouseenter",i),n.removeEventListener("focusin",i),n.removeEventListener("mouseleave",l),n.removeEventListener("blur",l),n.removeEventListener("click",l)}}}const Ft=Fe([]),Gn=Fe(""),ui=Fe(!1);function tr(){Ft.set([]),Gn.set(""),ui.set(!1)}const Ct=Mt([Ft,Gn],([n,e])=>n.length?e&&n.find(t=>t.id==e)||n[n.length-1]:null);Ct.set=n=>{K.isObject(n)?ki(n,!0):Gn.set(n)};function ki(n,e=!1){n&&(Ft.update(t=>(K.pushOrReplaceObject(t,n),t)),e&&Gn.set(n.id))}function ld(n){n&&(Ft.update(e=>(K.removeByKey(e,"id",n.id),e)),Gn.update(e=>e==n.id?"":e))}let Wn;async function e1(n){return Wn==null||Wn(),V.collection("prototypes").subscribe("*",e=>{e.action==="delete"?ld(e.record):ki(e.record)},{filter:`project="${n}"`}).then(e=>(Wn=e,e)).catch(e=>{console.warn("failed to init prototypes subscription:",e)})}const nr=Fe({});function Pt(n,e,t){return new Promise(i=>{nr.set({text:n,yesCallback:async()=>{e&&await e(),i()},noCallback:async()=>{t&&await t(),i()}})})}function sd(){nr.set({})}const Te={preview:"preview",hotspots:"hotspots",comments:"comments"};Object.freeze(Te);const Jn=Fe(""),Xi=Fe(""),jl=Fe(""),pt=Fe([]),fi=Fe(""),Si=Fe(null),qi=Fe(!1),ji=Fe(Te.preview),Pi=Fe(!1),Bn=Fe(1),Pl=Fe(!1),Nl=Fe(!0);function ir(){sr(),pt.set([]),Xi.set(""),Jn.set(""),jl.set(""),fi.set(""),Si.set(null),qi.set(!1),Bn.set(1),Pl.set(!1),Nl.set(!0)}const Ke=Mt([pt,Jn],([n,e])=>n.length?e&&n.find(t=>t.id==e)||n[0]:null);Ke.set=n=>{Xi.set(Yn(Jn)||null),Si.set(null),K.isObject(n)?Nn(n,!0):Jn.set(n)};const rd=Mt([pt,Xi],([n,e])=>!n.length||!e?null:n.find(t=>t.id==e));rd.set=n=>{K.isObject(n)?(Nn(n),Xi.set(n.id)):Xi.set(n)};const ci=Mt([pt,jl],([n,e])=>!n.length||!e?null:n.find(t=>t.id==e));ci.set=n=>{K.isObject(n)?(Nn(n),jl.set(n.id)):jl.set(n)};function Is(n=1){const e=Yn(pt)||[];if(!e.length)return null;const t=Yn(Jn)||null;let i=e.findIndex(l=>l.id==t)+n;return i<0?i=0:i>=e.length&&(i=e.length-1),e[i]}function Cn(n=1){const e=Is(n);if(!(e!=null&&e.id))return;const t=Yn(Jn)||null;(t==null?void 0:t.id)!=e.id&&Ke.set(e.id)}function Nn(n,e=!1){n&&(pt.update(t=>(K.pushOrReplaceObject(t,n),t)),e&&Ke.set(n.id))}function js(n){n&&pt.update(e=>(K.removeByKey(e,"id",n.id),Ft.update(t=>{var l;const i=t.find(s=>s.id==n.prototype);return(l=i==null?void 0:i.screensOrder)!=null&&l.length&&K.removeByValue(i.screensOrder,i.id),t}),Jn.update(t=>t==n.id?"":t),e))}let Ut;async function lr(n){return Ut==null||Ut(),V.collection("screens").subscribe("*",e=>{e.action==="delete"?js(e.record):Nn(e.record)},{filter:`prototype="${n}"`}).then(e=>(Ut=e,e)).catch(e=>{console.warn("failed to init screens subscription:",e)})}function Al(n){var t,i;if(!(n!=null&&n.id))return 0;let e=(i=(t=Yn(Ct))==null?void 0:t.screensOrder)==null?void 0:i.indexOf(n.id);return e<0&&(e=Yn(pt).findIndex(l=>l.id==n.id)),e+1}const od="fitToScreen";function ad(){Pi.update(n=>(n=!n,window.localStorage.setItem(od,n?1:0),K.replaceHashQueryParams({fit:n?1:0}),n))}function ud(){const n=K.getHashQueryParams();let e=typeof n.fit<"u"?n.fit:window.localStorage.getItem(od);e=!!(e<<0),Pi.set(e),K.replaceHashQueryParams({fit:e?1:0})}function sr(){const n=K.getHashQueryParams();zt(n.mode)}function zt(n){(!n||!Te[n])&&(n=Te.preview),ji.set(n),K.replaceHashQueryParams({mode:n})}async function rr(n,e){return Pt("Screen replacement could result in hotspots and comments misplacement if the new screen image has different dimensions from the original. Do you still want to proceed?",async()=>t1(n,e))}async function t1(n,e){if(!e||!(n!=null&&n.id)||n.isReplacing)return;n.isReplacing=!0;const t=new FormData;t.append("file",e),t.append("title",e.name.split(".").slice(0,-1).join(".")||e.name);try{const i=await V.collection("screens").update(n.id,t,{requestKey:"replace"+n.id});n.isReplacing=!1,Nn(i)}catch(i){i.isAbort||(n.isReplacing=!1,V.error(i))}}const wn=Fe([]),or=Mt([Ke,wn],([n,e])=>n!=null&&n.id?e.filter(t=>{var i,l;return((l=(i=t.expand)==null?void 0:i.comment)==null?void 0:l.screen)==n.id}):[]);function ar(n){wn.update(e=>(K.removeByKey(e,"id",(n==null?void 0:n.id)||n),e))}function n1(n){n.read||wn.update(e=>(K.pushOrReplaceObject(e,n),e))}const fd="comment.screen.prototype.project,comment.user";async function i1(){try{const n=await V.collection("notifications").getFullList({filter:"read=false",expand:fd});return wn.set(n),l1()}catch(n){n.isAbort||console.warn("loadNotifications:",n)}}let Vn;async function l1(){return Vn==null||Vn(),V.collection("notifications").subscribe("*",async n=>{n.action=="delete"||n.record.read?ar(n.record):n1(n.record)},{expand:fd}).then(n=>(Vn=n,n)).catch(n=>{n.isAbort||console.log("notifications subscription failed:",n)})}const s1=n=>({}),po=n=>({});function mo(n,e,t){const i=n.slice();return i[51]=e[t],i}const r1=n=>({}),ho=n=>({});function _o(n,e,t){const i=n.slice();return i[51]=e[t],i[55]=t,i}function go(n){let e,t,i;return{c(){e=w("div"),t=te(n[2]),i=I(),p(e,"class","block txt-placeholder"),B(e,"link-hint",!n[5]&&!n[6])},m(l,s){k(l,e,s),y(e,t),y(e,i)},p(l,s){s[0]&4&&Se(t,l[2]),s[0]&96&&B(e,"link-hint",!l[5]&&!l[6])},d(l){l&&v(e)}}}function o1(n){let e,t=n[51]+"",i;return{c(){e=w("span"),i=te(t),p(e,"class","txt")},m(l,s){k(l,e,s),y(e,i)},p(l,s){s[0]&1&&t!==(t=l[51]+"")&&Se(i,t)},i:Q,o:Q,d(l){l&&v(e)}}}function a1(n){let e,t,i;const l=[{item:n[51]},n[12]];var s=n[11];function r(o,a){let u={};for(let f=0;f<l.length;f+=1)u=Ue(u,l[f]);return a!==void 0&&a[0]&4097&&(u=Ue(u,gt(l,[a[0]&1&&{item:o[51]},a[0]&4096&&Nt(o[12])]))),{props:u}}return s&&(e=jn(s,r(n))),{c(){e&&F(e.$$.fragment),t=De()},m(o,a){e&&q(e,o,a),k(o,t,a),i=!0},p(o,a){if(a[0]&2048&&s!==(s=o[11])){if(e){ae();const u=e;j(u.$$.fragment,1,0,()=>{$(u,1)}),ue()}s?(e=jn(s,r(o,a)),F(e.$$.fragment),E(e.$$.fragment,1),q(e,t.parentNode,t)):e=null}else if(s){const u=a[0]&4097?gt(l,[a[0]&1&&{item:o[51]},a[0]&4096&&Nt(o[12])]):{};e.$set(u)}},i(o){i||(e&&E(e.$$.fragment,o),i=!0)},o(o){e&&j(e.$$.fragment,o),i=!1},d(o){o&&v(t),e&&$(e,o)}}}function bo(n){let e,t,i;function l(){return n[38](n[51])}return{c(){e=w("span"),e.innerHTML='<i class="iconoir-xmark"></i>',p(e,"class","clear")},m(s,r){k(s,e,r),t||(i=[be(Oe.call(null,e,"Clear")),H(e,"click",Ze(we(l)))],t=!0)},p(s,r){n=s},d(s){s&&v(e),t=!1,me(i)}}}function wo(n){let e,t,i,l,s,r;const o=[a1,o1],a=[];function u(c,d){return c[11]?0:1}t=u(n),i=a[t]=o[t](n);let f=(n[4]||n[9])&&bo(n);return{c(){e=w("div"),i.c(),l=I(),f&&f.c(),s=I(),p(e,"class","option")},m(c,d){k(c,e,d),a[t].m(e,null),y(e,l),f&&f.m(e,null),y(e,s),r=!0},p(c,d){let m=t;t=u(c),t===m?a[t].p(c,d):(ae(),j(a[m],1,1,()=>{a[m]=null}),ue(),i=a[t],i?i.p(c,d):(i=a[t]=o[t](c),i.c()),E(i,1),i.m(e,l)),c[4]||c[9]?f?f.p(c,d):(f=bo(c),f.c(),f.m(e,s)):f&&(f.d(1),f=null)},i(c){r||(E(i),r=!0)},o(c){j(i),r=!1},d(c){c&&v(e),a[t].d(),f&&f.d()}}}function yo(n){let e,t,i;function l(r){n[44](r)}let s={class:"dropdown dropdown-block options-dropdown "+n[8]+" "+(n[7]?"dropdown-upside":""),trigger:n[21],$$slots:{default:[c1]},$$scope:{ctx:n}};return n[22]!==void 0&&(s.active=n[22]),e=new Rt({props:s}),n[43](e),le.push(()=>Ae(e,"active",l)),e.$on("show",n[28]),e.$on("hide",n[45]),{c(){F(e.$$.fragment)},m(r,o){q(e,r,o),i=!0},p(r,o){const a={};o[0]&384&&(a.class="dropdown dropdown-block options-dropdown "+r[8]+" "+(r[7]?"dropdown-upside":"")),o[0]&2097152&&(a.trigger=r[21]),o[0]&25486346|o[1]&65536&&(a.$$scope={dirty:o,ctx:r}),!t&&o[0]&4194304&&(t=!0,a.active=r[22],Ne(()=>t=!1)),e.$set(a)},i(r){i||(E(e.$$.fragment,r),i=!0)},o(r){j(e.$$.fragment,r),i=!1},d(r){n[43](null),$(e,r)}}}function vo(n){let e,t,i,l,s,r,o,a,u=n[18].length&&ko(n);return{c(){e=w("div"),t=w("label"),i=w("div"),i.innerHTML='<i class="iconoir-search"></i>',l=I(),s=w("input"),r=I(),u&&u.c(),p(i,"class","addon"),s.autofocus=!0,p(s,"type","text"),p(s,"placeholder",n[3]),p(t,"class","field-group"),p(e,"class","form-field form-field-sm options-search")},m(f,c){k(f,e,c),y(e,t),y(t,i),y(t,l),y(t,s),ge(s,n[18]),y(t,r),u&&u.m(t,null),s.focus(),o||(a=H(s,"input",n[40]),o=!0)},p(f,c){c[0]&8&&p(s,"placeholder",f[3]),c[0]&262144&&s.value!==f[18]&&ge(s,f[18]),f[18].length?u?u.p(f,c):(u=ko(f),u.c(),u.m(t,null)):u&&(u.d(1),u=null)},d(f){f&&v(e),u&&u.d(),o=!1,a()}}}function ko(n){let e,t,i,l;return{c(){e=w("div"),t=w("button"),t.innerHTML='<i class="iconoir-xmark"></i>',p(t,"type","button"),p(t,"class","btn btn-xs btn-circle btn-hint btn-transparent clear"),p(e,"class","addon suffix")},m(s,r){k(s,e,r),y(e,t),i||(l=H(t,"click",Ze(we(n[25]))),i=!0)},p:Q,d(s){s&&v(e),i=!1,l()}}}function So(n){let e,t=n[1]&&To(n);return{c(){t&&t.c(),e=De()},m(i,l){t&&t.m(i,l),k(i,e,l)},p(i,l){i[1]?t?t.p(i,l):(t=To(i),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},d(i){i&&v(e),t&&t.d(i)}}}function To(n){let e,t;return{c(){e=w("div"),t=te(n[1]),p(e,"class","txt-missing")},m(i,l){k(i,e,l),y(e,t)},p(i,l){l[0]&2&&Se(t,i[1])},d(i){i&&v(e)}}}function u1(n){let e=n[51]+"",t;return{c(){t=te(e)},m(i,l){k(i,t,l)},p(i,l){l[0]&16777216&&e!==(e=i[51]+"")&&Se(t,e)},i:Q,o:Q,d(i){i&&v(t)}}}function f1(n){let e,t,i;const l=[{item:n[51]},n[14]];var s=n[13];function r(o,a){let u={};for(let f=0;f<l.length;f+=1)u=Ue(u,l[f]);return a!==void 0&&a[0]&16793600&&(u=Ue(u,gt(l,[a[0]&16777216&&{item:o[51]},a[0]&16384&&Nt(o[14])]))),{props:u}}return s&&(e=jn(s,r(n))),{c(){e&&F(e.$$.fragment),t=De()},m(o,a){e&&q(e,o,a),k(o,t,a),i=!0},p(o,a){if(a[0]&8192&&s!==(s=o[13])){if(e){ae();const u=e;j(u.$$.fragment,1,0,()=>{$(u,1)}),ue()}s?(e=jn(s,r(o,a)),F(e.$$.fragment),E(e.$$.fragment,1),q(e,t.parentNode,t)):e=null}else if(s){const u=a[0]&16793600?gt(l,[a[0]&16777216&&{item:o[51]},a[0]&16384&&Nt(o[14])]):{};e.$set(u)}},i(o){i||(e&&E(e.$$.fragment,o),i=!0)},o(o){e&&j(e.$$.fragment,o),i=!1},d(o){o&&v(t),e&&$(e,o)}}}function Oo(n){let e,t,i,l,s,r,o;const a=[f1,u1],u=[];function f(m,h){return m[13]?0:1}t=f(n),i=u[t]=a[t](n);function c(...m){return n[41](n[51],...m)}function d(...m){return n[42](n[51],...m)}return{c(){e=w("div"),i.c(),l=I(),p(e,"tabindex","0"),p(e,"class","dropdown-item option"),B(e,"closable",n[10]),B(e,"selected",n[23](n[51]))},m(m,h){k(m,e,h),u[t].m(e,null),y(e,l),s=!0,r||(o=[H(e,"click",c),H(e,"keydown",d)],r=!0)},p(m,h){n=m;let _=t;t=f(n),t===_?u[t].p(n,h):(ae(),j(u[_],1,1,()=>{u[_]=null}),ue(),i=u[t],i?i.p(n,h):(i=u[t]=a[t](n),i.c()),E(i,1),i.m(e,l)),(!s||h[0]&1024)&&B(e,"closable",n[10]),(!s||h[0]&25165824)&&B(e,"selected",n[23](n[51]))},i(m){s||(E(i),s=!0)},o(m){j(i),s=!1},d(m){m&&v(e),u[t].d(),r=!1,me(o)}}}function c1(n){let e,t,i,l,s,r=n[15]&&vo(n);const o=n[37].beforeOptions,a=st(o,n,n[47],ho);let u=Le(n[24]),f=[];for(let _=0;_<u.length;_+=1)f[_]=Oo(mo(n,u,_));const c=_=>j(f[_],1,1,()=>{f[_]=null});let d=null;u.length||(d=So(n));const m=n[37].afterOptions,h=st(m,n,n[47],po);return{c(){r&&r.c(),e=I(),a&&a.c(),t=I(),i=w("div");for(let _=0;_<f.length;_+=1)f[_].c();d&&d.c(),l=I(),h&&h.c(),p(i,"class","options-list")},m(_,b){r&&r.m(_,b),k(_,e,b),a&&a.m(_,b),k(_,t,b),k(_,i,b);for(let g=0;g<f.length;g+=1)f[g]&&f[g].m(i,null);d&&d.m(i,null),k(_,l,b),h&&h.m(_,b),s=!0},p(_,b){if(_[15]?r?r.p(_,b):(r=vo(_),r.c(),r.m(e.parentNode,e)):r&&(r.d(1),r=null),a&&a.p&&(!s||b[1]&65536)&&ot(a,o,_,_[47],s?rt(o,_[47],b,r1):at(_[47]),ho),b[0]&226518018){u=Le(_[24]);let g;for(g=0;g<u.length;g+=1){const T=mo(_,u,g);f[g]?(f[g].p(T,b),E(f[g],1)):(f[g]=Oo(T),f[g].c(),E(f[g],1),f[g].m(i,null))}for(ae(),g=u.length;g<f.length;g+=1)c(g);ue(),!u.length&&d?d.p(_,b):u.length?d&&(d.d(1),d=null):(d=So(_),d.c(),d.m(i,null))}h&&h.p&&(!s||b[1]&65536)&&ot(h,m,_,_[47],s?rt(m,_[47],b,s1):at(_[47]),po)},i(_){if(!s){E(a,_);for(let b=0;b<u.length;b+=1)E(f[b]);E(h,_),s=!0}},o(_){j(a,_),f=f.filter(Boolean);for(let b=0;b<f.length;b+=1)j(f[b]);j(h,_),s=!1},d(_){_&&(v(e),v(t),v(i),v(l)),r&&r.d(_),a&&a.d(_),ln(f,_),d&&d.d(),h&&h.d(_)}}}function d1(n){let e,t,i,l,s,r,o=Le(K.toArray(n[0])),a=[];for(let d=0;d<o.length;d+=1)a[d]=wo(_o(n,o,d));const u=d=>j(a[d],1,1,()=>{a[d]=null});let f=null;o.length||(f=go(n));let c=!n[5]&&!n[6]&&yo(n);return{c(){e=w("div"),t=w("div");for(let d=0;d<a.length;d+=1)a[d].c();f&&f.c(),l=I(),c&&c.c(),p(t,"tabindex",i=n[5]||n[6]?"-1":"0"),p(t,"class","selected-container"),B(t,"disabled",n[5]),B(t,"readonly",n[6]),p(e,"class",s="select "+n[16]),B(e,"active",n[22]),B(e,"upside",n[7]),B(e,"multiple",n[4]),B(e,"disabled",n[5]),B(e,"readonly",n[6])},m(d,m){k(d,e,m),y(e,t);for(let h=0;h<a.length;h+=1)a[h]&&a[h].m(t,null);f&&f.m(t,null),n[39](t),y(e,l),c&&c.m(e,null),n[46](e),r=!0},p(d,m){if(m[0]&137845){o=Le(K.toArray(d[0]));let h;for(h=0;h<o.length;h+=1){const _=_o(d,o,h);a[h]?(a[h].p(_,m),E(a[h],1)):(a[h]=wo(_),a[h].c(),E(a[h],1),a[h].m(t,null))}for(ae(),h=o.length;h<a.length;h+=1)u(h);ue(),!o.length&&f?f.p(d,m):o.length?f&&(f.d(1),f=null):(f=go(d),f.c(),f.m(t,null))}(!r||m[0]&96&&i!==(i=d[5]||d[6]?"-1":"0"))&&p(t,"tabindex",i),(!r||m[0]&32)&&B(t,"disabled",d[5]),(!r||m[0]&64)&&B(t,"readonly",d[6]),!d[5]&&!d[6]?c?(c.p(d,m),m[0]&96&&E(c,1)):(c=yo(d),c.c(),E(c,1),c.m(e,null)):c&&(ae(),j(c,1,1,()=>{c=null}),ue()),(!r||m[0]&65536&&s!==(s="select "+d[16]))&&p(e,"class",s),(!r||m[0]&4259840)&&B(e,"active",d[22]),(!r||m[0]&65664)&&B(e,"upside",d[7]),(!r||m[0]&65552)&&B(e,"multiple",d[4]),(!r||m[0]&65568)&&B(e,"disabled",d[5]),(!r||m[0]&65600)&&B(e,"readonly",d[6])},i(d){if(!r){for(let m=0;m<o.length;m+=1)E(a[m]);E(c),r=!0}},o(d){a=a.filter(Boolean);for(let m=0;m<a.length;m+=1)j(a[m]);j(c),r=!1},d(d){d&&v(e),ln(a,d),f&&f.d(),n[39](null),c&&c.d(),n[46](null)}}}function p1(n,e){let t=(""+e).replace(/\s+/g,"").toLowerCase(),i=n;try{typeof n=="object"&&n!==null&&(i=JSON.stringify(n))}catch{}return(""+i).replace(/\s+/g,"").toLowerCase().includes(t)}function m1(n,e,t){let i,l,{$$slots:s={},$$scope:r}=e,{id:o=""}=e,{noOptionsText:a="No options found"}=e,{selectPlaceholder:u="Select"}=e,{searchPlaceholder:f="Search..."}=e,{items:c=[]}=e,{multiple:d=!1}=e,{disabled:m=!1}=e,{readonly:h=!1}=e,{upside:_=!1}=e,{dropdownClass:b=""}=e,{selected:g=d?[]:void 0}=e,{toggle:T=d}=e,{closable:L=!0}=e,{labelComponent:O=void 0}=e,{labelComponentProps:C={}}=e,{optionComponent:S=void 0}=e,{optionComponentProps:P={}}=e,{searchable:R=!1}=e,{searchFunc:A=void 0}=e,{class:D=""}=e,M,Z="",Y,z,N=!1;function W(ie){if(K.isEmpty(g))return;let Ve=K.toArray(g);K.inArray(Ve,ie)&&(K.removeByValue(Ve,ie),t(0,g=Ve)),Y==null||Y.dispatchEvent(new CustomEvent("change",{detail:g,bubbles:!0}))}function ne(ie){if(d){let Ve=K.toArray(g);K.inArray(Ve,ie)||t(0,g=[...Ve,ie])}else t(0,g=ie);Y==null||Y.dispatchEvent(new CustomEvent("change",{detail:g,bubbles:!0}))}function X(ie){return l(ie)?W(ie):ne(ie)}function U(){t(0,g=d?[]:void 0)}function de(){M!=null&&M.show&&(M==null||M.show())}function re(){M!=null&&M.hide&&(M==null||M.hide())}function pe(){if(K.isEmpty(g)||K.isEmpty(c))return;let ie=K.toArray(g),Ve=[];for(const ce of ie)K.inArray(c,ce)||Ve.push(ce);if(Ve.length){for(const ce of Ve)K.removeByValue(ie,ce);t(0,g=d?ie:ie[0])}}function Ee(){t(18,Z="")}function tt(ie,Ve){ie=ie||[];const ce=A||p1;return ie.filter(Pe=>ce(Pe,Ve))||[]}function ut(ie,Ve){ie.preventDefault(),T&&d?X(Ve):ne(Ve)}function lt(ie,Ve){(ie.code==="Enter"||ie.code==="Space")&&(ut(ie,Ve),L&&re())}function dt(){Ee(),setTimeout(()=>{const ie=Y==null?void 0:Y.querySelector(".dropdown-item.option.selected");ie&&(ie.focus(),ie.scrollIntoView({block:"nearest"}))},0)}function se(ie){ie.stopPropagation(),!h&&!m&&(M==null||M.toggle())}gn(()=>{const ie=document.querySelectorAll(`label[for="${o}"]`);for(const Ve of ie)Ve.addEventListener("click",se);return()=>{for(const Ve of ie)Ve.removeEventListener("click",se)}});const J=ie=>W(ie);function G(ie){le[ie?"unshift":"push"](()=>{z=ie,t(21,z)})}function oe(){Z=this.value,t(18,Z)}const x=(ie,Ve)=>ut(Ve,ie),je=(ie,Ve)=>lt(Ve,ie);function Re(ie){le[ie?"unshift":"push"](()=>{M=ie,t(19,M)})}function Xe(ie){N=ie,t(22,N)}function bt(ie){$e.call(this,n,ie)}function Lt(ie){le[ie?"unshift":"push"](()=>{Y=ie,t(20,Y)})}return n.$$set=ie=>{"id"in ie&&t(29,o=ie.id),"noOptionsText"in ie&&t(1,a=ie.noOptionsText),"selectPlaceholder"in ie&&t(2,u=ie.selectPlaceholder),"searchPlaceholder"in ie&&t(3,f=ie.searchPlaceholder),"items"in ie&&t(30,c=ie.items),"multiple"in ie&&t(4,d=ie.multiple),"disabled"in ie&&t(5,m=ie.disabled),"readonly"in ie&&t(6,h=ie.readonly),"upside"in ie&&t(7,_=ie.upside),"dropdownClass"in ie&&t(8,b=ie.dropdownClass),"selected"in ie&&t(0,g=ie.selected),"toggle"in ie&&t(9,T=ie.toggle),"closable"in ie&&t(10,L=ie.closable),"labelComponent"in ie&&t(11,O=ie.labelComponent),"labelComponentProps"in ie&&t(12,C=ie.labelComponentProps),"optionComponent"in ie&&t(13,S=ie.optionComponent),"optionComponentProps"in ie&&t(14,P=ie.optionComponentProps),"searchable"in ie&&t(15,R=ie.searchable),"searchFunc"in ie&&t(31,A=ie.searchFunc),"class"in ie&&t(16,D=ie.class),"$$scope"in ie&&t(47,r=ie.$$scope)},n.$$.update=()=>{n.$$.dirty[0]&1073741824&&c&&(pe(),Ee()),n.$$.dirty[0]&1074003968&&t(24,i=tt(c,Z)),n.$$.dirty[0]&1&&t(23,l=function(ie){const Ve=K.toArray(g);return K.inArray(Ve,ie)})},[g,a,u,f,d,m,h,_,b,T,L,O,C,S,P,R,D,W,Z,M,Y,z,N,l,i,Ee,ut,lt,dt,o,c,A,ne,X,U,de,re,s,J,G,oe,x,je,Re,Xe,bt,Lt,r]}class h1 extends ve{constructor(e){super(),ye(this,e,m1,d1,_e,{id:29,noOptionsText:1,selectPlaceholder:2,searchPlaceholder:3,items:30,multiple:4,disabled:5,readonly:6,upside:7,dropdownClass:8,selected:0,toggle:9,closable:10,labelComponent:11,labelComponentProps:12,optionComponent:13,optionComponentProps:14,searchable:15,searchFunc:31,class:16,deselectItem:17,selectItem:32,toggleItem:33,reset:34,showDropdown:35,hideDropdown:36},null,[-1,-1])}get deselectItem(){return this.$$.ctx[17]}get selectItem(){return this.$$.ctx[32]}get toggleItem(){return this.$$.ctx[33]}get reset(){return this.$$.ctx[34]}get showDropdown(){return this.$$.ctx[35]}get hideDropdown(){return this.$$.ctx[36]}}function Co(n){let e,t;return{c(){e=w("i"),p(e,"class",t="icon "+n[0].icon)},m(i,l){k(i,e,l)},p(i,l){l&1&&t!==(t="icon "+i[0].icon)&&p(e,"class",t)},d(i){i&&v(e)}}}function _1(n){let e,t,i=(n[0].label||n[0].name||n[0].title||n[0].id||n[0].value)+"",l,s=n[0].icon&&Co(n);return{c(){s&&s.c(),e=I(),t=w("span"),l=te(i),p(t,"class","txt")},m(r,o){s&&s.m(r,o),k(r,e,o),k(r,t,o),y(t,l)},p(r,[o]){r[0].icon?s?s.p(r,o):(s=Co(r),s.c(),s.m(e.parentNode,e)):s&&(s.d(1),s=null),o&1&&i!==(i=(r[0].label||r[0].name||r[0].title||r[0].id||r[0].value)+"")&&Se(l,i)},i:Q,o:Q,d(r){r&&(v(e),v(t)),s&&s.d(r)}}}function g1(n,e,t){let{item:i={}}=e;return n.$$set=l=>{"item"in l&&t(0,i=l.item)},[i]}class Eo extends ve{constructor(e){super(),ye(this,e,g1,_1,_e,{item:0})}}const b1=n=>({}),Lo=n=>({});function w1(n){let e;const t=n[8].afterOptions,i=st(t,n,n[12],Lo);return{c(){i&&i.c()},m(l,s){i&&i.m(l,s),e=!0},p(l,s){i&&i.p&&(!e||s&4096)&&ot(i,t,l,l[12],e?rt(t,l[12],s,b1):at(l[12]),Lo)},i(l){e||(E(i,l),e=!0)},o(l){j(i,l),e=!1},d(l){i&&i.d(l)}}}function y1(n){let e,t,i;const l=[{items:n[1]},{multiple:n[2]},{labelComponent:n[3]},{optionComponent:n[4]},n[5]];function s(o){n[9](o)}let r={$$slots:{afterOptions:[w1]},$$scope:{ctx:n}};for(let o=0;o<l.length;o+=1)r=Ue(r,l[o]);return n[0]!==void 0&&(r.selected=n[0]),e=new h1({props:r}),le.push(()=>Ae(e,"selected",s)),e.$on("show",n[10]),e.$on("hide",n[11]),{c(){F(e.$$.fragment)},m(o,a){q(e,o,a),i=!0},p(o,[a]){const u=a&62?gt(l,[a&2&&{items:o[1]},a&4&&{multiple:o[2]},a&8&&{labelComponent:o[3]},a&16&&{optionComponent:o[4]},a&32&&Nt(o[5])]):{};a&4096&&(u.$$scope={dirty:a,ctx:o}),!t&&a&1&&(t=!0,u.selected=o[0],Ne(()=>t=!1)),e.$set(u)},i(o){i||(E(e.$$.fragment,o),i=!0)},o(o){j(e.$$.fragment,o),i=!1},d(o){$(e,o)}}}function v1(n,e,t){const i=["items","multiple","selected","labelComponent","optionComponent","selectionKey","keyOfSelected"];let l=ft(e,i),{$$slots:s={},$$scope:r}=e,{items:o=[]}=e,{multiple:a=!1}=e,{selected:u=a?[]:void 0}=e,{labelComponent:f=Eo}=e,{optionComponent:c=Eo}=e,{selectionKey:d="value"}=e,{keyOfSelected:m=a?[]:void 0}=e;function h(L){L=K.toArray(L,!0);let O=[];for(let C of L){const S=K.findByKey(o,d,C);S&&O.push(S)}L.length&&!O.length||t(0,u=a?O:O[0])}async function _(L){let O=K.toArray(L,!0).map(C=>C[d]);o.length&&t(6,m=a?O:O[0])}function b(L){u=L,t(0,u)}function g(L){$e.call(this,n,L)}function T(L){$e.call(this,n,L)}return n.$$set=L=>{e=Ue(Ue({},e),Kt(L)),t(5,l=ft(e,i)),"items"in L&&t(1,o=L.items),"multiple"in L&&t(2,a=L.multiple),"selected"in L&&t(0,u=L.selected),"labelComponent"in L&&t(3,f=L.labelComponent),"optionComponent"in L&&t(4,c=L.optionComponent),"selectionKey"in L&&t(7,d=L.selectionKey),"keyOfSelected"in L&&t(6,m=L.keyOfSelected),"$$scope"in L&&t(12,r=L.$$scope)},n.$$.update=()=>{n.$$.dirty&66&&o&&h(m),n.$$.dirty&1&&_(u)},[u,o,a,f,c,l,m,d,s,b,g,T,r]}class pn extends ve{constructor(e){super(),ye(this,e,v1,y1,_e,{items:1,multiple:2,selected:0,labelComponent:3,optionComponent:4,selectionKey:7,keyOfSelected:6})}}function Io(n,e,t){var s;const i=n.slice();i[19]=e[t];const l=((s=i[19].expand)==null?void 0:s.comment)||{};return i[20]=l,i}function jo(n){let e,t=n[1].length+"",i;return{c(){e=w("sub"),i=te(t),p(e,"class","sub sub-warning"),p(e,"title","Unread notifications")},m(l,s){k(l,e,s),y(e,i)},p(l,s){s&2&&t!==(t=l[1].length+"")&&Se(i,t)},d(l){l&&v(e)}}}function k1(n){let e;return{c(){e=w("div"),e.innerHTML='<figure class="icon"><i class="iconoir-bell"></i></figure> <p class="txt-hint">You don&#39;t have any unread notifications!</p>',p(e,"class","placeholder-block placeholder-block-sm p-base")},m(t,i){k(t,e,i)},p:Q,i:Q,o:Q,d(t){t&&v(e)}}}function S1(n){let e,t,i,l,s,r,o,a,u,f,c,d,m=[],h=new Map,_,b,g;function T(S){n[12](S)}let L={items:n[5]};n[0]!==void 0&&(L.keyOfSelected=n[0]),r=new pn({props:L}),le.push(()=>Ae(r,"keyOfSelected",T));let O=Le(n[6]);const C=S=>S[19].id;for(let S=0;S<O.length;S+=1){let P=Io(n,O,S),R=C(P);h.set(R,m[S]=No(R,P))}return{c(){e=w("div"),t=w("div"),t.innerHTML="<h6>Notifications</h6>",i=I(),l=w("div"),s=w("div"),F(r.$$.fragment),a=I(),u=w("div"),f=w("button"),f.innerHTML='<span class="txt">Mark all as read</span>',c=I(),d=w("div");for(let S=0;S<m.length;S+=1)m[S].c();p(t,"class","flex m-b-xs"),p(f,"type","button"),p(f,"class","txt-sm link-fade"),B(f,"txt-disabled",n[4]),p(u,"class","addon"),p(s,"class","field-group"),p(l,"class","form-field form-field-sm m-b-0 m-l-auto"),p(e,"class","block p-t-xs p-b-sm p-l-sm p-r-sm"),p(d,"class","list notifications-list")},m(S,P){k(S,e,P),y(e,t),y(e,i),y(e,l),y(l,s),q(r,s,null),y(s,a),y(s,u),y(u,f),k(S,c,P),k(S,d,P);for(let R=0;R<m.length;R+=1)m[R]&&m[R].m(d,null);_=!0,b||(g=H(f,"click",we(n[13])),b=!0)},p(S,P){const R={};P&32&&(R.items=S[5]),!o&&P&1&&(o=!0,R.keyOfSelected=S[0],Ne(()=>o=!1)),r.$set(R),(!_||P&16)&&B(f,"txt-disabled",S[4]),P&832&&(O=Le(S[6]),ae(),m=St(m,P,C,1,S,O,h,d,At,No,null,Io),ue())},i(S){if(!_){E(r.$$.fragment,S);for(let P=0;P<O.length;P+=1)E(m[P]);_=!0}},o(S){j(r.$$.fragment,S);for(let P=0;P<m.length;P+=1)j(m[P]);_=!1},d(S){S&&(v(e),v(c),v(d)),$(r);for(let P=0;P<m.length;P+=1)m[P].d();b=!1,g()}}}function Po(n){let e,t,i=n[20].expand.screen.title+"",l;return{c(){e=w("div"),t=w("small"),l=te(i),p(t,"class","screen-title"),p(e,"class","row txt-hint")},m(s,r){k(s,e,r),y(e,t),y(t,l)},p(s,r){r&64&&i!==(i=s[20].expand.screen.title+"")&&Se(l,i)},d(s){s&&v(e)}}}function No(n,e){var N,W,ne;let t,i,l,s,r,o,a,u=K.getCommentAuthor(e[20])+"",f,c,d,m=K.relativeDate(e[20].created)+"",h,_,b,g,T,L,O,C=e[20].message+"",S,P,R,A,D,M;i=new il({props:{user:(N=e[20].expand)==null?void 0:N.user,class:"avatar"}});function Z(){return e[14](e[19])}let Y=((ne=(W=e[20].expand)==null?void 0:W.screen)==null?void 0:ne.title)&&Po(e);function z(){return e[15](e[20])}return{key:n,first:null,c(){t=w("div"),F(i.$$.fragment),l=I(),s=w("div"),r=w("div"),o=w("div"),a=w("small"),f=te(u),c=I(),d=w("small"),h=te(m),_=I(),b=w("nav"),g=w("button"),g.innerHTML='<i class="iconoir-check"></i>',T=I(),L=w("div"),O=w("div"),S=te(C),P=I(),Y&&Y.c(),R=I(),p(a,"class","name"),p(d,"class","txt-xs txt-hint date"),p(o,"class","inline-flex flex-row-gap-0"),p(g,"type","button"),p(g,"class","btn btn-xs btn-circle btn-transparent btn-hint"),p(b,"class","ctrls"),p(r,"class","row"),p(O,"class","message"),p(L,"class","row"),p(s,"class","content"),p(t,"class","list-item handle"),this.first=t},m(X,U){k(X,t,U),q(i,t,null),y(t,l),y(t,s),y(s,r),y(r,o),y(o,a),y(a,f),y(o,c),y(o,d),y(d,h),y(r,_),y(r,b),y(b,g),y(s,T),y(s,L),y(L,O),y(O,S),y(s,P),Y&&Y.m(s,null),y(t,R),A=!0,D||(M=[be(Oe.call(null,g,"Mark as read")),H(g,"click",Ze(we(Z))),H(t,"click",z)],D=!0)},p(X,U){var re,pe,Ee;e=X;const de={};U&64&&(de.user=(re=e[20].expand)==null?void 0:re.user),i.$set(de),(!A||U&64)&&u!==(u=K.getCommentAuthor(e[20])+"")&&Se(f,u),(!A||U&64)&&m!==(m=K.relativeDate(e[20].created)+"")&&Se(h,m),(!A||U&64)&&C!==(C=e[20].message+"")&&Se(S,C),(Ee=(pe=e[20].expand)==null?void 0:pe.screen)!=null&&Ee.title?Y?Y.p(e,U):(Y=Po(e),Y.c(),Y.m(s,null)):Y&&(Y.d(1),Y=null)},i(X){A||(E(i.$$.fragment,X),A=!0)},o(X){j(i.$$.fragment,X),A=!1},d(X){X&&v(t),$(i),Y&&Y.d(),D=!1,me(M)}}}function T1(n){let e,t,i,l;const s=[S1,k1],r=[];function o(a,u){return a[1].length?0:1}return t=o(n),i=r[t]=s[t](n),{c(){e=w("div"),i.c(),p(e,"class","content")},m(a,u){k(a,e,u),r[t].m(e,null),l=!0},p(a,u){let f=t;t=o(a),t===f?r[t].p(a,u):(ae(),j(r[f],1,1,()=>{r[f]=null}),ue(),i=r[t],i?i.p(a,u):(i=r[t]=s[t](a),i.c()),E(i,1),i.m(e,null))},i(a){l||(E(i),l=!0)},o(a){j(i),l=!1},d(a){a&&v(e),r[t].d()}}}function O1(n){let e,t,i,l,s,r,o,a,u,f,c,d=n[1].length&&jo(n);function m(_){n[17](_)}let h={class:"dropdown notifications-dropdown",$$slots:{default:[T1]},$$scope:{ctx:n}};return n[3]!==void 0&&(h.active=n[3]),r=new Rt({props:h}),n[16](r),le.push(()=>Ae(r,"active",m)),r.$on("show",n[7]),{c(){e=w("div"),t=w("i"),l=I(),d&&d.c(),s=I(),F(r.$$.fragment),p(t,"class",i="iconoir-bell "+(n[1].length?"txt-warning":"txt-hint")),p(e,"tabindex","0"),p(e,"class","btn btn-hint btn-transparent btn-circle notifications-btn")},m(_,b){k(_,e,b),y(e,t),y(e,l),d&&d.m(e,null),y(e,s),q(r,e,null),u=!0,f||(c=be(a=Oe.call(null,e,n[3]?void 0:{position:"bottom",text:"Notifications"})),f=!0)},p(_,[b]){(!u||b&2&&i!==(i="iconoir-bell "+(_[1].length?"txt-warning":"txt-hint")))&&p(t,"class",i),_[1].length?d?d.p(_,b):(d=jo(_),d.c(),d.m(e,s)):d&&(d.d(1),d=null);const g={};b&8388723&&(g.$$scope={dirty:b,ctx:_}),!o&&b&8&&(o=!0,g.active=_[3],Ne(()=>o=!1)),r.$set(g),a&&et(a.update)&&b&8&&a.update.call(null,_[3]?void 0:{position:"bottom",text:"Notifications"})},i(_){u||(E(r.$$.fragment,_),u=!0)},o(_){j(r.$$.fragment,_),u=!1},d(_){_&&v(e),d&&d.d(),n[16](null),$(r),f=!1,c()}}}function C1(n,e=[]){return n.length?n:e}function E1(n,e,t){let i;ee(n,wn,S=>t(1,i=S));let l,s=!1,r=!1,o="",a=[],u=[];function f(){l==null||l.show()}function c(){l==null||l.hide()}function d(){t(0,o=""),m()}function m(){var P,R,A,D,M,Z,Y;const S={};for(let z of i){const N=(Y=(Z=(M=(D=(A=(R=(P=z.expand)==null?void 0:P.comment)==null?void 0:R.expand)==null?void 0:A.screen)==null?void 0:D.expand)==null?void 0:M.prototype)==null?void 0:Z.expand)==null?void 0:Y.project;N&&(S[N.id]={label:N.title,value:N.id})}t(5,a=Object.values(S)),a.length!=1?t(5,a=[{label:"All projects",value:""}].concat(a)):t(0,o=a[0].value)}async function h(S){t(4,r=!0),S=K.toArray(S),S.length||(S=i.map(P=>P.id));try{const P=[];for(let R of S)P.push(V.collection("notifications").update(R,{read:!0})),ar(R);await Promise.allSettled(P)}catch(P){P.isAbort||V.error(P)}t(4,r=!1)}function _(S){var M,Z,Y,z,N,W;const P=(z=(Y=(Z=(M=S.expand)==null?void 0:M.screen)==null?void 0:Z.expand)==null?void 0:Y.prototype)==null?void 0:z.project,R=(W=(N=S.expand)==null?void 0:N.screen)==null?void 0:W.prototype,A=S.screen,D=S.id;wi(`/projects/${P}/prototypes/${R}/screens/${A}?mode=comments&commentId=${D}`)}gn(()=>{K.getHashQueryParams().notifications&&(K.replaceHashQueryParams({notifications:null}),f())});function b(S){o=S,t(0,o)}const g=()=>h(),T=S=>{h(S.id)},L=S=>_(S);function O(S){le[S?"unshift":"push"](()=>{l=S,t(2,l)})}function C(S){s=S,t(3,s)}return n.$$.update=()=>{n.$$.dirty&2&&i!=null&&i.length&&m(),n.$$.dirty&3&&t(6,u=o?C1(i.filter(S=>{var P,R,A,D,M,Z;return((Z=(M=(D=(A=(R=(P=S.expand)==null?void 0:P.comment)==null?void 0:R.expand)==null?void 0:A.screen)==null?void 0:D.expand)==null?void 0:M.prototype)==null?void 0:Z.project)==o}),i):i)},[o,i,l,s,r,a,u,d,h,_,f,c,b,g,T,L,O,C]}class L1 extends ve{constructor(e){super(),ye(this,e,E1,O1,_e,{show:10,hide:11})}get show(){return this.$$.ctx[10]}get hide(){return this.$$.ctx[11]}}const I1=n=>({}),Ao=n=>({}),j1=n=>({}),Do=n=>({});function Mo(n){let e,t,i,l,s,r,o,a,u,f,c,d,m,h,_,b,g,T=n[4]&&Ro(n);const L=n[20].header,O=st(L,n,n[19],Do),C=n[20].default,S=st(C,n,n[19],null),P=n[20].footer,R=st(P,n,n[19],Ao);return{c(){e=w("div"),t=w("div"),l=I(),s=w("div"),r=w("div"),T&&T.c(),o=I(),O&&O.c(),a=I(),u=w("div"),S&&S.c(),f=I(),c=w("div"),R&&R.c(),p(t,"class","overlay"),p(r,"class","overlay-panel-section panel-header"),p(u,"class","overlay-panel-section panel-content"),p(c,"class","overlay-panel-section panel-footer"),p(s,"class",d="overlay-panel "+n[1]+" "+n[8]),B(s,"popup",n[2]),p(e,"class","overlay-panel-container"),B(e,"padded",n[2]),B(e,"active",n[0])},m(A,D){k(A,e,D),y(e,t),y(e,l),y(e,s),y(s,r),T&&T.m(r,null),y(r,o),O&&O.m(r,null),y(s,a),y(s,u),S&&S.m(u,null),n[22](u),y(s,f),y(s,c),R&&R.m(c,null),_=!0,b||(g=[H(t,"click",we(n[21])),H(u,"scroll",n[23])],b=!0)},p(A,D){n=A,n[4]?T?T.p(n,D):(T=Ro(n),T.c(),T.m(r,o)):T&&(T.d(1),T=null),O&&O.p&&(!_||D[0]&524288)&&ot(O,L,n,n[19],_?rt(L,n[19],D,j1):at(n[19]),Do),S&&S.p&&(!_||D[0]&524288)&&ot(S,C,n,n[19],_?rt(C,n[19],D,null):at(n[19]),null),R&&R.p&&(!_||D[0]&524288)&&ot(R,P,n,n[19],_?rt(P,n[19],D,I1):at(n[19]),Ao),(!_||D[0]&258&&d!==(d="overlay-panel "+n[1]+" "+n[8]))&&p(s,"class",d),(!_||D[0]&262)&&B(s,"popup",n[2]),(!_||D[0]&4)&&B(e,"padded",n[2]),(!_||D[0]&1)&&B(e,"active",n[0])},i(A){_||(A&&kt(()=>{_&&(i||(i=ct(t,Os,{duration:si,opacity:0},!0)),i.run(1))}),E(O,A),E(S,A),E(R,A),A&&kt(()=>{_&&(h&&h.end(1),m=zf(s,Pn,n[2]?{duration:si,y:-10}:{duration:si,x:50}),m.start())}),_=!0)},o(A){A&&(i||(i=ct(t,Os,{duration:si,opacity:0},!1)),i.run(0)),j(O,A),j(S,A),j(R,A),m&&m.invalidate(),A&&(h=Bf(s,Pn,n[2]?{duration:si,y:10}:{duration:si,x:50})),_=!1},d(A){A&&v(e),A&&i&&i.end(),T&&T.d(),O&&O.d(A),S&&S.d(A),n[22](null),R&&R.d(A),A&&h&&h.end(),b=!1,me(g)}}}function Ro(n){let e;function t(s,r){return s[2]?N1:P1}let i=t(n),l=i(n);return{c(){l.c(),e=De()},m(s,r){l.m(s,r),k(s,e,r)},p(s,r){i===(i=t(s))&&l?l.p(s,r):(l.d(1),l=i(s),l&&(l.c(),l.m(e.parentNode,e)))},d(s){s&&v(e),l.d(s)}}}function P1(n){let e,t,i;return{c(){e=w("button"),e.innerHTML='<i class="iconoir-xmark"></i>',p(e,"tabindex","-1"),p(e,"type","button"),p(e,"class","overlay-close")},m(l,s){k(l,e,s),t||(i=H(e,"click",we(n[5])),t=!0)},p:Q,d(l){l&&v(e),t=!1,i()}}}function N1(n){let e,t,i;return{c(){e=w("button"),e.innerHTML='<i class="iconoir-xmark txt-lg"></i>',p(e,"tabindex","-1"),p(e,"type","button"),p(e,"class","btn btn-sm btn-circle btn-transparent btn-close m-l-auto")},m(l,s){k(l,e,s),t||(i=H(e,"click",we(n[5])),t=!0)},p:Q,d(l){l&&v(e),t=!1,i()}}}function A1(n){let e,t,i,l,s=n[0]&&Mo(n);return{c(){e=w("div"),s&&s.c(),p(e,"id",n[9]),p(e,"class","overlay-panel-wrapper"),p(e,"tabindex","-1")},m(r,o){k(r,e,o),s&&s.m(e,null),n[24](e),t=!0,i||(l=[H(window,"resize",n[11]),H(window,"keydown",n[10])],i=!0)},p(r,o){r[0]?s?(s.p(r,o),o[0]&1&&E(s,1)):(s=Mo(r),s.c(),E(s,1),s.m(e,null)):s&&(ae(),j(s,1,1,()=>{s=null}),ue())},i(r){t||(E(s),t=!0)},o(r){j(s),t=!1},d(r){r&&v(e),s&&s.d(),n[24](null),i=!1,me(l)}}}let Un,os=[];function cd(){return Un=Un||document.querySelector(".overlays"),Un||(Un=document.createElement("div"),Un.classList.add("overlays"),document.body.appendChild(Un)),Un}let si=150;function Ho(){return 1e3+cd().querySelectorAll(".overlay-panel-container.active").length}function D1(n,e,t){let{$$slots:i={},$$scope:l}=e,{class:s=""}=e,{active:r=!1}=e,{popup:o=!1}=e,{overlayClose:a=!0}=e,{btnClose:u=!0}=e,{escHide:f=!0}=e,{beforeOpen:c=void 0}=e,{beforeHide:d=void 0}=e;const m=it(),h="op_"+K.randomString(5);let _,b,g,T,L="",O=r;function C(){typeof c=="function"&&c()===!1||t(0,r=!0)}function S(){typeof d=="function"&&d()===!1||t(0,r=!1)}function P(){return r}async function R(U){t(18,O=U),U?(g=document.activeElement,m("show"),_==null||_.focus()):(clearTimeout(T),m("hide"),g==null||g.focus(),setTimeout(()=>{g==null||g.blur()},0)),await Ot(),A()}function A(){_&&(r?t(6,_.style.zIndex=Ho(),_):t(6,_.style="",_))}function D(){K.pushUnique(os,h),document.body.classList.add("overlay-active")}function M(){K.removeByValue(os,h),os.length||document.body.classList.remove("overlay-active")}function Z(U){r&&f&&U.code=="Escape"&&!K.isInput(U.target)&&_&&_.style.zIndex==Ho()&&(U.preventDefault(),S())}function Y(U){r&&z(b)}function z(U,de){de&&t(8,L=""),U&&(T||(T=setTimeout(()=>{if(clearTimeout(T),T=null,!U)return;if(U.scrollHeight-U.offsetHeight>0)t(8,L="scrollable");else{t(8,L="");return}U.scrollTop==0?t(8,L+=" scroll-top-reached"):U.scrollTop+U.offsetHeight==U.scrollHeight&&t(8,L+=" scroll-bottom-reached")},100)))}gn(()=>(cd().appendChild(_),()=>{clearTimeout(T),M(),_==null||_.remove()}));const N=()=>a?S():!0;function W(U){le[U?"unshift":"push"](()=>{b=U,t(7,b)})}const ne=U=>z(U.target);function X(U){le[U?"unshift":"push"](()=>{_=U,t(6,_)})}return n.$$set=U=>{"class"in U&&t(1,s=U.class),"active"in U&&t(0,r=U.active),"popup"in U&&t(2,o=U.popup),"overlayClose"in U&&t(3,a=U.overlayClose),"btnClose"in U&&t(4,u=U.btnClose),"escHide"in U&&t(13,f=U.escHide),"beforeOpen"in U&&t(14,c=U.beforeOpen),"beforeHide"in U&&t(15,d=U.beforeHide),"$$scope"in U&&t(19,l=U.$$scope)},n.$$.update=()=>{n.$$.dirty[0]&262145&&O!=r&&R(r),n.$$.dirty[0]&128&&z(b,!0),n.$$.dirty[0]&64&&_&&A(),n.$$.dirty[0]&1&&(r?D():M())},[r,s,o,a,u,S,_,b,L,h,Z,Y,z,f,c,d,C,P,O,l,i,N,W,ne,X]}class mn extends ve{constructor(e){super(),ye(this,e,D1,A1,_e,{class:1,active:0,popup:2,overlayClose:3,btnClose:4,escHide:13,beforeOpen:14,beforeHide:15,show:16,hide:5,isActive:17},null,[-1,-1])}get show(){return this.$$.ctx[16]}get hide(){return this.$$.ctx[5]}get isActive(){return this.$$.ctx[17]}}function Uo(n,e,t){const i=n.slice();return i[12]=e[t],i}const M1=n=>({}),qo=n=>({uniqueId:n[4]});function $o(n){let e,t,i=Le(n[3]),l=[];for(let r=0;r<i.length;r+=1)l[r]=Fo(Uo(n,i,r));const s=r=>j(l[r],1,1,()=>{l[r]=null});return{c(){for(let r=0;r<l.length;r+=1)l[r].c();e=De()},m(r,o){for(let a=0;a<l.length;a+=1)l[a]&&l[a].m(r,o);k(r,e,o),t=!0},p(r,o){if(o&8){i=Le(r[3]);let a;for(a=0;a<i.length;a+=1){const u=Uo(r,i,a);l[a]?(l[a].p(u,o),E(l[a],1)):(l[a]=Fo(u),l[a].c(),E(l[a],1),l[a].m(e.parentNode,e))}for(ae(),a=i.length;a<l.length;a+=1)s(a);ue()}},i(r){if(!t){for(let o=0;o<i.length;o+=1)E(l[o]);t=!0}},o(r){l=l.filter(Boolean);for(let o=0;o<l.length;o+=1)j(l[o]);t=!1},d(r){r&&v(e),ln(l,r)}}}function Fo(n){let e,t,i=Dl(n[12])+"",l,s,r,o;return{c(){e=w("div"),t=w("pre"),l=te(i),s=I(),p(e,"class","help-block help-block-error")},m(a,u){k(a,e,u),y(e,t),y(t,l),y(e,s),o=!0},p(a,u){(!o||u&8)&&i!==(i=Dl(a[12])+"")&&Se(l,i)},i(a){o||(a&&kt(()=>{o&&(r||(r=ct(e,Et,{duration:150},!0)),r.run(1))}),o=!0)},o(a){a&&(r||(r=ct(e,Et,{duration:150},!1)),r.run(0)),o=!1},d(a){a&&v(e),a&&r&&r.end()}}}function R1(n){let e,t,i,l,s,r;const o=n[9].default,a=st(o,n,n[8],qo);let u=!n[0]&&$o(n);return{c(){e=w("div"),a&&a.c(),t=I(),u&&u.c(),p(e,"class",n[1]),B(e,"error",n[3].length)},m(f,c){var d;k(f,e,c),a&&a.m(e,null),y(e,t),u&&u.m(e,null),n[11](e),l=!0,s||(r=[be(i=Oe.call(null,e,{text:n[0]?Dl((d=n[3])==null?void 0:d[0]):""})),H(e,"click",n[10])],s=!0)},p(f,[c]){var d;a&&a.p&&(!l||c&256)&&ot(a,o,f,f[8],l?rt(o,f[8],c,M1):at(f[8]),qo),f[0]?u&&(ae(),j(u,1,1,()=>{u=null}),ue()):u?(u.p(f,c),c&1&&E(u,1)):(u=$o(f),u.c(),E(u,1),u.m(e,null)),(!l||c&2)&&p(e,"class",f[1]),i&&et(i.update)&&c&9&&i.update.call(null,{text:f[0]?Dl((d=f[3])==null?void 0:d[0]):""}),(!l||c&10)&&B(e,"error",f[3].length)},i(f){l||(E(a,f),E(u),l=!0)},o(f){j(a,f),j(u),l=!1},d(f){f&&v(e),a&&a.d(f),u&&u.d(),n[11](null),s=!1,me(r)}}}const Wo="Invalid value";function Dl(n){return n?typeof n=="object"?(n==null?void 0:n.message)||(n==null?void 0:n.code)||Wo:n||Wo:""}function H1(n,e,t){let i;ee(n,Yl,_=>t(7,i=_));let{$$slots:l={},$$scope:s}=e;const r="field_"+K.randomString(7);let{name:o=""}=e,{inlineError:a=!1}=e,{class:u=void 0}=e,f,c=[];function d(){Mh(o)}gn(()=>(f.addEventListener("input",d),f.addEventListener("change",d),()=>{f.removeEventListener("input",d),f.removeEventListener("change",d)}));function m(_){$e.call(this,n,_)}function h(_){le[_?"unshift":"push"](()=>{f=_,t(2,f)})}return n.$$set=_=>{"name"in _&&t(5,o=_.name),"inlineError"in _&&t(0,a=_.inlineError),"class"in _&&t(1,u=_.class),"$$scope"in _&&t(8,s=_.$$scope)},n.$$.update=()=>{n.$$.dirty&160&&t(3,c=K.toArray(K.getNestedVal(i,o)))},[a,u,f,c,r,o,d,i,s,l,m,h]}class Ce extends ve{constructor(e){super(),ye(this,e,H1,R1,_e,{name:5,inlineError:0,class:1,changed:6})}get changed(){return this.$$.ctx[6]}}function U1(n){let e,t,i,l,s,r,o,a;return{c(){e=w("label"),t=te("New email"),l=I(),s=w("input"),p(e,"for",i=n[14]),p(s,"type","email"),p(s,"id",r=n[14]),s.autofocus=!0,s.required=!0},m(u,f){k(u,e,f),y(e,t),k(u,l,f),k(u,s,f),ge(s,n[2]),s.focus(),o||(a=H(s,"input",n[7]),o=!0)},p(u,f){f&16384&&i!==(i=u[14])&&p(e,"for",i),f&16384&&r!==(r=u[14])&&p(s,"id",r),f&4&&s.value!==u[2]&&ge(s,u[2])},d(u){u&&(v(e),v(l),v(s)),o=!1,a()}}}function q1(n){let e,t,i,l,s;return t=new Ce({props:{class:"form-field required",name:"newEmail",$$slots:{default:[U1,({uniqueId:r})=>({14:r}),({uniqueId:r})=>r?16384:0]},$$scope:{ctx:n}}}),{c(){e=w("form"),F(t.$$.fragment),p(e,"id",n[4]),p(e,"class","grid grid-sm")},m(r,o){k(r,e,o),q(t,e,null),i=!0,l||(s=H(e,"submit",we(n[5])),l=!0)},p(r,o){const a={};o&49156&&(a.$$scope={dirty:o,ctx:r}),t.$set(a)},i(r){i||(E(t.$$.fragment,r),i=!0)},o(r){j(t.$$.fragment,r),i=!1},d(r){r&&v(e),$(t),l=!1,s()}}}function $1(n){let e;return{c(){e=w("h5"),e.textContent="Change email",p(e,"class","block txt-center")},m(t,i){k(t,e,i)},p:Q,d(t){t&&v(e)}}}function F1(n){let e,t,i,l,s,r,o;return{c(){e=w("button"),t=w("span"),t.textContent="Cancel",i=I(),l=w("button"),s=w("span"),s.textContent="Send confirmation link",p(t,"class","txt"),p(e,"type","button"),p(e,"class","btn btn-transparent m-r-auto"),e.disabled=n[3],p(s,"class","txt"),p(l,"form",n[4]),p(l,"type","submit"),p(l,"class","btn btn-expanded-sm btn-primary"),l.disabled=n[3],B(l,"btn-loading",n[3])},m(a,u){k(a,e,u),y(e,t),k(a,i,u),k(a,l,u),y(l,s),r||(o=H(e,"click",n[0]),r=!0)},p(a,u){u&8&&(e.disabled=a[3]),u&8&&(l.disabled=a[3]),u&8&&B(l,"btn-loading",a[3])},d(a){a&&(v(e),v(i),v(l)),r=!1,o()}}}function W1(n){let e,t,i={beforeHide:n[8],popup:!0,class:"overlay-panel-sm",$$slots:{footer:[F1],header:[$1],default:[q1]},$$scope:{ctx:n}};return e=new mn({props:i}),n[9](e),e.$on("show",n[10]),e.$on("hide",n[11]),{c(){F(e.$$.fragment)},m(l,s){q(e,l,s),t=!0},p(l,[s]){const r={};s&8&&(r.beforeHide=l[8]),s&32780&&(r.$$scope={dirty:s,ctx:l}),e.$set(r)},i(l){t||(E(e.$$.fragment,l),t=!0)},o(l){j(e.$$.fragment,l),t=!1},d(l){n[9](null),$(e,l)}}}function V1(n,e,t){const i=it(),l="email_"+K.randomString(5);let s,r="",o=!1;function a(){return f(),s==null?void 0:s.show()}function u(){return s==null?void 0:s.hide()}function f(){Jt({}),t(2,r="")}async function c(){t(3,o=!0);try{await V.collection("users").requestEmailChange(r),t(3,o=!1),i("submit"),_t(`A confirmation link was sent to ${r}.`),u()}catch(g){g.isAbort||(t(3,o=!1),V.error(g))}}function d(){r=this.value,t(2,r)}const m=()=>!o;function h(g){le[g?"unshift":"push"](()=>{s=g,t(1,s)})}function _(g){$e.call(this,n,g)}function b(g){$e.call(this,n,g)}return[u,s,r,o,l,c,a,d,m,h,_,b]}class z1 extends ve{constructor(e){super(),ye(this,e,V1,W1,_e,{show:6,hide:0})}get show(){return this.$$.ctx[6]}get hide(){return this.$$.ctx[0]}}function Vo(n){let e,t,i;return{c(){e=w("button"),e.innerHTML='<i class="iconoir-xmark txt-sm"></i>',p(e,"type","button"),p(e,"class","btn btn-xs btn-outline btn-circle btn-close svelte-60psra")},m(l,s){k(l,e,s),t||(i=[be(Oe.call(null,e,{position:"right",text:"Remove avatar"})),H(e,"click",Ze(we(n[11])))],t=!0)},p:Q,d(l){l&&v(e),t=!1,me(i)}}}function B1(n){let e,t=n[8]&&Vo(n);return{c(){t&&t.c(),e=De()},m(i,l){t&&t.m(i,l),k(i,e,l)},p(i,l){i[8]?t?t.p(i,l):(t=Vo(i),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},d(i){i&&v(e),t&&t.d(i)}}}function Z1(n){let e;return{c(){e=w("i"),p(e,"class","iconoir-media-image-plus")},m(t,i){k(t,e,i)},p:Q,d(t){t&&v(e)}}}function as(n){var f;let e,t,i,l,s,r,o;t=new il({props:{class:"thumb-xl "+(n[8]?"":"thumb-handle"),user:n[1],file:(f=n[2])==null?void 0:f[0],fallbackToOAuth2:!1,$$slots:{placeholder:[Z1],default:[B1]},$$scope:{ctx:n}}});let a=[{for:i=n[8]?null:n[32]},{class:"inline-flex"}],u={};for(let c=0;c<a.length;c+=1)u=Ue(u,a[c]);return{c(){e=w(n[8]?"div":"label"),F(t.$$.fragment),Sl(n[8]?"div":"label")(e,u)},m(c,d){k(c,e,d),q(t,e,null),s=!0,r||(o=be(l=Oe.call(null,e,n[8]?null:"Upload avatar")),r=!0)},p(c,d){var h;const m={};d[0]&256&&(m.class="thumb-xl "+(c[8]?"":"thumb-handle")),d[0]&2&&(m.user=c[1]),d[0]&4&&(m.file=(h=c[2])==null?void 0:h[0]),d[0]&256|d[1]&4&&(m.$$scope={dirty:d,ctx:c}),t.$set(m),Sl(c[8]?"div":"label")(e,u=gt(a,[(!s||d[0]&256|d[1]&2&&i!==(i=c[8]?null:c[32]))&&{for:i},{class:"inline-flex"}])),l&&et(l.update)&&d[0]&256&&l.update.call(null,c[8]?null:"Upload avatar")},i(c){s||(E(t.$$.fragment,c),s=!0)},o(c){j(t.$$.fragment,c),s=!1},d(c){c&&v(e),$(t),r=!1,o()}}}function Y1(n){let e,t,i,l=n[8]?"div":"label",s,r,o,a,u=(n[8]?"div":"label")&&as(n);return{c(){e=w("input"),i=I(),u&&u.c(),s=De(),p(e,"type","file"),p(e,"class","hidden"),p(e,"id",t=n[32])},m(f,c){k(f,e,c),k(f,i,c),u&&u.m(f,c),k(f,s,c),o||(a=H(e,"change",n[19]),o=!0)},p(f,c){(!r||c[1]&2&&t!==(t=f[32]))&&p(e,"id",t),f[8],l?_e(l,f[8]?"div":"label")?(u.d(1),u=as(f),l=f[8]?"div":"label",u.c(),u.m(s.parentNode,s)):u.p(f,c):(u=as(f),l=f[8]?"div":"label",u.c(),u.m(s.parentNode,s))},i:Q,o(f){j(u,f),r=!1},d(f){f&&(v(e),v(i),v(s)),u&&u.d(f),o=!1,a()}}}function K1(n){let e,t,i,l,s,r,o,a;return{c(){e=w("label"),t=te("Full name"),l=I(),s=w("input"),p(e,"for",i=n[32]),p(s,"type","text"),p(s,"id",r=n[32])},m(u,f){k(u,e,f),y(e,t),k(u,l,f),k(u,s,f),ge(s,n[1].name),o||(a=H(s,"input",n[20]),o=!0)},p(u,f){f[1]&2&&i!==(i=u[32])&&p(e,"for",i),f[1]&2&&r!==(r=u[32])&&p(s,"id",r),f[0]&2&&s.value!==u[1].name&&ge(s,u[1].name)},d(u){u&&(v(e),v(l),v(s)),o=!1,a()}}}function G1(n){let e,t,i,l,s,r,o,a;return{c(){e=w("label"),t=te("Username"),l=I(),s=w("input"),p(e,"for",i=n[32]),p(s,"type","text"),p(s,"id",r=n[32]),s.required=!0},m(u,f){k(u,e,f),y(e,t),k(u,l,f),k(u,s,f),ge(s,n[1].username),o||(a=H(s,"input",n[21]),o=!0)},p(u,f){f[1]&2&&i!==(i=u[32])&&p(e,"for",i),f[1]&2&&r!==(r=u[32])&&p(s,"id",r),f[0]&2&&s.value!==u[1].username&&ge(s,u[1].username)},d(u){u&&(v(e),v(l),v(s)),o=!1,a()}}}function zo(n){let e,t,i;function l(o,a){return o[1].email?X1:J1}let s=l(n),r=s(n);return{c(){e=w("button"),r.c(),p(e,"type","button"),p(e,"class","btn btn-xs btn-transparent")},m(o,a){k(o,e,a),r.m(e,null),t||(i=H(e,"click",Ze(function(){var u,f;et((u=n[5])==null?void 0:u.show())&&((f=n[5])==null||f.show().apply(this,arguments))})),t=!0)},p(o,a){n=o,s!==(s=l(n))&&(r.d(1),r=s(n),r&&(r.c(),r.m(e,null)))},d(o){o&&v(e),r.d(),t=!1,i()}}}function J1(n){let e;return{c(){e=te("Set email")},m(t,i){k(t,e,i)},d(t){t&&v(e)}}}function X1(n){let e;return{c(){e=te("Change email")},m(t,i){k(t,e,i)},d(t){t&&v(e)}}}function Q1(n){var c;let e,t,i,l,s,r,o,a,u,f=((c=n[9])==null?void 0:c.id)==n[1].id&&zo(n);return{c(){e=w("label"),t=te("Email"),l=I(),s=w("div"),r=w("input"),u=I(),f&&f.c(),p(e,"for",i=n[32]),p(r,"type","email"),p(r,"id",o=n[32]),r.value=a=n[1].email,r.readOnly=!0,p(s,"class","field-group")},m(d,m){k(d,e,m),y(e,t),k(d,l,m),k(d,s,m),y(s,r),y(s,u),f&&f.m(s,null)},p(d,m){var h;m[1]&2&&i!==(i=d[32])&&p(e,"for",i),m[1]&2&&o!==(o=d[32])&&p(r,"id",o),m[0]&2&&a!==(a=d[1].email)&&r.value!==a&&(r.value=a),((h=d[9])==null?void 0:h.id)==d[1].id?f?f.p(d,m):(f=zo(d),f.c(),f.m(s,null)):f&&(f.d(1),f=null)},d(d){d&&(v(e),v(l),v(s)),f&&f.d()}}}function x1(n){let e,t,i,l,s,r,o,a,u,f;return{c(){e=w("input"),i=I(),l=w("label"),s=w("span"),s.textContent="Public visible email",r=I(),o=w("i"),p(e,"type","checkbox"),p(e,"id",t=n[32]),p(s,"class","txt"),p(o,"class","iconoir-info-circle link-hint"),p(l,"for",a=n[32])},m(c,d){k(c,e,d),e.checked=n[1].emailVisibility,k(c,i,d),k(c,l,d),y(l,s),y(l,r),y(l,o),u||(f=[H(e,"change",n[22]),be(Oe.call(null,o,"By default other users can see only your avatar, name and username."))],u=!0)},p(c,d){d[1]&2&&t!==(t=c[32])&&p(e,"id",t),d[0]&2&&(e.checked=c[1].emailVisibility),d[1]&2&&a!==(a=c[32])&&p(l,"for",a)},d(c){c&&(v(e),v(i),v(l)),u=!1,me(f)}}}function e_(n){let e,t,i,l,s,r,o,a;return{c(){e=w("input"),i=I(),l=w("label"),s=w("span"),s.textContent="Enable email notifications for watched projects",p(e,"type","checkbox"),p(e,"id",t=n[32]),p(s,"class","txt"),p(l,"for",r=n[32])},m(u,f){k(u,e,f),e.checked=n[1].allowEmailNotifications,k(u,i,f),k(u,l,f),y(l,s),o||(a=H(e,"change",n[23]),o=!0)},p(u,f){f[1]&2&&t!==(t=u[32])&&p(e,"id",t),f[0]&2&&(e.checked=u[1].allowEmailNotifications),f[1]&2&&r!==(r=u[32])&&p(l,"for",r)},d(u){u&&(v(e),v(i),v(l)),o=!1,a()}}}function t_(n){let e,t,i,l,s,r,o,a,u,f,c,d,m,h,_;return t=new Ce({props:{class:"avatar-field block txt-center",name:"avatar",$$slots:{default:[Y1,({uniqueId:b})=>({32:b}),({uniqueId:b})=>[0,b?2:0]]},$$scope:{ctx:n}}}),l=new Ce({props:{class:"form-field",name:"name",$$slots:{default:[K1,({uniqueId:b})=>({32:b}),({uniqueId:b})=>[0,b?2:0]]},$$scope:{ctx:n}}}),r=new Ce({props:{class:"form-field required",name:"username",$$slots:{default:[G1,({uniqueId:b})=>({32:b}),({uniqueId:b})=>[0,b?2:0]]},$$scope:{ctx:n}}}),a=new Ce({props:{class:"form-field",name:"email",$$slots:{default:[Q1,({uniqueId:b})=>({32:b}),({uniqueId:b})=>[0,b?2:0]]},$$scope:{ctx:n}}}),f=new Ce({props:{class:"form-field form-field-toggle",name:"emailVisibility",$$slots:{default:[x1,({uniqueId:b})=>({32:b}),({uniqueId:b})=>[0,b?2:0]]},$$scope:{ctx:n}}}),d=new Ce({props:{class:"form-field form-field-toggle",name:"allowEmailNotifications",$$slots:{default:[e_,({uniqueId:b})=>({32:b}),({uniqueId:b})=>[0,b?2:0]]},$$scope:{ctx:n}}}),{c(){e=w("form"),F(t.$$.fragment),i=I(),F(l.$$.fragment),s=I(),F(r.$$.fragment),o=I(),F(a.$$.fragment),u=I(),F(f.$$.fragment),c=I(),F(d.$$.fragment),p(e,"id",n[10]),p(e,"class","grid grid-sm")},m(b,g){k(b,e,g),q(t,e,null),y(e,i),q(l,e,null),y(e,s),q(r,e,null),y(e,o),q(a,e,null),y(e,u),q(f,e,null),y(e,c),q(d,e,null),m=!0,h||(_=H(e,"submit",we(n[12])),h=!0)},p(b,g){const T={};g[0]&262|g[1]&6&&(T.$$scope={dirty:g,ctx:b}),t.$set(T);const L={};g[0]&2|g[1]&6&&(L.$$scope={dirty:g,ctx:b}),l.$set(L);const O={};g[0]&2|g[1]&6&&(O.$$scope={dirty:g,ctx:b}),r.$set(O);const C={};g[0]&546|g[1]&6&&(C.$$scope={dirty:g,ctx:b}),a.$set(C);const S={};g[0]&2|g[1]&6&&(S.$$scope={dirty:g,ctx:b}),f.$set(S);const P={};g[0]&2|g[1]&6&&(P.$$scope={dirty:g,ctx:b}),d.$set(P)},i(b){m||(E(t.$$.fragment,b),E(l.$$.fragment,b),E(r.$$.fragment,b),E(a.$$.fragment,b),E(f.$$.fragment,b),E(d.$$.fragment,b),m=!0)},o(b){j(t.$$.fragment,b),j(l.$$.fragment,b),j(r.$$.fragment,b),j(a.$$.fragment,b),j(f.$$.fragment,b),j(d.$$.fragment,b),m=!1},d(b){b&&v(e),$(t),$(l),$(r),$(a),$(f),$(d),h=!1,_()}}}function n_(n){let e;return{c(){e=w("h5"),e.textContent="Account settings",p(e,"class","block txt-center")},m(t,i){k(t,e,i)},p:Q,d(t){t&&v(e)}}}function i_(n){let e,t,i,l,s,r,o;return{c(){e=w("div"),e.innerHTML='<i class="iconoir-send"></i> <span class="txt">Password change request</span>',t=I(),i=w("hr"),l=I(),s=w("div"),s.innerHTML='<i class="iconoir-warning-triangle"></i> <span class="txt">Delete account</span>',p(e,"tabindex","0"),p(e,"class","dropdown-item closable"),p(s,"tabindex","0"),p(s,"class","dropdown-item closable link-danger")},m(a,u){k(a,e,u),k(a,t,u),k(a,i,u),k(a,l,u),k(a,s,u),r||(o=[H(e,"click",n[14]),H(s,"click",n[13])],r=!0)},p:Q,d(a){a&&(v(e),v(t),v(i),v(l),v(s)),r=!1,me(o)}}}function l_(n){let e,t,i,l,s,r,o,a,u,f,c,d,m,h,_,b;return s=new Rt({props:{class:"dropdown dropdown-upside dropdown-nowrap dropdown-left dropdown-sm",$$slots:{default:[i_]},$$scope:{ctx:n}}}),{c(){e=w("div"),t=w("button"),i=w("i"),l=I(),F(s.$$.fragment),r=I(),o=w("button"),a=w("span"),a.textContent="Cancel",f=I(),c=w("button"),d=w("span"),d.textContent="Save changes",p(i,"class","iconoir-more-horiz txt-lg"),p(t,"type","button"),p(t,"class","btn btn-sm btn-circle btn-transparent"),t.disabled=n[3],p(t,"aria-label","More"),p(e,"class","inline-flex m-r-auto"),p(a,"class","txt"),p(o,"type","button"),p(o,"class","btn btn-transparent"),o.disabled=u=!n[6],p(d,"class","txt"),p(c,"form",n[10]),p(c,"type","submit"),p(c,"class","btn btn-expanded-sm btn-primary"),c.disabled=m=n[3]||!n[6]||!n[7],B(c,"btn-loading",n[3])},m(g,T){k(g,e,T),y(e,t),y(t,i),y(t,l),q(s,t,null),k(g,r,T),k(g,o,T),y(o,a),k(g,f,T),k(g,c,T),y(c,d),h=!0,_||(b=H(o,"click",n[0]),_=!0)},p(g,T){const L={};T[1]&4&&(L.$$scope={dirty:T,ctx:g}),s.$set(L),(!h||T[0]&8)&&(t.disabled=g[3]),(!h||T[0]&64&&u!==(u=!g[6]))&&(o.disabled=u),(!h||T[0]&200&&m!==(m=g[3]||!g[6]||!g[7]))&&(c.disabled=m),(!h||T[0]&8)&&B(c,"btn-loading",g[3])},i(g){h||(E(s.$$.fragment,g),h=!0)},o(g){j(s.$$.fragment,g),h=!1},d(g){g&&(v(e),v(r),v(o),v(f),v(c)),$(s),_=!1,b()}}}function s_(n){let e,t,i,l,s={beforeHide:n[24],popup:!0,$$slots:{footer:[l_],header:[n_],default:[t_]},$$scope:{ctx:n}};e=new mn({props:s}),n[25](e),e.$on("show",n[26]),e.$on("hide",n[27]);let r={};return i=new z1({props:r}),n[28](i),{c(){F(e.$$.fragment),t=I(),F(i.$$.fragment)},m(o,a){q(e,o,a),k(o,t,a),q(i,o,a),l=!0},p(o,a){const u={};a[0]&64&&(u.beforeHide=o[24]),a[0]&1006|a[1]&4&&(u.$$scope={dirty:a,ctx:o}),e.$set(u);const f={};i.$set(f)},i(o){l||(E(e.$$.fragment,o),E(i.$$.fragment,o),l=!0)},o(o){j(e.$$.fragment,o),j(i.$$.fragment,o),l=!1},d(o){o&&v(t),n[25](null),$(e,o),n[28](null),$(i,o)}}}function r_(n,e,t){let i,l,s,r;ee(n,xn,U=>t(9,r=U));const o=it(),a="settings_"+K.randomString(5);let u,f,c={},d=null,m=!1,h=!1,_=!1,b="";function g(U){return L(),t(1,c=structuredClone(U||{})),t(18,b=JSON.stringify(c)),u==null?void 0:u.show()}function T(){return u==null?void 0:u.hide()}function L(){Jt({}),t(2,d=null)}function O(){t(1,c.avatar=null,c),t(2,d=null)}async function C(){t(3,m=!0);try{const U={name:c.name,username:c.username,emailVisibility:c.emailVisibility,allowEmailNotifications:c.allowEmailNotifications,avatar:c.avatar};d!=null&&d.length&&(U.avatar=d[0]),t(1,c=await V.collection("users").update(c.id,U)),t(3,m=!1),o("save",c),_t("Successfully saved account settings."),await Ot(),T()}catch(U){U.isAbort||(t(3,m=!1),V.error(U))}}function S(){if(!(c!=null&&c.id))return;let U=`Do you really want to delete your Presentator account and all of its related resources?

Note that projects that have more than one owner will not be deleted.`;t(16,h=!0),Pt(U,async()=>P(),()=>{setTimeout(()=>{t(16,h=!1)},0)})}async function P(){if(c!=null&&c.id){t(16,h=!0);try{const U=c.id==(r==null?void 0:r.id);await V.collection("users").delete(c.id),t(16,h=!1),o("delete",c),_t(`Successfully deleted user ${c.username}.`),U&&V.logout()}catch(U){U.isAbort||(V.error(U),t(16,h=!1))}}}async function R(){if(c!=null&&c.email){t(17,_=!0);try{await V.collection("users").requestPasswordReset(c.email),_t(`Successfully sent password change email to ${c.email}.`),t(17,_=!1)}catch(U){U.isAbort||(V.error(U),t(17,_=!1))}}}function A(){d=this.files,t(2,d)}function D(){c.name=this.value,t(1,c)}function M(){c.username=this.value,t(1,c)}function Z(){c.emailVisibility=this.checked,t(1,c)}function Y(){c.allowEmailNotifications=this.checked,t(1,c)}const z=()=>s;function N(U){le[U?"unshift":"push"](()=>{u=U,t(4,u)})}function W(U){$e.call(this,n,U)}function ne(U){$e.call(this,n,U)}function X(U){le[U?"unshift":"push"](()=>{f=U,t(5,f)})}return n.$$.update=()=>{n.$$.dirty[0]&6&&t(8,i=(c==null?void 0:c.avatar)||(d==null?void 0:d.length)),n.$$.dirty[0]&262150&&t(7,l=(d==null?void 0:d.length)||b!=JSON.stringify(c)),n.$$.dirty[0]&196616&&t(6,s=!m&&!h&&!_)},[T,c,d,m,u,f,s,l,i,r,a,O,C,S,R,g,h,_,b,A,D,M,Z,Y,z,N,W,ne,X]}class o_ extends ve{constructor(e){super(),ye(this,e,r_,s_,_e,{show:15,hide:0},null,[-1,-1])}get show(){return this.$$.ctx[15]}get hide(){return this.$$.ctx[0]}}function Bo(n,e,t){const i=n.slice();return i[13]=e[t][0],i[14]=e[t][1],i}const a_=n=>({}),Zo=n=>({}),u_=n=>({}),Yo=n=>({});function Ko(n){let e,t,i,l,s,r,o,a,u,f;t=new xs({props:{class:"app-logo-sm",withText:!1}});const c=n[8]["header-left"],d=st(c,n,n[12],Yo),m=n[8]["header-right"],h=st(m,n,n[12],Zo);return o=new L1({}),u=new il({props:{tabindex:"0",class:"thumb thumb-dark thumb-circle thumb-handle",user:n[6],$$slots:{default:[c_]},$$scope:{ctx:n}}}),{c(){e=w("header"),F(t.$$.fragment),i=I(),d&&d.c(),l=I(),s=w("div"),h&&h.c(),r=I(),F(o.$$.fragment),a=I(),F(u.$$.fragment),p(s,"class","inline-flex flex-gap-sm m-l-auto"),p(e,"class","app-header")},m(_,b){k(_,e,b),q(t,e,null),y(e,i),d&&d.m(e,null),y(e,l),y(e,s),h&&h.m(s,null),y(s,r),q(o,s,null),y(s,a),q(u,s,null),f=!0},p(_,b){d&&d.p&&(!f||b&4096)&&ot(d,c,_,_[12],f?rt(c,_[12],b,u_):at(_[12]),Yo),h&&h.p&&(!f||b&4096)&&ot(h,m,_,_[12],f?rt(m,_[12],b,a_):at(_[12]),Zo);const g={};b&64&&(g.user=_[6]),b&4192&&(g.$$scope={dirty:b,ctx:_}),u.$set(g)},i(_){f||(E(t.$$.fragment,_),E(d,_),E(h,_),E(o.$$.fragment,_),E(u.$$.fragment,_),f=!0)},o(_){j(t.$$.fragment,_),j(d,_),j(h,_),j(o.$$.fragment,_),j(u.$$.fragment,_),f=!1},d(_){_&&v(e),$(t),d&&d.d(_),h&&h.d(_),$(o),$(u)}}}function f_(n){let e,t,i,l,s,r,o;return{c(){e=w("button"),e.innerHTML='<i class="iconoir-settings"></i> <span class="txt">Settings</span>',t=I(),i=w("hr"),l=I(),s=w("button"),s.innerHTML='<i class="iconoir-log-out"></i> <span class="txt">Logout</span>',p(e,"type","button"),p(e,"class","dropdown-item closable"),p(s,"type","button"),p(s,"class","dropdown-item")},m(a,u){k(a,e,u),k(a,t,u),k(a,i,u),k(a,l,u),k(a,s,u),r||(o=[H(e,"click",Ze(n[9])),H(s,"click",n[10])],r=!0)},p:Q,d(a){a&&(v(e),v(t),v(i),v(l),v(s)),r=!1,me(o)}}}function c_(n){let e,t;return e=new Rt({props:{class:"dropdown",$$slots:{default:[f_]},$$scope:{ctx:n}}}),{c(){F(e.$$.fragment)},m(i,l){q(e,i,l),t=!0},p(i,l){const s={};l&4192&&(s.$$scope={dirty:l,ctx:i}),e.$set(s)},i(i){t||(E(e.$$.fragment,i),t=!0)},o(i){j(e.$$.fragment,i),t=!1},d(i){$(e,i)}}}function Go(n){var a;let e,t,i,l,s,r,o=((a=n[7])==null?void 0:a.links)&&Jo(n);return{c(){e=w("footer"),o&&o.c(),t=I(),i=w("a"),l=w("i"),s=I(),r=w("span"),r.textContent="Presentator v3.3.3",p(l,"class","iconoir-github"),p(r,"class","txt"),p(i,"href","https://github.com/presentator/presentator/releases"),p(i,"target","_blank"),p(i,"rel","noopener noreferrer"),p(e,"class","app-footer")},m(u,f){k(u,e,f),o&&o.m(e,null),y(e,t),y(e,i),y(i,l),y(i,s),y(i,r)},p(u,f){var c;(c=u[7])!=null&&c.links?o?o.p(u,f):(o=Jo(u),o.c(),o.m(e,t)):o&&(o.d(1),o=null)},d(u){u&&v(e),o&&o.d()}}}function Jo(n){var l;let e,t=Le(Object.entries((l=n[7])==null?void 0:l.links)),i=[];for(let s=0;s<t.length;s+=1)i[s]=Xo(Bo(n,t,s));return{c(){for(let s=0;s<i.length;s+=1)i[s].c();e=De()},m(s,r){for(let o=0;o<i.length;o+=1)i[o]&&i[o].m(s,r);k(s,e,r)},p(s,r){var o;if(r&128){t=Le(Object.entries((o=s[7])==null?void 0:o.links));let a;for(a=0;a<t.length;a+=1){const u=Bo(s,t,a);i[a]?i[a].p(u,r):(i[a]=Xo(u),i[a].c(),i[a].m(e.parentNode,e))}for(;a<i.length;a+=1)i[a].d(1);i.length=t.length}},d(s){s&&v(e),ln(i,s)}}}function Xo(n){let e,t=n[13]+"",i,l,s,r;return{c(){e=w("a"),i=te(t),s=I(),r=w("span"),r.textContent="|",p(e,"href",l=n[14]),p(e,"target","_blank"),p(e,"rel","noopener noreferrer"),p(r,"class","delimiter")},m(o,a){k(o,e,a),y(e,i),k(o,s,a),k(o,r,a)},p(o,a){a&128&&t!==(t=o[13]+"")&&Se(i,t),a&128&&l!==(l=o[14])&&p(e,"href",l)},d(o){o&&(v(e),v(s),v(r))}}}function d_(n){let e,t,i,l,s,r,o,a,u,f,c;document.title=e=K.joinNonEmpty([n[1],"Presentator"]," - ");let d=n[2]&&Ko(n);const m=n[8].default,h=st(m,n,n[12],null);let _=n[3]&&Go(n),b={};return f=new o_({props:b}),n[11](f),{c(){t=I(),i=w("div"),d&&d.c(),l=I(),s=w("main"),r=w("div"),h&&h.c(),o=I(),_&&_.c(),u=I(),F(f.$$.fragment),p(r,"class","app-content"),p(s,"class","app-body"),p(i,"class",a="app-layout "+n[0]),B(i,"fullpage",n[4])},m(g,T){k(g,t,T),k(g,i,T),d&&d.m(i,null),y(i,l),y(i,s),y(s,r),h&&h.m(r,null),y(s,o),_&&_.m(s,null),k(g,u,T),q(f,g,T),c=!0},p(g,[T]){(!c||T&2)&&e!==(e=K.joinNonEmpty([g[1],"Presentator"]," - "))&&(document.title=e),g[2]?d?(d.p(g,T),T&4&&E(d,1)):(d=Ko(g),d.c(),E(d,1),d.m(i,l)):d&&(ae(),j(d,1,1,()=>{d=null}),ue()),h&&h.p&&(!c||T&4096)&&ot(h,m,g,g[12],c?rt(m,g[12],T,null):at(g[12]),null),g[3]?_?_.p(g,T):(_=Go(g),_.c(),_.m(s,null)):_&&(_.d(1),_=null),(!c||T&1&&a!==(a="app-layout "+g[0]))&&p(i,"class",a),(!c||T&17)&&B(i,"fullpage",g[4]);const L={};f.$set(L)},i(g){c||(E(d),E(h,g),E(f.$$.fragment,g),c=!0)},o(g){j(d),j(h,g),j(f.$$.fragment,g),c=!1},d(g){g&&(v(t),v(i),v(u)),d&&d.d(),h&&h.d(g),_&&_.d(),n[11](null),$(f,g)}}}function p_(n,e,t){let i,l;ee(n,xn,b=>t(6,i=b)),ee(n,vi,b=>t(7,l=b));let{$$slots:s={},$$scope:r}=e,{class:o=""}=e,{title:a=""}=e,{header:u=!0}=e,{footer:f=!0}=e,{fullpage:c=!1}=e,d;const m=()=>d==null?void 0:d.show(i),h=()=>V.logout();function _(b){le[b?"unshift":"push"](()=>{d=b,t(5,d)})}return n.$$set=b=>{"class"in b&&t(0,o=b.class),"title"in b&&t(1,a=b.title),"header"in b&&t(2,u=b.header),"footer"in b&&t(3,f=b.footer),"fullpage"in b&&t(4,c=b.fullpage),"$$scope"in b&&t(12,r=b.$$scope)},[o,a,u,f,c,d,i,l,s,m,h,_,r]}class Ni extends ve{constructor(e){super(),ye(this,e,p_,d_,_e,{class:0,title:1,header:2,footer:3,fullpage:4})}}function Qo(n,e,t){const i=n.slice();return i[8]=e[t],i}function m_(n){let e,t,i,l,s;function r(){return n[4](n[8])}function o(){return n[5](n[8])}return{c(){e=w("img"),Zn(e.src,t=V.baseURL+"/_/images/oauth2/"+n[8].name+".svg")||p(e,"src",t),p(e,"alt",i=n[8].displayName+" logo"),p(e,"class","svelte-l24196")},m(a,u){k(a,e,u),l||(s=[H(e,"error",r),H(e,"load",o)],l=!0)},p(a,u){n=a,u&1&&!Zn(e.src,t=V.baseURL+"/_/images/oauth2/"+n[8].name+".svg")&&p(e,"src",t),u&1&&i!==(i=n[8].displayName+" logo")&&p(e,"alt",i)},d(a){a&&v(e),l=!1,me(s)}}}function h_(n){let e;return{c(){e=w("i"),p(e,"class","iconoir-fingerprint")},m(t,i){k(t,e,i)},p:Q,d(t){t&&v(e)}}}function xo(n){let e,t,i,l,s;function r(f,c){return f[1][f[8].name]?h_:m_}let o=r(n),a=o(n);function u(){return n[6](n[8])}return{c(){e=w("button"),a.c(),t=I(),p(e,"type","button"),p(e,"class","auth-provider svelte-l24196")},m(f,c){k(f,e,c),a.m(e,null),y(e,t),l||(s=[be(i=Oe.call(null,e,n[8].displayName)),H(e,"click",u)],l=!0)},p(f,c){n=f,o===(o=r(n))&&a?a.p(n,c):(a.d(1),a=o(n),a&&(a.c(),a.m(e,t))),i&&et(i.update)&&c&1&&i.update.call(null,n[8].displayName)},d(f){f&&v(e),a.d(),l=!1,me(s)}}}function __(n){let e,t=Le(n[0]),i=[];for(let l=0;l<t.length;l+=1)i[l]=xo(Qo(n,t,l));return{c(){e=w("nav");for(let l=0;l<i.length;l+=1)i[l].c();p(e,"class","auth-providers-list svelte-l24196")},m(l,s){k(l,e,s);for(let r=0;r<i.length;r+=1)i[r]&&i[r].m(e,null)},p(l,[s]){if(s&7){t=Le(l[0]);let r;for(r=0;r<t.length;r+=1){const o=Qo(l,t,r);i[r]?i[r].p(o,s):(i[r]=xo(o),i[r].c(),i[r].m(e,null))}for(;r<i.length;r+=1)i[r].d(1);i.length=t.length}},i:Q,o:Q,d(l){l&&v(e),ln(i,l)}}}function g_(n,e,t){const i=it();let{mfaId:l=null}=e,{providers:s=[]}=e,r={};function o(c){V.collection("users").authWithOAuth2({provider:c,mfaId:l,createData:{allowEmailNotifications:!0}}).then(()=>{i("submit",{})}).catch(d=>{var m;d.isAbort||((m=d.response)!=null&&m.mfaId?(t(3,l=d.response.mfaId),addWarningToast("Second authentication factor is required."),i("submit",{mfaId:l})):V.error(d))})}const a=c=>{t(1,r[c.name]=!0,r)},u=c=>{delete r[c.name]},f=c=>o(c.name);return n.$$set=c=>{"mfaId"in c&&t(3,l=c.mfaId),"providers"in c&&t(0,s=c.providers)},[s,r,o,l,a,u,f]}class dd extends ve{constructor(e){super(),ye(this,e,g_,__,_e,{mfaId:3,providers:0})}}function b_(n){let e,t;return e=new Ce({props:{class:"form-field form-field-lg",name:"email",$$slots:{default:[y_,({uniqueId:i})=>({11:i}),({uniqueId:i})=>i?2048:0]},$$scope:{ctx:n}}}),{c(){F(e.$$.fragment)},m(i,l){q(e,i,l),t=!0},p(i,l){const s={};l&6145&&(s.$$scope={dirty:l,ctx:i}),e.$set(s)},i(i){t||(E(e.$$.fragment,i),t=!0)},o(i){j(e.$$.fragment,i),t=!1},d(i){$(e,i)}}}function w_(n){let e,t,i,l;return i=new Ce({props:{class:"form-field form-field-lg",name:"password",$$slots:{default:[v_,({uniqueId:s})=>({11:s}),({uniqueId:s})=>s?2048:0]},$$scope:{ctx:n}}}),{c(){e=w("p"),e.textContent="Check your email and enter below the received OTP:",t=I(),F(i.$$.fragment),p(e,"class","m-b-sm")},m(s,r){k(s,e,r),k(s,t,r),q(i,s,r),l=!0},p(s,r){const o={};r&6148&&(o.$$scope={dirty:r,ctx:s}),i.$set(o)},i(s){l||(E(i.$$.fragment,s),l=!0)},o(s){j(i.$$.fragment,s),l=!1},d(s){s&&(v(e),v(t)),$(i,s)}}}function y_(n){let e,t,i,l,s,r,o,a,u;return{c(){e=w("div"),t=w("label"),i=w("i"),s=I(),r=w("input"),p(i,"class","iconoir-mail-open"),p(t,"for",l=n[11]),p(t,"class","addon prefix"),r.autofocus=!0,r.required=!0,p(r,"type","email"),p(r,"id",o=n[11]),p(r,"placeholder","Email"),p(e,"class","field-group")},m(f,c){k(f,e,c),y(e,t),y(t,i),y(e,s),y(e,r),ge(r,n[0]),r.focus(),a||(u=[be(Oe.call(null,t,{position:"left",text:"Email"})),H(r,"input",n[7])],a=!0)},p(f,c){c&2048&&l!==(l=f[11])&&p(t,"for",l),c&2048&&o!==(o=f[11])&&p(r,"id",o),c&1&&r.value!==f[0]&&ge(r,f[0])},d(f){f&&v(e),a=!1,me(u)}}}function v_(n){let e,t,i,l,s,r,o,a,u;return{c(){e=w("div"),t=w("label"),i=w("i"),s=I(),r=w("input"),p(i,"class","iconoir-lock"),p(t,"for",l=n[11]),p(t,"class","addon prefix"),r.autofocus=!0,r.required=!0,p(r,"type","password"),p(r,"id",o=n[11]),p(r,"placeholder","OTP"),p(e,"class","field-group")},m(f,c){k(f,e,c),y(e,t),y(t,i),y(e,s),y(e,r),ge(r,n[2]),r.focus(),a||(u=[be(Oe.call(null,t,{position:"left",text:"Email"})),H(r,"input",n[6])],a=!0)},p(f,c){c&2048&&l!==(l=f[11])&&p(t,"for",l),c&2048&&o!==(o=f[11])&&p(r,"id",o),c&4&&r.value!==f[2]&&ge(r,f[2])},d(f){f&&v(e),a=!1,me(u)}}}function k_(n){let e,t,i;return{c(){e=w("span"),e.textContent="Login",t=I(),i=w("i"),p(e,"class","txt"),p(i,"class","iconoir-arrow-right")},m(l,s){k(l,e,s),k(l,t,s),k(l,i,s)},d(l){l&&(v(e),v(t),v(i))}}}function S_(n){let e,t,i;return{c(){e=w("i"),t=I(),i=w("span"),i.textContent="Send OTP",p(e,"class","iconoir-send-mail"),p(i,"class","txt")},m(l,s){k(l,e,s),k(l,t,s),k(l,i,s)},d(l){l&&(v(e),v(t),v(i))}}}function T_(n){let e,t,i,l,s,r,o,a;const u=[w_,b_],f=[];function c(_,b){return _[1]?0:1}t=c(n),i=f[t]=u[t](n);function d(_,b){return _[1]?k_:S_}let m=d(n),h=m(n);return{c(){e=w("form"),i.c(),l=I(),s=w("button"),h.c(),p(s,"type","submit"),p(s,"class","btn btn-block btn-lg btn-primary btn-next"),B(s,"btn-disabled",n[3]),B(s,"btn-loading",n[3])},m(_,b){k(_,e,b),f[t].m(e,null),y(e,l),y(e,s),h.m(s,null),r=!0,o||(a=H(e,"submit",we(n[4])),o=!0)},p(_,[b]){let g=t;t=c(_),t===g?f[t].p(_,b):(ae(),j(f[g],1,1,()=>{f[g]=null}),ue(),i=f[t],i?i.p(_,b):(i=f[t]=u[t](_),i.c()),E(i,1),i.m(e,l)),m!==(m=d(_))&&(h.d(1),h=m(_),h&&(h.c(),h.m(s,null))),(!r||b&8)&&B(s,"btn-disabled",_[3]),(!r||b&8)&&B(s,"btn-loading",_[3])},i(_){r||(E(i),r=!0)},o(_){j(i),r=!1},d(_){_&&v(e),f[t].d(),h.d(),o=!1,a()}}}function O_(n,e,t){const i=it();let{mfaId:l=null}=e,{email:s=""}=e,r="",o="",a=!1;async function u(){a||(t(3,a=!0),r?await c():await f(),t(3,a=!1))}async function f(){t(1,r="");try{const h=await V.collection("users").requestOTP(s);t(1,r=h.otpId),Ji()}catch(h){V.error(h)}}async function c(){var h;try{await V.collection("users").authWithOTP(r,o,{mfaId:l}),i("submit",{})}catch(_){(h=_==null?void 0:_.response)!=null&&h.mfaId?(t(5,l=_.response.mfaId),Js("Second authentication factor is required."),i("submit",{mfaId:l})):V.error(_)}}function d(){o=this.value,t(2,o)}function m(){s=this.value,t(0,s)}return n.$$set=h=>{"mfaId"in h&&t(5,l=h.mfaId),"email"in h&&t(0,s=h.email)},[s,r,o,a,u,l,d,m]}class C_ extends ve{constructor(e){super(),ye(this,e,O_,T_,_e,{mfaId:5,email:0})}}function E_(n){let e,t,i,l,s,r,o,a,u,f;return{c(){e=w("div"),t=w("label"),i=w("i"),r=I(),o=w("input"),p(i,"class","iconoir-user"),p(t,"for",l=n[10]),p(t,"class","addon prefix"),o.autofocus=!0,o.required=!0,p(o,"type","text"),p(o,"id",a=n[10]),p(o,"placeholder",n[2]),p(e,"class","field-group")},m(c,d){k(c,e,d),y(e,t),y(t,i),y(e,r),y(e,o),ge(o,n[0]),o.focus(),u||(f=[be(s=Oe.call(null,t,{position:"left",text:n[2]})),H(o,"input",n[7])],u=!0)},p(c,d){d&1024&&l!==(l=c[10])&&p(t,"for",l),s&&et(s.update)&&d&4&&s.update.call(null,{position:"left",text:c[2]}),d&1024&&a!==(a=c[10])&&p(o,"id",a),d&4&&p(o,"placeholder",c[2]),d&1&&o.value!==c[0]&&ge(o,c[0])},d(c){c&&v(e),u=!1,me(f)}}}function L_(n){let e,t,i,l,s,r,o,a,u,f,c;return{c(){e=w("div"),t=w("label"),i=w("i"),s=I(),r=w("input"),a=I(),u=w("a"),u.textContent="Forgotten password?",p(i,"class","iconoir-lock"),p(t,"for",l=n[10]),p(t,"class","addon prefix"),r.required=!0,p(r,"type","password"),p(r,"id",o=n[10]),p(r,"placeholder","Password"),p(e,"class","field-group m-b-10"),p(u,"href","/forgotten-password"),p(u,"class","link-primary txt-sm")},m(d,m){k(d,e,m),y(e,t),y(t,i),y(e,s),y(e,r),ge(r,n[1]),k(d,a,m),k(d,u,m),f||(c=[be(Oe.call(null,t,{position:"left",text:"Password"})),H(r,"input",n[8]),be(Oi.call(null,u))],f=!0)},p(d,m){m&1024&&l!==(l=d[10])&&p(t,"for",l),m&1024&&o!==(o=d[10])&&p(r,"id",o),m&2&&r.value!==d[1]&&ge(r,d[1])},d(d){d&&(v(e),v(a),v(u)),f=!1,me(c)}}}function I_(n){let e,t,i,l,s,r,o,a,u;return t=new Ce({props:{class:"form-field form-field-lg",name:"identity",$$slots:{default:[E_,({uniqueId:f})=>({10:f}),({uniqueId:f})=>f?1024:0]},$$scope:{ctx:n}}}),l=new Ce({props:{class:"form-field form-field-lg",name:"password",$$slots:{default:[L_,({uniqueId:f})=>({10:f}),({uniqueId:f})=>f?1024:0]},$$scope:{ctx:n}}}),{c(){e=w("form"),F(t.$$.fragment),i=I(),F(l.$$.fragment),s=I(),r=w("button"),r.innerHTML='<span class="txt">Login</span> <i class="iconoir-arrow-right"></i>',p(r,"type","submit"),p(r,"class","btn btn-block btn-lg btn-primary btn-next"),B(r,"btn-disabled",n[3]),B(r,"btn-loading",n[3])},m(f,c){k(f,e,c),q(t,e,null),y(e,i),q(l,e,null),y(e,s),y(e,r),o=!0,a||(u=H(e,"submit",we(n[4])),a=!0)},p(f,[c]){const d={};c&3077&&(d.$$scope={dirty:c,ctx:f}),t.$set(d);const m={};c&3074&&(m.$$scope={dirty:c,ctx:f}),l.$set(m),(!o||c&8)&&B(r,"btn-disabled",f[3]),(!o||c&8)&&B(r,"btn-loading",f[3])},i(f){o||(E(t.$$.fragment,f),E(l.$$.fragment,f),o=!0)},o(f){j(t.$$.fragment,f),j(l.$$.fragment,f),o=!1},d(f){f&&v(e),$(t),$(l),a=!1,u()}}}function j_(n,e,t){const i=it();let{identityFields:l=[]}=e,{mfaId:s=null}=e,{identity:r=""}=e,{password:o=""}=e,a="",u=!1;async function f(){var m;if(!u){t(3,u=!0);try{await V.collection("users").authWithPassword(r,o,{mfaId:s}),Ji(),i("submit",{})}catch(h){(m=h==null?void 0:h.response)!=null&&m.mfaId?(t(5,s=h.response.mfaId),Js("Second authentication factor is required."),i("submit",{mfaId:s})):Gs("Invalid login credentials or unverified user.")}t(3,u=!1)}}function c(){r=this.value,t(0,r)}function d(){o=this.value,t(1,o)}return n.$$set=m=>{"identityFields"in m&&t(6,l=m.identityFields),"mfaId"in m&&t(5,s=m.mfaId),"identity"in m&&t(0,r=m.identity),"password"in m&&t(1,o=m.password)},n.$$.update=()=>{n.$$.dirty&64&&t(2,a=K.sentenize((l==null?void 0:l.join(" or "))||"",!1))},[r,o,a,u,f,s,l,c,d]}class P_ extends ve{constructor(e){super(),ye(this,e,j_,I_,_e,{identityFields:6,mfaId:5,identity:0,password:1})}}function N_(n){let e,t,i,l=n[7]&&!n[1].includes("oaut2"),s,r=n[2]&&ea(n),o=n[6]&&ta(n),a=l&&na(n);return{c(){e=w("div"),r&&r.c(),t=I(),o&&o.c(),i=I(),a&&a.c(),p(e,"class","panel-content")},m(u,f){k(u,e,f),r&&r.m(e,null),y(e,t),o&&o.m(e,null),y(e,i),a&&a.m(e,null),s=!0},p(u,f){u[2]?r?(r.p(u,f),f&4&&E(r,1)):(r=ea(u),r.c(),E(r,1),r.m(e,t)):r&&(ae(),j(r,1,1,()=>{r=null}),ue()),u[6]?o?(o.p(u,f),f&64&&E(o,1)):(o=ta(u),o.c(),E(o,1),o.m(e,i)):o&&(ae(),j(o,1,1,()=>{o=null}),ue()),f&130&&(l=u[7]&&!u[1].includes("oaut2")),l?a?(a.p(u,f),f&130&&E(a,1)):(a=na(u),a.c(),E(a,1),a.m(e,null)):a&&(ae(),j(a,1,1,()=>{a=null}),ue())},i(u){s||(E(r),E(o),E(a),s=!0)},o(u){j(r),j(o),j(a),s=!1},d(u){u&&v(e),r&&r.d(),o&&o.d(),a&&a.d()}}}function A_(n){let e;return{c(){e=w("span"),p(e,"class","loader")},m(t,i){k(t,e,i)},p:Q,i:Q,o:Q,d(t){t&&v(e)}}}function ea(n){let e,t,i,l;function s(a){n[11](a)}function r(a){n[12](a)}let o={identityFields:n[0].password.identityFields};return n[4]!==void 0&&(o.mfaId=n[4]),n[5]!==void 0&&(o.identity=n[5]),e=new P_({props:o}),le.push(()=>Ae(e,"mfaId",s)),le.push(()=>Ae(e,"identity",r)),e.$on("submit",n[13]),{c(){F(e.$$.fragment)},m(a,u){q(e,a,u),l=!0},p(a,u){const f={};u&1&&(f.identityFields=a[0].password.identityFields),!t&&u&16&&(t=!0,f.mfaId=a[4],Ne(()=>t=!1)),!i&&u&32&&(i=!0,f.identity=a[5],Ne(()=>i=!1)),e.$set(f)},i(a){l||(E(e.$$.fragment,a),l=!0)},o(a){j(e.$$.fragment,a),l=!1},d(a){$(e,a)}}}function ta(n){let e,t,i;function l(r){n[14](r)}let s={email:n[5].includes("@")?n[5]:""};return n[4]!==void 0&&(s.mfaId=n[4]),e=new C_({props:s}),le.push(()=>Ae(e,"mfaId",l)),e.$on("submit",n[15]),{c(){F(e.$$.fragment)},m(r,o){q(e,r,o),i=!0},p(r,o){const a={};o&32&&(a.email=r[5].includes("@")?r[5]:""),!t&&o&16&&(t=!0,a.mfaId=r[4],Ne(()=>t=!1)),e.$set(a)},i(r){i||(E(e.$$.fragment,r),i=!0)},o(r){j(e.$$.fragment,r),i=!1},d(r){$(e,r)}}}function na(n){let e,t,i,l;function s(f,c){return f[2]||f[6]?M_:D_}let r=s(n),o=r(n);function a(f){n[16](f)}let u={providers:n[0].oauth2.providers};return n[4]!==void 0&&(u.mfaId=n[4]),t=new dd({props:u}),le.push(()=>Ae(t,"mfaId",a)),t.$on("submit",n[17]),{c(){o.c(),e=I(),F(t.$$.fragment)},m(f,c){o.m(f,c),k(f,e,c),q(t,f,c),l=!0},p(f,c){r!==(r=s(f))&&(o.d(1),o=r(f),o&&(o.c(),o.m(e.parentNode,e)));const d={};c&1&&(d.providers=f[0].oauth2.providers),!i&&c&16&&(i=!0,d.mfaId=f[4],Ne(()=>i=!1)),t.$set(d)},i(f){l||(E(t.$$.fragment,f),l=!0)},o(f){j(t.$$.fragment,f),l=!1},d(f){f&&v(e),o.d(f),$(t,f)}}}function D_(n){let e;return{c(){e=w("p"),e.textContent="Sign in with",p(e,"class","m-b-sm")},m(t,i){k(t,e,i)},d(t){t&&v(e)}}}function M_(n){let e;return{c(){e=w("p"),e.textContent="Or sign in with",p(e,"class","m-t-base m-b-sm")},m(t,i){k(t,e,i)},d(t){t&&v(e)}}}function R_(n){let e,t,i,l,s,r,o,a,u,f,c,d,m,h,_;i=new xs({});const b=[A_,N_],g=[];function T(L,O){return L[3]?0:1}return a=T(n),u=g[a]=b[a](n),{c(){e=w("div"),t=w("header"),F(i.$$.fragment),l=I(),s=w("div"),r=w("h4"),r.textContent=`${pd}`,o=I(),u.c(),f=I(),c=w("div"),d=w("a"),d.innerHTML="Don&#39;t have an account yet? <strong>Register!</strong>",p(t,"class","block txt-center m-b-base"),p(r,"class","m-b-base"),p(s,"class","panel txt-center"),p(d,"href","/register"),p(d,"class","fade"),p(c,"class","block txt-center m-t-base"),p(e,"class","wrapper wrapper-sm m-b-base entrance-top")},m(L,O){k(L,e,O),y(e,t),q(i,t,null),y(e,l),y(e,s),y(s,r),y(s,o),g[a].m(s,null),y(e,f),y(e,c),y(c,d),m=!0,h||(_=be(Oi.call(null,d)),h=!0)},p(L,O){let C=a;a=T(L),a===C?g[a].p(L,O):(ae(),j(g[C],1,1,()=>{g[C]=null}),ue(),u=g[a],u?u.p(L,O):(u=g[a]=b[a](L),u.c()),E(u,1),u.m(s,null))},i(L){m||(E(i.$$.fragment,L),E(u),m=!0)},o(L){j(i.$$.fragment,L),j(u),m=!1},d(L){L&&v(e),$(i),g[a].d(),h=!1,_()}}}function H_(n){let e,t;return e=new Ni({props:{fullpage:!0,header:!1,title:pd,$$slots:{default:[R_]},$$scope:{ctx:n}}}),{c(){F(e.$$.fragment)},m(i,l){q(e,i,l),t=!0},p(i,[l]){const s={};l&524543&&(s.$$scope={dirty:l,ctx:i}),e.$set(s)},i(i){t||(E(e.$$.fragment,i),t=!0)},o(i){j(e.$$.fragment,i),t=!1},d(i){$(e,i)}}}const pd="Login";function U_(n,e,t){let i,l,s,r,o,a={},u=!1,f=null,c="",d=[];m();async function m(){t(3,u=!0);try{t(0,a=await V.collection("users").listAuthMethods()),t(3,u=!1)}catch(S){S!=null&&S.isAbort&&(V.error(S),t(3,u=!1))}}function h(S,P){d.push(S),t(1,d),P||(Ji(),V.replaceWithRemembered())}function _(S){f=S,t(4,f)}function b(S){c=S,t(5,c)}const g=S=>{var P;return h("passwordAuth",(P=S.detail)==null?void 0:P.mfaId)};function T(S){f=S,t(4,f)}const L=S=>{var P;return h("otp",(P=S.detail)==null?void 0:P.mfaId)};function O(S){f=S,t(4,f)}const C=S=>{var P;return h("oauth2",(P=S.detail)==null?void 0:P.mfaId)};return n.$$.update=()=>{var S,P,R,A,D;n.$$.dirty&1&&t(7,i=((S=a.oauth2)==null?void 0:S.enabled)&&((R=(P=a.oauth2)==null?void 0:P.providers)==null?void 0:R.length)),n.$$.dirty&1&&t(9,l=(A=a.otp)==null?void 0:A.enabled),n.$$.dirty&1&&t(10,s=(D=a.password)==null?void 0:D.enabled),n.$$.dirty&1026&&t(2,r=s&&!d.includes("passwordAuth")),n.$$.dirty&518&&t(6,o=!r&&l&&!d.includes("otp"))},[a,d,r,u,f,c,o,i,h,l,s,_,b,g,T,L,O,C]}class q_ extends ve{constructor(e){super(),ye(this,e,U_,H_,_e,{})}}function $_(n){let e,t,i,l=n[10]&&ia(n),s=n[9]&&la(n);return{c(){e=w("div"),l&&l.c(),t=I(),s&&s.c(),p(e,"class","panel-content")},m(r,o){k(r,e,o),l&&l.m(e,null),y(e,t),s&&s.m(e,null),i=!0},p(r,o){r[10]?l?(l.p(r,o),o&1024&&E(l,1)):(l=ia(r),l.c(),E(l,1),l.m(e,t)):l&&(ae(),j(l,1,1,()=>{l=null}),ue()),r[9]?s?(s.p(r,o),o&512&&E(s,1)):(s=la(r),s.c(),E(s,1),s.m(e,null)):s&&(ae(),j(s,1,1,()=>{s=null}),ue())},i(r){i||(E(l),E(s),i=!0)},o(r){j(l),j(s),i=!1},d(r){r&&v(e),l&&l.d(),s&&s.d()}}}function F_(n){let e;return{c(){e=w("span"),p(e,"class","loader")},m(t,i){k(t,e,i)},p:Q,i:Q,o:Q,d(t){t&&v(e)}}}function W_(n){let e,t,i,l,s,r,o,a;return{c(){e=w("div"),t=w("div"),i=w("p"),l=te(`Go check your email to verify your account:
                            `),s=w("br"),r=I(),o=w("strong"),a=te(n[0]),p(t,"class","content txt-center"),p(e,"class","alert m-0")},m(u,f){k(u,e,f),y(e,t),y(t,i),y(i,l),y(i,s),y(i,r),y(i,o),y(o,a)},p(u,f){f&1&&Se(a,u[0])},i:Q,o:Q,d(u){u&&v(e)}}}function ia(n){let e,t,i,l,s,r,o,a,u,f,c,d,m,h,_,b;return e=new Ce({props:{class:"form-field form-field-lg",name:"email",$$slots:{default:[V_,({uniqueId:g})=>({22:g}),({uniqueId:g})=>g?4194304:0]},$$scope:{ctx:n}}}),i=new Ce({props:{class:"form-field form-field-lg",name:"username",$$slots:{default:[z_,({uniqueId:g})=>({22:g}),({uniqueId:g})=>g?4194304:0]},$$scope:{ctx:n}}}),s=new Ce({props:{class:"form-field form-field-lg",name:"password",$$slots:{default:[B_,({uniqueId:g})=>({22:g}),({uniqueId:g})=>g?4194304:0]},$$scope:{ctx:n}}}),o=new Ce({props:{class:"form-field form-field-lg",name:"passwordConfirm",$$slots:{default:[Z_,({uniqueId:g})=>({22:g}),({uniqueId:g})=>g?4194304:0]},$$scope:{ctx:n}}}),{c(){F(e.$$.fragment),t=I(),F(i.$$.fragment),l=I(),F(s.$$.fragment),r=I(),F(o.$$.fragment),a=I(),u=w("button"),u.innerHTML='<span class="txt">Register</span> <i class="iconoir-arrow-right"></i>',f=I(),c=w("p"),d=te(`By registering you agree with our
                            `),m=w("a"),h=te("Terms and Privacy policy"),p(u,"type","submit"),p(u,"class","btn btn-block btn-lg btn-primary btn-next"),B(u,"btn-disabled",n[6]),B(u,"btn-loading",n[6]),p(m,"href",_=n[11].termsURL),p(m,"target","_blank"),p(m,"rel","noreferrer noopener"),p(c,"class","m-t-xs m-b-sm txt-sm txt-hint")},m(g,T){q(e,g,T),k(g,t,T),q(i,g,T),k(g,l,T),q(s,g,T),k(g,r,T),q(o,g,T),k(g,a,T),k(g,u,T),k(g,f,T),k(g,c,T),y(c,d),y(c,m),y(m,h),b=!0},p(g,T){const L={};T&12582913&&(L.$$scope={dirty:T,ctx:g}),e.$set(L);const O={};T&12582924&&(O.$$scope={dirty:T,ctx:g}),i.$set(O);const C={};T&12582928&&(C.$$scope={dirty:T,ctx:g}),s.$set(C);const S={};T&12582944&&(S.$$scope={dirty:T,ctx:g}),o.$set(S),(!b||T&64)&&B(u,"btn-disabled",g[6]),(!b||T&64)&&B(u,"btn-loading",g[6]),(!b||T&2048&&_!==(_=g[11].termsURL))&&p(m,"href",_)},i(g){b||(E(e.$$.fragment,g),E(i.$$.fragment,g),E(s.$$.fragment,g),E(o.$$.fragment,g),b=!0)},o(g){j(e.$$.fragment,g),j(i.$$.fragment,g),j(s.$$.fragment,g),j(o.$$.fragment,g),b=!1},d(g){g&&(v(t),v(l),v(r),v(a),v(u),v(f),v(c)),$(e,g),$(i,g),$(s,g),$(o,g)}}}function V_(n){let e,t,i,l,s,r,o,a,u;return{c(){e=w("div"),t=w("label"),i=w("i"),s=I(),r=w("input"),p(i,"class","iconoir-mail"),p(t,"for",l=n[22]),p(t,"class","addon prefix"),r.autofocus=!0,p(r,"type","email"),p(r,"id",o=n[22]),p(r,"name","register_email"),p(r,"placeholder","Email"),p(e,"class","field-group")},m(f,c){k(f,e,c),y(e,t),y(t,i),y(e,s),y(e,r),ge(r,n[0]),r.focus(),a||(u=[be(Oe.call(null,t,{position:"left",text:"Email"})),H(r,"input",n[14])],a=!0)},p(f,c){c&4194304&&l!==(l=f[22])&&p(t,"for",l),c&4194304&&o!==(o=f[22])&&p(r,"id",o),c&1&&r.value!==f[0]&&ge(r,f[0])},d(f){f&&v(e),a=!1,me(u)}}}function z_(n){let e,t,i,l,s,r,o,a,u;return{c(){e=w("div"),t=w("label"),i=w("i"),s=I(),r=w("input"),p(i,"class","iconoir-user"),p(t,"for",l=n[22]),p(t,"class","addon prefix"),p(r,"type","text"),p(r,"id",o=n[22]),p(r,"name","register_username"),p(r,"placeholder","Username"),p(e,"class","field-group")},m(f,c){k(f,e,c),y(e,t),y(t,i),y(e,s),y(e,r),ge(r,n[3]),a||(u=[be(Oe.call(null,t,{position:"left",text:"Username"})),H(r,"input",n[15]),H(r,"input",n[16])],a=!0)},p(f,c){c&4194304&&l!==(l=f[22])&&p(t,"for",l),c&4194304&&o!==(o=f[22])&&p(r,"id",o),c&8&&r.value!==f[3]&&ge(r,f[3])},d(f){f&&v(e),a=!1,me(u)}}}function B_(n){let e,t,i,l,s,r,o,a,u;return{c(){e=w("div"),t=w("label"),i=w("i"),s=I(),r=w("input"),p(i,"class","iconoir-lock"),p(t,"for",l=n[22]),p(t,"class","addon prefix"),r.required=!0,p(r,"type","password"),p(r,"id",o=n[22]),p(r,"name","register_password"),p(r,"placeholder","Password"),p(e,"class","field-group")},m(f,c){k(f,e,c),y(e,t),y(t,i),y(e,s),y(e,r),ge(r,n[4]),a||(u=[be(Oe.call(null,t,{position:"left",text:"Password"})),H(r,"input",n[17])],a=!0)},p(f,c){c&4194304&&l!==(l=f[22])&&p(t,"for",l),c&4194304&&o!==(o=f[22])&&p(r,"id",o),c&16&&r.value!==f[4]&&ge(r,f[4])},d(f){f&&v(e),a=!1,me(u)}}}function Z_(n){let e,t,i,l,s,r,o,a,u;return{c(){e=w("div"),t=w("label"),i=w("i"),s=I(),r=w("input"),p(i,"class","iconoir-lock"),p(t,"for",l=n[22]),p(t,"class","addon prefix"),r.required=!0,p(r,"type","password"),p(r,"id",o=n[22]),p(r,"name","register_passwordConfirm"),p(r,"placeholder","Password confirm"),p(r,"autocomplete","new-password"),p(e,"class","field-group")},m(f,c){k(f,e,c),y(e,t),y(t,i),y(e,s),y(e,r),ge(r,n[5]),a||(u=[be(Oe.call(null,t,{position:"left",text:"Password confirm"})),H(r,"input",n[18])],a=!0)},p(f,c){c&4194304&&l!==(l=f[22])&&p(t,"for",l),c&4194304&&o!==(o=f[22])&&p(r,"id",o),c&32&&r.value!==f[5]&&ge(r,f[5])},d(f){f&&v(e),a=!1,me(u)}}}function la(n){let e,t,i;function l(o,a){return o[10]?K_:Y_}let s=l(n),r=s(n);return t=new dd({props:{providers:n[1].oauth2.providers}}),t.$on("submit",n[19]),{c(){r.c(),e=I(),F(t.$$.fragment)},m(o,a){r.m(o,a),k(o,e,a),q(t,o,a),i=!0},p(o,a){s!==(s=l(o))&&(r.d(1),r=s(o),r&&(r.c(),r.m(e.parentNode,e)));const u={};a&2&&(u.providers=o[1].oauth2.providers),t.$set(u)},i(o){i||(E(t.$$.fragment,o),i=!0)},o(o){j(t.$$.fragment,o),i=!1},d(o){o&&v(e),r.d(o),$(t,o)}}}function Y_(n){let e;return{c(){e=w("p"),e.textContent="Sign up with",p(e,"class","m-b-sm")},m(t,i){k(t,e,i)},d(t){t&&v(e)}}}function K_(n){let e;return{c(){e=w("p"),e.textContent="Or sign up with",p(e,"class","m-t-base m-b-sm")},m(t,i){k(t,e,i)},d(t){t&&v(e)}}}function G_(n){let e,t,i,l,s,r,o,a,u,f,c,d,m,h,_;i=new xs({});const b=[W_,F_,$_],g=[];function T(L,O){return L[8]?0:L[7]?1:2}return a=T(n),u=g[a]=b[a](n),{c(){e=w("div"),t=w("header"),F(i.$$.fragment),l=I(),s=w("form"),r=w("h4"),r.textContent=`${md}`,o=I(),u.c(),f=I(),c=w("div"),d=w("a"),d.innerHTML="Already have an account? <strong>Login!</strong>",p(t,"class","block txt-center m-b-base"),p(r,"class","m-b-base"),p(s,"class","panel txt-center"),p(s,"autocomplete","off"),p(d,"href","/login"),p(d,"class","fade"),p(c,"class","block txt-center m-t-base"),p(e,"class","wrapper wrapper-sm m-b-base entrance-top")},m(L,O){k(L,e,O),y(e,t),q(i,t,null),y(e,l),y(e,s),y(s,r),y(s,o),g[a].m(s,null),y(e,f),y(e,c),y(c,d),m=!0,h||(_=[H(s,"submit",we(n[12])),be(Oi.call(null,d))],h=!0)},p(L,O){let C=a;a=T(L),a===C?g[a].p(L,O):(ae(),j(g[C],1,1,()=>{g[C]=null}),ue(),u=g[a],u?u.p(L,O):(u=g[a]=b[a](L),u.c()),E(u,1),u.m(s,null))},i(L){m||(E(i.$$.fragment,L),E(u),m=!0)},o(L){j(i.$$.fragment,L),j(u),m=!1},d(L){L&&v(e),$(i),g[a].d(),h=!1,me(_)}}}function J_(n){let e,t;return e=new Ni({props:{fullpage:!0,header:!1,title:md,$$slots:{default:[G_]},$$scope:{ctx:n}}}),{c(){F(e.$$.fragment)},m(i,l){q(e,i,l),t=!0},p(i,[l]){const s={};l&8392703&&(s.$$scope={dirty:l,ctx:i}),e.$set(s)},i(i){t||(E(e.$$.fragment,i),t=!0)},o(i){j(e.$$.fragment,i),t=!1},d(i){$(e,i)}}}const md="Register";function X_(n,e,t){let i,l,s,r;ee(n,vi,R=>t(11,r=R));let o="",a="",u="",f="",c=!1,d={},m=!1,h=!1,_=!1;b();async function b(){t(7,m=!0);try{t(1,d=await V.collection("users").listAuthMethods())}catch(R){V.error(R)}t(7,m=!1)}async function g(){if(!c){t(6,c=!0);try{await V.collection("users").create({email:o,username:a,password:u,passwordConfirm:f,allowEmailNotifications:!0}),Ji(),o&&await V.collection("users").requestVerification(o),t(8,h=!0)}catch(R){V.error(R)}t(6,c=!1)}}function T(){o=this.value,t(0,o)}const L=()=>{t(2,_=!0)};function O(){a=this.value,t(3,a),t(2,_),t(13,s),t(0,o)}function C(){u=this.value,t(4,u)}function S(){f=this.value,t(5,f)}const P=R=>{var A;(A=R.detail)!=null&&A.mfaId?Yt("/login"):(Ji(),V.replaceWithRemembered())};return n.$$.update=()=>{var R,A,D,M,Z,Y;n.$$.dirty&2&&((R=d.mfa)==null||R.enabled),n.$$.dirty&2&&t(10,i=(A=d.password)==null?void 0:A.enabled),n.$$.dirty&2&&t(9,l=((D=d.oauth2)==null?void 0:D.enabled)&&((Z=(M=d.oauth2)==null?void 0:M.providers)==null?void 0:Z.length)),n.$$.dirty&1&&t(13,s=((Y=o.split("@"))==null?void 0:Y[0])||""),n.$$.dirty&8196&&(_||t(3,a=s))},[o,d,_,a,u,f,c,m,h,l,i,r,g,s,T,L,O,C,S,P]}class Q_ extends ve{constructor(e){super(),ye(this,e,X_,J_,_e,{})}}const x_=n=>({isEmpty:n&32}),sa=n=>({isEmpty:n[5]}),eg=n=>({isEmpty:n&32}),ra=n=>({isEmpty:n[5]});function oa(n){let e,t,i,l,s,r,o;return{c(){e=w("button"),t=w("span"),t.textContent="Clear",p(t,"class","txt"),p(e,"type","button"),p(e,"class",i="btn btn-warning btn-"+(n[7][n[3]]||"sm")+" btn-expanded-"+(n[7][n[3]]||"sm"))},m(a,u){k(a,e,u),y(e,t),s=!0,r||(o=H(e,"click",Ze(n[9])),r=!0)},p(a,u){(!s||u&8&&i!==(i="btn btn-warning btn-"+(a[7][a[3]]||"sm")+" btn-expanded-"+(a[7][a[3]]||"sm")))&&p(e,"class",i)},i(a){s||(a&&kt(()=>{s&&(l||(l=ct(e,Pn,{duration:150,x:5},!0)),l.run(1))}),s=!0)},o(a){a&&(l||(l=ct(e,Pn,{duration:150,x:5},!1)),l.run(0)),s=!1},d(a){a&&v(e),a&&l&&l.end(),r=!1,o()}}}function tg(n){let e,t,i,l,s,r,o,a,u,f,c,d;const m=n[11].prefix,h=st(m,n,n[10],ra);let _=!n[5]&&oa(n);const b=n[11].suffix,g=st(b,n,n[10],sa);return{c(){e=w("div"),t=w("div"),h&&h.c(),i=I(),l=w("div"),l.innerHTML='<i class="iconoir-search"></i>',s=I(),r=w("input"),o=I(),_&&_.c(),a=I(),g&&g.c(),p(l,"class","addon prefix"),p(r,"type","text"),p(r,"id",n[6]),p(r,"placeholder",n[2]),p(t,"class","field-group"),p(e,"class",u="form-field form-field-"+n[3]+" search-bar "+n[1])},m(T,L){k(T,e,L),y(e,t),h&&h.m(t,null),y(t,i),y(t,l),y(t,s),y(t,r),n[12](r),ge(r,n[0]),y(t,o),_&&_.m(t,null),y(t,a),g&&g.m(t,null),f=!0,c||(d=[H(r,"input",n[13]),H(t,"click",n[8])],c=!0)},p(T,[L]){h&&h.p&&(!f||L&1056)&&ot(h,m,T,T[10],f?rt(m,T[10],L,eg):at(T[10]),ra),(!f||L&4)&&p(r,"placeholder",T[2]),L&1&&r.value!==T[0]&&ge(r,T[0]),T[5]?_&&(ae(),j(_,1,1,()=>{_=null}),ue()):_?(_.p(T,L),L&32&&E(_,1)):(_=oa(T),_.c(),E(_,1),_.m(t,a)),g&&g.p&&(!f||L&1056)&&ot(g,b,T,T[10],f?rt(b,T[10],L,x_):at(T[10]),sa),(!f||L&10&&u!==(u="form-field form-field-"+T[3]+" search-bar "+T[1]))&&p(e,"class",u)},i(T){f||(E(h,T),E(_),E(g,T),f=!0)},o(T){j(h,T),j(_),j(g,T),f=!1},d(T){T&&v(e),h&&h.d(T),n[12](null),_&&_.d(),g&&g.d(T),c=!1,me(d)}}}function ng(n,e,t){let i,{$$slots:l={},$$scope:s}=e;const r="search_"+K.randomString(5),o={lg:"sm",md:"sm",sm:"xs"};let{class:a=""}=e,{value:u}=e,{placeholder:f="Search..."}=e,{size:c="lg"}=e,d;function m(){d==null||d.focus()}function h(){t(0,u="")}function _(g){le[g?"unshift":"push"](()=>{d=g,t(4,d)})}function b(){u=this.value,t(0,u)}return n.$$set=g=>{"class"in g&&t(1,a=g.class),"value"in g&&t(0,u=g.value),"placeholder"in g&&t(2,f=g.placeholder),"size"in g&&t(3,c=g.size),"$$scope"in g&&t(10,s=g.$$scope)},n.$$.update=()=>{n.$$.dirty&1&&t(5,i=K.isEmpty(u))},[u,a,f,c,d,i,r,o,m,h,s,l,_,b]}class hd extends ve{constructor(e){super(),ye(this,e,ng,tg,_e,{class:1,value:0,placeholder:2,size:3})}}const ll=Fe([]),rn=Fe(!1),sl=Fe("");function Kl(){ll.set([]),rn.set(!1),sl.set("")}const cn=Mt([ll,sl],([n,e])=>n.length?e&&n.find(t=>t.id==e)||n[0]:null);cn.set=n=>{K.isObject(n)?Xn(n,!0):sl.set(n)};function Xn(n,e=!1){n&&(ll.update(t=>(K.pushOrReplaceObject(t,n),t)),e&&sl.set(n.id))}function us(n){n&&(ll.update(e=>(K.removeByKey(e,"id",n.id),e)),sl.update(e=>e==n.id?"":e))}function aa(n){let e,t=n[0].value+"",i;return{c(){e=w("small"),i=te(t),p(e,"class","txt-hint m-l-auto")},m(l,s){k(l,e,s),y(e,i)},p(l,s){s&1&&t!==(t=l[0].value+"")&&Se(i,t)},d(l){l&&v(e)}}}function ig(n){let e,t,i=n[0].label+"",l,s,r=n[0].value&&aa(n);return{c(){e=w("div"),t=w("span"),l=te(i),s=I(),r&&r.c(),p(t,"class","txt"),p(e,"class","flex")},m(o,a){k(o,e,a),y(e,t),y(t,l),y(e,s),r&&r.m(e,null)},p(o,[a]){a&1&&i!==(i=o[0].label+"")&&Se(l,i),o[0].value?r?r.p(o,a):(r=aa(o),r.c(),r.m(e,null)):r&&(r.d(1),r=null)},i:Q,o:Q,d(o){o&&v(e),r&&r.d()}}}function lg(n,e,t){let{item:i={}}=e;return n.$$set=l=>{"item"in l&&t(0,i=l.item)},[i]}class ua extends ve{constructor(e){super(),ye(this,e,lg,ig,_e,{item:0})}}function fa(n){let e,t,i,l,s,r,o;return{c(){e=w("div"),t=w("input"),i=I(),l=w("div"),s=w("input"),p(t,"type","number"),p(t,"min","1"),p(t,"placeholder","Width"),t.required=!0,p(e,"class","col-3"),p(s,"type","number"),p(s,"min","1"),p(s,"placeholder","Height"),s.required=!0,p(l,"class","col-3")},m(a,u){k(a,e,u),y(e,t),ge(t,n[3]),k(a,i,u),k(a,l,u),y(l,s),ge(s,n[4]),r||(o=[H(t,"input",n[8]),be(Oe.call(null,e,"Width")),H(s,"input",n[9]),be(Oe.call(null,l,"Height"))],r=!0)},p(a,u){u&8&&vt(t.value)!==a[3]&&ge(t,a[3]),u&16&&vt(s.value)!==a[4]&&ge(s,a[4])},d(a){a&&(v(e),v(i),v(l)),r=!1,me(o)}}}function sg(n){let e,t,i,l,s,r,o;function a(c){n[7](c)}let u={id:n[0],upside:!0,labelComponent:ua,optionComponent:ua,items:n[1]};n[2]!==void 0&&(u.keyOfSelected=n[2]),i=new pn({props:u}),le.push(()=>Ae(i,"keyOfSelected",a));let f=n[2]==""&&fa(n);return{c(){e=w("div"),t=w("div"),F(i.$$.fragment),r=I(),f&&f.c(),p(t,"class",s="col-"+(n[2]==""?6:12)),p(e,"class","grid grid-sm")},m(c,d){k(c,e,d),y(e,t),q(i,t,null),y(e,r),f&&f.m(e,null),o=!0},p(c,[d]){const m={};d&1&&(m.id=c[0]),d&2&&(m.items=c[1]),!l&&d&4&&(l=!0,m.keyOfSelected=c[2],Ne(()=>l=!1)),i.$set(m),(!o||d&4&&s!==(s="col-"+(c[2]==""?6:12)))&&p(t,"class",s),c[2]==""?f?f.p(c,d):(f=fa(c),f.c(),f.m(e,null)):f&&(f.d(1),f=null)},i(c){o||(E(i.$$.fragment,c),o=!0)},o(c){j(i.$$.fragment,c),o=!1},d(c){c&&v(e),$(i),f&&f.d()}}}function rg(n,e,t){var b;let{id:i}=e,{options:l=[]}=e,{value:s=((b=l==null?void 0:l[0])==null?void 0:b.value)||""}=e,r=s,o="",a=0,u=0;function f(g){t(6,r=g),t(5,s=g),d()}function c(){var g;t(2,o=((g=l.find(T=>T.value==s))==null?void 0:g.value)||""),d()}function d(){const g=s.split("x");t(3,a=(g==null?void 0:g[0])<<0),t(4,u=(g==null?void 0:g[1])<<0)}function m(g){o=g,t(2,o)}function h(){a=vt(this.value),t(3,a)}function _(){u=vt(this.value),t(4,u)}return n.$$set=g=>{"id"in g&&t(0,i=g.id),"options"in g&&t(1,l=g.options),"value"in g&&t(5,s=g.value)},n.$$.update=()=>{n.$$.dirty&96&&r!=s&&(c(),f(s)),n.$$.dirty&2&&l&&c(),n.$$.dirty&4&&o&&f(o),n.$$.dirty&24&&(a||u)&&f(`${a}x${u}`)},[i,l,o,a,u,s,r,m,h,_]}class og extends ve{constructor(e){super(),ye(this,e,rg,sg,_e,{id:0,options:1,value:5})}}function ag(n){let e,t,i,l,s,r,o,a,u,f,c;return u=Mf(n[5][0]),{c(){e=w("input"),i=I(),l=w("label"),s=w("i"),r=I(),o=w("span"),o.textContent="Desktop",p(e,"type","radio"),p(e,"id",t=n[13]),p(e,"name","type"),e.__value=di,ge(e,e.__value),p(s,"class","iconoir-modern-tv svelte-1i8gqwf"),p(o,"class","txt"),p(l,"for",a=n[13]),p(l,"class","svelte-1i8gqwf"),u.p(e)},m(d,m){k(d,e,m),e.checked=e.__value===n[1],k(d,i,m),k(d,l,m),y(l,s),y(l,r),y(l,o),f||(c=H(e,"change",n[4]),f=!0)},p(d,m){m&8192&&t!==(t=d[13])&&p(e,"id",t),m&2&&(e.checked=e.__value===d[1]),m&8192&&a!==(a=d[13])&&p(l,"for",a)},d(d){d&&(v(e),v(i),v(l)),u.r(),f=!1,c()}}}function ug(n){let e,t,i,l,s,r,o,a,u,f,c;return u=Mf(n[5][0]),{c(){e=w("input"),i=I(),l=w("label"),s=w("i"),r=I(),o=w("span"),o.textContent="Mobile",p(e,"type","radio"),p(e,"id",t=n[13]),p(e,"name","type"),e.__value=_d,ge(e,e.__value),p(s,"class","iconoir-smartphone-device svelte-1i8gqwf"),p(o,"class","txt"),p(l,"for",a=n[13]),p(l,"class","svelte-1i8gqwf"),u.p(e)},m(d,m){k(d,e,m),e.checked=e.__value===n[1],k(d,i,m),k(d,l,m),y(l,s),y(l,r),y(l,o),f||(c=H(e,"change",n[6]),f=!0)},p(d,m){m&8192&&t!==(t=d[13])&&p(e,"id",t),m&2&&(e.checked=e.__value===d[1]),m&8192&&a!==(a=d[13])&&p(l,"for",a)},d(d){d&&(v(e),v(i),v(l)),u.r(),f=!1,c()}}}function fg(n){let e,t,i,l,s;return t=new Ce({props:{class:"group-item",$$slots:{default:[ag,({uniqueId:r})=>({13:r}),({uniqueId:r})=>r?8192:0]},$$scope:{ctx:n}}}),l=new Ce({props:{class:"group-item",$$slots:{default:[ug,({uniqueId:r})=>({13:r}),({uniqueId:r})=>r?8192:0]},$$scope:{ctx:n}}}),{c(){e=w("div"),F(t.$$.fragment),i=I(),F(l.$$.fragment),p(e,"class","radio-group type-group svelte-1i8gqwf")},m(r,o){k(r,e,o),q(t,e,null),y(e,i),q(l,e,null),s=!0},p(r,o){const a={};o&24578&&(a.$$scope={dirty:o,ctx:r}),t.$set(a);const u={};o&24578&&(u.$$scope={dirty:o,ctx:r}),l.$set(u)},i(r){s||(E(t.$$.fragment,r),E(l.$$.fragment,r),s=!0)},o(r){j(t.$$.fragment,r),j(l.$$.fragment,r),s=!1},d(r){r&&v(e),$(t),$(l)}}}function cg(n){let e,t,i,l;return e=new Ce({props:{class:"form-field m-b-sm entrance-top",$$slots:{default:[pg,({uniqueId:s})=>({13:s}),({uniqueId:s})=>s?8192:0]},$$scope:{ctx:n}}}),i=new Ce({props:{class:"form-field entrance-top",name:"scale",$$slots:{default:[mg,({uniqueId:s})=>({13:s}),({uniqueId:s})=>s?8192:0]},$$scope:{ctx:n}}}),{c(){F(e.$$.fragment),t=I(),F(i.$$.fragment)},m(s,r){q(e,s,r),k(s,t,r),q(i,s,r),l=!0},p(s,r){const o={};r&24577&&(o.$$scope={dirty:r,ctx:s}),e.$set(o);const a={};r&24577&&(a.$$scope={dirty:r,ctx:s}),i.$set(a)},i(s){l||(E(e.$$.fragment,s),E(i.$$.fragment,s),l=!0)},o(s){j(e.$$.fragment,s),j(i.$$.fragment,s),l=!1},d(s){s&&v(t),$(e,s),$(i,s)}}}function dg(n){let e,t;return e=new Ce({props:{class:"form-field entrance-top",name:"scale",$$slots:{default:[hg,({uniqueId:i})=>({13:i}),({uniqueId:i})=>i?8192:0]},$$scope:{ctx:n}}}),{c(){F(e.$$.fragment)},m(i,l){q(e,i,l),t=!0},p(i,l){const s={};l&24577&&(s.$$scope={dirty:l,ctx:i}),e.$set(s)},i(i){t||(E(e.$$.fragment,i),t=!0)},o(i){j(e.$$.fragment,i),t=!1},d(i){$(e,i)}}}function pg(n){let e,t,i;function l(r){n[8](r)}let s={id:n[13],options:n[2]};return n[0].size!==void 0&&(s.value=n[0].size),e=new og({props:s}),le.push(()=>Ae(e,"value",l)),{c(){F(e.$$.fragment)},m(r,o){q(e,r,o),i=!0},p(r,o){const a={};o&8192&&(a.id=r[13]),!t&&o&1&&(t=!0,a.value=r[0].size,Ne(()=>t=!1)),e.$set(a)},i(r){i||(E(e.$$.fragment,r),i=!0)},o(r){j(e.$$.fragment,r),i=!1},d(r){$(e,r)}}}function mg(n){let e,t,i,l,s,r,o,a,u;return{c(){e=w("input"),l=I(),s=w("label"),r=w("span"),r.textContent="Auto scale",p(e,"type","checkbox"),p(e,"id",t=n[13]),e.checked=i=n[0].scale==0,p(r,"class","txt"),p(s,"for",o=n[13])},m(f,c){k(f,e,c),k(f,l,c),k(f,s,c),y(s,r),a||(u=H(e,"change",n[9]),a=!0)},p(f,c){c&8192&&t!==(t=f[13])&&p(e,"id",t),c&1&&i!==(i=f[0].scale==0)&&(e.checked=i),c&8192&&o!==(o=f[13])&&p(s,"for",o)},d(f){f&&(v(e),v(l),v(s)),a=!1,u()}}}function hg(n){let e,t,i,l,s,r,o,a,u;return{c(){e=w("input"),l=I(),s=w("label"),r=w("span"),r.textContent="2x Retina rescale",p(e,"type","checkbox"),p(e,"id",t=n[13]),e.checked=i=n[0].scale==.5,p(r,"class","txt"),p(s,"for",o=n[13])},m(f,c){k(f,e,c),k(f,l,c),k(f,s,c),y(s,r),a||(u=H(e,"change",n[7]),a=!0)},p(f,c){c&8192&&t!==(t=f[13])&&p(e,"id",t),c&1&&i!==(i=f[0].scale==.5)&&(e.checked=i),c&8192&&o!==(o=f[13])&&p(s,"for",o)},d(f){f&&(v(e),v(l),v(s)),a=!1,u()}}}function _g(n){let e,t,i,l,s,r;e=new Ce({props:{class:"form-field m-b-sm",$$slots:{default:[fg]},$$scope:{ctx:n}}});const o=[dg,cg],a=[];function u(f,c){return f[1]==di?0:1}return i=u(n),l=a[i]=o[i](n),{c(){F(e.$$.fragment),t=I(),l.c(),s=De()},m(f,c){q(e,f,c),k(f,t,c),a[i].m(f,c),k(f,s,c),r=!0},p(f,[c]){const d={};c&16386&&(d.$$scope={dirty:c,ctx:f}),e.$set(d);let m=i;i=u(f),i===m?a[i].p(f,c):(ae(),j(a[m],1,1,()=>{a[m]=null}),ue(),l=a[i],l?l.p(f,c):(l=a[i]=o[i](f),l.c()),E(l,1),l.m(s.parentNode,s))},i(f){r||(E(e.$$.fragment,f),E(l),r=!0)},o(f){j(e.$$.fragment,f),j(l),r=!1},d(f){f&&(v(t),v(s)),$(e,f),a[i].d(f)}}}const di="desktop",_d="mobile";function gg(n,e,t){let{prototype:i}=e;const l=[{label:"Google Pixel",value:"412x732"},{label:"iPhone XS",value:"375x812"},{label:"iPhone 13/14",value:"390x844"},{label:"iPad Pro",value:"1024x1366"},{label:"Other",value:""}];let s=di,r=s;function o(){t(1,s=i.size?_d:di),t(3,r=s),s==di&&!i.scale&&t(0,i.scale=1,i)}function a(){t(0,i.size="",i),t(0,i.scale=i.scale==.5?.5:1,i)}function u(){t(0,i.size=l[0].value,i),t(0,i.scale=0,i)}const f=[[]];function c(){s=this.__value,t(1,s)}function d(){s=this.__value,t(1,s)}const m=b=>{var g;(g=b==null?void 0:b.target)!=null&&g.checked?t(0,i.scale=.5,i):t(0,i.scale=1,i)};function h(b){n.$$.not_equal(i.size,b)&&(i.size=b,t(0,i))}const _=b=>{var g;(g=b==null?void 0:b.target)!=null&&g.checked?t(0,i.scale=0,i):t(0,i.scale=1,i)};return n.$$set=b=>{"prototype"in b&&t(0,i=b.prototype)},n.$$.update=()=>{n.$$.dirty&1&&i&&o(),n.$$.dirty&10&&r!=s&&(t(3,r=s),s==di?a():u())},[i,s,l,r,c,f,d,m,h,_]}class gd extends ve{constructor(e){super(),ye(this,e,gg,_g,_e,{prototype:0})}}function bg(n){let e,t,i,l,s,r,o,a;return{c(){e=w("label"),t=te("Project title"),l=I(),s=w("input"),p(e,"for",i=n[17]),p(s,"type","text"),p(s,"id",r=n[17]),s.autofocus=!0,s.required=!0},m(u,f){k(u,e,f),y(e,t),k(u,l,f),k(u,s,f),ge(s,n[2].title),s.focus(),o||(a=H(s,"input",n[10]),o=!0)},p(u,f){f&131072&&i!==(i=u[17])&&p(e,"for",i),f&131072&&r!==(r=u[17])&&p(s,"id",r),f&4&&s.value!==u[2].title&&ge(s,u[2].title)},d(u){u&&(v(e),v(l),v(s)),o=!1,a()}}}function ca(n){let e,t,i,l,s;function r(a){n[11](a)}let o={};return n[3]!==void 0&&(o.prototype=n[3]),i=new gd({props:o}),le.push(()=>Ae(i,"prototype",r)),{c(){e=w("div"),e.textContent="Prototype",t=I(),F(i.$$.fragment),p(e,"class","block m-b-10")},m(a,u){k(a,e,u),k(a,t,u),q(i,a,u),s=!0},p(a,u){const f={};!l&&u&8&&(l=!0,f.prototype=a[3],Ne(()=>l=!1)),i.$set(f)},i(a){s||(E(i.$$.fragment,a),s=!0)},o(a){j(i.$$.fragment,a),s=!1},d(a){a&&(v(e),v(t)),$(i,a)}}}function wg(n){let e,t,i,l,s,r;t=new Ce({props:{class:"form-field required",name:"title",$$slots:{default:[bg,({uniqueId:a})=>({17:a}),({uniqueId:a})=>a?131072:0]},$$scope:{ctx:n}}});let o=!n[2].id&&ca(n);return{c(){e=w("form"),F(t.$$.fragment),i=I(),o&&o.c(),p(e,"id",n[5]),p(e,"class","content")},m(a,u){k(a,e,u),q(t,e,null),y(e,i),o&&o.m(e,null),l=!0,s||(r=H(e,"submit",we(n[6])),s=!0)},p(a,u){const f={};u&393220&&(f.$$scope={dirty:u,ctx:a}),t.$set(f),a[2].id?o&&(ae(),j(o,1,1,()=>{o=null}),ue()):o?(o.p(a,u),u&4&&E(o,1)):(o=ca(a),o.c(),E(o,1),o.m(e,null))},i(a){l||(E(t.$$.fragment,a),E(o),l=!0)},o(a){j(t.$$.fragment,a),j(o),l=!1},d(a){a&&v(e),$(t),o&&o.d(),s=!1,r()}}}function yg(n){let e,t=n[2].id?"Update project":"Create project",i;return{c(){e=w("h5"),i=te(t),p(e,"class","block txt-center")},m(l,s){k(l,e,s),y(e,i)},p(l,s){s&4&&t!==(t=l[2].id?"Update project":"Create project")&&Se(i,t)},d(l){l&&v(e)}}}function vg(n){let e,t,i,l,s=n[2].id?"Update project":"Create project",r,o,a;return{c(){e=w("button"),t=te("Cancel"),i=I(),l=w("button"),r=te(s),p(e,"type","button"),p(e,"class","btn btn-transparent"),e.disabled=n[4],p(l,"type","submit"),p(l,"form",n[5]),p(l,"class","btn btn-expanded btn-primary m-l-auto"),l.disabled=n[4],B(l,"btn-loading",n[4])},m(u,f){k(u,e,f),y(e,t),k(u,i,f),k(u,l,f),y(l,r),o||(a=H(e,"click",n[9]),o=!0)},p(u,f){f&16&&(e.disabled=u[4]),f&4&&s!==(s=u[2].id?"Update project":"Create project")&&Se(r,s),f&16&&(l.disabled=u[4]),f&16&&B(l,"btn-loading",u[4])},d(u){u&&(v(e),v(i),v(l)),o=!1,a()}}}function kg(n){let e,t,i={popup:!0,overlayClose:!n[4],escHide:!n[4],beforeHide:n[12],$$slots:{footer:[vg],header:[yg],default:[wg]},$$scope:{ctx:n}};return e=new mn({props:i}),n[13](e),e.$on("show",n[14]),e.$on("hide",n[15]),{c(){F(e.$$.fragment)},m(l,s){q(e,l,s),t=!0},p(l,[s]){const r={};s&16&&(r.overlayClose=!l[4]),s&16&&(r.escHide=!l[4]),s&16&&(r.beforeHide=l[12]),s&262172&&(r.$$scope={dirty:s,ctx:l}),e.$set(r)},i(l){t||(E(e.$$.fragment,l),t=!0)},o(l){j(e.$$.fragment,l),t=!1},d(l){n[13](null),$(e,l)}}}function Sg(n,e,t){const i="project_upsert_"+K.randomString(5),l=it();let{successRedirect:s=!0}=e,r,o={},a={},u=!1;function f(O){return Jt({}),t(2,o=Object.assign({users:[V.authStore.record.id]},O)),t(3,a={}),o.id||(t(3,a.size="",a),t(3,a.scale=1,a)),r==null?void 0:r.show()}function c(){return r==null?void 0:r.hide()}async function d(){if(!u){t(4,u=!0);try{let O;o.id?O=await V.collection("projects").update(o.id,o):(O=await V.collection("projects").create(o),await V.collection("prototypes").create(Object.assign({project:O.id,title:K.isDesktopPrototype(a)?"Desktop":"Mobile"},a))),l("submit",O),t(4,u=!1),s?wi("/projects/"+O.id+"/prototypes"):c()}catch(O){O.isAbort||(t(4,u=!1),V.error(O))}}}const m=()=>c();function h(){o.title=this.value,t(2,o)}function _(O){a=O,t(3,a)}const b=()=>!u;function g(O){le[O?"unshift":"push"](()=>{r=O,t(1,r)})}function T(O){$e.call(this,n,O)}function L(O){$e.call(this,n,O)}return n.$$set=O=>{"successRedirect"in O&&t(7,s=O.successRedirect)},[c,r,o,a,u,i,d,s,f,m,h,_,b,g,T,L]}class bd extends ve{constructor(e){super(),ye(this,e,Sg,kg,_e,{successRedirect:7,show:8,hide:0})}get show(){return this.$$.ctx[8]}get hide(){return this.$$.ctx[0]}}const Tg=n=>({isLoading:n&1,img:n&1024}),da=n=>({isLoading:n[0],img:n[10]});function pa(n){let e;return{c(){e=w("span"),p(e,"class",n[8])},m(t,i){k(t,e,i)},p(t,i){i&256&&p(e,"class",t[8])},d(t){t&&v(e)}}}function Og(n){let e,t,i,l,s,r,o,a,u,f=n[0]&&pa(n);const c=n[17].default,d=st(c,n,n[16],da);return{c(){e=w("figure"),t=w("img"),l=I(),f&&f.c(),s=I(),d&&d.c(),p(t,"crossorigin","anonymous"),p(t,"loading",n[7]),p(t,"fetchpriority",n[5]),p(t,"alt",n[2]),p(t,"width",n[3]),p(t,"height",n[4]),p(t,"draggable",n[6]),Zn(t.src,i=n[1])||p(t,"src",i),p(e,"class",r="lazy-load "+n[9]),B(e,"loading",n[0])},m(m,h){k(m,e,h),y(e,t),n[21](t),y(e,l),f&&f.m(e,null),y(e,s),d&&d.m(e,null),o=!0,a||(u=[H(t,"load",n[11]),H(t,"error",n[12]),H(t,"click",n[18]),H(t,"mousedown",n[19]),H(t,"touchstart",n[20])],a=!0)},p(m,[h]){(!o||h&128)&&p(t,"loading",m[7]),(!o||h&32)&&p(t,"fetchpriority",m[5]),(!o||h&4)&&p(t,"alt",m[2]),(!o||h&8)&&p(t,"width",m[3]),(!o||h&16)&&p(t,"height",m[4]),(!o||h&64)&&p(t,"draggable",m[6]),(!o||h&2&&!Zn(t.src,i=m[1]))&&p(t,"src",i),m[0]?f?f.p(m,h):(f=pa(m),f.c(),f.m(e,s)):f&&(f.d(1),f=null),d&&d.p&&(!o||h&66561)&&ot(d,c,m,m[16],o?rt(c,m[16],h,Tg):at(m[16]),da),(!o||h&512&&r!==(r="lazy-load "+m[9]))&&p(e,"class",r),(!o||h&513)&&B(e,"loading",m[0])},i(m){o||(E(d,m),o=!0)},o(m){j(d,m),o=!1},d(m){m&&v(e),n[21](null),f&&f.d(),d&&d.d(m),a=!1,me(u)}}}function Cg(n,e,t){let{$$slots:i={},$$scope:l}=e;const s=it();let{src:r}=e,{alt:o=void 0}=e,{width:a=void 0}=e,{height:u=void 0}=e,{fetchpriority:f=void 0}=e,{draggable:c=null}=e,{scale:d=void 0}=e,{loading:m="lazy"}=e,{loaderClass:h="loader"}=e,{isLoading:_=!0}=e,{class:b=""}=e,g,T=r;function L(){return g!=null&&g.naturalWidth?g.clientWidth/g.naturalWidth:1}function O(){S(),s("load",g),t(0,_=!1)}function C(){t(0,_=!1),s("error",g)}function S(){if(!g||!g.complete||typeof d>"u")return;t(10,g.style.width="auto",g),t(10,g.style.height="auto",g),d==0?t(10,g.style["max-width"]="100%",g):t(10,g.style["max-width"]="",g);const M=d>0?g.naturalWidth*d:g.naturalWidth;t(10,g.style.width=M+"px",g)}function P(M){$e.call(this,n,M)}function R(M){$e.call(this,n,M)}function A(M){$e.call(this,n,M)}function D(M){le[M?"unshift":"push"](()=>{g=M,t(10,g)})}return n.$$set=M=>{"src"in M&&t(1,r=M.src),"alt"in M&&t(2,o=M.alt),"width"in M&&t(3,a=M.width),"height"in M&&t(4,u=M.height),"fetchpriority"in M&&t(5,f=M.fetchpriority),"draggable"in M&&t(6,c=M.draggable),"scale"in M&&t(13,d=M.scale),"loading"in M&&t(7,m=M.loading),"loaderClass"in M&&t(8,h=M.loaderClass),"isLoading"in M&&t(0,_=M.isLoading),"class"in M&&t(9,b=M.class),"$$scope"in M&&t(16,l=M.$$scope)},n.$$.update=()=>{n.$$.dirty&32770&&T!=r&&(t(15,T=r),t(0,_=!0)),n.$$.dirty&8192&&typeof d<"u"&&S()},[_,r,o,a,u,f,c,m,h,b,g,O,C,d,L,T,l,i,P,R,A,D]}class Xt extends ve{constructor(e){super(),ye(this,e,Cg,Og,_e,{src:1,alt:2,width:3,height:4,fetchpriority:5,draggable:6,scale:13,loading:7,loaderClass:8,isLoading:0,class:9,widthRatio:14})}get widthRatio(){return this.$$.ctx[14]}}function fs(n){let e,t=n[0][n[3]]+"",i,l,s,r,o,a,u,f=[{spellcheck:l=!1},{tabindex:"0"},{contenteditable:s=n[8]&&!n[1]},{"data-placeholder":n[4]},{class:r="contenteditable inline-edit "+n[6]},n[10]],c={};for(let d=0;d<f.length;d+=1)c=Ue(c,f[d]);return{c(){e=w(n[2]),i=te(t),Sl(n[2])(e,c),B(e,"svelte-obfpdk",!0)},m(d,m){k(d,e,m),y(e,i),n[12](e),a||(u=[H(e,"focus",n[13]),H(e,"blur",n[14]),H(e,"keypress",n[15]),be(o=Oe.call(null,e,n[8]?"":{position:"bottom-left",text:n[5]}))],a=!0)},p(d,m){m&9&&t!==(t=d[0][d[3]]+"")&&ep(i,t,d[8]&&!d[1]),Sl(d[2])(e,c=gt(f,[{spellcheck:l},{tabindex:"0"},m&258&&s!==(s=d[8]&&!d[1])&&{contenteditable:s},m&16&&{"data-placeholder":d[4]},m&64&&r!==(r="contenteditable inline-edit "+d[6])&&{class:r},m&1024&&d[10]])),o&&et(o.update)&&m&288&&o.update.call(null,d[8]?"":{position:"bottom-left",text:d[5]}),B(e,"svelte-obfpdk",!0)},d(d){d&&v(e),n[12](null),a=!1,me(u)}}}function Eg(n){let e,t=n[2],i=n[2]&&fs(n);return{c(){e=w("div"),i&&i.c(),p(e,"class","inline-edit-container svelte-obfpdk")},m(l,s){k(l,e,s),i&&i.m(e,null)},p(l,[s]){l[2]?t?_e(t,l[2])?(i.d(1),i=fs(l),t=l[2],i.c(),i.m(e,null)):i.p(l,s):(i=fs(l),t=l[2],i.c(),i.m(e,null)):t&&(i.d(1),i=null,t=l[2])},i:Q,o:Q,d(l){l&&v(e),i&&i.d(l)}}}function Lg(n,e,t){const i=["collection","model","disabled","tag","prop","placeholder","tooltip","class"];let l=ft(e,i),{collection:s=""}=e,{model:r={}}=e,{disabled:o=!1}=e,{tag:a="div"}=e,{prop:u="title"}=e,{placeholder:f="Title"}=e,{tooltip:c="Edit title"}=e,{class:d=""}=e,m,h=!1;async function _(){if(!m)return;const O=m.textContent;if(O||t(7,m.textContent=r[u],m),O!=r[u])try{const C={};C[u]=O;const S=await V.collection(s).update(r.id,C,{requestKey:"inline_"+s+r.id});t(0,r[u]=S[u],r),t(0,r.updated=S.updated,r)}catch(C){C.isAbort||console.warn("Failed to update "+u,C)}}function b(O){le[O?"unshift":"push"](()=>{m=O,t(7,m)})}const g=()=>t(8,h=!0),T=()=>{t(8,h=!1),_()},L=O=>{O.code=="Enter"&&(O.preventDefault(),m==null||m.blur())};return n.$$set=O=>{e=Ue(Ue({},e),Kt(O)),t(10,l=ft(e,i)),"collection"in O&&t(11,s=O.collection),"model"in O&&t(0,r=O.model),"disabled"in O&&t(1,o=O.disabled),"tag"in O&&t(2,a=O.tag),"prop"in O&&t(3,u=O.prop),"placeholder"in O&&t(4,f=O.placeholder),"tooltip"in O&&t(5,c=O.tooltip),"class"in O&&t(6,d=O.class)},[r,o,a,u,f,c,d,m,h,_,l,s,b,g,T,L]}class ur extends ve{constructor(e){super(),ye(this,e,Lg,Eg,_e,{collection:11,model:0,disabled:1,tag:2,prop:3,placeholder:4,tooltip:5,class:6})}}function ma(n,e,t){const i=n.slice();return i[23]=e[t],i}function Ig(n){let e;return{c(){e=w("i"),p(e,"class","iconoir-media-image")},m(t,i){k(t,e,i)},p:Q,i:Q,o:Q,d(t){t&&v(e)}}}function jg(n){let e,t=[],i=new Map,l,s=Le(n[1]);const r=o=>o[23].id;for(let o=0;o<s.length;o+=1){let a=ma(n,s,o),u=r(a);i.set(u,t[o]=ha(u,a))}return{c(){e=w("div");for(let o=0;o<t.length;o+=1)t[o].c();p(e,"class","card-images-set")},m(o,a){k(o,e,a);for(let u=0;u<t.length;u+=1)t[u]&&t[u].m(e,null);l=!0},p(o,a){a&2&&(s=Le(o[1]),ae(),t=St(t,a,r,1,o,s,i,e,At,ha,null,ma),ue())},i(o){if(!l){for(let a=0;a<s.length;a+=1)E(t[a]);l=!0}},o(o){for(let a=0;a<t.length;a+=1)j(t[a]);l=!1},d(o){o&&v(e);for(let a=0;a<t.length;a+=1)t[a].d()}}}function ha(n,e){let t,i,l,s;return i=new Xt({props:{src:V.files.getURL(e[23],e[23].file,{thumb:"450x0"}),alt:e[23].title}}),{key:n,first:null,c(){t=w("div"),F(i.$$.fragment),l=I(),p(t,"class","card-img"),qe(t,"background-color",e[23].background),this.first=t},m(r,o){k(r,t,o),q(i,t,null),y(t,l),s=!0},p(r,o){e=r;const a={};o&2&&(a.src=V.files.getURL(e[23],e[23].file,{thumb:"450x0"})),o&2&&(a.alt=e[23].title),i.$set(a),o&2&&qe(t,"background-color",e[23].background)},i(r){s||(E(i.$$.fragment,r),s=!0)},o(r){j(i.$$.fragment,r),s=!1},d(r){r&&v(t),$(i)}}}function _a(n){let e,t,i,l,s;function r(u,f){return u[0].expand.projectUserPreferences_via_project[0].favorite?Ng:Pg}let o=r(n),a=o(n);return{c(){e=w("div"),t=w("button"),a.c(),p(t,"type","button"),p(t,"class","btn btn-sm btn-circle btn-transparent"),B(t,"fade",!n[0].expand.projectUserPreferences_via_project[0].favorite),p(e,"class","ctrl ctrl-top-left")},m(u,f){k(u,e,f),y(e,t),a.m(t,null),l||(s=[be(i=Oe.call(null,t,n[0].expand.projectUserPreferences_via_project[0].favorite?"Remove from favorites":"Add to favorites")),H(t,"click",Ze(n[11]))],l=!0)},p(u,f){o!==(o=r(u))&&(a.d(1),a=o(u),a&&(a.c(),a.m(t,null))),i&&et(i.update)&&f&1&&i.update.call(null,u[0].expand.projectUserPreferences_via_project[0].favorite?"Remove from favorites":"Add to favorites"),f&1&&B(t,"fade",!u[0].expand.projectUserPreferences_via_project[0].favorite)},d(u){u&&v(e),a.d(),l=!1,me(s)}}}function Pg(n){let e;return{c(){e=w("i"),p(e,"class","iconoir-star")},m(t,i){k(t,e,i)},d(t){t&&v(e)}}}function Ng(n){let e;return{c(){e=w("i"),p(e,"class","iconoir-star-solid txt-warning")},m(t,i){k(t,e,i)},d(t){t&&v(e)}}}function Ag(n){let e,t,i;return{c(){e=w("i"),t=I(),i=w("span"),i.textContent="Watch",p(e,"class","iconoir-eye-solid"),p(i,"class","txt")},m(l,s){k(l,e,s),k(l,t,s),k(l,i,s)},d(l){l&&(v(e),v(t),v(i))}}}function Dg(n){let e,t,i;return{c(){e=w("i"),t=I(),i=w("span"),i.textContent="Unwatch",p(e,"class","iconoir-eye"),p(i,"class","txt")},m(l,s){k(l,e,s),k(l,t,s),k(l,i,s)},d(l){l&&(v(e),v(t),v(i))}}}function Mg(n){let e,t,i;return{c(){e=w("div"),e.innerHTML='<i class="iconoir-repository"></i> <span class="txt">Archive</span>',p(e,"class","dropdown-item")},m(l,s){k(l,e,s),t||(i=H(e,"click",n[14]),t=!0)},p:Q,d(l){l&&v(e),t=!1,i()}}}function Rg(n){let e,t,i;return{c(){e=w("div"),e.innerHTML='<i class="iconoir-repository"></i> <span class="txt">Unarchive</span>',p(e,"class","dropdown-item")},m(l,s){k(l,e,s),t||(i=H(e,"click",n[13]),t=!0)},p:Q,d(l){l&&v(e),t=!1,i()}}}function Hg(n){let e,t,i,l,s,r,o,a;function u(_,b){return _[0].expand.projectUserPreferences_via_project[0].watch?Dg:Ag}let f=u(n),c=f(n);function d(_,b){return _[0].archived?Rg:Mg}let m=d(n),h=m(n);return{c(){e=w("div"),c.c(),t=I(),h.c(),i=I(),l=w("hr"),s=I(),r=w("div"),r.innerHTML='<i class="iconoir-trash"></i> <span class="txt">Delete</span>',p(e,"class","dropdown-item"),p(r,"class","dropdown-item link-danger")},m(_,b){k(_,e,b),c.m(e,null),k(_,t,b),h.m(_,b),k(_,i,b),k(_,l,b),k(_,s,b),k(_,r,b),o||(a=[H(e,"click",n[12]),H(r,"click",n[15])],o=!0)},p(_,b){f!==(f=u(_))&&(c.d(1),c=f(_),c&&(c.c(),c.m(e,null))),m===(m=d(_))&&h?h.p(_,b):(h.d(1),h=m(_),h&&(h.c(),h.m(i.parentNode,i)))},d(_){_&&(v(e),v(t),v(i),v(l),v(s),v(r)),c.d(),h.d(_),o=!1,me(a)}}}function ga(n){let e,t,i,l,s,r,o;return{c(){e=w("div"),t=w("i"),i=I(),l=w("span"),s=te(n[2]),p(t,"class","iconoir-message-text"),p(l,"class","txt"),p(e,"class","meta-item txt-warning")},m(a,u){k(a,e,u),y(e,t),y(e,i),y(e,l),y(l,s),r||(o=be(Oe.call(null,e,"Unread comments")),r=!0)},p(a,u){u&4&&Se(s,a[2])},d(a){a&&v(e),r=!1,o()}}}function ba(n){let e,t,i;return{c(){e=w("div"),e.innerHTML='<i class="iconoir-repository"></i>',p(e,"class","meta-item")},m(l,s){k(l,e,s),t||(i=be(Oe.call(null,e,"Archived")),t=!0)},d(l){l&&v(e),t=!1,i()}}}function Ug(n){var de,re;let e,t,i,l,s,r,o,a,u,f,c,d,m,h,_,b,g,T,L,O,C,S,P,R,A,D,M;const Z=[jg,Ig],Y=[];function z(pe,Ee){return pe[1].length?0:1}i=z(n),l=Y[i]=Z[i](n);let N=((re=(de=n[0].expand)==null?void 0:de.projectUserPreferences_via_project)==null?void 0:re[0])&&_a(n);h=new Rt({props:{class:"dropdown dropdown-nowrap dropdown-sm",$$slots:{default:[Hg]},$$scope:{ctx:n}}});function W(pe){n[18](pe)}let ne={tag:"h5",class:"title",collection:"projects"};n[0]!==void 0&&(ne.model=n[0]),g=new ur({props:ne}),le.push(()=>Ae(g,"model",W));let X=n[2]&&ga(n),U=n[0].archived&&ba();return{c(){e=w("div"),t=w("figure"),l.c(),s=I(),r=w("div"),N&&N.c(),o=I(),a=w("div"),a.innerHTML='<i class="iconoir-media-image-list preview-icon" title="View project"></i>',u=I(),f=w("div"),c=w("button"),d=w("i"),m=I(),F(h.$$.fragment),_=I(),b=w("div"),F(g.$$.fragment),L=I(),O=w("div"),X&&X.c(),C=I(),U&&U.c(),S=I(),P=w("div"),P.innerHTML='<div class="iconoir-calendar"></div>',p(a,"class","ctrl ctrl-center"),p(d,"class","iconoir-more-vert"),p(c,"type","button"),p(c,"class","btn btn-sm btn-circle btn-transparent fade"),p(f,"class","ctrl ctrl-top-right"),p(r,"class","card-overlay handle"),p(t,"class","card-featured"),p(P,"class","meta-item"),p(O,"class","meta"),p(b,"class","card-content"),p(e,"class","card entrance-top")},m(pe,Ee){k(pe,e,Ee),y(e,t),Y[i].m(t,null),y(t,s),y(t,r),N&&N.m(r,null),y(r,o),y(r,a),y(r,u),y(r,f),y(f,c),y(c,d),y(c,m),q(h,c,null),y(e,_),y(e,b),q(g,b,null),y(b,L),y(b,O),X&&X.m(O,null),y(O,C),U&&U.m(O,null),y(O,S),y(O,P),A=!0,D||(M=[H(f,"click",Ze(n[10])),H(r,"auxclick",n[16]),H(r,"click",n[17]),be(R=Oe.call(null,P,{text:"Created "+K.relativeDate(n[0].created),sub:K.formatToLocalDate(n[0].created)}))],D=!0)},p(pe,[Ee]){var dt,se;let tt=i;i=z(pe),i===tt?Y[i].p(pe,Ee):(ae(),j(Y[tt],1,1,()=>{Y[tt]=null}),ue(),l=Y[i],l?l.p(pe,Ee):(l=Y[i]=Z[i](pe),l.c()),E(l,1),l.m(t,s)),(se=(dt=pe[0].expand)==null?void 0:dt.projectUserPreferences_via_project)!=null&&se[0]?N?N.p(pe,Ee):(N=_a(pe),N.c(),N.m(r,o)):N&&(N.d(1),N=null);const ut={};Ee&67108865&&(ut.$$scope={dirty:Ee,ctx:pe}),h.$set(ut);const lt={};!T&&Ee&1&&(T=!0,lt.model=pe[0],Ne(()=>T=!1)),g.$set(lt),pe[2]?X?X.p(pe,Ee):(X=ga(pe),X.c(),X.m(O,C)):X&&(X.d(1),X=null),pe[0].archived?U||(U=ba(),U.c(),U.m(O,S)):U&&(U.d(1),U=null),R&&et(R.update)&&Ee&1&&R.update.call(null,{text:"Created "+K.relativeDate(pe[0].created),sub:K.formatToLocalDate(pe[0].created)})},i(pe){A||(E(l),E(h.$$.fragment,pe),E(g.$$.fragment,pe),A=!0)},o(pe){j(l),j(h.$$.fragment,pe),j(g.$$.fragment,pe),A=!1},d(pe){pe&&v(e),Y[i].d(),N&&N.d(),$(h),$(g),X&&X.d(),U&&U.d(),D=!1,me(M)}}}function qg(n,e,t){let i,l;ee(n,wn,D=>t(9,l=D));let{project:s}=e,r=[];function o(D){var Z,Y,z,N,W,ne,X,U;t(1,r=[]);const M=((z=(Y=(Z=D==null?void 0:D.expand)==null?void 0:Z.prototypes_via_project)==null?void 0:Y.sort(function(de,re){return de.created<re.created?-1:de.created>re.created?1:0}))==null?void 0:z.slice(-3))||[];for(let de of M){let re=null;(N=de.screensOrder)!=null&&N[0]&&(re=(ne=(W=de.expand)==null?void 0:W.screens_via_prototype)==null?void 0:ne.find(pe=>{var Ee;return pe.id==((Ee=de.screensOrder)==null?void 0:Ee[0])})),re||(re=(U=(X=de.expand)==null?void 0:X.screens_via_prototype)==null?void 0:U[0]),re&&r.push(re)}}function a(D,M=!1){const Z="/projects/"+D.id+"/prototypes";M?window.open("#"+Z,"_blank").focus():wi(Z)}async function u(D){Pt(`Do you really want to delete project ${D.title} and all its related screens?`,async()=>f(D),()=>{var M;(M=document.activeElement)==null||M.blur()})}async function f(D){try{await V.collection("projects").delete(D.id),us(D),_t(`Successfully deleted project ${D.title}.`)}catch(M){M.isAbort||V.error(M)}}async function c(D){Pt(`Do you really want to archive project ${D.title}?`,async()=>d(D),()=>{var M;(M=document.activeElement)==null||M.blur()})}async function d(D){try{await V.collection("projects").update(D.id,{archived:!0}),D.archived||us(D),_t(`Successfully archived project ${D.title}.`)}catch(M){M.isAbort||V.error(M)}}async function m(D){Pt(`Do you really want to unarchive project ${D.title}?`,async()=>h(D),()=>{var M;(M=document.activeElement)==null||M.blur()})}async function h(D){try{await V.collection("projects").update(D.id,{archived:!1}),D.archived&&us(D),_t(`Successfully unarchived project ${D.title}.`)}catch(M){M.isAbort||V.error(M)}}async function _(D){if(!(D!=null&&D.id))return D;try{return D.watch=!D.watch,await V.collection("projectUserPreferences").update(D.id,{watch:D.watch})}catch(M){M.isAbort||V.error(M)}}async function b(D){if(!(D!=null&&D.id))return D;try{return D.favorite=!D.favorite,await V.collection("projectUserPreferences").update(D.id,{favorite:D.favorite})}catch(M){M.isAbort||V.error(M)}}function g(D){$e.call(this,n,D)}const T=D=>{var M,Z;b(s.expand.projectUserPreferences_via_project[0]),t(0,s),(Z=(M=D.target)==null?void 0:M.closest("button"))==null||Z.blur()},L=()=>{_(s.expand.projectUserPreferences_via_project[0]),t(0,s)},O=()=>m(s),C=()=>c(s),S=()=>u(s),P=()=>{a(s,!0)},R=()=>{a(s)};function A(D){s=D,t(0,s)}return n.$$set=D=>{"project"in D&&t(0,s=D.project)},n.$$.update=()=>{n.$$.dirty&1&&o(s),n.$$.dirty&513&&t(2,i=l.filter(D=>{var M,Z,Y,z,N,W;return!D.read&&((W=(N=(z=(Y=(Z=(M=D==null?void 0:D.expand)==null?void 0:M.comment)==null?void 0:Z.expand)==null?void 0:Y.screen)==null?void 0:z.expand)==null?void 0:N.prototype)==null?void 0:W.project)==s.id}).length)},[s,r,i,a,u,c,m,_,b,l,g,T,L,O,C,S,P,R,A]}class wd extends ve{constructor(e){super(),ye(this,e,qg,Ug,_e,{project:0})}}function wa(n,e,t){const i=n.slice();return i[20]=e[t],i[21]=e,i[22]=t,i}function ya(n,e,t){const i=n.slice();return i[20]=e[t],i[23]=e,i[24]=t,i}function $g(n){let e,t,i,l,s=n[4].length&&va(n),r=n[4].length&&n[3].length&&Sa(),o=n[3].length&&Ta(n);return{c(){s&&s.c(),e=I(),r&&r.c(),t=I(),o&&o.c(),i=De()},m(a,u){s&&s.m(a,u),k(a,e,u),r&&r.m(a,u),k(a,t,u),o&&o.m(a,u),k(a,i,u),l=!0},p(a,u){a[4].length?s?(s.p(a,u),u&16&&E(s,1)):(s=va(a),s.c(),E(s,1),s.m(e.parentNode,e)):s&&(ae(),j(s,1,1,()=>{s=null}),ue()),a[4].length&&a[3].length?r||(r=Sa(),r.c(),r.m(t.parentNode,t)):r&&(r.d(1),r=null),a[3].length?o?(o.p(a,u),u&8&&E(o,1)):(o=Ta(a),o.c(),E(o,1),o.m(i.parentNode,i)):o&&(ae(),j(o,1,1,()=>{o=null}),ue())},i(a){l||(E(s),E(o),l=!0)},o(a){j(s),j(o),l=!1},d(a){a&&(v(e),v(t),v(i)),s&&s.d(a),r&&r.d(a),o&&o.d(a)}}}function Fg(n){let e;function t(s,r){return s[5]?zg:Vg}let i=t(n),l=i(n);return{c(){l.c(),e=De()},m(s,r){l.m(s,r),k(s,e,r)},p(s,r){i===(i=t(s))&&l?l.p(s,r):(l.d(1),l=i(s),l&&(l.c(),l.m(e.parentNode,e)))},i:Q,o:Q,d(s){s&&v(e),l.d(s)}}}function Wg(n){let e;return{c(){e=w("div"),e.innerHTML='<span class="loader loader-lg"></span>',p(e,"class","block txt-center m-t-lg")},m(t,i){k(t,e,i)},p:Q,i:Q,o:Q,d(t){t&&v(e)}}}function va(n){let e,t=[],i=new Map,l,s=Le(n[4]);const r=o=>o[20].id;for(let o=0;o<s.length;o+=1){let a=ya(n,s,o),u=r(a);i.set(u,t[o]=ka(u,a))}return{c(){e=w("div");for(let o=0;o<t.length;o+=1)t[o].c();p(e,"class","cards-list")},m(o,a){k(o,e,a);for(let u=0;u<t.length;u+=1)t[u]&&t[u].m(e,null);l=!0},p(o,a){a&16&&(s=Le(o[4]),ae(),t=St(t,a,r,1,o,s,i,e,At,ka,null,ya),ue())},i(o){if(!l){for(let a=0;a<s.length;a+=1)E(t[a]);l=!0}},o(o){for(let a=0;a<t.length;a+=1)j(t[a]);l=!1},d(o){o&&v(e);for(let a=0;a<t.length;a+=1)t[a].d()}}}function ka(n,e){let t,i,l,s;function r(a){e[15](a,e[20],e[23],e[24])}let o={};return e[20]!==void 0&&(o.project=e[20]),i=new wd({props:o}),le.push(()=>Ae(i,"project",r)),{key:n,first:null,c(){t=De(),F(i.$$.fragment),this.first=t},m(a,u){k(a,t,u),q(i,a,u),s=!0},p(a,u){e=a;const f={};!l&&u&16&&(l=!0,f.project=e[20],Ne(()=>l=!1)),i.$set(f)},i(a){s||(E(i.$$.fragment,a),s=!0)},o(a){j(i.$$.fragment,a),s=!1},d(a){a&&v(t),$(i,a)}}}function Sa(n){let e;return{c(){e=w("hr")},m(t,i){k(t,e,i)},d(t){t&&v(e)}}}function Ta(n){let e,t=[],i=new Map,l,s=Le(n[3]);const r=o=>o[20].id;for(let o=0;o<s.length;o+=1){let a=wa(n,s,o),u=r(a);i.set(u,t[o]=Oa(u,a))}return{c(){e=w("div");for(let o=0;o<t.length;o+=1)t[o].c();p(e,"class","cards-list")},m(o,a){k(o,e,a);for(let u=0;u<t.length;u+=1)t[u]&&t[u].m(e,null);l=!0},p(o,a){a&8&&(s=Le(o[3]),ae(),t=St(t,a,r,1,o,s,i,e,At,Oa,null,wa),ue())},i(o){if(!l){for(let a=0;a<s.length;a+=1)E(t[a]);l=!0}},o(o){for(let a=0;a<t.length;a+=1)j(t[a]);l=!1},d(o){o&&v(e);for(let a=0;a<t.length;a+=1)t[a].d()}}}function Oa(n,e){let t,i,l,s;function r(a){e[16](a,e[20],e[21],e[22])}let o={};return e[20]!==void 0&&(o.project=e[20]),i=new wd({props:o}),le.push(()=>Ae(i,"project",r)),{key:n,first:null,c(){t=De(),F(i.$$.fragment),this.first=t},m(a,u){k(a,t,u),q(i,a,u),s=!0},p(a,u){e=a;const f={};!l&&u&8&&(l=!0,f.project=e[20],Ne(()=>l=!1)),i.$set(f)},i(a){s||(E(i.$$.fragment,a),s=!0)},o(a){j(i.$$.fragment,a),s=!1},d(a){a&&v(t),$(i,a)}}}function Vg(n){let e,t,i,l,s,r,o,a,u,f;return{c(){e=w("div"),t=w("div"),t.innerHTML='<i class="iconoir-grid-plus"></i>',i=I(),l=w("h6"),l.textContent="You don't have any active projects yet!",s=I(),r=w("div"),r.innerHTML="<p>Create a new project to share your designs, collect feedback and more.</p>",o=I(),a=w("button"),a.innerHTML='<i class="iconoir-plus"></i> <span class="txt">New project</span>',p(t,"class","icon"),p(l,"class","title"),p(r,"class","content"),p(a,"type","button"),p(a,"class","btn btn-expanded btn-primary btn-lg m-t-base"),p(e,"class","placeholder-block entrance-top")},m(c,d){k(c,e,d),y(e,t),y(e,i),y(e,l),y(e,s),y(e,r),y(e,o),y(e,a),u||(f=H(a,"click",n[14]),u=!0)},p:Q,d(c){c&&v(e),u=!1,f()}}}function zg(n){let e;return{c(){e=w("div"),e.innerHTML='<div class="icon"><i class="iconoir-grid-xmark"></i></div> <h6 class="title">No projects found!</h6>',p(e,"class","placeholder-block m-b-sm entrance-top")},m(t,i){k(t,e,i)},p:Q,d(t){t&&v(e)}}}function Ca(n){let e,t,i,l,s;return{c(){e=w("button"),e.innerHTML='<span class="txt">Load more</span>',t=I(),i=w("div"),p(e,"type","button"),p(e,"class","btn btn-semitransparent btn-expanded btn-lg m-b-sm entrance-top"),B(e,"btn-disabled",n[7]),B(e,"btn-loading",n[7]),p(i,"class","clearfix")},m(r,o){k(r,e,o),k(r,t,o),k(r,i,o),l||(s=H(e,"click",n[17]),l=!0)},p(r,o){o&128&&B(e,"btn-disabled",r[7]),o&128&&B(e,"btn-loading",r[7])},d(r){r&&(v(e),v(t),v(i)),l=!1,s()}}}function Ea(n){let e,t,i;return{c(){e=w("button"),e.textContent="Reset filters",p(e,"type","button"),p(e,"class","btn btn-transparent btn-hint btn-expanded entrance-top")},m(l,s){k(l,e,s),t||(i=H(e,"click",n[9]),t=!0)},p:Q,d(l){l&&v(e),t=!1,i()}}}function Bg(n){let e,t,i,l,s,r,o,a;const u=[Wg,Fg,$g],f=[];function c(_,b){return _[7]&&!_[0].length?0:!_[7]&&!_[0].length?1:2}e=c(n),t=f[e]=u[e](n);let d=n[6]&&Ca(n),m=!n[7]&&n[5]&&Ea(n),h={};return o=new bd({props:h}),n[18](o),{c(){t.c(),i=I(),l=w("div"),d&&d.c(),s=I(),m&&m.c(),r=I(),F(o.$$.fragment),p(l,"class","block txt-center m-t-base")},m(_,b){f[e].m(_,b),k(_,i,b),k(_,l,b),d&&d.m(l,null),y(l,s),m&&m.m(l,null),k(_,r,b),q(o,_,b),a=!0},p(_,[b]){let g=e;e=c(_),e===g?f[e].p(_,b):(ae(),j(f[g],1,1,()=>{f[g]=null}),ue(),t=f[e],t?t.p(_,b):(t=f[e]=u[e](_),t.c()),E(t,1),t.m(i.parentNode,i)),_[6]?d?d.p(_,b):(d=Ca(_),d.c(),d.m(l,s)):d&&(d.d(1),d=null),!_[7]&&_[5]?m?m.p(_,b):(m=Ea(_),m.c(),m.m(l,null)):m&&(m.d(1),m=null);const T={};o.$set(T)},i(_){a||(E(t),E(o.$$.fragment,_),a=!0)},o(_){j(t),j(o.$$.fragment,_),a=!1},d(_){_&&(v(i),v(l),v(r)),f[e].d(_),d&&d.d(),m&&m.d(),n[18](null),$(o,_)}}}const La=50;function Zg(n,e,t){let i,l,s,r,o,a;ee(n,rn,P=>t(7,o=P)),ee(n,ll,P=>t(0,a=P));let{search:u=""}=e,{archived:f=!1}=e,c,d=1,m=0,h;b();async function _(P=1){P<=1&&b(),ke(rn,o=!0,o);let R=`project.archived=${f}`;return u&&(R+=V.filter("&&project.title~{:title}",{title:u})),V.collection("projectUserPreferences").getList(P,La,{sort:"-favorite,-lastVisited,-project.created",filter:R,skipTotal:1,expand:"project.prototypes_via_project.screens_via_prototype",requestKey:"projects_list"}).then(A=>{var D;t(2,d=A.page),t(12,m=A.items.length);for(const M of A.items){const Z=(D=M.expand)==null?void 0:D.project;if(!Z){console.warn("missing project for preference",M.id);continue}delete M.expand,Z.expand=Z.expand||{},Z.expand.projectUserPreferences_via_project=[M],Xn(Z)}ke(rn,o=!1,o)}).catch(A=>{A!=null&&A.isAbort||(ke(rn,o=!1,o),V.error(A))})}function b(){Kl(),t(12,m=0),t(2,d=1)}function g(){t(10,u=""),t(11,f=!1)}const T=()=>c==null?void 0:c.show();function L(P,R,A,D){A[D]=P,t(4,s),t(0,a)}function O(P,R,A,D){A[D]=P,t(3,r),t(0,a)}const C=()=>_(d+1);function S(P){le[P?"unshift":"push"](()=>{c=P,t(1,c)})}return n.$$set=P=>{"search"in P&&t(10,u=P.search),"archived"in P&&t(11,f=P.archived)},n.$$.update=()=>{n.$$.dirty&4096&&t(6,i=m==La),n.$$.dirty&11264&&(u!==-1||f!==-1)&&(ke(rn,o=!0,o),clearTimeout(h),t(13,h=setTimeout(()=>_(1),50))),n.$$.dirty&3072&&t(5,l=u||f),n.$$.dirty&1&&t(4,s=a.filter(P=>{var R,A,D;return(D=(A=(R=P.expand)==null?void 0:R.projectUserPreferences_via_project)==null?void 0:A[0])==null?void 0:D.favorite})),n.$$.dirty&1&&t(3,r=a.filter(P=>{var R,A,D;return!((D=(A=(R=P.expand)==null?void 0:R.projectUserPreferences_via_project)==null?void 0:A[0])!=null&&D.favorite)}))},[a,c,d,r,s,l,i,o,_,g,u,f,m,h,T,L,O,C,S]}class Yg extends ve{constructor(e){super(),ye(this,e,Zg,Bg,_e,{search:10,archived:11})}}function Kg(n){let e,t,i;function l(r){n[5](r)}let s={class:"projects-filter-select fade m-l-xs",items:n[3]};return n[2]!==void 0&&(s.keyOfSelected=n[2]),e=new pn({props:s}),le.push(()=>Ae(e,"keyOfSelected",l)),{c(){F(e.$$.fragment)},m(r,o){q(e,r,o),i=!0},p(r,o){const a={};!t&&o&4&&(t=!0,a.keyOfSelected=r[2],Ne(()=>t=!1)),e.$set(a)},i(r){i||(E(e.$$.fragment,r),i=!0)},o(r){j(e.$$.fragment,r),i=!1},d(r){$(e,r)}}}function Gg(n){let e,t,i,l,s,r,o;function a(m){n[6](m)}let u={placeholder:"Search projects...",$$slots:{suffix:[Kg]},$$scope:{ctx:n}};n[1]!==void 0&&(u.value=n[1]),e=new hd({props:u}),le.push(()=>Ae(e,"value",a));function f(m){n[7](m)}function c(m){n[8](m)}let d={};return n[1]!==void 0&&(d.search=n[1]),n[2]!==void 0&&(d.archived=n[2]),l=new Yg({props:d}),le.push(()=>Ae(l,"search",f)),le.push(()=>Ae(l,"archived",c)),{c(){F(e.$$.fragment),i=I(),F(l.$$.fragment)},m(m,h){q(e,m,h),k(m,i,h),q(l,m,h),o=!0},p(m,h){const _={};h&1028&&(_.$$scope={dirty:h,ctx:m}),!t&&h&2&&(t=!0,_.value=m[1],Ne(()=>t=!1)),e.$set(_);const b={};!s&&h&2&&(s=!0,b.search=m[1],Ne(()=>s=!1)),!r&&h&4&&(r=!0,b.archived=m[2],Ne(()=>r=!1)),l.$set(b)},i(m){o||(E(e.$$.fragment,m),E(l.$$.fragment,m),o=!0)},o(m){j(e.$$.fragment,m),j(l.$$.fragment,m),o=!1},d(m){m&&v(i),$(e,m),$(l,m)}}}function Jg(n){let e,t;return{c(){e=w("nav"),t=w("div"),t.textContent=`${yd}`,p(t,"class","breadcrumb-item"),p(e,"class","breadcrumbs")},m(i,l){k(i,e,l),y(e,t)},p:Q,d(i){i&&v(e)}}}function Xg(n){let e,t,i;return{c(){e=w("button"),e.innerHTML='<i class="iconoir-plus"></i> <div class="txt">New project</div>',p(e,"type","button"),p(e,"class","btn btn-primary")},m(l,s){k(l,e,s),t||(i=H(e,"click",n[4]),t=!0)},p:Q,d(l){l&&v(e),t=!1,i()}}}function Qg(n){let e,t,i,l;e=new Ni({props:{title:yd,$$slots:{"header-right":[Xg],"header-left":[Jg],default:[Gg]},$$scope:{ctx:n}}});let s={};return i=new bd({props:s}),n[9](i),{c(){F(e.$$.fragment),t=I(),F(i.$$.fragment)},m(r,o){q(e,r,o),k(r,t,o),q(i,r,o),l=!0},p(r,[o]){const a={};o&1031&&(a.$$scope={dirty:o,ctx:r}),e.$set(a);const u={};i.$set(u)},i(r){l||(E(e.$$.fragment,r),E(i.$$.fragment,r),l=!0)},o(r){j(e.$$.fragment,r),j(i.$$.fragment,r),l=!1},d(r){r&&v(t),$(e,r),n[9](null),$(i,r)}}}const yd="Projects";function xg(n,e,t){const i=[{label:"Active projects",value:!1},{label:"Archived projects",value:!0}];let l,s="",r=!1;const o=()=>l==null?void 0:l.show();function a(m){r=m,t(2,r)}function u(m){s=m,t(1,s)}function f(m){s=m,t(1,s)}function c(m){r=m,t(2,r)}function d(m){le[m?"unshift":"push"](()=>{l=m,t(0,l)})}return[l,s,r,i,o,a,u,f,c,d]}class eb extends ve{constructor(e){super(),ye(this,e,xg,Qg,_e,{})}}function tb(n){let e,t,i,l,s,r,o,a;return{c(){e=w("label"),t=te("Title"),l=I(),s=w("input"),p(e,"for",i=n[18]),p(s,"type","text"),p(s,"id",r=n[18]),s.required=!0},m(u,f){k(u,e,f),y(e,t),k(u,l,f),k(u,s,f),ge(s,n[1].title),o||(a=[H(s,"input",n[9]),H(s,"input",n[10])],o=!0)},p(u,f){f&262144&&i!==(i=u[18])&&p(e,"for",i),f&262144&&r!==(r=u[18])&&p(s,"id",r),f&2&&s.value!==u[1].title&&ge(s,u[1].title)},d(u){u&&(v(e),v(l),v(s)),o=!1,me(a)}}}function nb(n){let e,t,i,l,s,r,o,a,u,f;t=new Ce({props:{class:"form-field required",name:"title",$$slots:{default:[tb,({uniqueId:m})=>({18:m}),({uniqueId:m})=>m?262144:0]},$$scope:{ctx:n}}});function c(m){n[11](m)}let d={};return n[1]!==void 0&&(d.prototype=n[1]),r=new gd({props:d}),le.push(()=>Ae(r,"prototype",c)),{c(){e=w("form"),F(t.$$.fragment),i=I(),l=w("div"),l.innerHTML='Type<sup class="txt-danger">*</sup>',s=I(),F(r.$$.fragment),p(l,"class","block m-b-10"),p(e,"id",n[5]),p(e,"class","content")},m(m,h){k(m,e,h),q(t,e,null),y(e,i),y(e,l),y(e,s),q(r,e,null),a=!0,u||(f=H(e,"submit",we(n[6])),u=!0)},p(m,h){const _={};h&786438&&(_.$$scope={dirty:h,ctx:m}),t.$set(_);const b={};!o&&h&2&&(o=!0,b.prototype=m[1],Ne(()=>o=!1)),r.$set(b)},i(m){a||(E(t.$$.fragment,m),E(r.$$.fragment,m),a=!0)},o(m){j(t.$$.fragment,m),j(r.$$.fragment,m),a=!1},d(m){m&&v(e),$(t),$(r),u=!1,f()}}}function ib(n){let e,t=n[1].id?"Update prototype":"Create prototype",i;return{c(){e=w("h5"),i=te(t),p(e,"class","block txt-center")},m(l,s){k(l,e,s),y(e,i)},p(l,s){s&2&&t!==(t=l[1].id?"Update prototype":"Create prototype")&&Se(i,t)},d(l){l&&v(e)}}}function lb(n){let e,t,i,l,s,r=n[1].id?"Update prototype":"Create prototype",o,a,u;return{c(){e=w("button"),t=w("span"),t.textContent="Cancel",i=I(),l=w("button"),s=w("span"),o=te(r),p(t,"class","txt"),p(e,"type","button"),p(e,"class","btn btn-transparent"),e.disabled=n[4],p(s,"class","txt"),p(l,"type","submit"),p(l,"form",n[5]),p(l,"class","btn btn-expanded btn-primary m-l-auto"),l.disabled=n[4],B(l,"btn-loading",n[4])},m(f,c){k(f,e,c),y(e,t),k(f,i,c),k(f,l,c),y(l,s),y(s,o),a||(u=H(e,"click",n[8]),a=!0)},p(f,c){c&16&&(e.disabled=f[4]),c&2&&r!==(r=f[1].id?"Update prototype":"Create prototype")&&Se(o,r),c&16&&(l.disabled=f[4]),c&16&&B(l,"btn-loading",f[4])},d(f){f&&(v(e),v(i),v(l)),a=!1,u()}}}function sb(n){let e,t,i={popup:!0,overlayClose:!n[4],escHide:!n[4],beforeHide:n[12],$$slots:{footer:[lb],header:[ib],default:[nb]},$$scope:{ctx:n}};return e=new mn({props:i}),n[13](e),e.$on("show",n[14]),e.$on("hide",n[15]),{c(){F(e.$$.fragment)},m(l,s){q(e,l,s),t=!0},p(l,[s]){const r={};s&16&&(r.overlayClose=!l[4]),s&16&&(r.escHide=!l[4]),s&16&&(r.beforeHide=l[12]),s&524310&&(r.$$scope={dirty:s,ctx:l}),e.$set(r)},i(l){t||(E(e.$$.fragment,l),t=!0)},o(l){j(e.$$.fragment,l),t=!1},d(l){n[13](null),$(e,l)}}}function rb(n,e,t){const i="prototype_"+K.randomString(5),l=it();let s,r={},o=!1,a=!1;function u(C){return c(),t(1,r=Object.assign({},C)),s==null?void 0:s.show()}function f(){return s==null?void 0:s.hide()}function c(){Jt({}),t(2,a=!1)}async function d(){if(!(!r.project||o)){t(4,o=!0);try{let C;r.id?(C=await V.collection("prototypes").update(r.id,r),_t(`Successfully updated prototype ${r.title}.`)):(C=await V.collection("prototypes").create(r),_t(`Successfully created prototype ${r.title}.`)),t(4,o=!1),f(),l("submit",C)}catch(C){C.isAbort||(t(4,o=!1),V.error(C))}}}const m=()=>f(),h=()=>{t(2,a=!0)};function _(){r.title=this.value,t(1,r),t(2,a)}function b(C){r=C,t(1,r),t(2,a)}const g=()=>!o;function T(C){le[C?"unshift":"push"](()=>{s=C,t(3,s)})}function L(C){$e.call(this,n,C)}function O(C){$e.call(this,n,C)}return n.$$.update=()=>{n.$$.dirty&6&&!a&&!r.id&&t(1,r.title=r.size?"Mobile":"Desktop",r)},[f,r,a,s,o,i,d,u,m,h,_,b,g,T,L,O]}class ob extends ve{constructor(e){super(),ye(this,e,rb,sb,_e,{show:7,hide:0})}get show(){return this.$$.ctx[7]}get hide(){return this.$$.ctx[0]}}const ab=n=>({}),Ia=n=>({});function ja(n,e,t){const i=n.slice();return i[19]=e[t],i}const ub=n=>({}),Pa=n=>({});function fb(n){let e,t,i=[],l=new Map,s,r,o,a,u,f;const c=n[9].before,d=st(c,n,n[16],Pa);let m=Le(n[2]);const h=g=>g[19].id;for(let g=0;g<m.length;g+=1){let T=ja(n,m,g),L=h(T);l.set(L,i[g]=Na(L,T))}const _=n[9].after,b=st(_,n,n[16],Ia);return{c(){e=w("nav"),d&&d.c(),t=I();for(let g=0;g<i.length;g+=1)i[g].c();s=I(),r=w("button"),r.innerHTML='<i class="iconoir-plus"></i>',o=I(),b&&b.c(),p(r,"type","button"),p(r,"class","btn btn-circle btn-transparent link-hint"),p(e,"class","prototypes-bar entrance-left svelte-fzv0qw")},m(g,T){k(g,e,T),d&&d.m(e,null),y(e,t);for(let L=0;L<i.length;L+=1)i[L]&&i[L].m(e,null);y(e,s),y(e,r),y(e,o),b&&b.m(e,null),a=!0,u||(f=[be(Oe.call(null,r,{text:"New prototype",position:"right"})),H(r,"click",n[6])],u=!0)},p(g,T){d&&d.p&&(!a||T&65536)&&ot(d,c,g,g[16],a?rt(c,g[16],T,ub):at(g[16]),Pa),T&61&&(m=Le(g[2]),ae(),i=St(i,T,h,1,g,m,l,e,At,Na,s,ja),ue()),b&&b.p&&(!a||T&65536)&&ot(b,_,g,g[16],a?rt(_,g[16],T,ab):at(g[16]),Ia)},i(g){if(!a){E(d,g);for(let T=0;T<m.length;T+=1)E(i[T]);E(b,g),a=!0}},o(g){j(d,g);for(let T=0;T<i.length;T+=1)j(i[T]);j(b,g),a=!1},d(g){g&&v(e),d&&d.d(g);for(let T=0;T<i.length;T+=1)i[T].d();b&&b.d(g),u=!1,me(f)}}}function cb(n){let e,t,i,l,s,r,o,a,u,f;return{c(){e=w("div"),t=w("div"),t.innerHTML='<i class="iconoir-pen-tablet"></i>',i=I(),l=w("h6"),l.textContent="The project doesn't have any prototypes yet!",s=I(),r=w("div"),r.innerHTML="<p>Create a new desktop or mobile prototype.</p>",o=I(),a=w("button"),a.innerHTML='<i class="iconoir-plus"></i> <span class="txt">New prototype</span>',p(t,"class","icon"),p(l,"class","title"),p(r,"class","content"),p(a,"type","button"),p(a,"class","btn btn-expanded btn-primary btn-lg m-t-base"),p(e,"class","placeholder-block entrance-top")},m(c,d){k(c,e,d),y(e,t),y(e,i),y(e,l),y(e,s),y(e,r),y(e,o),y(e,a),u||(f=H(a,"click",n[6]),u=!0)},p:Q,i:Q,o:Q,d(c){c&&v(e),u=!1,f()}}}function db(n){let e;return{c(){e=w("div"),e.innerHTML='<span class="loader loader-lg"></span>',p(e,"class","block txt-center m-t-lg")},m(t,i){k(t,e,i)},p:Q,i:Q,o:Q,d(t){t&&v(e)}}}function pb(n){let e,t,i,l,s,r,o,a,u;function f(){return n[10](n[19])}function c(){return n[11](n[19])}function d(){return n[12](n[19])}return{c(){e=w("button"),e.innerHTML='<i class="iconoir-edit-pencil"></i> <span class="txt">Edit</span>',t=I(),i=w("button"),i.innerHTML='<i class="iconoir-copy"></i> <span class="txt">Duplicate</span>',l=I(),s=w("hr"),r=I(),o=w("button"),o.innerHTML='<i class="iconoir-trash"></i> <span class="txt">Delete</span>',p(e,"type","button"),p(e,"class","dropdown-item closable"),p(i,"type","button"),p(i,"class","dropdown-item closable"),p(o,"type","button"),p(o,"class","dropdown-item link-danger closable")},m(m,h){k(m,e,h),k(m,t,h),k(m,i,h),k(m,l,h),k(m,s,h),k(m,r,h),k(m,o,h),a||(u=[H(e,"click",we(f)),H(i,"click",we(c)),H(o,"click",we(d))],a=!0)},p(m,h){n=m},d(m){m&&(v(e),v(t),v(i),v(l),v(s),v(r),v(o)),a=!1,me(u)}}}function Na(n,e){let t,i,l,s,r,o=e[19].title+"",a,u,f,c,d,m,h,_,b,g,T;h=new Rt({props:{class:"dropdown dropdown-nowrap dropdown-sm dropdown-right",$$slots:{default:[pb]},$$scope:{ctx:e}}});function L(){return e[13](e[19])}return{key:n,first:null,c(){var O;t=w("button"),i=w("i"),s=I(),r=w("span"),a=te(o),u=I(),f=w("div"),c=w("div"),d=w("i"),m=I(),F(h.$$.fragment),p(i,"class",l=wr(K.getPrototypeIcon(e[19]))+" svelte-fzv0qw"),p(r,"class","txt txt-ellipsis"),p(d,"class","iconoir-more-vert txt-sm txt-sm"),p(c,"class","meta-item"),p(f,"class","meta"),p(t,"type","button"),p(t,"class",_="btn "+(((O=e[3])==null?void 0:O.id)==e[19].id?"btn-semitransparent":"btn-transparent link-hint")),this.first=t},m(O,C){k(O,t,C),y(t,i),y(t,s),y(t,r),y(r,a),y(t,u),y(t,f),y(f,c),y(c,d),y(c,m),q(h,c,null),b=!0,g||(T=H(t,"click",we(L)),g=!0)},p(O,C){var P;e=O,(!b||C&4&&l!==(l=wr(K.getPrototypeIcon(e[19]))+" svelte-fzv0qw"))&&p(i,"class",l),(!b||C&4)&&o!==(o=e[19].title+"")&&Se(a,o);const S={};C&65541&&(S.$$scope={dirty:C,ctx:e}),h.$set(S),(!b||C&12&&_!==(_="btn "+(((P=e[3])==null?void 0:P.id)==e[19].id?"btn-semitransparent":"btn-transparent link-hint")))&&p(t,"class",_)},i(O){b||(E(h.$$.fragment,O),b=!0)},o(O){j(h.$$.fragment,O),b=!1},d(O){O&&v(t),$(h),g=!1,T()}}}function mb(n){let e,t,i,l,s;const r=[db,cb,fb],o=[];function a(f,c){return f[1]?0:!f[1]&&!f[2].length?1:2}e=a(n),t=o[e]=r[e](n);let u={};return l=new ob({props:u}),n[14](l),l.$on("submit",n[15]),{c(){t.c(),i=I(),F(l.$$.fragment)},m(f,c){o[e].m(f,c),k(f,i,c),q(l,f,c),s=!0},p(f,[c]){let d=e;e=a(f),e===d?o[e].p(f,c):(ae(),j(o[d],1,1,()=>{o[d]=null}),ue(),t=o[e],t?t.p(f,c):(t=o[e]=r[e](f),t.c()),E(t,1),t.m(i.parentNode,i));const m={};l.$set(m)},i(f){s||(E(t),E(l.$$.fragment,f),s=!0)},o(f){j(t),j(l.$$.fragment,f),s=!1},d(f){f&&v(i),o[e].d(f),n[14](null),$(l,f)}}}function hb(n,e,t){let i,l,s;ee(n,ui,S=>t(1,i=S)),ee(n,Ft,S=>t(2,l=S)),ee(n,Ct,S=>t(3,s=S));let{$$slots:r={},$$scope:o}=e,{projectId:a}=e,{initialPrototypeId:u=""}=e,f;async function c(S,P){if(S){ke(ui,i=!0,i);try{ke(Ct,s=P,s),ke(Ft,l=await V.collection("prototypes").getFullList({filter:`project="${S}"`,sort:"created"}),l),ke(ui,i=!1,i)}catch(R){R!=null&&R.isAbort||(V.error(R),ke(ui,i=!1,i))}}}function d(S){S!=null&&S.id&&Pt("Do you really want to delete the selected prototype and all its screens?",()=>V.collection("prototypes").delete(S.id).then(()=>{ld(S),_t(`Successfully deleted prototype ${S.title}.`)}).catch(P=>{V.error(P)}))}function m(S){Pt("Do you really want to duplicate the selected prototype and all of its screens and hotspots?",async()=>h(S))}async function h(S){if(S!=null&&S.id)try{const P=await V.send("/api/pr/duplicate-prototype/"+encodeURIComponent(S.id),{method:"POST"});ki(P,!0)}catch(P){P.isAbort||V.error(P)}}function _(){f==null||f.show({project:a})}const b=S=>f==null?void 0:f.show(S),g=S=>m(S),T=S=>d(S),L=S=>{ke(Ct,s=S.id,s)};function O(S){le[S?"unshift":"push"](()=>{f=S,t(0,f)})}const C=S=>{S.detail&&ki(S.detail,!0)};return n.$$set=S=>{"projectId"in S&&t(7,a=S.projectId),"initialPrototypeId"in S&&t(8,u=S.initialPrototypeId),"$$scope"in S&&t(16,o=S.$$scope)},n.$$.update=()=>{n.$$.dirty&384&&c(a,u)},[f,i,l,s,d,m,_,a,u,r,b,g,T,L,O,C,o]}class _b extends ve{constructor(e){super(),ye(this,e,hb,mb,_e,{projectId:7,initialPrototypeId:8})}}function vd(n,{from:e,to:t},i={}){const l=getComputedStyle(n),s=l.transform==="none"?"":l.transform,[r,o]=l.transformOrigin.split(" ").map(parseFloat),a=e.left+e.width*r/t.width-(t.left+r),u=e.top+e.height*o/t.height-(t.top+o),{delay:f=0,duration:c=m=>Math.sqrt(m)*120,easing:d=er}=i;return{delay:f,duration:et(c)?c(Math.sqrt(a*a+u*u)):c,easing:d,css:(m,h)=>{const _=h*a,b=h*u,g=m+h*e.width/t.width,T=m+h*e.height/t.height;return`transform: ${s} translate(${_}px, ${b}px) scale(${g}, ${T});`}}}const gb=n=>({dragover:n&1}),Aa=n=>({dragover:n[0]});function bb(n){let e,t,i,l;const s=n[3].default,r=st(s,n,n[2],Aa);return{c(){e=w("div"),r&&r.c()},m(o,a){k(o,e,a),r&&r.m(e,null),t=!0,i||(l=[H(e,"dragover",Ze(we(n[4]))),H(e,"dragenter",Ze(we(n[5]))),H(e,"dragleave",we(n[6])),H(e,"drop",Ze(we(n[7])))],i=!0)},p(o,[a]){r&&r.p&&(!t||a&5)&&ot(r,s,o,o[2],t?rt(s,o[2],a,gb):at(o[2]),Aa)},i(o){t||(E(r,o),t=!0)},o(o){j(r,o),t=!1},d(o){o&&v(e),r&&r.d(o),i=!1,me(l)}}}function wb(n,e,t){let{$$slots:i={},$$scope:l}=e;const s=it();let r=!1;function o(c){$e.call(this,n,c)}const a=c=>{t(0,r=!0),s("dragenter")},u=c=>{c.currentTarget.contains(c.relatedTarget)||(c.stopPropagation(),t(0,r=!1),s("dragleave"))},f=c=>{t(0,r=!1),c.dataTransfer.files.length&&s("drop",c.dataTransfer.files)};return n.$$set=c=>{"$$scope"in c&&t(2,l=c.$$scope)},[r,s,l,i,o,a,u,f]}class kd extends ve{constructor(e){super(),ye(this,e,wb,bb,_e,{})}}const yb=n=>({dragging:n&4,dragover:n&8}),Da=n=>({dragging:n[2],dragover:n[3]});function vb(n){let e,t,i,l,s;const r=n[10].default,o=st(r,n,n[9],Da);return{c(){e=w("div"),o&&o.c(),p(e,"draggable",t=!n[1]),p(e,"class","sortable svelte-beosc3"),B(e,"dragging",n[2]),B(e,"dragover",n[3])},m(a,u){k(a,e,u),o&&o.m(e,null),i=!0,l||(s=[H(e,"dragover",we(n[11])),H(e,"dragleave",we(n[12])),H(e,"dragend",n[13]),H(e,"dragstart",n[14]),H(e,"drop",we(n[15]))],l=!0)},p(a,[u]){o&&o.p&&(!i||u&524)&&ot(o,r,a,a[9],i?rt(r,a[9],u,yb):at(a[9]),Da),(!i||u&2&&t!==(t=!a[1]))&&p(e,"draggable",t),(!i||u&4)&&B(e,"dragging",a[2]),(!i||u&8)&&B(e,"dragover",a[3])},i(a){i||(E(o,a),i=!0)},o(a){j(o,a),i=!1},d(a){a&&v(e),o&&o.d(a),l=!1,me(s)}}}function kb(n,e,t){let{$$slots:i={},$$scope:l}=e;const s=it();let{index:r}=e,{list:o=[]}=e,{group:a="default"}=e,{disabled:u=!1}=e,{dragHandleClass:f=""}=e,c=!1,d=!1;function m(O,C){if(!(!O||u)){if(f&&!O.target.classList.contains(f)){t(3,d=!1),t(2,c=!1),O.preventDefault();return}t(2,c=!0),O.dataTransfer.effectAllowed="move",O.dataTransfer.dropEffect="move",O.dataTransfer.setData("text/plain",JSON.stringify({index:C,group:a})),s("drag",O)}}function h(O,C){if(t(3,d=!1),t(2,c=!1),!O||u)return;O.dataTransfer.dropEffect="move";let S={};try{S=JSON.parse(O.dataTransfer.getData("text/plain"))}catch{}if(S.group!=a)return;const P=S.index<<0;P<C?(o.splice(C+1,0,o[P]),o.splice(P,1)):(o.splice(C,0,o[P]),o.splice(P+1,1)),t(6,o),s("sort",{oldIndex:P,newIndex:C,list:o})}const _=()=>{t(3,d=!0)},b=()=>{t(3,d=!1)},g=()=>{t(3,d=!1),t(2,c=!1)},T=O=>m(O,r),L=O=>h(O,r);return n.$$set=O=>{"index"in O&&t(0,r=O.index),"list"in O&&t(6,o=O.list),"group"in O&&t(7,a=O.group),"disabled"in O&&t(1,u=O.disabled),"dragHandleClass"in O&&t(8,f=O.dragHandleClass),"$$scope"in O&&t(9,l=O.$$scope)},[r,u,c,d,m,h,o,a,f,l,i,_,b,g,T,L]}class Sb extends ve{constructor(e){super(),ye(this,e,kb,vb,_e,{index:0,list:6,group:7,disabled:1,dragHandleClass:8})}}const Tb=n=>({uniqueId:n&1,isUploading:n&4,dragover:n&16384}),Ma=n=>({uniqueId:n[0],isUploading:n[2],dragover:n[14]});function Ob(n){let e,t,i,l,s;const r=n[4].default,o=st(r,n,n[10],Ma);return{c(){e=w("input"),t=I(),o&&o.c(),e.multiple=!0,p(e,"id",n[0]),p(e,"type","file"),p(e,"accept","image/*"),p(e,"class","hidden")},m(a,u){k(a,e,u),n[7](e),k(a,t,u),o&&o.m(a,u),i=!0,l||(s=H(e,"change",n[8]),l=!0)},p(a,u){(!i||u&1)&&p(e,"id",a[0]),o&&o.p&&(!i||u&17413)&&ot(o,r,a,a[10],i?rt(r,a[10],u,Tb):at(a[10]),Ma)},i(a){i||(E(o,a),i=!0)},o(a){j(o,a),i=!1},d(a){a&&(v(e),v(t)),n[7](null),o&&o.d(a),l=!1,s()}}}function Cb(n){let e,t,i,l;return e=new kd({props:{$$slots:{default:[Ob,({dragover:s})=>({14:s}),({dragover:s})=>s?16384:0]},$$scope:{ctx:n}}}),e.$on("drop",n[9]),{c(){F(e.$$.fragment)},m(s,r){q(e,s,r),t=!0,i||(l=[H(window,"drop",we(n[6])),H(window,"dragover",Ze(we(n[5])))],i=!0)},p(s,[r]){const o={};r&17415&&(o.$$scope={dirty:r,ctx:s}),e.$set(o)},i(s){t||(E(e.$$.fragment,s),t=!0)},o(s){j(e.$$.fragment,s),t=!1},d(s){$(e,s),i=!1,me(l)}}}function Eb(n,e,t){let i,l;ee(n,Ct,g=>t(11,i=g)),ee(n,pt,g=>t(12,l=g));let{$$slots:s={},$$scope:r}=e;const o=it();let{id:a="uploader_"+K.randomString(5)}=e,u,f=!1;async function c(g){if(f||!(i!=null&&i.id)||!(g!=null&&g.length))return;t(2,f=!0);const T=[];let L=[];for(let S=0;S<g.length;S++){const P=g.item(S);let R="s"+S;R+=K.randomString(15-R.length);const A=l==null?void 0:l[l.length-1],D=new FormData;D.append("id",R),D.append("file",P),D.append("title",P.name.split(".").slice(0,-1).join(".")||P.name),D.append("prototype",i.id),D.append("background",(A==null?void 0:A.background)||""),D.append("alignment",(A==null?void 0:A.alignment)||""),T.push(V.collection("screens").create(D,{requestKey:null})),L.push(R)}const O=[],C={};try{const S=await Promise.allSettled(T);for(const R of S)R.status==="fulfilled"?(C[R.value.id]=R.value,Nn(R.value)):O.push(R);L=L.filter(R=>!!C[R]);const P=await V.collection("prototypes").update(i.id,{screensOrder:i.screensOrder.concat(L)},{$autoCancel:!1});ki(P),o("upload",Object.values(C)),u&&t(1,u.value="",u)}catch(S){console.warn("screens upload error:",S)}O.length>0&&(console.warn("failed to upload:",O),Js("Failed to upload some of the selected files.")),t(2,f=!1)}function d(g){$e.call(this,n,g)}const m=g=>{c(g.dataTransfer.files)};function h(g){le[g?"unshift":"push"](()=>{u=g,t(1,u)})}const _=g=>c(g.target.files),b=g=>{c(g.detail)};return n.$$set=g=>{"id"in g&&t(0,a=g.id),"$$scope"in g&&t(10,r=g.$$scope)},[a,u,f,c,s,d,m,h,_,b,r]}class Lb extends ve{constructor(e){super(),ye(this,e,Eb,Cb,_e,{id:0})}}function Ra(n,e,t){const i=n.slice();return i[42]=e[t],i}function Ha(n,e,t){var o,a,u,f,c;const i=n.slice();i[47]=e[t],i[51]=e,i[52]=t;const l=(o=i[10])==null?void 0:o.filter(function(...m){return n[31](i[47],...m)}).length;i[48]=l;const s=(a=i[10])==null?void 0:a.filter(function(...m){return n[32](i[47],...m)}).map(d=>{var m,h;return(h=(m=d.expand)==null?void 0:m.comment)==null?void 0:h.id});i[49]=s;const r=i[49].length+(((c=(f=(u=i[47].expand)==null?void 0:u.comments_via_screen)==null?void 0:f.filter(function(...m){return n[33](i[49],...m)}))==null?void 0:c.length)||0);return i[50]=r,i}function Ib(n){let e,t=[],i=new Map,l,s,r,o,a,u,f=Le(n[5]?n[8].slice(0,n[5]):n[8]);const c=m=>{var h;return((h=m[3])==null?void 0:h.id)+m[47].id};for(let m=0;m<f.length;m+=1){let h=Ha(n,f,m),_=c(h);i.set(_,t[m]=qa(_,h))}r=new Lb({props:{id:"screen_uploader",$$slots:{default:[$b,({dragover:m,isUploading:h})=>({45:m,46:h}),({dragover:m,isUploading:h})=>[0,(m?16384:0)|(h?32768:0)]]},$$scope:{ctx:n}}}),r.$on("upload",Vb);let d=n[7]&&$a(n);return{c(){e=w("div");for(let m=0;m<t.length;m+=1)t[m].c();l=I(),s=w("div"),F(r.$$.fragment),o=I(),d&&d.c(),a=De(),p(s,"class","card card-placeholder"),p(e,"class","cards-list compact screens-list entrance-top"),B(e,"reordering",n[4])},m(m,h){k(m,e,h);for(let _=0;_<t.length;_+=1)t[_]&&t[_].m(e,null);y(e,l),y(e,s),q(r,s,null),k(m,o,h),d&&d.m(m,h),k(m,a,h),u=!0},p(m,h){if(h[0]&140601|h[1]&4210688){f=Le(m[5]?m[8].slice(0,m[5]):m[8]),ae();for(let b=0;b<t.length;b+=1)t[b].r();t=St(t,h,c,1,m,f,i,e,Yf,qa,l,Ha);for(let b=0;b<t.length;b+=1)t[b].a();ue()}const _={};h[1]&8437760&&(_.$$scope={dirty:h,ctx:m}),r.$set(_),(!u||h[0]&16)&&B(e,"reordering",m[4]),m[7]?d?(d.p(m,h),h[0]&128&&E(d,1)):(d=$a(m),d.c(),E(d,1),d.m(a.parentNode,a)):d&&(ae(),j(d,1,1,()=>{d=null}),ue())},i(m){if(!u){for(let h=0;h<f.length;h+=1)E(t[h]);E(r.$$.fragment,m),E(d),u=!0}},o(m){for(let h=0;h<t.length;h+=1)j(t[h]);j(r.$$.fragment,m),j(d),u=!1},d(m){m&&(v(e),v(o),v(a));for(let h=0;h<t.length;h+=1)t[h].d();$(r),d&&d.d(m)}}}function jb(n){let e;return{c(){e=w("div"),e.innerHTML='<span class="loader loader-lg"></span>',p(e,"class","block txt-center m-t-lg")},m(t,i){k(t,e,i)},p:Q,i:Q,o:Q,d(t){t&&v(e)}}}function Pb(n){let e;return{c(){e=w("i"),p(e,"class","iconoir-media-image")},m(t,i){k(t,e,i)},p:Q,i:Q,o:Q,d(t){t&&v(e)}}}function Nb(n){let e,t,i;return t=new Xt({props:{src:V.files.getURL(n[47],n[47].file,{thumb:"450x0"}),alt:n[47].title,draggable:!1}}),{c(){e=w("div"),F(t.$$.fragment),p(e,"class","card-img"),qe(e,"background-color",n[47].background)},m(l,s){k(l,e,s),q(t,e,null),i=!0},p(l,s){const r={};s[0]&288&&(r.src=V.files.getURL(l[47],l[47].file,{thumb:"450x0"})),s[0]&288&&(r.alt=l[47].title),t.$set(r),s[0]&288&&qe(e,"background-color",l[47].background)},i(l){i||(E(t.$$.fragment,l),i=!0)},o(l){j(t.$$.fragment,l),i=!1},d(l){l&&v(e),$(t)}}}function Ab(n){let e;return{c(){e=w("span"),p(e,"class","loader loader-lg")},m(t,i){k(t,e,i)},p:Q,i:Q,o:Q,d(t){t&&v(e)}}}function Db(n){let e,t,i,l,s,r,o;function a(){n[23].call(e,n[47])}function u(...f){return n[24](n[47],...f)}return{c(){e=w("input"),i=I(),l=w("label"),p(e,"type","checkbox"),p(e,"id",t=n[53]),p(l,"for",s=n[53])},m(f,c){k(f,e,c),e.checked=n[0][n[47].id],k(f,i,c),k(f,l,c),r||(o=[H(e,"change",a),H(e,"change",u)],r=!0)},p(f,c){n=f,c[1]&4194304&&t!==(t=n[53])&&p(e,"id",t),c[0]&289&&(e.checked=n[0][n[47].id]),c[1]&4194304&&s!==(s=n[53])&&p(l,"for",s)},d(f){f&&(v(e),v(i),v(l)),r=!1,me(o)}}}function Mb(n){let e,t,i;function l(){return n[25](n[47])}return{c(){e=w("div"),e.innerHTML='<i class="iconoir-trash"></i> <span class="txt">Delete</span>',p(e,"class","dropdown-item link-danger closable")},m(s,r){k(s,e,r),t||(i=H(e,"click",Ze(we(l))),t=!0)},p(s,r){n=s},d(s){s&&v(e),t=!1,i()}}}function Rb(n){let e,t,i,l,s,r,o,a,u,f,c,d,m,h,_,b,g,T,L;const O=[Ab,Nb,Pb],C=[];function S(P,R){return P[47].isReplacing?0:P[47].file?1:2}return t=S(n),i=C[t]=O[t](n),u=new Ce({props:{class:"form-field m-0",$$slots:{default:[Db,({uniqueId:P})=>({53:P}),({uniqueId:P})=>[0,P?4194304:0]]},$$scope:{ctx:n}}}),_=new Rt({props:{class:"dropdown dropdown-sm",$$slots:{default:[Mb]},$$scope:{ctx:n}}}),{c(){e=w("figure"),i.c(),l=I(),s=w("a"),r=w("div"),r.innerHTML='<i class="iconoir-play-solid preview-icon"></i>',o=I(),a=w("div"),F(u.$$.fragment),f=I(),c=w("div"),d=w("button"),m=w("i"),h=I(),F(_.$$.fragment),p(r,"class","ctrl ctrl-center"),p(a,"class","ctrl ctrl-top-left"),p(m,"class","iconoir-more-vert"),p(d,"type","button"),p(d,"class","btn btn-sm btn-circle btn-transparent fade"),p(c,"class","ctrl ctrl-top-right"),p(s,"href",b=`/projects/${n[3].project}/prototypes/${n[3].id}/screens/${n[47].id}`),p(s,"class","card-overlay handle"),p(s,"draggable",!1),p(e,"class","card-featured"),p(e,"draggable",!1),B(e,"dragover",n[45])},m(P,R){k(P,e,R),C[t].m(e,null),y(e,l),y(e,s),y(s,r),y(s,o),y(s,a),q(u,a,null),y(s,f),y(s,c),y(c,d),y(d,m),y(d,h),q(_,d,null),g=!0,T||(L=[H(a,"click",Ze(n[22])),H(d,"mousedown",Ze(we(n[20]))),H(d,"click",Ze(we(n[21]))),be(Oi.call(null,s))],T=!0)},p(P,R){let A=t;t=S(P),t===A?C[t].p(P,R):(ae(),j(C[A],1,1,()=>{C[A]=null}),ue(),i=C[t],i?i.p(P,R):(i=C[t]=O[t](P),i.c()),E(i,1),i.m(e,l));const D={};R[0]&289|R[1]&12582912&&(D.$$scope={dirty:R,ctx:P}),u.$set(D);const M={};R[0]&288|R[1]&8388608&&(M.$$scope={dirty:R,ctx:P}),_.$set(M),(!g||R[0]&296&&b!==(b=`/projects/${P[3].project}/prototypes/${P[3].id}/screens/${P[47].id}`))&&p(s,"href",b),(!g||R[1]&16384)&&B(e,"dragover",P[45])},i(P){g||(E(i),E(u.$$.fragment,P),E(_.$$.fragment,P),g=!0)},o(P){j(i),j(u.$$.fragment,P),j(_.$$.fragment,P),g=!1},d(P){P&&v(e),C[t].d(),$(u),$(_),T=!1,me(L)}}}function Hb(n){let e,t,i;function l(r){n[26](r)}let s={index:n[52],$$slots:{default:[Rb]},$$scope:{ctx:n}};return n[8]!==void 0&&(s.list=n[8]),e=new Sb({props:s}),le.push(()=>Ae(e,"list",l)),e.$on("drag",n[27]),e.$on("sort",n[28]),{c(){F(e.$$.fragment)},m(r,o){q(e,r,o),i=!0},p(r,o){const a={};o[0]&288&&(a.index=r[52]),o[0]&297|o[1]&8404992&&(a.$$scope={dirty:o,ctx:r}),!t&&o[0]&256&&(t=!0,a.list=r[8],Ne(()=>t=!1)),e.$set(a)},i(r){i||(E(e.$$.fragment,r),i=!0)},o(r){j(e.$$.fragment,r),i=!1},d(r){$(e,r)}}}function Ua(n){let e,t,i,l,s=(n[50]||n[48])+"",r,o,a,u;return{c(){e=w("div"),t=w("i"),i=I(),l=w("span"),r=te(s),p(t,"class","iconoir-message-text"),p(l,"class","txt"),p(e,"class","meta-item"),B(e,"txt-warning",n[48]>0)},m(f,c){k(f,e,c),y(e,t),y(e,i),y(e,l),y(l,r),a||(u=be(o=Oe.call(null,e,[n[50]?n[50]+" unresolved":"",n[48]?n[48]+" unread":""].filter(Boolean).join(`
`))),a=!0)},p(f,c){n=f,c[0]&1312&&s!==(s=(n[50]||n[48])+"")&&Se(r,s),o&&et(o.update)&&c[0]&1312&&o.update.call(null,[n[50]?n[50]+" unresolved":"",n[48]?n[48]+" unread":""].filter(Boolean).join(`
`)),c[0]&1312&&B(e,"txt-warning",n[48]>0)},d(f){f&&v(e),a=!1,u()}}}function qa(n,e){let t,i,l,s,r,o,a,u,f,c,d,m,h=Q,_,b,g;function T(...S){return e[29](e[47],...S)}i=new kd({props:{$$slots:{default:[Hb,({dragover:S})=>({45:S}),({dragover:S})=>[0,S?16384:0]]},$$scope:{ctx:e}}}),i.$on("drop",T);function L(S){e[30](S,e[47],e[51],e[52])}let O={tag:"h5",class:"title",collection:"screens"};e[47]!==void 0&&(O.model=e[47]),r=new ur({props:O}),le.push(()=>Ae(r,"model",L));let C=(e[50]||e[48])&&Ua(e);return{key:n,first:null,c(){t=w("div"),F(i.$$.fragment),l=I(),s=w("div"),F(r.$$.fragment),a=I(),u=w("div"),C&&C.c(),f=I(),c=w("div"),c.innerHTML='<div class="iconoir-calendar"></div>',p(c,"class","meta-item"),p(u,"class","meta"),p(s,"class","card-content"),p(t,"class","card screen-card"),B(t,"selected",e[0][e[47].id]),this.first=t},m(S,P){k(S,t,P),q(i,t,null),y(t,l),y(t,s),q(r,s,null),y(s,a),y(s,u),C&&C.m(u,null),y(u,f),y(u,c),_=!0,b||(g=be(d=Oe.call(null,c,{text:"Created "+K.relativeDate(e[47].created),sub:K.formatToLocalDate(e[47].created)})),b=!0)},p(S,P){e=S;const R={};P[0]&297|P[1]&8404992&&(R.$$scope={dirty:P,ctx:e}),i.$set(R);const A={};!o&&P[0]&288&&(o=!0,A.model=e[47],Ne(()=>o=!1)),r.$set(A),e[50]||e[48]?C?C.p(e,P):(C=Ua(e),C.c(),C.m(u,f)):C&&(C.d(1),C=null),d&&et(d.update)&&P[0]&288&&d.update.call(null,{text:"Created "+K.relativeDate(e[47].created),sub:K.formatToLocalDate(e[47].created)}),(!_||P[0]&289)&&B(t,"selected",e[0][e[47].id])},r(){m=t.getBoundingClientRect()},f(){qf(t),h()},a(){h(),h=Uf(t,m,vd,{duration:200,delay:50})},i(S){_||(E(i.$$.fragment,S),E(r.$$.fragment,S),_=!0)},o(S){j(i.$$.fragment,S),j(r.$$.fragment,S),_=!1},d(S){S&&v(t),$(i),$(r),C&&C.d(),b=!1,g()}}}function Ub(n){let e,t,i,l,s;return{c(){e=w("div"),e.innerHTML='<i class="iconoir-upload-square"></i>',t=I(),i=w("div"),i.textContent="Upload screens",l=I(),s=w("div"),s.textContent="Drop or click here to upload new screens",p(e,"class","icon"),p(i,"class","title"),p(s,"class","content")},m(r,o){k(r,e,o),k(r,t,o),k(r,i,o),k(r,l,o),k(r,s,o)},d(r){r&&(v(e),v(t),v(i),v(l),v(s))}}}function qb(n){let e;return{c(){e=w("span"),p(e,"class","loader loader-primary")},m(t,i){k(t,e,i)},d(t){t&&v(e)}}}function $b(n){let e,t;function i(r,o){return r[46]?qb:Ub}let l=i(n),s=l(n);return{c(){e=w("label"),t=w("div"),s.c(),p(t,"class","placeholder"),p(e,"for","screen_uploader"),p(e,"class","card-featured"),B(e,"dragover",n[45]),B(e,"no-pointer-events",n[46])},m(r,o){k(r,e,o),y(e,t),s.m(t,null)},p(r,o){l!==(l=i(r))&&(s.d(1),s=l(r),s&&(s.c(),s.m(t,null))),o[1]&16384&&B(e,"dragover",r[45]),o[1]&32768&&B(e,"no-pointer-events",r[46])},d(r){r&&v(e),s.d()}}}function $a(n){let e,t,i,l,s,r,o=n[7]==1?"screen":"screens",a,u,f,c,d,m,h,_,b,g,T,L,O=n[11].length>1&&Fa(n);return{c(){e=w("div"),t=w("div"),i=te("Selected "),l=w("strong"),s=te(n[7]),r=I(),a=te(o),u=I(),O&&O.c(),f=I(),c=w("button"),d=w("span"),d.textContent="Delete",m=I(),h=w("button"),_=w("i"),p(t,"class","info"),p(d,"class","txt"),p(c,"type","button"),p(c,"class","btn btn-sm btn-semitransparent btn-danger btn-expanded-sm"),c.disabled=n[6],B(c,"btn-loading",n[1]),p(_,"class","iconoir-xmark"),p(h,"type","button"),p(h,"class","btn btn-sm btn-circle btn-transparent m-l-auto"),h.disabled=n[6],p(e,"class","bulk-bar")},m(C,S){k(C,e,S),y(e,t),y(t,i),y(t,l),y(l,s),y(l,r),y(l,a),y(e,u),O&&O.m(e,null),y(e,f),y(e,c),y(c,d),y(e,m),y(e,h),y(h,_),g=!0,T||(L=[H(c,"click",n[16]),be(Oe.call(null,h,{position:"top",text:"Clear selection"})),H(h,"click",n[14])],T=!0)},p(C,S){(!g||S[0]&128)&&Se(s,C[7]),(!g||S[0]&128)&&o!==(o=C[7]==1?"screen":"screens")&&Se(a,o),C[11].length>1?O?(O.p(C,S),S[0]&2048&&E(O,1)):(O=Fa(C),O.c(),E(O,1),O.m(e,f)):O&&(ae(),j(O,1,1,()=>{O=null}),ue()),(!g||S[0]&64)&&(c.disabled=C[6]),(!g||S[0]&2)&&B(c,"btn-loading",C[1]),(!g||S[0]&64)&&(h.disabled=C[6])},i(C){g||(E(O),C&&kt(()=>{g&&(b||(b=ct(e,Pn,{duration:150,y:10,opacity:0},!0)),b.run(1))}),g=!0)},o(C){j(O),C&&(b||(b=ct(e,Pn,{duration:150,y:10,opacity:0},!1)),b.run(0)),g=!1},d(C){C&&v(e),O&&O.d(),C&&b&&b.end(),T=!1,me(L)}}}function Fa(n){let e,t,i,l,s,r,o;return r=new Rt({props:{class:"dropdown dropdown-upside dropdown-sm",$$slots:{default:[Fb]},$$scope:{ctx:n}}}),{c(){e=w("button"),t=w("span"),t.textContent="Move to",i=I(),l=w("i"),s=I(),F(r.$$.fragment),p(t,"class","txt"),p(l,"class","iconoir-nav-arrow-down"),p(e,"type","button"),p(e,"class","btn btn-sm btn-semitransparent btn-expanded-sm"),e.disabled=n[6],B(e,"btn-loading",n[2])},m(a,u){k(a,e,u),y(e,t),y(e,i),y(e,l),y(e,s),q(r,e,null),o=!0},p(a,u){const f={};u[0]&2056|u[1]&8388608&&(f.$$scope={dirty:u,ctx:a}),r.$set(f),(!o||u[0]&64)&&(e.disabled=a[6]),(!o||u[0]&4)&&B(e,"btn-loading",a[2])},i(a){o||(E(r.$$.fragment,a),o=!0)},o(a){j(r.$$.fragment,a),o=!1},d(a){a&&v(e),$(r)}}}function Wa(n){let e,t,i=n[42].title+"",l,s,r,o;function a(){return n[34](n[42])}return{c(){e=w("button"),t=w("span"),l=te(i),s=I(),p(t,"class","txt"),p(e,"type","button"),p(e,"class","dropdown-item closable")},m(u,f){k(u,e,f),y(e,t),y(t,l),y(e,s),r||(o=H(e,"click",a),r=!0)},p(u,f){n=u,f[0]&2048&&i!==(i=n[42].title+"")&&Se(l,i)},d(u){u&&v(e),r=!1,o()}}}function Va(n,e){var s;let t,i,l=e[42].id!=((s=e[3])==null?void 0:s.id)&&Wa(e);return{key:n,first:null,c(){t=De(),l&&l.c(),i=De(),this.first=t},m(r,o){k(r,t,o),l&&l.m(r,o),k(r,i,o)},p(r,o){var a;e=r,e[42].id!=((a=e[3])==null?void 0:a.id)?l?l.p(e,o):(l=Wa(e),l.c(),l.m(i.parentNode,i)):l&&(l.d(1),l=null)},d(r){r&&(v(t),v(i)),l&&l.d(r)}}}function Fb(n){let e=[],t=new Map,i,l=Le(n[11]);const s=r=>r[42].id;for(let r=0;r<l.length;r+=1){let o=Ra(n,l,r),a=s(o);t.set(a,e[r]=Va(a,o))}return{c(){for(let r=0;r<e.length;r+=1)e[r].c();i=De()},m(r,o){for(let a=0;a<e.length;a+=1)e[a]&&e[a].m(r,o);k(r,i,o)},p(r,o){o[0]&34824&&(l=Le(r[11]),e=St(e,o,s,1,r,l,t,i.parentNode,Zf,Va,i,Ra))},d(r){r&&v(i);for(let o=0;o<e.length;o+=1)e[o].d(r)}}}function Wb(n){let e,t,i,l,s,r;const o=[jb,Ib],a=[];function u(f,c){var d;return f[9]&&!f[8].length?0:(d=f[3])!=null&&d.id?1:-1}return~(e=u(n))&&(t=a[e]=o[e](n)),{c(){t&&t.c(),i=De()},m(f,c){~e&&a[e].m(f,c),k(f,i,c),l=!0,s||(r=H(window,"keydown",n[12]),s=!0)},p(f,c){let d=e;e=u(f),e===d?~e&&a[e].p(f,c):(t&&(ae(),j(a[d],1,1,()=>{a[d]=null}),ue()),~e?(t=a[e],t?t.p(f,c):(t=a[e]=o[e](f),t.c()),E(t,1),t.m(i.parentNode,i)):t=null)},i(f){l||(E(t),l=!0)},o(f){j(t),l=!1},d(f){f&&v(i),~e&&a[e].d(f),s=!1,r()}}}function za(n,e){if(!(e!=null&&e.length)||!n.length)return n;let t,i;return n.sort((l,s)=>(t=e.findIndex(r=>r==l.id),i=e.findIndex(r=>r==s.id),t>=0&&i>=0?t<i?-1:t>i?1:0:l.created<s.created?-1:l.created>s.created?1:0)),n}function Vb(){var n;(n=document.querySelector(".screens-list"))==null||n.scrollIntoView({behavior:"smooth",block:"end"})}function zb(n,e,t){let i,l,s,r,o,a,u;ee(n,pt,J=>t(8,s=J)),ee(n,Ct,J=>t(3,r=J)),ee(n,qi,J=>t(9,o=J)),ee(n,wn,J=>t(10,a=J)),ee(n,Ft,J=>t(11,u=J));let f={},c=!1,d=!1,m=!1,h=0,_,b,g;async function T(){for(t(18,_=r==null?void 0:r.id),t(19,b=JSON.stringify(r==null?void 0:r.screensOrder)),P(),t(5,h=50),await L();h<s.length;)await K.yieldToMain(),t(5,h+=15);t(5,h=0)}async function L(){if(r!=null&&r.id){ir(),lr(r.id),ke(qi,o=!0,o);try{let J=await V.collection("screens").getFullList({filter:`prototype="${r.id}"`,expand:"comments_via_screen",fields:"*,expand.comments_via_screen.id,expand.comments_via_screen.replyTo,expand.comments_via_screen.resolved",sort:"created"});ke(pt,s=za(J,r.screensOrder),s),ke(qi,o=!1,o)}catch(J){J!=null&&J.isAbort||(V.error(J),ke(qi,o=!1,o))}}}function O(){t(19,b=JSON.stringify(r==null?void 0:r.screensOrder)),clearTimeout(g),g=setTimeout(()=>{ke(pt,s=za(s,r.screensOrder),s)},200)}function C(J){if(J.ctrlKey&&J.code=="KeyA"&&!K.isInput(J.target)){J.preventDefault();for(const G of s)t(0,f[G.id]=!0,f)}}async function S(){const J=s.map(x=>x.id),G=JSON.stringify(r.screensOrder),oe=JSON.stringify(J);if(G!=oe)try{t(4,m=!0),clearTimeout(g),t(19,b=oe),ke(Ct,r.screensOrder=J,r),await V.collection("prototypes").update(r.id,{screensOrder:J}),t(4,m=!1)}catch(x){x.isAbort||(t(4,m=!1),V.error(x))}}function P(){t(0,f={})}async function R(J){const G=Object.keys(f);Pt(`Do you really want to move the selected ${G.length} ${G.length==1?"screen":"screens"}?`,async()=>A(J))}async function A(J){const G=Object.keys(f);if(!(!G.length||!(J!=null&&J.id)||l)){t(2,d=!0);try{const oe=[],x={prototype:J.id};for(let je of G)oe.push(V.collection("screens").update(je,x,{requestKey:"move_"+je}));oe.push(V.collection("prototypes").update(r.id,{"screensOrder-":G})),await Promise.all(oe),P(),ke(Ct,r=J.id,r)}catch(oe){V.error(oe)}t(2,d=!1)}}function D(){const J=Object.keys(f);Pt(`Do you really want to delete the selected ${J.length} ${J.length==1?"screen":"screens"}?`,async()=>M())}async function M(){const J=Object.keys(f);if(!(!J.length||l)){t(1,c=!0);try{const G=J.map(x=>V.collection("screens").delete(x));await Promise.all(G);const oe=s.filter(x=>J.includes(x.id));for(const x of oe)js(x);P(),S(),_t(`Successfully deleted ${J.length} ${J.length==1?"screen":"screens"}.`)}catch(G){G.isAbort||(V.error(G),T())}t(1,c=!1)}}async function Z(J){Pt(`Do you really want to delete ${J.title}?`,async()=>Y(J),()=>{var G;(G=document.activeElement)==null||G.blur()})}async function Y(J){try{await V.collection("screens").delete(J.id),js(J),P(),_t(`Successfully deleted screen ${J.title}.`)}catch(G){G.isAbort||(V.error(G),T())}}Gt(()=>{clearTimeout(g),Ut==null||Ut()});function z(J){$e.call(this,n,J)}function N(J){$e.call(this,n,J)}function W(J){$e.call(this,n,J)}function ne(J){f[J.id]=this.checked,t(0,f)}const X=(J,G)=>{G.target.checked||(delete f[J.id],t(0,f),G.target.blur())},U=J=>Z(J);function de(J){s=J,pt.set(s)}const re=J=>{if(!J.detail)return;const G=document.createElement("div");G.className="draggable-ghost",document.body.appendChild(G),J.detail.dataTransfer.setDragImage(G,0,0),setTimeout(()=>{G==null||G.remove()},0)},pe=()=>{S()},Ee=(J,G)=>{m||rr(J,G.detail[0])};function tt(J,G,oe,x){oe[x]=J,t(5,h)}const ut=(J,G)=>{var oe,x;return((x=(oe=G.expand)==null?void 0:oe.comment)==null?void 0:x.screen)==J.id},lt=(J,G)=>{var oe,x,je,Re,Xe,bt;return!((x=(oe=G.expand)==null?void 0:oe.comment)!=null&&x.replyTo)&&!((Re=(je=G.expand)==null?void 0:je.comment)!=null&&Re.resolved)&&((bt=(Xe=G.expand)==null?void 0:Xe.comment)==null?void 0:bt.screen)==J.id},dt=(J,G)=>!G.replyTo&&!G.resolved&&!J.includes(G.id),se=J=>R(J);return n.$$.update=()=>{n.$$.dirty[0]&262152&&_!=(r==null?void 0:r.id)&&T(),n.$$.dirty[0]&786440&&_&&b!=JSON.stringify(r==null?void 0:r.screensOrder)&&O(),n.$$.dirty[0]&1&&t(7,i=Object.keys(f).length),n.$$.dirty[0]&6&&t(6,l=c||d)},[f,c,d,r,m,h,l,i,s,o,a,u,C,S,P,R,D,Z,_,b,z,N,W,ne,X,U,de,re,pe,Ee,tt,ut,lt,dt,se]}class Bb extends ve{constructor(e){super(),ye(this,e,zb,Wb,_e,{},null,[-1,-1])}}function Ba(n){let e,t,i=n[0].name&&Za(n),l=n[2]&&Ya();return{c(){e=w("div"),i&&i.c(),t=I(),l&&l.c(),p(e,"class","row")},m(s,r){k(s,e,r),i&&i.m(e,null),y(e,t),l&&l.m(e,null)},p(s,r){s[0].name?i?i.p(s,r):(i=Za(s),i.c(),i.m(e,t)):i&&(i.d(1),i=null),s[2]?l||(l=Ya(),l.c(),l.m(e,null)):l&&(l.d(1),l=null)},d(s){s&&v(e),i&&i.d(),l&&l.d()}}}function Za(n){let e,t=n[0].name+"",i,l;return{c(){e=w("span"),i=te(t),p(e,"class","user-name txt-ellipsis"),p(e,"title",l=n[0].name)},m(s,r){k(s,e,r),y(e,i)},p(s,r){r&1&&t!==(t=s[0].name+"")&&Se(i,t),r&1&&l!==(l=s[0].name)&&p(e,"title",l)},d(s){s&&v(e)}}}function Ya(n){let e;return{c(){e=w("span"),e.textContent="You",p(e,"class","label label-sm label-warning")},m(t,i){k(t,e,i)},d(t){t&&v(e)}}}function Ka(n){let e,t,i,l=n[0].email+"",s,r;return{c(){e=w("small"),e.textContent="|",t=I(),i=w("small"),s=te(l),p(i,"class","user-email txt-ellipsis"),p(i,"title",r=n[0].email)},m(o,a){k(o,e,a),k(o,t,a),k(o,i,a),y(i,s)},p(o,a){a&1&&l!==(l=o[0].email+"")&&Se(s,l),a&1&&r!==(r=o[0].email)&&p(i,"title",r)},d(o){o&&(v(e),v(t),v(i))}}}function Zb(n){let e,t,i,l,s,r,o,a,u=n[0].username+"",f,c,d,m,h,_;t=new il({props:{user:n[0]}});let b=(n[0].name||n[2])&&Ba(n),g=n[0].email&&Ka(n);const T=n[5].default,L=st(T,n,n[4],null);return{c(){e=w("div"),F(t.$$.fragment),i=I(),l=w("div"),b&&b.c(),s=I(),r=w("div"),o=w("small"),a=te("@"),f=te(u),d=I(),g&&g.c(),m=I(),L&&L.c(),p(o,"class","user-username txt-ellipsis"),p(o,"title",c="@"+n[0].username),p(r,"class","row txt-hint"),p(l,"class","content"),p(e,"class",h="list-item "+n[1])},m(O,C){k(O,e,C),q(t,e,null),y(e,i),y(e,l),b&&b.m(l,null),y(l,s),y(l,r),y(r,o),y(o,a),y(o,f),y(r,d),g&&g.m(r,null),y(e,m),L&&L.m(e,null),_=!0},p(O,[C]){const S={};C&1&&(S.user=O[0]),t.$set(S),O[0].name||O[2]?b?b.p(O,C):(b=Ba(O),b.c(),b.m(l,s)):b&&(b.d(1),b=null),(!_||C&1)&&u!==(u=O[0].username+"")&&Se(f,u),(!_||C&1&&c!==(c="@"+O[0].username))&&p(o,"title",c),O[0].email?g?g.p(O,C):(g=Ka(O),g.c(),g.m(r,null)):g&&(g.d(1),g=null),L&&L.p&&(!_||C&16)&&ot(L,T,O,O[4],_?rt(T,O[4],C,null):at(O[4]),null),(!_||C&2&&h!==(h="list-item "+O[1]))&&p(e,"class",h)},i(O){_||(E(t.$$.fragment,O),E(L,O),_=!0)},o(O){j(t.$$.fragment,O),j(L,O),_=!1},d(O){O&&v(e),$(t),b&&b.d(),g&&g.d(),L&&L.d(O)}}}function Yb(n,e,t){let i,l;ee(n,xn,u=>t(3,l=u));let{$$slots:s={},$$scope:r}=e,{user:o={}}=e,{class:a=""}=e;return n.$$set=u=>{"user"in u&&t(0,o=u.user),"class"in u&&t(1,a=u.class),"$$scope"in u&&t(4,r=u.$$scope)},n.$$.update=()=>{n.$$.dirty&9&&t(2,i=(l==null?void 0:l.id)==o.id)},[o,a,i,l,r,s]}class Sd extends ve{constructor(e){super(),ye(this,e,Yb,Zb,_e,{user:0,class:1})}}function Ga(n,e,t){const i=n.slice();return i[31]=e[t],i}function Ja(n,e,t){const i=n.slice();return i[28]=e[t],i}function Xa(n,e,t){const i=n.slice();return i[31]=e[t],i}function Qa(n,e,t){const i=n.slice();return i[28]=e[t],i}function Kb(n){let e=[],t=new Map,i,l,s=Le(n[8]);const r=a=>a[31].id;for(let a=0;a<s.length;a+=1){let u=Xa(n,s,a),f=r(u);t.set(f,e[a]=eu(f,u))}let o=null;return s.length||(o=xa()),{c(){for(let a=0;a<e.length;a+=1)e[a].c();i=De(),o&&o.c()},m(a,u){for(let f=0;f<e.length;f+=1)e[f]&&e[f].m(a,u);k(a,i,u),o&&o.m(a,u),l=!0},p(a,u){u[0]&2340&&(s=Le(a[8]),ae(),e=St(e,u,r,1,a,s,t,i.parentNode,At,eu,i,Xa),ue(),!s.length&&o?o.p(a,u):s.length?o&&(o.d(1),o=null):(o=xa(),o.c(),o.m(i.parentNode,i)))},i(a){if(!l){for(let u=0;u<s.length;u+=1)E(e[u]);l=!0}},o(a){for(let u=0;u<e.length;u+=1)j(e[u]);l=!1},d(a){a&&v(i);for(let u=0;u<e.length;u+=1)e[u].d(a);o&&o.d(a)}}}function Gb(n){let e,t=Le(Array(n[2].users.length||1)),i=[];for(let l=0;l<t.length;l+=1)i[l]=tu(Qa(n,t,l));return{c(){for(let l=0;l<i.length;l+=1)i[l].c();e=De()},m(l,s){for(let r=0;r<i.length;r+=1)i[r]&&i[r].m(l,s);k(l,e,s)},p(l,s){if(s[0]&4){t=Le(Array(l[2].users.length||1));let r;for(r=0;r<t.length;r+=1){const o=Qa(l,t,r);i[r]?i[r].p(o,s):(i[r]=tu(),i[r].c(),i[r].m(e.parentNode,e))}for(;r<i.length;r+=1)i[r].d(1);i.length=t.length}},i:Q,o:Q,d(l){l&&v(e),ln(i,l)}}}function xa(n){let e;return{c(){e=w("div"),e.innerHTML='<div class="block txt-center p-5"><span class="txt-hint">The project doesn&#39;t have any owners yet.</span></div> ',p(e,"class","list-item txt-hint")},m(t,i){k(t,e,i)},p:Q,d(t){t&&v(e)}}}function Jb(n){let e,t,i,l,s,r,o;function a(){return n[15](n[31])}return{c(){e=w("button"),t=w("span"),t.textContent="Revoke access",s=I(),p(t,"class","txt"),p(e,"type","button"),p(e,"class","btn btn-sm btn-semitransparent btn-danger"),e.disabled=i=n[2].users.length==1||n[5]},m(u,f){k(u,e,f),y(e,t),k(u,s,f),r||(o=[be(l=Oe.call(null,e,n[2].users.length==1?"You can't remove the only project owner":"")),H(e,"click",we(a))],r=!0)},p(u,f){n=u,f[0]&36&&i!==(i=n[2].users.length==1||n[5])&&(e.disabled=i),l&&et(l.update)&&f[0]&4&&l.update.call(null,n[2].users.length==1?"You can't remove the only project owner":"")},d(u){u&&(v(e),v(s)),r=!1,me(o)}}}function eu(n,e){let t,i,l;return i=new Sd({props:{user:e[31],$$slots:{default:[Jb]},$$scope:{ctx:e}}}),{key:n,first:null,c(){t=De(),F(i.$$.fragment),this.first=t},m(s,r){k(s,t,r),q(i,s,r),l=!0},p(s,r){e=s;const o={};r[0]&256&&(o.user=e[31]),r[0]&292|r[1]&128&&(o.$$scope={dirty:r,ctx:e}),i.$set(o)},i(s){l||(E(i.$$.fragment,s),l=!0)},o(s){j(i.$$.fragment,s),l=!1},d(s){s&&v(t),$(i,s)}}}function tu(n){let e;return{c(){e=w("div"),e.innerHTML='<figure class="thumb thumb-circle"></figure> <div class="content"><div class="skeleton-loader"></div></div> ',p(e,"class","list-item")},m(t,i){k(t,e,i)},p:Q,d(t){t&&v(e)}}}function nu(n){let e;return{c(){e=w("div"),p(e,"class","clearfix m-b-sm")},m(t,i){k(t,e,i)},d(t){t&&v(e)}}}function Xb(n){let e;return{c(){e=w("div"),e.innerHTML='<div class="block txt-center"><span class="txt-hint">No users found.</span></div>',p(e,"class","list-item svelte-1tb8gd9")},m(t,i){k(t,e,i)},p:Q,i:Q,o:Q,d(t){t&&v(e)}}}function Qb(n){let e=[],t=new Map,i,l,s=Le(n[6]);const r=o=>o[31].id;for(let o=0;o<s.length;o+=1){let a=Ga(n,s,o),u=r(a);t.set(u,e[o]=iu(u,a))}return{c(){for(let o=0;o<e.length;o+=1)e[o].c();i=De()},m(o,a){for(let u=0;u<e.length;u+=1)e[u]&&e[u].m(o,a);k(o,i,a),l=!0},p(o,a){a[0]&1104&&(s=Le(o[6]),ae(),e=St(e,a,r,1,o,s,t,i.parentNode,At,iu,i,Ga),ue())},i(o){if(!l){for(let a=0;a<s.length;a+=1)E(e[a]);l=!0}},o(o){for(let a=0;a<e.length;a+=1)j(e[a]);l=!1},d(o){o&&v(i);for(let a=0;a<e.length;a+=1)e[a].d(o)}}}function xb(n){let e,t=Le(Array(n[6].length||1)),i=[];for(let l=0;l<t.length;l+=1)i[l]=lu(Ja(n,t,l));return{c(){for(let l=0;l<i.length;l+=1)i[l].c();e=De()},m(l,s){for(let r=0;r<i.length;r+=1)i[r]&&i[r].m(l,s);k(l,e,s)},p(l,s){if(s[0]&64){t=Le(Array(l[6].length||1));let r;for(r=0;r<t.length;r+=1){const o=Ja(l,t,r);i[r]?i[r].p(o,s):(i[r]=lu(),i[r].c(),i[r].m(e.parentNode,e))}for(;r<i.length;r+=1)i[r].d(1);i.length=t.length}},i:Q,o:Q,d(l){l&&v(e),ln(i,l)}}}function e0(n){let e,t,i,l,s;function r(){return n[17](n[31])}return{c(){e=w("button"),t=w("span"),t.textContent="Add",i=I(),p(t,"class","txt"),p(e,"type","button"),p(e,"class","btn btn-sm btn-expanded-sm btn-semitransparent"),e.disabled=n[4]},m(o,a){k(o,e,a),y(e,t),k(o,i,a),l||(s=H(e,"click",we(r)),l=!0)},p(o,a){n=o,a[0]&16&&(e.disabled=n[4])},d(o){o&&(v(e),v(i)),l=!1,s()}}}function iu(n,e){let t,i,l;return i=new Sd({props:{user:e[31],$$slots:{default:[e0]},$$scope:{ctx:e}}}),{key:n,first:null,c(){t=De(),F(i.$$.fragment),this.first=t},m(s,r){k(s,t,r),q(i,s,r),l=!0},p(s,r){e=s;const o={};r[0]&64&&(o.user=e[31]),r[0]&80|r[1]&128&&(o.$$scope={dirty:r,ctx:e}),i.$set(o)},i(s){l||(E(i.$$.fragment,s),l=!0)},o(s){j(i.$$.fragment,s),l=!1},d(s){s&&v(t),$(i,s)}}}function lu(n){let e;return{c(){e=w("div"),e.innerHTML='<figure class="thumb thumb-circle"></figure> <div class="content"><div class="skeleton-loader"></div></div> ',p(e,"class","list-item svelte-1tb8gd9")},m(t,i){k(t,e,i)},p:Q,d(t){t&&v(e)}}}function t0(n){let e,t,i,l,s,r,o,a,u,f,c,d,m,h,_,b;const g=[Gb,Kb],T=[];function L(D,M){return D[9]?0:1}l=L(n),s=T[l]=g[l](n);function O(D){n[16](D)}let C={class:"m-b-0",placeholder:"Search users..."};n[1]!==void 0&&(C.value=n[1]),u=new hd({props:C}),le.push(()=>Ae(u,"value",O));let S=(n[7]||n[1])&&nu();const P=[xb,Qb,Xb],R=[];function A(D,M){return D[7]?0:D[6].length?1:D[1]?2:-1}return~(h=A(n))&&(_=R[h]=P[h](n)),{c(){e=w("h6"),e.textContent="Current owners",t=I(),i=w("div"),s.c(),r=I(),o=w("hr"),a=I(),F(u.$$.fragment),c=I(),S&&S.c(),d=I(),m=w("div"),_&&_.c(),p(e,"class","m-b-sm"),p(i,"class","list list-current-owners"),p(m,"class","list list-suggestions svelte-1tb8gd9")},m(D,M){k(D,e,M),k(D,t,M),k(D,i,M),T[l].m(i,null),k(D,r,M),k(D,o,M),k(D,a,M),q(u,D,M),k(D,c,M),S&&S.m(D,M),k(D,d,M),k(D,m,M),~h&&R[h].m(m,null),b=!0},p(D,M){let Z=l;l=L(D),l===Z?T[l].p(D,M):(ae(),j(T[Z],1,1,()=>{T[Z]=null}),ue(),s=T[l],s?s.p(D,M):(s=T[l]=g[l](D),s.c()),E(s,1),s.m(i,null));const Y={};!f&&M[0]&2&&(f=!0,Y.value=D[1],Ne(()=>f=!1)),u.$set(Y),D[7]||D[1]?S||(S=nu(),S.c(),S.m(d.parentNode,d)):S&&(S.d(1),S=null);let z=h;h=A(D),h===z?~h&&R[h].p(D,M):(_&&(ae(),j(R[z],1,1,()=>{R[z]=null}),ue()),~h?(_=R[h],_?_.p(D,M):(_=R[h]=P[h](D),_.c()),E(_,1),_.m(m,null)):_=null)},i(D){b||(E(s),E(u.$$.fragment,D),E(_),b=!0)},o(D){j(s),j(u.$$.fragment,D),j(_),b=!1},d(D){D&&(v(e),v(t),v(i),v(r),v(o),v(a),v(c),v(d),v(m)),T[l].d(),$(u,D),S&&S.d(D),~h&&R[h].d()}}}function n0(n){let e;return{c(){e=w("h5"),e.textContent="Manage project owners",p(e,"class","block txt-center")},m(t,i){k(t,e,i)},p:Q,d(t){t&&v(e)}}}function i0(n){let e,t,i,l,s;return{c(){e=w("button"),t=w("span"),t.textContent="Close",p(t,"class","txt"),p(e,"type","button"),p(e,"class","btn btn-transparent m-r-auto"),e.disabled=i=n[4]||n[5]},m(r,o){k(r,e,o),y(e,t),l||(s=H(e,"click",n[14]),l=!0)},p(r,o){o[0]&48&&i!==(i=r[4]||r[5])&&(e.disabled=i)},d(r){r&&v(e),l=!1,s()}}}function l0(n){let e,t,i={popup:!0,overlayClose:!n[4],escHide:!n[4],beforeHide:n[18],$$slots:{footer:[i0],header:[n0],default:[t0]},$$scope:{ctx:n}};return e=new mn({props:i}),n[19](e),e.$on("show",n[20]),e.$on("hide",n[21]),{c(){F(e.$$.fragment)},m(l,s){q(e,l,s),t=!0},p(l,s){const r={};s[0]&16&&(r.overlayClose=!l[4]),s[0]&16&&(r.escHide=!l[4]),s[0]&16&&(r.beforeHide=l[18]),s[0]&1014|s[1]&128&&(r.$$scope={dirty:s,ctx:l}),e.$set(r)},i(l){t||(E(e.$$.fragment,l),t=!0)},o(l){j(e.$$.fragment,l),t=!1},d(l){n[19](null),$(e,l)}}}const su="project_owners_list",cs="project_owners_suggestions";function s0(n,e,t){let i,l;ee(n,cn,N=>t(2,i=N)),ee(n,xn,N=>t(22,l=N));const s=it();let r,o="",a=!1,u=!1,f=[],c=!1,d=[],m=!1,h;function _(){return g(),r==null?void 0:r.show()}function b(){return V.cancelRequest(su),V.cancelRequest(cs),clearTimeout(h),r==null?void 0:r.hide()}async function g(){var N;if((N=i==null?void 0:i.users)!=null&&N.length){t(8,d=[]),t(9,m=!0);try{const W=await V.collection("users").getFullList({filter:i.users.map(ne=>`id="${ne}"`).join("||"),requestKey:su});for(let ne of i.users){const X=W.find(U=>U.id==ne);X&&d.push(X)}t(9,m=!1)}catch(W){W.isAbort||(V.error(W),t(9,m=!1))}}}async function T(){var N,W;t(7,c=!0);try{let ne=["username","name","email"].map(U=>`${U}~"${o.replaceAll('"',"")}"`).join("||");(N=i==null?void 0:i.users)!=null&&N.length&&(ne=((W=i==null?void 0:i.users)==null?void 0:W.map(U=>`id!="${U}"`).join("&&"))+` && (${ne})`);const X=await V.collection("users").getList(1,30,{filter:ne,requestKey:cs});t(6,f=X.items),t(7,c=!1)}catch(ne){ne.isAbort||(V.error(ne),t(7,c=!1))}}function L(N){Pt(`Do you really want to add user ${K.getUserDisplayName(N)} to the project owners?`,async()=>O(N))}async function O(N){if(!(a||!(N!=null&&N.id))){t(4,a=!0);try{const W=await V.collection("projects").update(i.id,{"users+":N.id});Xn(W),K.removeByKey(f,"id",N.id),t(6,f),t(1,o),t(13,h),f.length||t(1,o=""),_t(`Successfully added ${K.getUserDisplayName(N)} to the project owners list.`),s("add",N),t(4,a=!1)}catch(W){W.isAbort||(V.error(W),t(4,a=!1))}}}function C(N){let W=`Do you really want to remove the project access of user ${K.getUserDisplayName(N)}?`;l.id==N.id&&(W=`You no longer will have access to the project! 

Do you really want to remove your user from the project owners list?`),Pt(W,async()=>S(N))}async function S(N){if(!(u||!(N!=null&&N.id))){t(5,u=!0);try{const W=await V.collection("projects").update(i.id,{"users-":N.id});Xn(W),l.id==N.id?(_t(`Successfully removed your user from the ${i.title} owners list.`),Yt("/projects")):_t(`Successfully removed ${K.getUserDisplayName(N)} from the ${i.title} owners list.`),s("remove",N),K.removeByKey(d,"id",N.id),t(8,d),o&&T(),t(5,u=!1)}catch(W){W.isAbort||(V.error(W),t(5,u=!1))}}}Gt(()=>{b()});const P=()=>b(),R=N=>C(N);function A(N){o=N,t(1,o)}const D=N=>L(N),M=()=>!a;function Z(N){le[N?"unshift":"push"](()=>{r=N,t(3,r)})}function Y(N){$e.call(this,n,N)}function z(N){$e.call(this,n,N)}return n.$$.update=()=>{n.$$.dirty[0]&8194&&(o?(t(7,c=!0),clearTimeout(h),t(13,h=setTimeout(T,100))):(clearTimeout(h),V.cancelRequest(cs),t(6,f=[]))),n.$$.dirty[0]&4&&(i==null?void 0:i.users)!==-1&&g()},[b,o,i,r,a,u,f,c,d,m,L,C,_,h,P,R,A,D,M,Z,Y,z]}class r0 extends ve{constructor(e){super(),ye(this,e,s0,l0,_e,{show:12,hide:0},null,[-1,-1])}get show(){return this.$$.ctx[12]}get hide(){return this.$$.ctx[0]}}function o0(n){let e,t,i,l,s;return{c(){e=w("i"),p(e,"class",t=n[2]+" "+(n[3]?n[1]:n[0])),p(e,"aria-label","Copy")},m(r,o){k(r,e,o),l||(s=[be(i=Oe.call(null,e,n[3]?"":"Copy")),H(e,"click",Ze(n[4]))],l=!0)},p(r,[o]){o&15&&t!==(t=r[2]+" "+(r[3]?r[1]:r[0]))&&p(e,"class",t),i&&et(i.update)&&o&8&&i.update.call(null,r[3]?"":"Copy")},i:Q,o:Q,d(r){r&&v(e),l=!1,me(s)}}}function a0(n,e,t){let{value:i=""}=e,{idleClasses:l="iconoir-copy link-hint"}=e,{successClasses:s="iconoir-check txt-success"}=e,{successDuration:r=500}=e,{class:o=""}=e,a;function u(){i&&(K.copyToClipboard(i),clearTimeout(a),t(3,a=setTimeout(()=>{clearTimeout(a),t(3,a=null)},r)))}return Gt(()=>{a&&clearTimeout(a)}),n.$$set=f=>{"value"in f&&t(5,i=f.value),"idleClasses"in f&&t(0,l=f.idleClasses),"successClasses"in f&&t(1,s=f.successClasses),"successDuration"in f&&t(6,r=f.successDuration),"class"in f&&t(2,o=f.class)},[l,s,o,a,u,i,r]}class u0 extends ve{constructor(e){super(),ye(this,e,a0,o0,_e,{value:5,idleClasses:0,successClasses:1,successDuration:6,class:2})}}function ru(n){let e,t,i,l,s,r,o;return{c(){e=w("div"),t=w("div"),i=w("div"),l=w("a"),s=te(n[10]),p(l,"href",n[10]),p(l,"target","_blank"),p(l,"rel","noopener noreferrer"),p(i,"class","content txt-center txt-bold"),p(t,"class","alert alert-warning m-0"),p(e,"class","col-12")},m(a,u){k(a,e,u),y(e,t),y(t,i),y(i,l),y(l,s),r||(o=be(Oe.call(null,l,"Open in new tab")),r=!0)},p(a,u){u&1024&&Se(s,a[10]),u&1024&&p(l,"href",a[10])},d(a){a&&v(e),r=!1,o()}}}function f0(n){let e,t,i,l,s,r,o,a;return{c(){e=w("input"),i=I(),l=w("label"),s=te("Allow comments"),p(e,"type","checkbox"),p(e,"id",t=n[29]),p(l,"for",r=n[29])},m(u,f){k(u,e,f),e.checked=n[2].allowComments,k(u,i,f),k(u,l,f),y(l,s),o||(a=H(e,"change",n[16]),o=!0)},p(u,f){f&536870912&&t!==(t=u[29])&&p(e,"id",t),f&4&&(e.checked=u[2].allowComments),f&536870912&&r!==(r=u[29])&&p(l,"for",r)},d(u){u&&(v(e),v(i),v(l)),o=!1,a()}}}function ou(n){let e,t,i,l,s,r,o,a;return{c(){e=w("span"),t=w("span"),t.textContent="Change password",i=I(),l=w("i"),p(t,"class","txt"),p(l,"class",s="iconoir-nav-arrow-"+(n[5]?"up":"down")),p(e,"class",r="inline-flex m-l-10 "+(n[5]?"link-base":"link-hint"))},m(u,f){k(u,e,f),y(e,t),y(e,i),y(e,l),o||(a=H(e,"click",Ze(we(n[18]))),o=!0)},p(u,f){f&32&&s!==(s="iconoir-nav-arrow-"+(u[5]?"up":"down"))&&p(l,"class",s),f&32&&r!==(r="inline-flex m-l-10 "+(u[5]?"link-base":"link-hint"))&&p(e,"class",r)},d(u){u&&v(e),o=!1,a()}}}function c0(n){let e,t,i,l,s,r,o,a,u,f=n[2].passwordProtect&&n[8]&&ou(n);return{c(){e=w("input"),i=I(),l=w("label"),s=w("div"),s.textContent="Protect with password",r=I(),f&&f.c(),p(e,"type","checkbox"),p(e,"id",t=n[29]),p(s,"class","txt"),p(l,"for",o=n[29])},m(c,d){k(c,e,d),e.checked=n[2].passwordProtect,k(c,i,d),k(c,l,d),y(l,s),y(l,r),f&&f.m(l,null),a||(u=H(e,"change",n[17]),a=!0)},p(c,d){d&536870912&&t!==(t=c[29])&&p(e,"id",t),d&4&&(e.checked=c[2].passwordProtect),c[2].passwordProtect&&c[8]?f?f.p(c,d):(f=ou(c),f.c(),f.m(l,null)):f&&(f.d(1),f=null),d&536870912&&o!==(o=c[29])&&p(l,"for",o)},d(c){c&&(v(e),v(i),v(l)),f&&f.d(),a=!1,u()}}}function au(n){let e,t,i,l;return t=new Ce({props:{class:"form-field form-field-toggle p-t-xs",name:"password",$$slots:{default:[d0,({uniqueId:s})=>({29:s}),({uniqueId:s})=>s?536870912:0]},$$scope:{ctx:n}}}),{c(){e=w("div"),F(t.$$.fragment),p(e,"class","block")},m(s,r){k(s,e,r),q(t,e,null),l=!0},p(s,r){const o={};r&1610612800&&(o.$$scope={dirty:r,ctx:s}),t.$set(o)},i(s){l||(E(t.$$.fragment,s),s&&kt(()=>{l&&(i||(i=ct(e,Et,{duration:150},!0)),i.run(1))}),l=!0)},o(s){j(t.$$.fragment,s),s&&(i||(i=ct(e,Et,{duration:150},!1)),i.run(0)),l=!1},d(s){s&&v(e),$(t),s&&i&&i.end()}}}function d0(n){let e,t,i,l;return{c(){e=w("input"),p(e,"type","password"),p(e,"id",t=n[29]),p(e,"placeholder","Password"),p(e,"minlength","5"),e.required=!0},m(s,r){k(s,e,r),ge(e,n[6]),i||(l=H(e,"input",n[19]),i=!0)},p(s,r){r&536870912&&t!==(t=s[29])&&p(e,"id",t),r&64&&e.value!==s[6]&&ge(e,s[6])},d(s){s&&v(e),i=!1,l()}}}function p0(n){let e,t,i,l,s,r,o,a,u,f;return{c(){var c;e=w("input"),s=I(),r=w("label"),o=te("Restrict access to prototypes"),p(e,"type","checkbox"),p(e,"id",t=n[29]),e.checked=i=((c=n[2].onlyPrototypes)==null?void 0:c.length)>0,e.disabled=l=!n[9].length,p(r,"for",a=n[29])},m(c,d){k(c,e,d),k(c,s,d),k(c,r,d),y(r,o),u||(f=H(e,"change",n[20]),u=!0)},p(c,d){var m;d&536870912&&t!==(t=c[29])&&p(e,"id",t),d&4&&i!==(i=((m=c[2].onlyPrototypes)==null?void 0:m.length)>0)&&(e.checked=i),d&512&&l!==(l=!c[9].length)&&(e.disabled=l),d&536870912&&a!==(a=c[29])&&p(r,"for",a)},d(c){c&&(v(e),v(s),v(r)),u=!1,f()}}}function uu(n){let e,t,i,l;return t=new Ce({props:{class:"form-field link-prototypes-dropdown p-t-xs",$$slots:{default:[m0]},$$scope:{ctx:n}}}),{c(){e=w("div"),F(t.$$.fragment),p(e,"class","block")},m(s,r){k(s,e,r),q(t,e,null),l=!0},p(s,r){const o={};r&1073742340&&(o.$$scope={dirty:r,ctx:s}),t.$set(o)},i(s){l||(E(t.$$.fragment,s),s&&kt(()=>{l&&(i||(i=ct(e,Et,{duration:150},!0)),i.run(1))}),l=!0)},o(s){j(t.$$.fragment,s),s&&(i||(i=ct(e,Et,{duration:150},!1)),i.run(0)),l=!1},d(s){s&&v(e),$(t),s&&i&&i.end()}}}function m0(n){let e,t,i;function l(r){n[21](r)}let s={items:n[9],closable:!1,multiple:!0,upside:!0,selectPlaceholder:"Select prototypes"};return n[2].onlyPrototypes!==void 0&&(s.keyOfSelected=n[2].onlyPrototypes),e=new pn({props:s}),le.push(()=>Ae(e,"keyOfSelected",l)),{c(){F(e.$$.fragment)},m(r,o){q(e,r,o),i=!0},p(r,o){const a={};o&512&&(a.items=r[9]),!t&&o&4&&(t=!0,a.keyOfSelected=r[2].onlyPrototypes,Ne(()=>t=!1)),e.$set(a)},i(r){i||(E(e.$$.fragment,r),i=!0)},o(r){j(e.$$.fragment,r),i=!1},d(r){$(e,r)}}}function h0(n){let e,t,i,l,s,r,o,a,u,f,c,d,m,h,_=n[2].id&&ru(n);i=new Ce({props:{class:"form-field form-field-toggle",name:"allowComments",$$slots:{default:[f0,({uniqueId:T})=>({29:T}),({uniqueId:T})=>T?536870912:0]},$$scope:{ctx:n}}}),r=new Ce({props:{class:"form-field form-field-toggle",name:"passwordProtect",$$slots:{default:[c0,({uniqueId:T})=>({29:T}),({uniqueId:T})=>T?536870912:0]},$$scope:{ctx:n}}});let b=n[2].passwordProtect&&n[5]&&au(n);f=new Ce({props:{class:"form-field form-field-toggle",$$slots:{default:[p0,({uniqueId:T})=>({29:T}),({uniqueId:T})=>T?536870912:0]},$$scope:{ctx:n}}});let g=n[4]&&uu(n);return{c(){e=w("form"),_&&_.c(),t=I(),F(i.$$.fragment),l=I(),s=w("div"),F(r.$$.fragment),o=I(),b&&b.c(),a=I(),u=w("div"),F(f.$$.fragment),c=I(),g&&g.c(),p(s,"class","col-12"),p(u,"class","col-12"),p(e,"id",n[11]),p(e,"class","grid")},m(T,L){k(T,e,L),_&&_.m(e,null),y(e,t),q(i,e,null),y(e,l),y(e,s),q(r,s,null),y(s,o),b&&b.m(s,null),y(e,a),y(e,u),q(f,u,null),y(u,c),g&&g.m(u,null),d=!0,m||(h=H(e,"submit",we(n[12])),m=!0)},p(T,L){T[2].id?_?_.p(T,L):(_=ru(T),_.c(),_.m(e,t)):_&&(_.d(1),_=null);const O={};L&1610612740&&(O.$$scope={dirty:L,ctx:T}),i.$set(O);const C={};L&1610613028&&(C.$$scope={dirty:L,ctx:T}),r.$set(C),T[2].passwordProtect&&T[5]?b?(b.p(T,L),L&36&&E(b,1)):(b=au(T),b.c(),E(b,1),b.m(s,null)):b&&(ae(),j(b,1,1,()=>{b=null}),ue());const S={};L&1610613268&&(S.$$scope={dirty:L,ctx:T}),f.$set(S),T[4]?g?(g.p(T,L),L&16&&E(g,1)):(g=uu(T),g.c(),E(g,1),g.m(u,null)):g&&(ae(),j(g,1,1,()=>{g=null}),ue())},i(T){d||(E(i.$$.fragment,T),E(r.$$.fragment,T),E(b),E(f.$$.fragment,T),E(g),d=!0)},o(T){j(i.$$.fragment,T),j(r.$$.fragment,T),j(b),j(f.$$.fragment,T),j(g),d=!1},d(T){T&&v(e),_&&_.d(),$(i),$(r),b&&b.d(),$(f),g&&g.d(),m=!1,h()}}}function _0(n){let e,t,i,l,s=n[2].id?"Update link":"Create link",r,o,a,u,f;return{c(){e=w("div"),t=w("button"),t.innerHTML='<i class="iconoir-arrow-left"></i>',i=I(),l=w("h5"),r=te(s),o=I(),a=w("div"),a.textContent=" ",p(t,"type","button"),p(t,"class","btn btn-circle btn-sm btn-transparent btn-hint"),p(e,"class","flex-fill"),p(l,"class","title"),p(a,"class","flex-fill")},m(c,d){k(c,e,d),y(e,t),k(c,i,d),k(c,l,d),y(l,r),k(c,o,d),k(c,a,d),u||(f=[be(Oe.call(null,t,{position:"right",text:"Back"})),H(t,"click",n[1])],u=!0)},p(c,d){d&4&&s!==(s=c[2].id?"Update link":"Create link")&&Se(r,s)},d(c){c&&(v(e),v(i),v(l),v(o),v(a)),u=!1,me(f)}}}function g0(n){let e,t,i,l,s=n[2].id?"Update":"Create",r,o,a,u;return{c(){e=w("button"),e.innerHTML='<span class="txt">Back</span>',t=I(),i=w("button"),l=w("span"),r=te(s),o=te(" link"),p(e,"type","button"),p(e,"class","btn btn-transparent m-r-auto"),p(l,"class","txt"),p(i,"type","submit"),p(i,"form",n[11]),p(i,"class","btn btn-expanded btn-primary"),i.disabled=n[7],B(i,"btn-loading",n[7])},m(f,c){k(f,e,c),k(f,t,c),k(f,i,c),y(i,l),y(l,r),y(l,o),a||(u=H(e,"click",n[1]),a=!0)},p(f,c){c&4&&s!==(s=f[2].id?"Update":"Create")&&Se(r,s),c&128&&(i.disabled=f[7]),c&128&&B(i,"btn-loading",f[7])},d(f){f&&(v(e),v(t),v(i)),a=!1,u()}}}function b0(n){let e,t,i;const l=[{popup:!0},{beforeHide:n[22]},n[13]];function s(o){n[24](o)}let r={$$slots:{footer:[g0],header:[_0],default:[h0]},$$scope:{ctx:n}};for(let o=0;o<l.length;o+=1)r=Ue(r,l[o]);return n[0]!==void 0&&(r.active=n[0]),e=new mn({props:r}),n[23](e),le.push(()=>Ae(e,"active",s)),e.$on("show",n[25]),e.$on("hide",n[26]),{c(){F(e.$$.fragment)},m(o,a){q(e,o,a),i=!0},p(o,[a]){const u=a&8320?gt(l,[l[0],a&128&&{beforeHide:o[22]},a&8192&&Nt(o[13])]):{};a&1073743860&&(u.$$scope={dirty:a,ctx:o}),!t&&a&1&&(t=!0,u.active=o[0],Ne(()=>t=!1)),e.$set(u)},i(o){i||(E(e.$$.fragment,o),i=!0)},o(o){j(e.$$.fragment,o),i=!1},d(o){n[23](null),$(e,o)}}}function w0(n,e,t){let i,l;const s=["active","show","hide"];let r=ft(e,s),o;ee(n,Ft,ne=>t(15,o=ne));const a=it(),u="link_upsert_"+K.randomString(5);let{active:f=!1}=e,c,d={},m=!1,h=!1,_="",b=!1,g=!1;function T(ne){return t(2,d=structuredClone(ne)),O(),c==null?void 0:c.show()}function L(){return c==null?void 0:c.hide()}function O(){var ne;Jt({}),t(4,m=((ne=d.onlyPrototypes)==null?void 0:ne.length)>0),t(8,g=!!d.passwordProtect),t(5,h=!d.id||!g),t(6,_=""),t(7,b=!1)}async function C(){t(7,b=!0);try{const ne=!d.id,X={project:d.project,allowComments:d.allowComments,onlyPrototypes:m?d.onlyPrototypes:[],passwordProtect:d.passwordProtect};ne&&!X.passwordProtect?(X.password="pb123456",X.passwordConfirm=X.password):X.passwordProtect&&h&&(X.password=_,X.passwordConfirm=X.password),ne?(t(2,d=await V.collection("links").create(X)),_t("Successfully created new project link.")):(t(2,d=await V.collection("links").update(d.id,X)),_t("Successfully updated project link.")),t(7,b=!1),L(),a("save",d)}catch(ne){t(7,b=!1),ne.isAbort||V.error(ne)}}function S(){d.allowComments=this.checked,t(2,d)}function P(){d.passwordProtect=this.checked,t(2,d)}const R=()=>t(5,h=!h);function A(){_=this.value,t(6,_)}const D=ne=>{t(4,m=ne.target.checked)};function M(ne){n.$$.not_equal(d.onlyPrototypes,ne)&&(d.onlyPrototypes=ne,t(2,d))}const Z=()=>!b;function Y(ne){le[ne?"unshift":"push"](()=>{c=ne,t(3,c)})}function z(ne){f=ne,t(0,f)}function N(ne){$e.call(this,n,ne)}function W(ne){$e.call(this,n,ne)}return n.$$set=ne=>{e=Ue(Ue({},e),Kt(ne)),t(13,r=ft(e,s)),"active"in ne&&t(0,f=ne.active)},n.$$.update=()=>{n.$$.dirty&4&&t(10,i=K.getProjectLinkURL(d)),n.$$.dirty&32768&&t(9,l=o.map(ne=>({value:ne.id,label:ne.title}))||[])},[f,L,d,c,m,h,_,b,g,l,i,u,C,r,T,o,S,P,R,A,D,M,Z,Y,z,N,W]}class y0 extends ve{constructor(e){super(),ye(this,e,w0,b0,_e,{active:0,show:14,hide:1})}get show(){return this.$$.ctx[14]}get hide(){return this.$$.ctx[1]}}function v0(n){let e,t,i,l,s=[{type:t=n[5].type||"text"},{value:n[4]},{disabled:n[3]},{readOnly:n[2]},n[5]],r={};for(let o=0;o<s.length;o+=1)r=Ue(r,s[o]);return{c(){e=w("input"),Kn(e,r)},m(o,a){k(o,e,a),"value"in r&&(e.value=r.value),e.autofocus&&e.focus(),i||(l=H(e,"input",n[6]),i=!0)},p(o,[a]){Kn(e,r=gt(s,[a&32&&t!==(t=o[5].type||"text")&&{type:t},a&16&&e.value!==o[4]&&{value:o[4]},a&8&&{disabled:o[3]},a&4&&{readOnly:o[2]},a&32&&o[5]])),"value"in r&&(e.value=r.value)},i:Q,o:Q,d(o){o&&v(e),i=!1,l()}}}function k0(n,e,t){let i;const l=["value","separator","readonly","disabled"];let s=ft(e,l),{value:r=[]}=e,{separator:o=","}=e,{readonly:a=null}=e,{disabled:u=null}=e;const f=c=>{t(0,r=K.splitNonEmpty(c.target.value,o))};return n.$$set=c=>{e=Ue(Ue({},e),Kt(c)),t(5,s=ft(e,l)),"value"in c&&t(0,r=c.value),"separator"in c&&t(1,o=c.separator),"readonly"in c&&t(2,a=c.readonly),"disabled"in c&&t(3,u=c.disabled)},n.$$.update=()=>{n.$$.dirty&3&&t(4,i=K.joinNonEmpty(r,o+" "))},[r,o,a,u,i,s,f]}class S0 extends ve{constructor(e){super(),ye(this,e,k0,v0,_e,{value:0,separator:1,readonly:2,disabled:3})}}function fu(n){let e,t,i,l,s,r,o;return{c(){e=w("div"),t=w("div"),i=w("div"),l=w("a"),s=te(n[7]),p(l,"href",n[7]),p(l,"target","_blank"),p(l,"rel","noopener noreferrer"),p(i,"class","content txt-center txt-bold"),p(t,"class","alert alert-warning m-0"),p(e,"class","col-12")},m(a,u){k(a,e,u),y(e,t),y(t,i),y(i,l),y(l,s),r||(o=be(Oe.call(null,l,"Open in new tab")),r=!0)},p(a,u){u&128&&Se(s,a[7]),u&128&&p(l,"href",a[7])},d(a){a&&v(e),r=!1,o()}}}function T0(n){let e,t,i,l,s,r,o,a,u;function f(d){n[12](d)}let c={id:n[21],required:!0,autofocus:!0};return n[4]!==void 0&&(c.value=n[4]),s=new S0({props:c}),le.push(()=>Ae(s,"value",f)),{c(){e=w("label"),t=te("Email(s)"),l=I(),F(s.$$.fragment),o=I(),a=w("div"),a.textContent="Separate multiple emails with comma.",p(e,"for",i=n[21]),p(a,"class","help-block")},m(d,m){k(d,e,m),y(e,t),k(d,l,m),q(s,d,m),k(d,o,m),k(d,a,m),u=!0},p(d,m){(!u||m&2097152&&i!==(i=d[21]))&&p(e,"for",i);const h={};m&2097152&&(h.id=d[21]),!r&&m&16&&(r=!0,h.value=d[4],Ne(()=>r=!1)),s.$set(h)},i(d){u||(E(s.$$.fragment,d),u=!0)},o(d){j(s.$$.fragment,d),u=!1},d(d){d&&(v(e),v(l),v(o),v(a)),$(s,d)}}}function O0(n){let e,t,i,l,s,r,o,a,u;return{c(){e=w("label"),t=te("Additional message"),l=I(),s=w("textarea"),p(e,"for",i=n[21]),p(s,"id",r=n[21]),p(s,"rows","3"),p(s,"placeholder",o=n[2].passwordProtected?"eg. The password is...":"")},m(f,c){k(f,e,c),y(e,t),k(f,l,c),k(f,s,c),ge(s,n[5]),a||(u=H(s,"input",n[13]),a=!0)},p(f,c){c&2097152&&i!==(i=f[21])&&p(e,"for",i),c&2097152&&r!==(r=f[21])&&p(s,"id",r),c&4&&o!==(o=f[2].passwordProtected?"eg. The password is...":"")&&p(s,"placeholder",o),c&32&&ge(s,f[5])},d(f){f&&(v(e),v(l),v(s)),a=!1,u()}}}function C0(n){let e,t,i,l,s,r,o,a,u=n[2].id&&fu(n);return i=new Ce({props:{class:"form-field required",name:"emails",$$slots:{default:[T0,({uniqueId:f})=>({21:f}),({uniqueId:f})=>f?2097152:0]},$$scope:{ctx:n}}}),s=new Ce({props:{class:"form-field",name:"message",$$slots:{default:[O0,({uniqueId:f})=>({21:f}),({uniqueId:f})=>f?2097152:0]},$$scope:{ctx:n}}}),{c(){e=w("form"),u&&u.c(),t=I(),F(i.$$.fragment),l=I(),F(s.$$.fragment),p(e,"id",n[8]),p(e,"class","grid grid-sm")},m(f,c){k(f,e,c),u&&u.m(e,null),y(e,t),q(i,e,null),y(e,l),q(s,e,null),r=!0,o||(a=H(e,"submit",we(n[9])),o=!0)},p(f,c){f[2].id?u?u.p(f,c):(u=fu(f),u.c(),u.m(e,t)):u&&(u.d(1),u=null);const d={};c&6291472&&(d.$$scope={dirty:c,ctx:f}),i.$set(d);const m={};c&6291492&&(m.$$scope={dirty:c,ctx:f}),s.$set(m)},i(f){r||(E(i.$$.fragment,f),E(s.$$.fragment,f),r=!0)},o(f){j(i.$$.fragment,f),j(s.$$.fragment,f),r=!1},d(f){f&&v(e),u&&u.d(),$(i),$(s),o=!1,a()}}}function E0(n){let e,t,i,l,s,r,o,a;return{c(){e=w("div"),t=w("button"),t.innerHTML='<i class="iconoir-arrow-left"></i>',i=I(),l=w("h5"),l.textContent="Share project link",s=I(),r=w("div"),r.textContent=" ",p(t,"type","button"),p(t,"class","btn btn-circle btn-sm btn-transparent btn-hint"),p(e,"class","flex-fill"),p(l,"class","title"),p(r,"class","flex-fill")},m(u,f){k(u,e,f),y(e,t),k(u,i,f),k(u,l,f),k(u,s,f),k(u,r,f),o||(a=[be(Oe.call(null,t,{position:"right",text:"Back"})),H(t,"click",n[1])],o=!0)},p:Q,d(u){u&&(v(e),v(i),v(l),v(s),v(r)),o=!1,me(a)}}}function L0(n){let e,t,i,l,s,r,o,a,u;return{c(){e=w("button"),t=w("span"),t.textContent="Back",i=I(),l=w("button"),s=w("i"),r=I(),o=w("span"),o.textContent="Send",p(t,"class","txt"),p(e,"type","button"),p(e,"class","btn btn-transparent m-r-auto"),p(e,"disable",n[6]),p(s,"class","iconoir-send-mail"),p(o,"class","txt"),p(l,"type","submit"),p(l,"form",n[8]),p(l,"class","btn btn-expanded-sm btn-primary"),l.disabled=n[6],B(l,"btn-loading",n[6])},m(f,c){k(f,e,c),y(e,t),k(f,i,c),k(f,l,c),y(l,s),y(l,r),y(l,o),a||(u=H(e,"click",n[1]),a=!0)},p(f,c){c&64&&p(e,"disable",f[6]),c&64&&(l.disabled=f[6]),c&64&&B(l,"btn-loading",f[6])},d(f){f&&(v(e),v(i),v(l)),a=!1,u()}}}function I0(n){let e,t,i;const l=[{popup:!0},{beforeHide:n[14]},n[10]];function s(o){n[16](o)}let r={$$slots:{footer:[L0],header:[E0],default:[C0]},$$scope:{ctx:n}};for(let o=0;o<l.length;o+=1)r=Ue(r,l[o]);return n[0]!==void 0&&(r.active=n[0]),e=new mn({props:r}),n[15](e),le.push(()=>Ae(e,"active",s)),e.$on("show",n[17]),e.$on("hide",n[18]),{c(){F(e.$$.fragment)},m(o,a){q(e,o,a),i=!0},p(o,[a]){const u=a&1088?gt(l,[l[0],a&64&&{beforeHide:o[14]},a&1024&&Nt(o[10])]):{};a&4194548&&(u.$$scope={dirty:a,ctx:o}),!t&&a&1&&(t=!0,u.active=o[0],Ne(()=>t=!1)),e.$set(u)},i(o){i||(E(e.$$.fragment,o),i=!0)},o(o){j(e.$$.fragment,o),i=!1},d(o){n[15](null),$(e,o)}}}function j0(n,e,t){let i;const l=["active","show","hide"];let s=ft(e,l);const r=it(),o="share_"+K.randomString(5);let{active:a=!1}=e,u,f={},c=[],d="",m=!1;function h(A=null){return b(),t(2,f=A?structuredClone(A):{}),u==null?void 0:u.show()}function _(){return u==null?void 0:u.hide()}function b(){Jt({}),t(6,m=!1),t(4,c=[]),t(5,d="")}async function g(){t(6,m=!0);try{await V.send("/api/pr/share/"+encodeURIComponent(f.id),{method:"POST",body:{emails:c,message:d}}),t(6,m=!1),_(),r("submit"),_t("Successfully shared the project link!")}catch(A){A.isAbort||(t(6,m=!1),V.error(A))}}function T(A){c=A,t(4,c)}function L(){d=this.value,t(5,d)}const O=()=>!m;function C(A){le[A?"unshift":"push"](()=>{u=A,t(3,u)})}function S(A){a=A,t(0,a)}function P(A){$e.call(this,n,A)}function R(A){$e.call(this,n,A)}return n.$$set=A=>{e=Ue(Ue({},e),Kt(A)),t(10,s=ft(e,l)),"active"in A&&t(0,a=A.active)},n.$$.update=()=>{n.$$.dirty&4&&t(7,i=K.getProjectLinkURL(f))},[a,_,f,u,c,d,m,i,o,g,s,h,T,L,O,C,S,P,R]}class P0 extends ve{constructor(e){super(),ye(this,e,j0,I0,_e,{active:0,show:11,hide:1})}get show(){return this.$$.ctx[11]}get hide(){return this.$$.ctx[1]}}function cu(n,e,t){const i=n.slice();i[29]=e[t];const l=K.getProjectLinkURL(i[29]);return i[30]=l,i}function N0(n){let e=[],t=new Map,i,l,s=Le(n[7]);const r=a=>a[29].id;for(let a=0;a<s.length;a+=1){let u=cu(n,s,a),f=r(u);t.set(f,e[a]=pu(f,u))}let o=null;return s.length||(o=du()),{c(){for(let a=0;a<e.length;a+=1)e[a].c();i=De(),o&&o.c()},m(a,u){for(let f=0;f<e.length;f+=1)e[f]&&e[f].m(a,u);k(a,i,u),o&&o.m(a,u),l=!0},p(a,u){u[0]&2272&&(s=Le(a[7]),ae(),e=St(e,u,r,1,a,s,t,i.parentNode,At,pu,i,cu),ue(),!s.length&&o?o.p(a,u):s.length?o&&(o.d(1),o=null):(o=du(),o.c(),o.m(i.parentNode,i)))},i(a){if(!l){for(let u=0;u<s.length;u+=1)E(e[u]);l=!0}},o(a){for(let u=0;u<e.length;u+=1)j(e[u]);l=!1},d(a){a&&v(i);for(let u=0;u<e.length;u+=1)e[u].d(a);o&&o.d(a)}}}function A0(n){let e;return{c(){e=w("div"),e.innerHTML='<div class="skeleton-loader"></div>',p(e,"class","project-link m-t-10 m-b-10")},m(t,i){k(t,e,i)},p:Q,i:Q,o:Q,d(t){t&&v(e)}}}function du(n){let e;return{c(){e=w("div"),e.textContent=`Create project links that you can send to your clients and teammates for feedback.
                `,p(e,"class","block txt-center txt-hint")},m(t,i){k(t,e,i)},p:Q,d(t){t&&v(e)}}}function pu(n,e){let t,i,l,s=e[30]+"",r,o,a,u,f,c,d,m,h,_,b,g,T,L,O,C,S,P,R,A,D,M,Z,Y,z,N,W,ne;u=new u0({props:{class:"m-l-5",value:e[30]}});function X(){return e[14](e[29])}function U(){return e[15](e[29])}function de(){return e[16](e[29])}return{key:n,first:null,c(){var re;t=w("div"),i=w("div"),l=w("a"),r=te(s),a=I(),F(u.$$.fragment),f=I(),c=w("div"),d=w("span"),m=te("Comments"),_=I(),b=w("span"),g=te("Password"),L=I(),O=w("span"),C=te("Restricted"),P=I(),R=w("nav"),A=w("button"),A.innerHTML='<i class="iconoir-share-android"></i>',D=I(),M=w("button"),M.innerHTML='<i class="iconoir-settings"></i>',Z=I(),Y=w("button"),Y.innerHTML='<i class="iconoir-trash"></i>',z=I(),p(l,"href",o=e[30]),p(l,"target","_blank"),p(l,"rel","noopener noreferrer"),p(l,"class","url"),p(d,"class",h="meta-item label-sm label label-"+(e[29].allowComments?"success":"disabled")),p(b,"class",T="meta-item label-sm label label-"+(e[29].passwordProtect?"success":"disabled")),p(O,"class",S="meta-item label-sm label label-"+((re=e[29].onlyPrototypes)!=null&&re.length?"success":"disabled")),p(c,"class","meta"),p(i,"class","content"),p(A,"type","button"),p(A,"class","ctrl-item btn btn-sm btn-circle btn-transparent btn-hint"),p(M,"type","button"),p(M,"class","ctrl-item btn btn-sm btn-circle btn-transparent btn-hint"),p(Y,"type","button"),p(Y,"class","ctrl-item btn btn-sm btn-circle btn-transparent btn-hint"),p(R,"class","ctrls"),p(t,"class","project-link"),this.first=t},m(re,pe){k(re,t,pe),y(t,i),y(i,l),y(l,r),y(i,a),q(u,i,null),y(i,f),y(i,c),y(c,d),y(d,m),y(c,_),y(c,b),y(b,g),y(c,L),y(c,O),y(O,C),y(t,P),y(t,R),y(R,A),y(R,D),y(R,M),y(R,Z),y(R,Y),y(t,z),N=!0,W||(ne=[be(Oe.call(null,l,{position:"top",text:"Open in new tab"})),be(Oe.call(null,A,"Share")),H(A,"click",X),be(Oe.call(null,M,"Settings")),H(M,"click",U),be(Oe.call(null,Y,"Delete")),H(Y,"click",de)],W=!0)},p(re,pe){var tt;e=re,(!N||pe[0]&128)&&s!==(s=e[30]+"")&&Se(r,s),(!N||pe[0]&128&&o!==(o=e[30]))&&p(l,"href",o);const Ee={};pe[0]&128&&(Ee.value=e[30]),u.$set(Ee),(!N||pe[0]&128&&h!==(h="meta-item label-sm label label-"+(e[29].allowComments?"success":"disabled")))&&p(d,"class",h),(!N||pe[0]&128&&T!==(T="meta-item label-sm label label-"+(e[29].passwordProtect?"success":"disabled")))&&p(b,"class",T),(!N||pe[0]&128&&S!==(S="meta-item label-sm label label-"+((tt=e[29].onlyPrototypes)!=null&&tt.length?"success":"disabled")))&&p(O,"class",S)},i(re){N||(E(u.$$.fragment,re),N=!0)},o(re){j(u.$$.fragment,re),N=!1},d(re){re&&v(t),$(u),W=!1,me(ne)}}}function D0(n){let e,t,i,l;const s=[A0,N0],r=[];function o(a,u){return a[8]?0:1}return t=o(n),i=r[t]=s[t](n),{c(){e=w("div"),i.c(),p(e,"class","project-links-list")},m(a,u){k(a,e,u),r[t].m(e,null),l=!0},p(a,u){let f=t;t=o(a),t===f?r[t].p(a,u):(ae(),j(r[f],1,1,()=>{r[f]=null}),ue(),i=r[t],i?i.p(a,u):(i=r[t]=s[t](a),i.c()),E(i,1),i.m(e,null))},i(a){l||(E(i),l=!0)},o(a){j(i),l=!1},d(a){a&&v(e),r[t].d()}}}function M0(n){let e;return{c(){e=w("h5"),e.textContent="Project links",p(e,"class","block txt-center")},m(t,i){k(t,e,i)},p:Q,d(t){t&&v(e)}}}function R0(n){let e,t,i,l,s,r,o,a;return{c(){e=w("button"),e.innerHTML='<span class="txt">Close</span>',t=I(),i=w("button"),l=w("i"),s=I(),r=w("span"),r.textContent="New link",p(e,"type","button"),p(e,"class","btn btn-transparent m-r-auto"),p(l,"class","iconoir-plus"),p(r,"class","txt"),p(i,"type","button"),p(i,"class","btn btn-expanded btn-primary"),i.disabled=n[8]},m(u,f){k(u,e,f),k(u,t,f),k(u,i,f),y(i,l),y(i,s),y(i,r),o||(a=[H(e,"click",n[13]),H(i,"click",function(){var c,d;et((c=n[6])==null?void 0:c.show({project:n[10].id,allowComments:!0}))&&((d=n[6])==null||d.show({project:n[10].id,allowComments:!0}).apply(this,arguments))})],o=!0)},p(u,f){n=u,f[0]&256&&(i.disabled=n[8])},d(u){u&&(v(e),v(t),v(i)),o=!1,me(a)}}}function H0(n){let e,t,i,l,s,r,o,a,u;function f(b){n[18](b)}let c={popup:!0,class:n[9]?"temp-hide":"",$$slots:{footer:[R0],header:[M0],default:[D0]},$$scope:{ctx:n}};n[0]!==void 0&&(c.active=n[0]),e=new mn({props:c}),n[17](e),le.push(()=>Ae(e,"active",f)),e.$on("show",n[19]),e.$on("hide",n[20]);function d(b){n[22](b)}let m={};n[2]!==void 0&&(m.active=n[2]),l=new y0({props:m}),n[21](l),le.push(()=>Ae(l,"active",d)),l.$on("save",n[23]);function h(b){n[25](b)}let _={};return n[3]!==void 0&&(_.active=n[3]),o=new P0({props:_}),n[24](o),le.push(()=>Ae(o,"active",h)),{c(){F(e.$$.fragment),i=I(),F(l.$$.fragment),r=I(),F(o.$$.fragment)},m(b,g){q(e,b,g),k(b,i,g),q(l,b,g),k(b,r,g),q(o,b,g),u=!0},p(b,g){const T={};g[0]&512&&(T.class=b[9]?"temp-hide":""),g[0]&1504|g[1]&4&&(T.$$scope={dirty:g,ctx:b}),!t&&g[0]&1&&(t=!0,T.active=b[0],Ne(()=>t=!1)),e.$set(T);const L={};!s&&g[0]&4&&(s=!0,L.active=b[2],Ne(()=>s=!1)),l.$set(L);const O={};!a&&g[0]&8&&(a=!0,O.active=b[3],Ne(()=>a=!1)),o.$set(O)},i(b){u||(E(e.$$.fragment,b),E(l.$$.fragment,b),E(o.$$.fragment,b),u=!0)},o(b){j(e.$$.fragment,b),j(l.$$.fragment,b),j(o.$$.fragment,b),u=!1},d(b){b&&(v(i),v(r)),n[17](null),$(e,b),n[21](null),$(l,b),n[24](null),$(o,b)}}}const mu="list_links";function U0(n,e,t){let i;ee(n,cn,W=>t(10,i=W));const l=it();let{active:s=!1}=e,r,o,a,u=!1,f=!1,c=[],d=!1,m=!1;function h(){return b(),r==null?void 0:r.show()}function _(){return V.cancelRequest(mu),r==null?void 0:r.hide()}async function b(){t(8,d=!0);try{t(7,c=await V.collection("links").getFullList({filter:`project='${i==null?void 0:i.id}'`,requestKey:mu}))}catch(W){W.isAbort||V.error(W)}t(8,d=!1)}function g(W){Pt("Do you really want to delete the selected project link?",()=>T(W))}async function T(W){if(W!=null&&W.id)try{await V.collection("links").delete(W.id),K.removeByKey(c,"id",W.id),t(7,c),_t("Successfully deleted project link."),l("delete",W)}catch(ne){ne.isAbort||V.error(ne)}}Gt(()=>{_()});const L=()=>_(),O=W=>o==null?void 0:o.show(W),C=W=>a==null?void 0:a.show(W),S=W=>g(W);function P(W){le[W?"unshift":"push"](()=>{r=W,t(4,r)})}function R(W){s=W,t(0,s)}function A(W){$e.call(this,n,W)}function D(W){$e.call(this,n,W)}function M(W){le[W?"unshift":"push"](()=>{a=W,t(6,a)})}function Z(W){u=W,t(2,u)}const Y=W=>{K.pushOrReplaceObject(c,W.detail),t(7,c)};function z(W){le[W?"unshift":"push"](()=>{o=W,t(5,o)})}function N(W){f=W,t(3,f)}return n.$$set=W=>{"active"in W&&t(0,s=W.active)},n.$$.update=()=>{n.$$.dirty[0]&12&&t(9,m=u||f)},[s,_,u,f,r,o,a,c,d,m,i,g,h,L,O,C,S,P,R,A,D,M,Z,Y,z,N]}class q0 extends ve{constructor(e){super(),ye(this,e,U0,H0,_e,{active:0,show:12,hide:1},null,[-1,-1])}get show(){return this.$$.ctx[12]}get hide(){return this.$$.ctx[1]}}function hu(n){let e;return{c(){e=w("div"),e.innerHTML='<span class="loader loader-lg"></span>',p(e,"class","block txt-center")},m(t,i){k(t,e,i)},d(t){t&&v(e)}}}function $0(n){let e,t,i,l,s,r,o=n[7]&&hu();return i=new _b({props:{projectId:n[0].projectId,initialPrototypeId:n[6]}}),s=new Bb({}),{c(){var a;o&&o.c(),e=I(),t=w("div"),F(i.$$.fragment),l=I(),F(s.$$.fragment),p(t,"class","screens-list-wrapper svelte-1y0govx"),B(t,"hidden",n[7]||!((a=n[2])!=null&&a.id))},m(a,u){o&&o.m(a,u),k(a,e,u),k(a,t,u),q(i,t,null),y(t,l),q(s,t,null),r=!0},p(a,u){var c;a[7]?o||(o=hu(),o.c(),o.m(e.parentNode,e)):o&&(o.d(1),o=null);const f={};u&1&&(f.projectId=a[0].projectId),u&64&&(f.initialPrototypeId=a[6]),i.$set(f),(!r||u&132)&&B(t,"hidden",a[7]||!((c=a[2])!=null&&c.id))},i(a){r||(E(i.$$.fragment,a),E(s.$$.fragment,a),r=!0)},o(a){j(i.$$.fragment,a),j(s.$$.fragment,a),r=!1},d(a){a&&(v(e),v(t)),o&&o.d(a),$(i),$(s)}}}function F0(n){let e;return{c(){e=w("div"),p(e,"class","breadcrumb-item")},m(t,i){k(t,e,i)},p:Q,i:Q,o:Q,d(t){t&&v(e)}}}function W0(n){let e,t,i,l;function s(o){n[11](o)}let r={collection:"projects"};return n[2]!==void 0&&(r.model=n[2]),t=new ur({props:r}),le.push(()=>Ae(t,"model",s)),{c(){e=w("div"),F(t.$$.fragment),p(e,"class","breadcrumb-item entrance-left")},m(o,a){k(o,e,a),q(t,e,null),l=!0},p(o,a){const u={};!i&&a&4&&(i=!0,u.model=o[2],Ne(()=>i=!1)),t.$set(u)},i(o){l||(E(t.$$.fragment,o),l=!0)},o(o){j(t.$$.fragment,o),l=!1},d(o){o&&v(e),$(t)}}}function _u(n){let e,t,i,l,s,r;return{c(){e=w("div"),t=w("button"),t.innerHTML='<i class="iconoir-user-plus"></i>',i=I(),l=w("button"),l.innerHTML='<i class="iconoir-internet txt-base"></i>',p(t,"type","button"),p(t,"class","menu-item"),p(l,"type","button"),p(l,"class","menu-item"),p(e,"class","header-menu entrance-left")},m(o,a){k(o,e,a),y(e,t),y(e,i),y(e,l),s||(r=[be(Oe.call(null,t,"Project owners")),H(t,"click",n[12]),be(Oe.call(null,l,"Share")),H(l,"click",n[13])],s=!0)},p:Q,d(o){o&&v(e),s=!1,me(r)}}}function V0(n){var _;let e,t,i,l,s,r,o,a,u,f;const c=[W0,F0],d=[];function m(b,g){var T;return(T=b[2])!=null&&T.id?0:1}l=m(n),s=d[l]=c[l](n);let h=((_=n[2])==null?void 0:_.id)&&_u(n);return{c(){e=w("nav"),t=w("a"),t.textContent="Projects",i=I(),s.c(),r=I(),h&&h.c(),o=De(),p(t,"href","/projects"),p(t,"class","breadcrumb-item"),p(e,"class","breadcrumbs svelte-1y0govx")},m(b,g){k(b,e,g),y(e,t),y(e,i),d[l].m(e,null),k(b,r,g),h&&h.m(b,g),k(b,o,g),a=!0,u||(f=be(Oi.call(null,t)),u=!0)},p(b,g){var L;let T=l;l=m(b),l===T?d[l].p(b,g):(ae(),j(d[T],1,1,()=>{d[T]=null}),ue(),s=d[l],s?s.p(b,g):(s=d[l]=c[l](b),s.c()),E(s,1),s.m(e,null)),(L=b[2])!=null&&L.id?h?h.p(b,g):(h=_u(b),h.c(),h.m(o.parentNode,o)):h&&(h.d(1),h=null)},i(b){a||(E(s),a=!0)},o(b){j(s),a=!1},d(b){b&&(v(e),v(r),v(o)),d[l].d(),h&&h.d(b),u=!1,f()}}}function gu(n){let e;return{c(){e=w("label"),e.innerHTML='<i class="iconoir-upload-square"></i> <span class="txt">Upload screens</span>',p(e,"for","screen_uploader"),p(e,"class","btn btn-primary btn-screen-upload entrance-right")},m(t,i){k(t,e,i)},d(t){t&&v(e)}}}function z0(n){var i;let e,t=((i=n[1])==null?void 0:i.id)&&gu();return{c(){t&&t.c(),e=De()},m(l,s){t&&t.m(l,s),k(l,e,s)},p(l,s){var r;(r=l[1])!=null&&r.id?t||(t=gu(),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},d(l){l&&v(e),t&&t.d(l)}}}function B0(n){let e,t,i,l,s,r;e=new Ni({props:{title:n[5],$$slots:{"header-right":[z0],"header-left":[V0],default:[$0]},$$scope:{ctx:n}}});let o={};i=new r0({props:o}),n[14](i);let a={};return s=new q0({props:a}),n[15](s),{c(){F(e.$$.fragment),t=I(),F(i.$$.fragment),l=I(),F(s.$$.fragment)},m(u,f){q(e,u,f),k(u,t,f),q(i,u,f),k(u,l,f),q(s,u,f),r=!0},p(u,[f]){const c={};f&32&&(c.title=u[5]),f&131295&&(c.$$scope={dirty:f,ctx:u}),e.$set(c);const d={};i.$set(d);const m={};s.$set(m)},i(u){r||(E(e.$$.fragment,u),E(i.$$.fragment,u),E(s.$$.fragment,u),r=!0)},o(u){j(e.$$.fragment,u),j(i.$$.fragment,u),j(s.$$.fragment,u),r=!1},d(u){u&&(v(t),v(l)),$(e,u),n[14](null),$(i,u),n[15](null),$(s,u)}}}function Z0(n,e,t){let i,l,s,r,o;ee(n,rn,O=>t(9,l=O)),ee(n,Ct,O=>t(1,s=O)),ee(n,ui,O=>t(10,r=O)),ee(n,cn,O=>t(2,o=O));let{params:a}=e,u,f,c="",d,m;async function h(O){Kl(),tr(),e1(O),ke(rn,l=!0,l);try{const C=await V.collection("projects").getOne(O);Xn(C,!0),ke(rn,l=!1,l)}catch(C){C.isAbort||(ke(rn,l=!1,l),V.error(C),C.status==404&&Yt("/"))}}Gt(()=>{Wn==null||Wn()});function _(O){o=O,cn.set(o)}const b=()=>u==null?void 0:u.show(),g=()=>f==null?void 0:f.show();function T(O){le[O?"unshift":"push"](()=>{u=O,t(3,u)})}function L(O){le[O?"unshift":"push"](()=>{f=O,t(4,f)})}return n.$$set=O=>{"params"in O&&t(0,a=O.params)},n.$$.update=()=>{n.$$.dirty&257&&d!=a.projectId&&(t(8,d=a.projectId),t(6,m=a.prototypeId),h(d)),n.$$.dirty&4&&o!=null&&o.title&&t(5,c=o.title),n.$$.dirty&1536&&t(7,i=l||r),n.$$.dirty&2&&s!=null&&s.id&&Yt(`/projects/${s.project}/prototypes/${s.id}`)},[a,s,o,u,f,c,m,i,d,l,r,_,b,g,T,L]}class Y0 extends ve{constructor(e){super(),ye(this,e,Z0,B0,_e,{params:0})}}const Dn=Fe([]),Ai=Fe(null),bi=Fe(!1),$n=Fe(!1),Wi=Fe(!1);function K0(){Dn.set([]),Ai.set(null),bi.set(!1),$n.set(!1)}const Wt=Mt([Dn,Ai],([n,e])=>!n.length||e===null?null:n.find(t=>t.id===e));Wt.set=n=>{K.isObject(n)?Ti(n,!0):Ai.set(n)};function Ti(n,e=!1){n&&(Dn.update(t=>(K.pushOrReplaceObject(t,n),t)),e&&Ai.set(n.id))}function Td(n){n&&(Dn.update(e=>e.filter(t=>t.id!=n.id&&t.replyTo!=n.id)),Ai.update(e=>e==n.id?n.replyTo||null:e))}function Ps(){Dn.update(n=>n.filter(e=>!!e.id)),Ai.update(n=>n===""?null:n)}const fr=Mt([Dn,Ke],([n,e])=>n.filter(t=>t.screen==(e==null?void 0:e.id)).sort((t,i)=>!t.created||t.created>i.created?1:-1)),Od=Mt([fr],([n])=>n.filter(e=>!e.replyTo)),Cd=Mt([fr],([n])=>n.filter(e=>e.id&&!e.replyTo&&!e.resolved));let an;async function Ed(n){return an==null||an(),V.collection("comments").subscribe("*",e=>{e.action==="delete"?Td(e.record):Ti(e.record)},{filter:`screen.prototype="${n}"`,expand:"user"}).then(e=>(an=e,e)).catch(e=>{console.warn("failed to init comments subscription:",e)})}async function Ld(n,e=void 0){var t;K0(),bi.set(!0);try{const i=await V.collection("comments").getFullList({filter:`screen.prototype="${n}"`,expand:"user"});Dn.set(i),Yn(ji)===Te.comments&&e&&((t=i.find(l=>l.id==e))!=null&&t.resolved&&Wi.set(!0),Wt.set(e)),bi.set(!1)}catch(i){i.isAbort||(bi.set(!1),V.error(i))}}const dn=Fe([]),Vi=Fe(!1);function G0(){dn.set([]),Vi.set(!1)}function zi(n){dn.update(e=>(K.pushOrReplaceObject(e,n),e))}function Id(n){dn.update(e=>(K.removeByKey(e,"id",n==null?void 0:n.id),e))}const J0=Mt([dn,Ke],([n,e])=>n.filter(t=>t.screens.length&&(e==null?void 0:e.id)&&t.screens.includes(e.id)));let un;async function jd(n){return un==null||un(),V.collection("hotspotTemplates").subscribe("*",e=>{e.action==="delete"?Id(e.record):zi(e.record)},{filter:`prototype="${n}"`}).then(e=>(un=e,e)).catch(e=>{console.warn("failed to init templates subscription:",e)})}async function Pd(n){G0(),Vi.set(!0);try{const e=await V.collection("hotspotTemplates").getFullList({filter:`prototype="${n}"`});e.sort((t,i)=>!t.created||t.created>i.created?1:-1),dn.set(e),Vi.set(!1)}catch(e){e.isAbort||(Vi.set(!1),V.error(e))}}const xe={note:"note",screen:"screen",overlay:"overlay",back:"back",prev:"prev",next:"next",url:"url",scroll:"scroll"};Object.freeze(xe);const yn=Fe([]),Di=Fe(null),Bi=Fe(!1),X0=Fe(!1),hn=Fe(!1);function Q0(){yn.set([]),Di.set(null),Bi.set(!1),X0.set(!1),hn.set(!1)}const We=Mt([yn,Di],([n,e])=>!n.length||e===null?null:n.find(t=>t.id===e));We.set=n=>{K.isObject(n)?In(n,!0):Di.set(n)};function In(n,e=!1){n&&(yn.update(t=>(K.pushOrReplaceObject(t,n),t)),e&&Di.set(n.id))}function Nd(n){n&&(yn.update(e=>(K.removeByKey(e,"id",n.id),e)),Di.update(e=>e==n.id?null:e))}function Ns(){yn.update(n=>n.filter(e=>!!e.id)),Di.update(n=>n===""?null:n)}const Ad=Mt([Ke,yn,dn],([n,e,t])=>Dd(n,e,t));function Dd(n,e,t){return e.filter(i=>{var l;if(!(n!=null&&n.id))return!1;if(i.screen==n.id)return!0;for(let s of t)if(i.hotspotTemplate==s.id&&((l=s.screens)!=null&&l.includes(n.id)))return!0;return!1})}let fn;async function Md(n){return fn==null||fn(),V.collection("hotspots").subscribe("*",e=>{e.action=="delete"?Nd(e.record):In(e.record)},{filter:`screen.prototype="${n}" || hotspotTemplate.prototype="${n}"`}).then(e=>(fn=e,e)).catch(e=>{console.warn("failed to init hotspots subscription:",e)})}async function Rd(n){Q0(),Bi.set(!0);try{const e=await V.collection("hotspots").getFullList({filter:`screen.prototype="${n}" || hotspotTemplate.prototype="${n}"`});yn.set(e),Bi.set(!1)}catch(e){e.isAbort||(Bi.set(!1),V.error(e))}}function bu(n,e,t){const i=n.slice();return i[9]=e[t],i}function wu(n){let e,t=[],i=new Map,l,s,r,o=Le(n[3]);const a=u=>u[9].id;for(let u=0;u<o.length;u+=1){let f=bu(n,o,u),c=a(f);i.set(c,t[u]=yu(c,f))}return{c(){e=w("div");for(let u=0;u<t.length;u+=1)t[u].c();p(e,"class",l="screens-bar "+n[1])},m(u,f){k(u,e,f);for(let c=0;c<t.length;c+=1)t[c]&&t[c].m(e,null);r=!0},p(u,f){f&12&&(o=Le(u[3]),ae(),t=St(t,f,a,1,u,o,i,e,At,yu,null,bu),ue()),(!r||f&2&&l!==(l="screens-bar "+u[1]))&&p(e,"class",l)},i(u){if(!r){for(let f=0;f<o.length;f+=1)E(t[f]);u&&kt(()=>{r&&(s||(s=ct(e,Et,{duration:150},!0)),s.run(1))}),r=!0}},o(u){for(let f=0;f<t.length;f+=1)j(t[f]);u&&(s||(s=ct(e,Et,{duration:150},!1)),s.run(0)),r=!1},d(u){u&&v(e);for(let f=0;f<t.length;f+=1)t[f].d();u&&s&&s.end()}}}function yu(n,e){let t,i,l,s,r,o,a,u;i=new Xt({props:{src:V.files.getURL(e[9],e[9].file,{thumb:"100x100"}),alt:e[9].title}});function f(){return e[7](e[9])}return{key:n,first:null,c(){t=w("button"),F(i.$$.fragment),l=I(),p(t,"type","button"),p(t,"data-screen-id",s=e[9].id),p(t,"class","thumb thumb-handle"),B(t,"thumb-highlight-mode-accent",e[2].id==e[9].id),this.first=t},m(c,d){k(c,t,d),q(i,t,null),y(t,l),o=!0,a||(u=[be(r=Oe.call(null,t,{position:"top",text:e[9].title})),H(t,"click",Ze(we(f)))],a=!0)},p(c,d){e=c;const m={};d&8&&(m.src=V.files.getURL(e[9],e[9].file,{thumb:"100x100"})),d&8&&(m.alt=e[9].title),i.$set(m),(!o||d&8&&s!==(s=e[9].id))&&p(t,"data-screen-id",s),r&&et(r.update)&&d&8&&r.update.call(null,{position:"top",text:e[9].title}),(!o||d&12)&&B(t,"thumb-highlight-mode-accent",e[2].id==e[9].id)},i(c){o||(E(i.$$.fragment,c),o=!0)},o(c){j(i.$$.fragment,c),o=!1},d(c){c&&v(t),$(i),a=!1,me(u)}}}function x0(n){let e,t,i=n[0]&&wu(n);return{c(){i&&i.c(),e=De()},m(l,s){i&&i.m(l,s),k(l,e,s),t=!0},p(l,[s]){l[0]?i?(i.p(l,s),s&1&&E(i,1)):(i=wu(l),i.c(),E(i,1),i.m(e.parentNode,e)):i&&(ae(),j(i,1,1,()=>{i=null}),ue())},i(l){t||(E(i),t=!0)},o(l){j(i),t=!1},d(l){l&&v(e),i&&i.d(l)}}}function e2(n,e,t){let i,l;ee(n,Ke,d=>t(2,i=d)),ee(n,pt,d=>t(3,l=d));let{active:s=!0}=e,{class:r=""}=e;function o(){t(0,s=!0)}function a(){t(0,s=!1)}function u(){s?a():o()}async function f(){if(!s||!(i!=null&&i.id))return;await Ot();const d=document.querySelector(`[data-screen-id="${i.id}"]`);d&&(d.scrollIntoView(),document.activeElement&&d.parentNode.contains(document.activeElement)&&d.focus())}gn(()=>{f()});const c=d=>{ke(Ke,i=d.id,i)};return n.$$set=d=>{"active"in d&&t(0,s=d.active),"class"in d&&t(1,r=d.class)},n.$$.update=()=>{n.$$.dirty&5&&s&&i!=null&&i.id&&f()},[s,r,i,l,o,a,u,c]}class Hd extends ve{constructor(e){super(),ye(this,e,e2,x0,_e,{active:0,class:1,show:4,hide:5,toggle:6})}get show(){return this.$$.ctx[4]}get hide(){return this.$$.ctx[5]}get toggle(){return this.$$.ctx[6]}}function t2(n){let e,t,i,l,s,r;const o=n[12].default,a=st(o,n,n[11],null);let u=[{class:t="draggable "+n[0]},n[5]],f={};for(let c=0;c<u.length;c+=1)f=Ue(f,u[c]);return{c(){e=w("div"),a&&a.c(),Kn(e,f),B(e,"dragging",n[4])},m(c,d){k(c,e,d),a&&a.m(e,null),n[15](e),l=!0,s||(r=[H(e,"mousedown",n[16]),H(e,"touchstart",n[2]),H(e,"click",n[13]),H(e,"keydown",n[14]),be(i=Oe.call(null,e,n[1]))],s=!0)},p(c,[d]){a&&a.p&&(!l||d&2048)&&ot(a,o,c,c[11],l?rt(o,c[11],d,null):at(c[11]),null),Kn(e,f=gt(u,[(!l||d&1&&t!==(t="draggable "+c[0]))&&{class:t},d&32&&c[5]])),i&&et(i.update)&&d&2&&i.update.call(null,c[1]),B(e,"dragging",c[4])},i(c){l||(E(a,c),l=!0)},o(c){j(a,c),l=!1},d(c){c&&v(e),a&&a.d(c),n[15](null),s=!1,me(r)}}}function n2(n,e,t){let i;const l=["disabled","tolerance","passive","parentSelector","class","tooltip","getElem","dragInit"];let s=ft(e,l),{$$slots:r={},$$scope:o}=e;const a=it();let{disabled:u=!1}=e,{tolerance:f=6}=e,{passive:c=!1}=e,{parentSelector:d=null}=e,{class:m=void 0}=e,{tooltip:h=null}=e,_,b=0,g=0,T=0,L=0,O=!1,C=!1,S=!1;function P(){return _}function R(N){u||!_||!N||(N.stopPropagation(),K.normalizePointerEvent(N),b=N.clientX,g=N.clientY,T=b-_.offsetLeft,L=g-_.offsetTop,document.addEventListener("touchmove",D),document.addEventListener("mousemove",D),document.addEventListener("touchend",A),document.addEventListener("mouseup",A),a("draginit",{event:N,elem:_}))}function A(N){var ne;K.normalizePointerEvent(N);const W=S;(ne=i==null?void 0:i.classList)==null||ne.remove("child-dragging"),S&&(N.touches||N.preventDefault(),t(4,S=!1),O=!1,C=!1,_.classList.remove("no-pointer-events","dragging"),a("dragstop",{event:N,elem:_})),document.removeEventListener("touchmove",D),document.removeEventListener("mousemove",D),document.removeEventListener("touchend",A),document.removeEventListener("mouseup",A),a("dragrelease",{event:N,elem:_,dragged:W})}function D(N){K.normalizePointerEvent(N);let W=N.clientX-T,ne=N.clientY-L;if(!S&&Math.abs(W-_.offsetLeft)<f&&Math.abs(ne-_.offsetTop)<f)return;N.touches||N.preventDefault();let X=N.clientX-b,U=N.clientY-g;const de={event:N,elem:_,diffX:X,diffY:U};if(S||(t(4,S=!0),_.classList.add("no-pointer-events","dragging"),i.classList.add("child-dragging"),a("dragstart",de)),a("dragging",de),!c){if(N.shiftKey?!O&&!C&&(Math.abs(X)>Math.abs(U)?(O=!1,C=!0):(O=!0,C=!1)):(O=!1,C=!1),!O){let re=i.scrollWidth||i.offsetWidth;W+_.offsetWidth>re&&(W=re-_.offsetWidth),W=W<0?0:W,t(3,_.style.left=W+"px",_)}if(!C){let re=i.scrollHeight||i.offsetHeight;ne+_.offsetHeight>re&&(ne=re-_.offsetHeight),ne=ne<0?0:ne,t(3,_.style.top=ne+"px",_)}}}function M(N){$e.call(this,n,N)}function Z(N){$e.call(this,n,N)}function Y(N){le[N?"unshift":"push"](()=>{_=N,t(3,_)})}const z=N=>{N.button==0&&R(N)};return n.$$set=N=>{e=Ue(Ue({},e),Kt(N)),t(5,s=ft(e,l)),"disabled"in N&&t(6,u=N.disabled),"tolerance"in N&&t(7,f=N.tolerance),"passive"in N&&t(8,c=N.passive),"parentSelector"in N&&t(9,d=N.parentSelector),"class"in N&&t(0,m=N.class),"tooltip"in N&&t(1,h=N.tooltip),"$$scope"in N&&t(11,o=N.$$scope)},n.$$.update=()=>{n.$$.dirty&520&&(i=(_==null?void 0:_.closest(d))||(_==null?void 0:_.parentNode))},[m,h,R,_,S,s,u,f,c,d,P,o,r,M,Z,Y,z]}class cr extends ve{constructor(e){super(),ye(this,e,n2,t2,_e,{disabled:6,tolerance:7,passive:8,parentSelector:9,class:0,tooltip:1,getElem:10,dragInit:2})}get getElem(){return this.$$.ctx[10]}get dragInit(){return this.$$.ctx[2]}}function i2(n){let e;const t=n[10].default,i=st(t,n,n[13],null);return{c(){i&&i.c()},m(l,s){i&&i.m(l,s),e=!0},p(l,s){i&&i.p&&(!e||s&8192)&&ot(i,t,l,l[13],e?rt(t,l[13],s,null):at(l[13]),null)},i(l){e||(E(i,l),e=!0)},o(l){j(i,l),e=!1},d(l){i&&i.d(l)}}}function l2(n){let e;return{c(){e=w("span"),p(e,"class","loader loader-xs loader-danger-alt")},m(t,i){k(t,e,i)},p:Q,i:Q,o:Q,d(t){t&&v(e)}}}function s2(n){let e,t,i,l;const s=[l2,i2],r=[];function o(a,u){return a[2]?0:1}return e=o(n),t=r[e]=s[e](n),{c(){t.c(),i=De()},m(a,u){r[e].m(a,u),k(a,i,u),l=!0},p(a,u){let f=e;e=o(a),e===f?r[e].p(a,u):(ae(),j(r[f],1,1,()=>{r[f]=null}),ue(),t=r[e],t?t.p(a,u):(t=r[e]=s[e](a),t.c()),E(t,1),t.m(i.parentNode,i))},i(a){l||(E(t),l=!0)},o(a){j(t),l=!1},d(a){a&&v(i),r[e].d(a)}}}function r2(n){let e,t;return e=new cr({props:{disabled:n[1],class:"comment-pin "+(n[0].resolved?"resolved":"")+" "+(n[4]?"unread":""),parentSelector:".screen-preview-img-wrapper","data-comment-pin":n[0].id,style:"left: min(calc(100% - "+_l+"px), "+n[0].left*n[3]+"px); top: min(calc(100% - "+_l+"px), "+n[0].top*n[3]+"px)",$$slots:{default:[s2]},$$scope:{ctx:n}}}),e.$on("dragstop",n[11]),e.$on("click",n[12]),{c(){F(e.$$.fragment)},m(i,l){q(e,i,l),t=!0},p(i,[l]){const s={};l&2&&(s.disabled=i[1]),l&17&&(s.class="comment-pin "+(i[0].resolved?"resolved":"")+" "+(i[4]?"unread":"")),l&1&&(s["data-comment-pin"]=i[0].id),l&9&&(s.style="left: min(calc(100% - "+_l+"px), "+i[0].left*i[3]+"px); top: min(calc(100% - "+_l+"px), "+i[0].top*i[3]+"px)"),l&8196&&(s.$$scope={dirty:l,ctx:i}),e.$set(s)},i(i){t||(E(e.$$.fragment,i),t=!0)},o(i){j(e.$$.fragment,i),t=!1},d(i){$(e,i)}}}const _l=36;function o2(n,e,t){let i,l,s,r,o;ee(n,wn,g=>t(8,s=g)),ee(n,Bn,g=>t(9,r=g)),ee(n,Wt,g=>t(5,o=g));let{$$slots:a={},$$scope:u}=e,{comment:f}=e,{disabled:c=!1}=e,{scale:d=null}=e,m=!1;async function h(g){if(g&&(Object.assign(f,{left:g.offsetLeft/i,top:g.offsetTop/i}),Ti(f),!!f.id)){t(2,m=!0);try{const T={left:f.left,top:f.top};await V.collection("comments").update(f.id,T),t(2,m=!1)}catch(T){T.isAbort||(V.error(T),t(2,m=!1))}}}const _=g=>{h(g.detail.elem)},b=()=>{o!=f&&Ps(),ke(Wt,o=f,o)};return n.$$set=g=>{"comment"in g&&t(0,f=g.comment),"disabled"in g&&t(1,c=g.disabled),"scale"in g&&t(7,d=g.scale),"$$scope"in g&&t(13,u=g.$$scope)},n.$$.update=()=>{n.$$.dirty&640&&t(3,i=d===null?r:d),n.$$.dirty&257&&t(4,l=f!=null&&f.id?!!(s!=null&&s.find(g=>{var T,L;return!g.read&&(g.comment==f.id||((L=(T=g.expand)==null?void 0:T.comment)==null?void 0:L.replyTo)==f.id)})):!1)},[f,c,m,i,l,o,h,d,s,r,a,_,b,u]}class a2 extends ve{constructor(e){super(),ye(this,e,o2,r2,_e,{comment:0,disabled:1,scale:7})}}function vu(n){let e,t,i={class:"resize-handle",passive:!0,parentSelector:".screen-preview-img-wrapper"};return e=new cr({props:i}),n[21](e),e.$on("draginit",n[22]),e.$on("dragstart",n[23]),e.$on("dragstop",n[24]),e.$on("dragrelease",n[25]),e.$on("dragging",n[26]),{c(){F(e.$$.fragment)},m(l,s){q(e,l,s),t=!0},p(l,s){const r={};e.$set(r)},i(l){t||(E(e.$$.fragment,l),t=!0)},o(l){j(e.$$.fragment,l),t=!1},d(l){n[21](null),$(e,l)}}}function u2(n){let e,t,i=!n[1]&&vu(n);return{c(){i&&i.c(),e=De()},m(l,s){i&&i.m(l,s),k(l,e,s),t=!0},p(l,s){l[1]?i&&(ae(),j(i,1,1,()=>{i=null}),ue()):i?(i.p(l,s),s[0]&2&&E(i,1)):(i=vu(l),i.c(),E(i,1),i.m(e.parentNode,e))},i(l){t||(E(i),t=!0)},o(l){j(i),t=!1},d(l){l&&v(e),i&&i.d(l)}}}function f2(n){var l;let e,t,i={class:"hotspot type-"+n[0].type+" "+(n[1]?"preview":"")+" "+(((l=n[4])==null?void 0:l.id)==n[0].id?"active":"")+" "+(n[13]?"no-pointer-events":"")+" "+(n[0].hotspotTemplate?"template":""),"data-hotspot":n[0].id,parentSelector:As,disabled:n[13]||n[1]||n[0].disabled,style:`
        left: min(calc(100% - `+n[0].width*n[12]+"px), "+n[0].left*n[12]+`px);
        top: min(calc(100% - `+n[0].height*n[12]+"px), "+n[0].top*n[12]+`px);
        width: `+n[0].width*n[12]+`px;
        height: `+n[0].height*n[12]+`px;
    `,tooltip:n[10],$$slots:{default:[u2]},$$scope:{ctx:n}};return e=new cr({props:i}),n[27](e),e.$on("dragstart",n[28]),e.$on("dragrelease",n[29]),e.$on("dragstop",n[15]),e.$on("click",n[30]),{c(){F(e.$$.fragment)},m(s,r){q(e,s,r),t=!0},p(s,r){var a;const o={};r[0]&8211&&(o.class="hotspot type-"+s[0].type+" "+(s[1]?"preview":"")+" "+(((a=s[4])==null?void 0:a.id)==s[0].id?"active":"")+" "+(s[13]?"no-pointer-events":"")+" "+(s[0].hotspotTemplate?"template":"")),r[0]&1&&(o["data-hotspot"]=s[0].id),r[0]&8195&&(o.disabled=s[13]||s[1]||s[0].disabled),r[0]&4097&&(o.style=`
        left: min(calc(100% - `+s[0].width*s[12]+"px), "+s[0].left*s[12]+`px);
        top: min(calc(100% - `+s[0].height*s[12]+"px), "+s[0].top*s[12]+`px);
        width: `+s[0].width*s[12]+`px;
        height: `+s[0].height*s[12]+`px;
    `),r[0]&1024&&(o.tooltip=s[10]),r[0]&7163|r[1]&4194304&&(o.$$scope={dirty:r,ctx:s}),e.$set(o)},i(s){t||(E(e.$$.fragment,s),t=!0)},o(s){j(e.$$.fragment,s),t=!1},d(s){n[27](null),$(e,s)}}}let ds,ps;const As=".active-screen-preview-wrapper",c2=".screen-preview",gl=25;function d2(n,e,t){let i,l,s,r,o,a,u,f,c,d,m,h,_;ee(n,ci,ce=>t(33,r=ce)),ee(n,fi,ce=>t(34,o=ce)),ee(n,Ke,ce=>t(35,a=ce)),ee(n,vi,ce=>t(36,u=ce)),ee(n,rd,ce=>t(37,f=ce)),ee(n,Si,ce=>t(38,c=ce)),ee(n,pt,ce=>t(39,d=ce)),ee(n,We,ce=>t(4,m=ce)),ee(n,hn,ce=>t(5,h=ce)),ee(n,Bn,ce=>t(20,_=ce));const b=As+" .screen-preview-img img";let{hotspot:g}=e,{preview:T=!1}=e,{scale:L=null}=e,{backFunc:O=null}=e,C,S,P,R=0,A=0,D=0,M=0,Z=!1,Y;function z(){var ce;t(10,Y=void 0),(m==null?void 0:m.id)!=g.id&&(g.type==xe.note?t(10,Y={position:"follow",text:(ce=g.settings)==null?void 0:ce.note,hideOnClick:!1}):T||t(10,Y={position:"top",text:`Ctrl + Click to follow
Shift + Click to duplicate`,delay:500,hideOnClick:!0}))}function N(ce=!1){return(!S||ce)&&(S=document.querySelector(As)),S}function W(){l&&Object.assign(g,{left:l.offsetLeft/i,top:l.offsetTop/i,width:l.offsetWidth/i,height:l.offsetHeight/i})}async function ne(ce){var Pe,fe;if(l&&((fe=(Pe=ce==null?void 0:ce.detail)==null?void 0:Pe.event)!=null&&fe.altKey&&await X(),W(),In(g),!!g.id)){Z=!0;try{const ze={left:g.left,top:g.top,width:g.width,height:g.height};await V.collection("hotspots").update(g.id,ze),Z=!1}catch(ze){ze.isAbort||(V.error(ze),Z=!1)}}}async function X(){const ce=document.querySelector(b);if(!ce)return;W();const Pe=K.closestFeatureEdge(ce,{x:g.left,y:g.top,w:g.width,h:g.height});t(0,g.left+=Pe.x,g),t(0,g.top+=Pe.y,g),t(0,g.width=Pe.w,g),t(0,g.height=Pe.h,g),await Ot()}async function U(){const ce=N().offsetWidth||1/0,Pe=structuredClone(g);Pe.id="hcopy"+K.randomString(10),Pe.left=Pe.left+Pe.width,Pe.disabled=!0,Pe.left+Pe.width>ce&&(Pe.left=ce-Pe.width),In(Pe);try{In(await V.collection("hotspots").create(Pe)),Z=!1}catch(fe){fe.isAbort||(V.error(fe),Z=!1,Nd(Pe))}}function de(){switch(g.type){case xe.screen:return re();case xe.overlay:return pe();case xe.back:return Ee();case xe.prev:return tt();case xe.next:return ut();case xe.url:return lt();case xe.scroll:return dt()}}function re(){const ce=d.find(Pe=>Pe.id==g.settings.screen);J(ce)}function pe(){ke(Si,c=g.settings,c)}function Ee(){O?O():f!=null&&f.id&&J(f)}function tt(){const ce=Is(-1);J(ce)}function ut(){const ce=Is(1);J(ce)}function lt(){u!=null&&u.allowHotspotsURL&&window.open(g.settings.url||"#","_blank","noopener,noreferrer")}function dt(){var ce;(ce=document.querySelector(c2))==null||ce.scrollTo({behavior:"smooth",top:g.settings.scrollTop||0,left:g.settings.scrollLeft||0})}function se(){clearTimeout(ps),clearTimeout(ds),ke(ci,r=null,r),ke(fi,o="",o)}function J(ce){if(!ce){se();return}if(!g.settings.transition){se(),ke(Ke,a=ce.id,a);return}ke(fi,o=g.settings.transition,o),ke(ci,r=ce.id,r),clearTimeout(ds),ds=setTimeout(()=>{ke(Ke,a=r==null?void 0:r.id,a),clearTimeout(ps),ps=setTimeout(()=>{ke(fi,o="",o),ke(ci,r="",r)},100)},350)}function G(ce){le[ce?"unshift":"push"](()=>{P=ce,t(3,P)})}const oe=()=>{ke(hn,h=!0,h)},x=()=>{l&&(t(6,R=l.offsetWidth),t(7,A=l.offsetHeight),t(8,D=l.offsetLeft),t(9,M=l.offsetTop))},je=ce=>{ne(ce),ke(hn,h=!1,h)},Re=ce=>{ce.detail.dragged||(ke(hn,h=!1,h),(m==null?void 0:m.id)!=(g==null?void 0:g.id)&&ke(We,m=g,m))},Xe=ce=>{if(!l)return;let Pe=R+ce.detail.diffX,fe=A+ce.detail.diffY,ze=D,nt=M;const Qe=N().offsetWidth,wt=N().offsetHeight;Pe<0&&(Pe=-1*ce.detail.diffX,ze=D+ce.detail.diffX,ze<0&&(ze=0,Pe=D)),ze+Pe>=Qe&&(Pe=Qe-ze,Pe<gl&&(Pe=gl,ze=Qe-Pe)),fe<0&&(fe=-1*ce.detail.diffY,nt=M+ce.detail.diffY,nt<0&&(nt=0,fe=M)),nt+fe>=wt&&(fe=wt-nt,fe<gl&&(fe=gl,nt=wt-fe)),t(0,g.width=Pe/i,g),t(0,g.height=fe/i,g),t(0,g.left=ze/i,g),t(0,g.top=nt/i,g)};function bt(ce){le[ce?"unshift":"push"](()=>{C=ce,t(2,C)})}const Lt=()=>{ke(hn,h=!0,h)},ie=()=>{ke(hn,h=!1,h)},Ve=ce=>{if(ce.stopImmediatePropagation(),!h){if(!T&&(g!=null&&g.id)&&ce.shiftKey)return U();m!=g&&Ns(),T||ce.ctrlKey?de():ke(We,m=g,m)}};return n.$$set=ce=>{"hotspot"in ce&&t(0,g=ce.hotspot),"preview"in ce&&t(1,T=ce.preview),"scale"in ce&&t(18,L=ce.scale),"backFunc"in ce&&t(19,O=ce.backFunc)},n.$$.update=()=>{n.$$.dirty[0]&1310720&&t(12,i=L===null?_:L),n.$$.dirty[0]&9&&g.startResizing&&P&&(P.dragInit(g.startResizing),delete g.startResizing),n.$$.dirty[0]&4&&t(11,l=C==null?void 0:C.getElem()),n.$$.dirty[0]&49&&t(13,s=h||m&&m.id!=g.id),n.$$.dirty[0]&3&&(g||T)&&z()},N(!0),[g,T,C,P,m,h,R,A,D,M,Y,l,i,s,N,ne,U,de,L,O,_,G,oe,x,je,Re,Xe,bt,Lt,ie,Ve]}class Gl extends ve{constructor(e){super(),ye(this,e,d2,f2,_e,{hotspot:0,preview:1,scale:18,backFunc:19},null,[-1,-1])}}function ku(n,e,t){const i=n.slice();return i[18]=e[t],i}function Su(n){let e,t,i,l,s,r,o=[],a=new Map,u=`${n[1].offsetTop*n[6]}px`,f=`${n[1].offsetLeft*n[6]}px`,c=`${n[1].offseRight*n[6]}px`,d=`${n[1].offsetBottom*n[6]}px`,m,h,_,b,g={src:V.files.getURL(n[0],n[0].file),alt:n[0].title,draggable:!1,loading:"eager",loaderClass:"hidden",fetchpriority:"high",scale:n[6]};l=new Xt({props:g}),n[13](l),l.$on("load",n[8]);let T=Le(n[5]);const L=O=>O[18].id;for(let O=0;O<T.length;O+=1){let C=ku(n,T,O),S=L(C);a.set(S,o[O]=Tu(S,C))}return{c(){e=w("div"),t=w("div"),i=w("div"),F(l.$$.fragment),s=I(),r=w("div");for(let O=0;O<o.length;O+=1)o[O].c();p(r,"class","hotspots"),p(i,"class","screen-overlay-offset"),qe(i,"margin-top",u),qe(i,"margin-left",f),qe(i,"margin-right",c),qe(i,"margin-bottom",d),p(t,"class",m="screen-overlay "+(n[1].fixOverlay?"fixed":"")+" transition-"+(n[1].transition||"none")+" position-"+n[1].overlayPosition),p(e,"class","screen-overlay-container")},m(O,C){k(O,e,C),y(e,t),y(t,i),q(l,i,null),y(i,s),y(i,r);for(let S=0;S<o.length;S+=1)o[S]&&o[S].m(r,null);h=!0,_||(b=H(e,"click",n[14]),_=!0)},p(O,C){const S={};C&1&&(S.src=V.files.getURL(O[0],O[0].file)),C&1&&(S.alt=O[0].title),C&64&&(S.scale=O[6]),l.$set(S),C&176&&(T=Le(O[5]),ae(),o=St(o,C,L,1,O,T,a,r,At,Tu,null,ku),ue()),C&66&&u!==(u=`${O[1].offsetTop*O[6]}px`)&&qe(i,"margin-top",u),C&66&&f!==(f=`${O[1].offsetLeft*O[6]}px`)&&qe(i,"margin-left",f),C&66&&c!==(c=`${O[1].offseRight*O[6]}px`)&&qe(i,"margin-right",c),C&66&&d!==(d=`${O[1].offsetBottom*O[6]}px`)&&qe(i,"margin-bottom",d),(!h||C&2&&m!==(m="screen-overlay "+(O[1].fixOverlay?"fixed":"")+" transition-"+(O[1].transition||"none")+" position-"+O[1].overlayPosition))&&p(t,"class",m)},i(O){if(!h){E(l.$$.fragment,O);for(let C=0;C<T.length;C+=1)E(o[C]);h=!0}},o(O){j(l.$$.fragment,O);for(let C=0;C<o.length;C+=1)j(o[C]);h=!1},d(O){O&&v(e),n[13](null),$(l);for(let C=0;C<o.length;C+=1)o[C].d();_=!1,b()}}}function Tu(n,e){let t,i,l;return i=new Gl({props:{preview:!0,hotspot:e[18],scale:e[4],backFunc:e[7]}}),{key:n,first:null,c(){t=De(),F(i.$$.fragment),this.first=t},m(s,r){k(s,t,r),q(i,s,r),l=!0},p(s,r){e=s;const o={};r&32&&(o.hotspot=e[18]),r&16&&(o.scale=e[4]),i.$set(o)},i(s){l||(E(i.$$.fragment,s),l=!0)},o(s){j(i.$$.fragment,s),l=!1},d(s){s&&v(t),$(i,s)}}}function p2(n){let e,t,i,l,s=n[3]&&n[1]&&Su(n);return{c(){s&&s.c(),e=De()},m(r,o){s&&s.m(r,o),k(r,e,o),t=!0,i||(l=H(window,"resize",n[12]),i=!0)},p(r,[o]){r[3]&&r[1]?s?(s.p(r,o),o&10&&E(s,1)):(s=Su(r),s.c(),E(s,1),s.m(e.parentNode,e)):s&&(ae(),j(s,1,1,()=>{s=null}),ue())},i(r){t||(E(s),t=!0)},o(r){j(s),t=!1},d(r){r&&v(e),s&&s.d(r),i=!1,l()}}}function m2(n,e,t){let i,l,s,r,o,a,u;ee(n,Si,C=>t(1,l=C)),ee(n,pt,C=>t(16,s=C)),ee(n,Pi,C=>t(9,r=C)),ee(n,dn,C=>t(10,o=C)),ee(n,yn,C=>t(11,a=C)),ee(n,Bn,C=>t(6,u=C));let f=null,c=null,d=!1,m=null,h=null;function _(){t(0,c=l!=null&&l.screen?s.find(C=>C.id==l.screen):null),c?t(3,d=!0):b()}function b(){t(3,d=!1),l&&ke(Si,l=null,l),c&&t(0,c=null)}function g(C=250){d&&(h&&clearTimeout(h),h=setTimeout(()=>{t(4,m=f?f.widthRatio():null),h=null},C))}Gt(()=>{h&&clearTimeout(h)});const T=()=>g();function L(C){le[C?"unshift":"push"](()=>{f=C,t(2,f)})}const O=function(C){l.outsideClose&&C.target==this&&b()};return n.$$.update=()=>{n.$$.dirty&2&&l!=-1&&_(),n.$$.dirty&3073&&t(5,i=c!=null&&c.id?Dd(c,a,o):[]),n.$$.dirty&512&&r!==-1&&g()},[c,l,f,d,m,i,u,b,g,r,o,a,T,L,O]}class h2 extends ve{constructor(e){super(),ye(this,e,m2,p2,_e,{})}}function Ou(n,e,t){const i=n.slice();return i[45]=e[t],i}function Cu(n,e,t){const i=n.slice();return i[50]=e[t],i[52]=t,i}function Eu(n,e,t){const i=n.slice();return i[45]=e[t],i}function Lu(n,e,t){const i=n.slice();return i[45]=e[t],i}function Iu(n){let e,t,i,l,s=`${n[2].fixedHeader*n[13]}px`,r=`-${n[2].fixedHeader*n[13]}px`,o;return l=new Xt({props:{class:"screen-preview-img",src:V.files.getURL(n[2],n[2].file),alt:n[2].title,draggable:!1,loaderClass:"hidden",fetchpriority:"high",scale:n[5].scale,$$slots:{default:[_2]},$$scope:{ctx:n}}}),l.$on("click",n[27]),{c(){e=w("div"),t=w("div"),i=w("div"),F(l.$$.fragment),p(i,"class","fixed-screen-hotspots-wrapper"),p(t,"class","fixed-screen-overflow"),p(e,"class","fixed-screen-header"),qe(e,"height",s),qe(e,"margin-top",r)},m(a,u){k(a,e,u),y(e,t),y(t,i),q(l,i,null),o=!0},p(a,u){const f={};u[0]&4&&(f.src=V.files.getURL(a[2],a[2].file)),u[0]&4&&(f.alt=a[2].title),u[0]&32&&(f.scale=a[5].scale),u[0]&131072|u[1]&16777216&&(f.$$scope={dirty:u,ctx:a}),l.$set(f),u[0]&8196&&s!==(s=`${a[2].fixedHeader*a[13]}px`)&&qe(e,"height",s),u[0]&8196&&r!==(r=`-${a[2].fixedHeader*a[13]}px`)&&qe(e,"margin-top",r)},i(a){o||(E(l.$$.fragment,a),o=!0)},o(a){j(l.$$.fragment,a),o=!1},d(a){a&&v(e),$(l)}}}function ju(n,e){let t,i,l;return i=new Gl({props:{preview:!0,hotspot:e[45]}}),{key:n,first:null,c(){t=De(),F(i.$$.fragment),this.first=t},m(s,r){k(s,t,r),q(i,s,r),l=!0},p(s,r){e=s;const o={};r[0]&131072&&(o.hotspot=e[45]),i.$set(o)},i(s){l||(E(i.$$.fragment,s),l=!0)},o(s){j(i.$$.fragment,s),l=!1},d(s){s&&v(t),$(i,s)}}}function _2(n){let e,t=[],i=new Map,l,s=Le(n[17]);const r=o=>"header_"+o[45].id;for(let o=0;o<s.length;o+=1){let a=Lu(n,s,o),u=r(a);i.set(u,t[o]=ju(u,a))}return{c(){e=w("div");for(let o=0;o<t.length;o+=1)t[o].c();p(e,"class","hotspots svelte-r47g7")},m(o,a){k(o,e,a);for(let u=0;u<t.length;u+=1)t[u]&&t[u].m(e,null);l=!0},p(o,a){a[0]&131072&&(s=Le(o[17]),ae(),t=St(t,a,r,1,o,s,i,e,At,ju,null,Lu),ue())},i(o){if(!l){for(let a=0;a<s.length;a+=1)E(t[a]);l=!0}},o(o){for(let a=0;a<t.length;a+=1)j(t[a]);l=!1},d(o){o&&v(e);for(let a=0;a<t.length;a+=1)t[a].d()}}}function g2(n){let e,t=[],i=new Map,l,s=Le(n[18]);const r=o=>o[50].id;for(let o=0;o<s.length;o+=1){let a=Cu(n,s,o),u=r(a);i.set(u,t[o]=Nu(u,a))}return{c(){e=w("div");for(let o=0;o<t.length;o+=1)t[o].c();p(e,"class","comment-pins svelte-r47g7")},m(o,a){k(o,e,a);for(let u=0;u<t.length;u+=1)t[u]&&t[u].m(e,null);l=!0},p(o,a){a[0]&1836040&&(s=Le(o[18]),ae(),t=St(t,a,r,1,o,s,i,e,At,Nu,null,Cu),ue())},i(o){if(!l){for(let a=0;a<s.length;a+=1)E(t[a]);l=!0}},o(o){for(let a=0;a<t.length;a+=1)j(t[a]);l=!1},d(o){o&&v(e);for(let a=0;a<t.length;a+=1)t[a].d()}}}function b2(n){let e,t=[],i=new Map,l,s,r,o=Le(n[17]);const a=u=>u[45].id;for(let u=0;u<o.length;u+=1){let f=Eu(n,o,u),c=a(f);i.set(c,t[u]=Au(c,f))}return s=new h2({}),{c(){e=w("div");for(let u=0;u<t.length;u+=1)t[u].c();l=I(),F(s.$$.fragment),p(e,"class","hotspots svelte-r47g7")},m(u,f){k(u,e,f);for(let c=0;c<t.length;c+=1)t[c]&&t[c].m(e,null);k(u,l,f),q(s,u,f),r=!0},p(u,f){f[0]&131074&&(o=Le(u[17]),ae(),t=St(t,f,a,1,u,o,i,e,At,Au,null,Eu),ue())},i(u){if(!r){for(let f=0;f<o.length;f+=1)E(t[f]);E(s.$$.fragment,u),r=!0}},o(u){for(let f=0;f<t.length;f+=1)j(t[f]);j(s.$$.fragment,u),r=!1},d(u){u&&(v(e),v(l));for(let f=0;f<t.length;f+=1)t[f].d();$(s,u)}}}function Pu(n){let e,t;return e=new a2({props:{disabled:!n[10],comment:n[50],$$slots:{default:[w2]},$$scope:{ctx:n}}}),{c(){F(e.$$.fragment)},m(i,l){q(e,i,l),t=!0},p(i,l){const s={};l[0]&1024&&(s.disabled=!i[10]),l[0]&262144&&(s.comment=i[50]),l[0]&262144|l[1]&16777216&&(s.$$scope={dirty:l,ctx:i}),e.$set(s)},i(i){t||(E(e.$$.fragment,i),t=!0)},o(i){j(e.$$.fragment,i),t=!1},d(i){$(e,i)}}}function w2(n){let e=(n[50].id?n[52]+1:"")+"",t,i;return{c(){t=te(e),i=I()},m(l,s){k(l,t,s),k(l,i,s)},p(l,s){s[0]&262144&&e!==(e=(l[50].id?l[52]+1:"")+"")&&Se(t,e)},d(l){l&&(v(t),v(i))}}}function Nu(n,e){var a,u;let t,i=!e[50].resolved||e[19]||((a=e[3])==null?void 0:a.id)==e[50].id||((u=e[3])==null?void 0:u.replyTo)==e[50].id||e[20].filter(r).length,l,s;function r(...f){return e[32](e[50],...f)}let o=i&&Pu(e);return{key:n,first:null,c(){t=De(),o&&o.c(),l=De(),this.first=t},m(f,c){k(f,t,c),o&&o.m(f,c),k(f,l,c),s=!0},p(f,c){var d,m;e=f,c[0]&1835016&&(i=!e[50].resolved||e[19]||((d=e[3])==null?void 0:d.id)==e[50].id||((m=e[3])==null?void 0:m.replyTo)==e[50].id||e[20].filter(r).length),i?o?(o.p(e,c),c[0]&1835016&&E(o,1)):(o=Pu(e),o.c(),E(o,1),o.m(l.parentNode,l)):o&&(ae(),j(o,1,1,()=>{o=null}),ue())},i(f){s||(E(o),s=!0)},o(f){j(o),s=!1},d(f){f&&(v(t),v(l)),o&&o.d(f)}}}function Au(n,e){let t,i,l;return i=new Gl({props:{hotspot:e[45],preview:e[1]==Te.preview}}),{key:n,first:null,c(){t=De(),F(i.$$.fragment),this.first=t},m(s,r){k(s,t,r),q(i,s,r),l=!0},p(s,r){e=s;const o={};r[0]&131072&&(o.hotspot=e[45]),r[0]&2&&(o.preview=e[1]==Te.preview),i.$set(o)},i(s){l||(E(i.$$.fragment,s),l=!0)},o(s){j(i.$$.fragment,s),l=!1},d(s){s&&v(t),$(i,s)}}}function Du(n){let e,t,i,l,s=`${n[2].fixedFooter*n[13]}px`,r=`-${n[2].fixedFooter*n[13]}px`,o;return l=new Xt({props:{class:"screen-preview-img",src:V.files.getURL(n[2],n[2].file),alt:n[2].title,draggable:!1,loading:"eager",loaderClass:"hidden",fetchpriority:"high",scale:n[5].scale,$$slots:{default:[y2]},$$scope:{ctx:n}}}),l.$on("click",n[27]),{c(){e=w("div"),t=w("div"),i=w("div"),F(l.$$.fragment),p(i,"class","fixed-screen-hotspots-wrapper"),p(t,"class","fixed-screen-overflow"),p(e,"class","fixed-screen-footer"),qe(e,"height",s),qe(e,"margin-top",r)},m(a,u){k(a,e,u),y(e,t),y(t,i),q(l,i,null),o=!0},p(a,u){const f={};u[0]&4&&(f.src=V.files.getURL(a[2],a[2].file)),u[0]&4&&(f.alt=a[2].title),u[0]&32&&(f.scale=a[5].scale),u[0]&131072|u[1]&16777216&&(f.$$scope={dirty:u,ctx:a}),l.$set(f),u[0]&8196&&s!==(s=`${a[2].fixedFooter*a[13]}px`)&&qe(e,"height",s),u[0]&8196&&r!==(r=`-${a[2].fixedFooter*a[13]}px`)&&qe(e,"margin-top",r)},i(a){o||(E(l.$$.fragment,a),o=!0)},o(a){j(l.$$.fragment,a),o=!1},d(a){a&&v(e),$(l)}}}function Mu(n,e){let t,i,l;return i=new Gl({props:{preview:!0,hotspot:e[45]}}),{key:n,first:null,c(){t=De(),F(i.$$.fragment),this.first=t},m(s,r){k(s,t,r),q(i,s,r),l=!0},p(s,r){e=s;const o={};r[0]&131072&&(o.hotspot=e[45]),i.$set(o)},i(s){l||(E(i.$$.fragment,s),l=!0)},o(s){j(i.$$.fragment,s),l=!1},d(s){s&&v(t),$(i,s)}}}function y2(n){let e,t=[],i=new Map,l,s=Le(n[17]);const r=o=>"footer_"+o[45].id;for(let o=0;o<s.length;o+=1){let a=Ou(n,s,o),u=r(a);i.set(u,t[o]=Mu(u,a))}return{c(){e=w("div");for(let o=0;o<t.length;o+=1)t[o].c();p(e,"class","hotspots svelte-r47g7")},m(o,a){k(o,e,a);for(let u=0;u<t.length;u+=1)t[u]&&t[u].m(e,null);l=!0},p(o,a){a[0]&131072&&(s=Le(o[17]),ae(),t=St(t,a,r,1,o,s,i,e,At,Mu,null,Ou),ue())},i(o){if(!l){for(let a=0;a<s.length;a+=1)E(t[a]);l=!0}},o(o){for(let a=0;a<t.length;a+=1)j(t[a]);l=!1},d(o){o&&v(e);for(let a=0;a<t.length;a+=1)t[a].d()}}}function Ru(n){let e,t,i,l,s,r,o,a,u=n[21].fixedHeader>0&&n[1]==Te.preview&&Hu(n);s=new Xt({props:{class:"screen-preview-img",src:V.files.getURL(n[21],n[21].file),alt:n[21].title,loading:"eager",loaderClass:"loader",fetchpriority:"high",draggable:!1,scale:n[5].scale}}),s.$on("load",n[38]);let f=n[21].fixedFooter>0&&n[1]==Te.preview&&Uu(n);return{c(){e=w("div"),t=w("div"),u&&u.c(),i=I(),l=w("div"),F(s.$$.fragment),r=I(),f&&f.c(),p(l,"class","screen-preview-img-wrapper"),p(t,"class",o="screen-preview align-"+(n[2].alignment||"center")+" svelte-r47g7"),B(t,"fit-to-screen",n[4]),qe(t,"width",n[12]?`${n[12]}px`:void 0),qe(t,"height",n[11]?`${n[11]}px`:void 0),qe(t,"background-color",n[21].background||Ml),p(e,"class","transition-item new")},m(c,d){k(c,e,d),y(e,t),u&&u.m(t,null),y(t,i),y(t,l),q(s,l,null),y(t,r),f&&f.m(t,null),n[39](t),a=!0},p(c,d){c[21].fixedHeader>0&&c[1]==Te.preview?u?(u.p(c,d),d[0]&2097154&&E(u,1)):(u=Hu(c),u.c(),E(u,1),u.m(t,i)):u&&(ae(),j(u,1,1,()=>{u=null}),ue());const m={};d[0]&2097152&&(m.src=V.files.getURL(c[21],c[21].file)),d[0]&2097152&&(m.alt=c[21].title),d[0]&32&&(m.scale=c[5].scale),s.$set(m),c[21].fixedFooter>0&&c[1]==Te.preview?f?(f.p(c,d),d[0]&2097154&&E(f,1)):(f=Uu(c),f.c(),E(f,1),f.m(t,null)):f&&(ae(),j(f,1,1,()=>{f=null}),ue()),(!a||d[0]&4&&o!==(o="screen-preview align-"+(c[2].alignment||"center")+" svelte-r47g7"))&&p(t,"class",o),(!a||d[0]&20)&&B(t,"fit-to-screen",c[4]),d[0]&4096&&qe(t,"width",c[12]?`${c[12]}px`:void 0),d[0]&2048&&qe(t,"height",c[11]?`${c[11]}px`:void 0),d[0]&2097152&&qe(t,"background-color",c[21].background||Ml)},i(c){a||(E(u),E(s.$$.fragment,c),E(f),a=!0)},o(c){j(u),j(s.$$.fragment,c),j(f),a=!1},d(c){c&&v(e),u&&u.d(),$(s),f&&f.d(),n[39](null)}}}function Hu(n){let e,t,i,l=`${n[21].fixedHeader*n[13]}px`,s=`-${n[21].fixedHeader*n[13]}px`,r;return i=new Xt({props:{class:"screen-preview-img",src:V.files.getURL(n[21],n[21].file),alt:n[21].title,draggable:!1,loaderClass:"hidden",fetchpriority:"high",scale:n[5].scale}}),{c(){e=w("div"),t=w("div"),F(i.$$.fragment),p(t,"class","fixed-screen-overflow"),p(e,"class","fixed-screen-header"),qe(e,"height",l),qe(e,"margin-top",s)},m(o,a){k(o,e,a),y(e,t),q(i,t,null),r=!0},p(o,a){const u={};a[0]&2097152&&(u.src=V.files.getURL(o[21],o[21].file)),a[0]&2097152&&(u.alt=o[21].title),a[0]&32&&(u.scale=o[5].scale),i.$set(u),a[0]&2105344&&l!==(l=`${o[21].fixedHeader*o[13]}px`)&&qe(e,"height",l),a[0]&2105344&&s!==(s=`-${o[21].fixedHeader*o[13]}px`)&&qe(e,"margin-top",s)},i(o){r||(E(i.$$.fragment,o),r=!0)},o(o){j(i.$$.fragment,o),r=!1},d(o){o&&v(e),$(i)}}}function Uu(n){let e,t,i,l=`${n[21].fixedFooter*n[13]}px`,s=`-${n[21].fixedFooter*n[13]}px`,r;return i=new Xt({props:{class:"screen-preview-img",src:V.files.getURL(n[21],n[21].file),alt:n[21].title,loading:"eager",loaderClass:"hidden",fetchpriority:"high",scale:n[5].scale}}),{c(){e=w("div"),t=w("div"),F(i.$$.fragment),p(t,"class","fixed-screen-overflow"),p(e,"class","fixed-screen-footer"),qe(e,"height",l),qe(e,"margin-top",s)},m(o,a){k(o,e,a),y(e,t),q(i,t,null),r=!0},p(o,a){const u={};a[0]&2097152&&(u.src=V.files.getURL(o[21],o[21].file)),a[0]&2097152&&(u.alt=o[21].title),a[0]&32&&(u.scale=o[5].scale),i.$set(u),a[0]&2105344&&l!==(l=`${o[21].fixedFooter*o[13]}px`)&&qe(e,"height",l),a[0]&2105344&&s!==(s=`-${o[21].fixedFooter*o[13]}px`)&&qe(e,"margin-top",s)},i(o){r||(E(i.$$.fragment,o),r=!0)},o(o){j(i.$$.fragment,o),r=!1},d(o){o&&v(e),$(i)}}}function v2(n){var z;let e,t,i,l,s,r,o,a,u,f,c,d,m,h,_,b,g,T,L,O,C,S=n[2].fixedHeader>0&&n[1]==Te.preview&&Iu(n);function P(N){n[34](N)}let R={class:"screen-preview-img",src:V.files.getURL(n[2],n[2].file),alt:n[2].title,loading:"eager",loaderClass:"loader",fetchpriority:"high",draggable:!1,scale:n[5].scale};n[9]!==void 0&&(R.isLoading=n[9]),a=new Xt({props:R}),le.push(()=>Ae(a,"isLoading",P)),a.$on("load",n[35]),a.$on("mousedown",n[36]),a.$on("touchstart",n[26]),a.$on("click",n[27]),a.$on("click",n[25]);const A=[b2,g2],D=[];function M(N,W){return N[1]==Te.hotspots||N[1]==Te.preview?0:N[1]==Te.comments?1:-1}~(d=M(n))&&(m=D[d]=A[d](n));let Z=n[2].fixedFooter>0&&n[1]==Te.preview&&Du(n),Y=n[14]&&((z=n[21])==null?void 0:z.id)&&Ru(n);return{c(){e=w("div"),t=w("div"),i=w("div"),l=w("div"),S&&S.c(),s=I(),r=w("div"),o=w("div"),F(a.$$.fragment),c=I(),m&&m.c(),h=I(),Z&&Z.c(),b=I(),Y&&Y.c(),p(o,"class","tooltip-wrapper"),p(r,"class","screen-preview-img-wrapper active-screen-preview-wrapper svelte-r47g7"),B(r,"loading",n[9]),p(l,"class",_="screen-preview align-"+(n[2].alignment||"center")+" svelte-r47g7"),B(l,"fit-to-screen",n[4]),qe(l,"width",n[12]?`${n[12]}px`:void 0),qe(l,"height",n[11]?`${n[11]}px`:void 0),qe(l,"background-color",n[2].background||Ml),p(i,"class","transition-item old"),p(t,"class",g="transition-container transition-"+n[14]+" svelte-r47g7"),B(t,"active",n[14]),p(e,"class",T="screen-preview-holder "+(n[5].size?"mobile":"desktop")),B(e,"in-transition",!!n[14]),B(e,"hints",n[8]||n[15]),B(e,"annotations",n[16])},m(N,W){k(N,e,W),y(e,t),y(t,i),y(i,l),S&&S.m(l,null),y(l,s),y(l,r),y(r,o),q(a,o,null),y(r,c),~d&&D[d].m(r,null),y(l,h),Z&&Z.m(l,null),n[37](l),y(t,b),Y&&Y.m(t,null),L=!0,O||(C=[H(window,"resize",n[33]),be(f=Oe.call(null,o,n[7]))],O=!0)},p(N,W){var U;N[2].fixedHeader>0&&N[1]==Te.preview?S?(S.p(N,W),W[0]&6&&E(S,1)):(S=Iu(N),S.c(),E(S,1),S.m(l,s)):S&&(ae(),j(S,1,1,()=>{S=null}),ue());const ne={};W[0]&4&&(ne.src=V.files.getURL(N[2],N[2].file)),W[0]&4&&(ne.alt=N[2].title),W[0]&32&&(ne.scale=N[5].scale),!u&&W[0]&512&&(u=!0,ne.isLoading=N[9],Ne(()=>u=!1)),a.$set(ne),f&&et(f.update)&&W[0]&128&&f.update.call(null,N[7]);let X=d;d=M(N),d===X?~d&&D[d].p(N,W):(m&&(ae(),j(D[X],1,1,()=>{D[X]=null}),ue()),~d?(m=D[d],m?m.p(N,W):(m=D[d]=A[d](N),m.c()),E(m,1),m.m(r,null)):m=null),(!L||W[0]&512)&&B(r,"loading",N[9]),N[2].fixedFooter>0&&N[1]==Te.preview?Z?(Z.p(N,W),W[0]&6&&E(Z,1)):(Z=Du(N),Z.c(),E(Z,1),Z.m(l,null)):Z&&(ae(),j(Z,1,1,()=>{Z=null}),ue()),(!L||W[0]&4&&_!==(_="screen-preview align-"+(N[2].alignment||"center")+" svelte-r47g7"))&&p(l,"class",_),(!L||W[0]&20)&&B(l,"fit-to-screen",N[4]),W[0]&4096&&qe(l,"width",N[12]?`${N[12]}px`:void 0),W[0]&2048&&qe(l,"height",N[11]?`${N[11]}px`:void 0),W[0]&4&&qe(l,"background-color",N[2].background||Ml),N[14]&&((U=N[21])!=null&&U.id)?Y?(Y.p(N,W),W[0]&2113536&&E(Y,1)):(Y=Ru(N),Y.c(),E(Y,1),Y.m(t,null)):Y&&(ae(),j(Y,1,1,()=>{Y=null}),ue()),(!L||W[0]&16384&&g!==(g="transition-container transition-"+N[14]+" svelte-r47g7"))&&p(t,"class",g),(!L||W[0]&16384)&&B(t,"active",N[14]),(!L||W[0]&32&&T!==(T="screen-preview-holder "+(N[5].size?"mobile":"desktop")))&&p(e,"class",T),(!L||W[0]&16416)&&B(e,"in-transition",!!N[14]),(!L||W[0]&33056)&&B(e,"hints",N[8]||N[15]),(!L||W[0]&65568)&&B(e,"annotations",N[16])},i(N){L||(E(S),E(a.$$.fragment,N),E(m),E(Z),E(Y),L=!0)},o(N){j(S),j(a.$$.fragment,N),j(m),j(Z),j(Y),L=!1},d(N){N&&v(e),S&&S.d(),$(a),~d&&D[d].d(),Z&&Z.d(),n[37](null),Y&&Y.d(),O=!1,me(C)}}}const Ml="var(--baseColor)";function k2(n,e,t){let i,l,s,r,o,a,u,f,c,d,m,h,_,b,g,T,L,O,C,S,P,R;ee(n,pt,x=>t(43,r=x)),ee(n,ji,x=>t(1,o=x)),ee(n,Ke,x=>t(2,a=x)),ee(n,Bn,x=>t(13,u=x)),ee(n,We,x=>t(28,f=x)),ee(n,Wt,x=>t(3,c=x)),ee(n,Pi,x=>t(4,d=x)),ee(n,Ct,x=>t(5,m=x)),ee(n,xn,x=>t(29,h=x)),ee(n,cn,x=>t(30,_=x)),ee(n,hn,x=>t(31,b=x)),ee(n,fi,x=>t(14,g=x)),ee(n,Pl,x=>t(15,T=x)),ee(n,Nl,x=>t(16,L=x)),ee(n,Ad,x=>t(17,O=x)),ee(n,Od,x=>t(18,C=x)),ee(n,Wi,x=>t(19,S=x)),ee(n,or,x=>t(20,P=x)),ee(n,ci,x=>t(21,R=x));let A,D,M={},Z,Y,z=!1,N=!1,W=!0;function ne(){let x=m==null?void 0:m.scale;if(!a||x&&!d){ke(Bn,u=x,u);return}K.loadImage(V.files.getURL(a,a.file)).then(je=>{!je.success||!je.width||(clearTimeout(Z),Z=setTimeout(()=>{if(!A||!(a!=null&&a.id))return;const Re=x>0?je.width*x:je.width;A.clientWidth<Re?x=A.clientWidth/je.width||1:x||(x=1),ke(Bn,u=x,u)},0))})}function X(x,je="",Re=100){je=je||"default",clearTimeout(M[je]),M[je]=setTimeout(x,Re)}function U(x,je){je=je||A,je&&(x=="left"?je.scrollLeft=0:x=="right"?je.scrollLeft=je.scrollWidth:je.scrollLeft=(je.scrollWidth-je.offsetWidth)/2)}function de(x){if(o!=Te.comments||c)return;x.preventDefault();const je={id:"",left:x.offsetX/u,top:x.offsetY/u,message:"",screen:a==null?void 0:a.id};Ti(je,!0)}function re(x){if(o!=Te.hotspots||f)return;K.normalizePointerEvent(x),x.touches||x.preventDefault();const je={id:"",left:x.offsetX/u,top:x.offsetY/u,width:25,height:25,type:xe.screen,settings:{},screen:a==null?void 0:a.id,startResizing:x};In(je,!0)}function pe(){clearTimeout(N),t(8,z=!1)}function Ee(){o==Te.preview&&(t(8,z=!0),clearTimeout(N),N=setTimeout(()=>{t(8,z=!1)},500))}gn(()=>{for(let x of r.slice(0,50))K.loadImage(V.files.getURL(x,x.file));return()=>{clearTimeout(N),clearTimeout(Z);for(let x in M)clearTimeout(M[x])}});const tt=(x,je)=>{var Re,Xe,bt;return((Xe=(Re=je.expand)==null?void 0:Re.comment)==null?void 0:Xe.id)==x.id||((bt=je.expand)==null?void 0:bt.comment.replyTo)==x.id},ut=()=>{X(()=>{U(a==null?void 0:a.alignment,A),ne()})};function lt(x){W=x,t(9,W)}const dt=x=>{var je;(je=x.detail)==null||je.scrollIntoView(top),U(a.alignment),X(()=>{K.triggerEvent("mainScreenLoaded")},"mainScreenLoaded")},se=x=>{x.button==0&&re(x)};function J(x){le[x?"unshift":"push"](()=>{A=x,t(0,A)})}const G=()=>U(R.alignment,D);function oe(x){le[x?"unshift":"push"](()=>{D=x,t(6,D)})}return n.$$.update=()=>{var x,je,Re,Xe,bt,Lt;n.$$.dirty[0]&32&&t(12,i=((je=(x=m==null?void 0:m.size)==null?void 0:x.split("x"))==null?void 0:je[0])<<0),n.$$.dirty[0]&32&&t(11,l=((Xe=(Re=m==null?void 0:m.size)==null?void 0:Re.split("x"))==null?void 0:Xe[1])<<0),n.$$.dirty[0]&5&&U(a==null?void 0:a.alignment,A),n.$$.dirty[0]&21&&(d||X(()=>U(a==null?void 0:a.alignment,A),"",0)),n.$$.dirty[0]&52&&(a||m||d)&&(pe(),ne()),n.$$.dirty[0]&268435466|n.$$.dirty[1]&1&&(o==Te.hotspots&&!f&&!b?t(7,Y={position:"follow",text:"Click and drag to create hotspot",sub:'Hold "Alt" to snap'}):o==Te.comments&&!c?t(7,Y={position:"follow",text:"Click to leave a comment"}):t(7,Y=void 0)),n.$$.dirty[0]&1610612736&&t(10,s=(h==null?void 0:h.id)&&((Lt=(bt=_==null?void 0:_.expand)==null?void 0:bt.users)==null?void 0:Lt.find(ie=>ie.id==h.id)))},[A,o,a,c,d,m,D,Y,z,W,s,l,i,u,g,T,L,O,C,S,P,R,ne,X,U,de,re,Ee,f,h,_,b,tt,ut,lt,dt,se,J,G,oe]}class Ud extends ve{constructor(e){super(),ye(this,e,k2,v2,_e,{},null,[-1,-1])}}function qu(n,e,t){const i=n.slice();return i[45]=e[t][0],i[46]=e[t][1],i}function S2(n){let e;return{c(){e=w("i"),p(e,"class","iconoir-settings")},m(t,i){k(t,e,i)},d(t){t&&v(e)}}}function T2(n){let e;return{c(){e=w("div"),p(e,"class","loader loader-xs")},m(t,i){k(t,e,i)},d(t){t&&v(e)}}}function O2(n){let e,t,i,l;return{c(){e=w("input"),p(e,"type","text"),p(e,"id",t=n[44]),e.required=!0,p(e,"placeholder","Screen title")},m(s,r){k(s,e,r),ge(e,n[9].title),i||(l=H(e,"input",n[20]),i=!0)},p(s,r){r[1]&8192&&t!==(t=s[44])&&p(e,"id",t),r[0]&512&&e.value!==s[9].title&&ge(e,s[9].title)},d(s){s&&v(e),i=!1,l()}}}function $u(n){let e,t,i;function l(){return n[22](n[45])}return{c(){e=w("button"),e.textContent=`${n[46]} `,p(e,"type","button"),p(e,"class","btn btn-sm btn-semitransparent"),B(e,"btn-primary",n[9].alignment==n[45]||!n[9].alignment&&n[45]=="center")},m(s,r){k(s,e,r),t||(i=H(e,"click",we(l)),t=!0)},p(s,r){n=s,r[0]&1536&&B(e,"btn-primary",n[9].alignment==n[45]||!n[9].alignment&&n[45]=="center")},d(s){s&&v(e),t=!1,i()}}}function C2(n){let e,t,i,l,s,r,o,a,u,f=Le(Object.entries(n[10])),c=[];for(let d=0;d<f.length;d+=1)c[d]=$u(qu(n,f,d));return{c(){e=w("label"),t=w("span"),t.textContent="Alignment",i=I(),l=w("i"),r=I(),o=w("div");for(let d=0;d<c.length;d+=1)c[d].c();p(t,"class","txt"),p(l,"class",s="iconoir-keyframes txt-sm "+(n[6]?"txt-disabled":"link-hint")),B(l,"no-pointer-events",n[6]),p(o,"class","btns-group btns-group-block")},m(d,m){k(d,e,m),y(e,t),y(e,i),y(e,l),k(d,r,m),k(d,o,m);for(let h=0;h<c.length;h+=1)c[h]&&c[h].m(o,null);a||(u=[be(Oe.call(null,l,"Apply to all screens")),H(l,"click",Ze(we(n[21])))],a=!0)},p(d,m){if(m[0]&64&&s!==(s="iconoir-keyframes txt-sm "+(d[6]?"txt-disabled":"link-hint"))&&p(l,"class",s),m[0]&64&&B(l,"no-pointer-events",d[6]),m[0]&17920){f=Le(Object.entries(d[10]));let h;for(h=0;h<f.length;h+=1){const _=qu(d,f,h);c[h]?c[h].p(_,m):(c[h]=$u(_),c[h].c(),c[h].m(o,null))}for(;h<c.length;h+=1)c[h].d(1);c.length=f.length}},d(d){d&&(v(e),v(r),v(o)),ln(c,d),a=!1,me(u)}}}function E2(n){let e,t,i,l,s,r,o,a,u,f,c,d,m=(n[9].background||"none")+"",h,_,b,g;return{c(){e=w("label"),t=w("span"),t.textContent="Background",i=I(),l=w("i"),o=I(),a=w("div"),u=w("input"),c=I(),d=w("label"),h=te(m),p(t,"class","txt"),p(l,"class",s="iconoir-keyframes txt-sm "+(n[6]?"txt-disabled":"link-hint")),B(l,"no-pointer-events",n[6]),p(e,"for",r=n[44]),p(u,"type","color"),p(u,"id",f=n[44]),B(u,"fade",!n[9].background),p(d,"for",_=n[44]),p(d,"class","addon txt-mono"),p(a,"class","field-group")},m(T,L){k(T,e,L),y(e,t),y(e,i),y(e,l),k(T,o,L),k(T,a,L),y(a,u),ge(u,n[9].background),y(a,c),y(a,d),y(d,h),b||(g=[be(Oe.call(null,l,"Apply to all screens")),H(l,"click",Ze(we(n[23]))),H(u,"input",n[24])],b=!0)},p(T,L){L[0]&64&&s!==(s="iconoir-keyframes txt-sm "+(T[6]?"txt-disabled":"link-hint"))&&p(l,"class",s),L[0]&64&&B(l,"no-pointer-events",T[6]),L[1]&8192&&r!==(r=T[44])&&p(e,"for",r),L[1]&8192&&f!==(f=T[44])&&p(u,"id",f),L[0]&512&&ge(u,T[9].background),L[0]&512&&B(u,"fade",!T[9].background),L[0]&512&&m!==(m=(T[9].background||"none")+"")&&Se(h,m),L[1]&8192&&_!==(_=T[44])&&p(d,"for",_)},d(T){T&&(v(e),v(o),v(a)),b=!1,me(g)}}}function L2(n){let e,t,i,l,s,r,o,a,u,f,c;return{c(){e=w("input"),i=I(),l=w("label"),s=te("Has fixed header"),o=I(),a=w("i"),p(e,"type","checkbox"),p(e,"id",t=n[44]),p(l,"for",r=n[44]),p(a,"class",u="iconoir-keyframes txt-sm "+(n[6]?"txt-disabled":"link-hint")),B(a,"no-pointer-events",n[6])},m(d,m){k(d,e,m),e.checked=n[0],k(d,i,m),k(d,l,m),y(l,s),k(d,o,m),k(d,a,m),f||(c=[H(e,"change",n[25]),H(e,"change",n[26]),be(Oe.call(null,a,"Apply to all screens")),H(a,"click",Ze(we(n[27])))],f=!0)},p(d,m){m[1]&8192&&t!==(t=d[44])&&p(e,"id",t),m[0]&1&&(e.checked=d[0]),m[1]&8192&&r!==(r=d[44])&&p(l,"for",r),m[0]&64&&u!==(u="iconoir-keyframes txt-sm "+(d[6]?"txt-disabled":"link-hint"))&&p(a,"class",u),m[0]&64&&B(a,"no-pointer-events",d[6])},d(d){d&&(v(e),v(i),v(l),v(o),v(a)),f=!1,me(c)}}}function I2(n){let e,t,i,l,s,r,o;return{c(){e=w("div"),t=w("input"),l=I(),s=w("div"),s.textContent="px",p(t,"id",i=n[44]),p(t,"type","number"),p(t,"min","0"),p(s,"class","addon"),p(e,"class","field-group")},m(a,u){k(a,e,u),y(e,t),n[28](t),ge(t,n[9].fixedHeader),y(e,l),y(e,s),r||(o=H(t,"input",n[29]),r=!0)},p(a,u){u[1]&8192&&i!==(i=a[44])&&p(t,"id",i),u[0]&512&&vt(t.value)!==a[9].fixedHeader&&ge(t,a[9].fixedHeader)},d(a){a&&v(e),n[28](null),r=!1,o()}}}function j2(n){let e,t,i,l,s,r,o,a,u,f,c;return{c(){e=w("input"),i=I(),l=w("label"),s=te("Has fixed footer"),o=I(),a=w("i"),p(e,"type","checkbox"),p(e,"id",t=n[44]),p(l,"for",r=n[44]),p(a,"class",u="iconoir-keyframes txt-sm "+(n[6]?"txt-disabled":"link-hint")),B(a,"no-pointer-events",n[6])},m(d,m){k(d,e,m),e.checked=n[1],k(d,i,m),k(d,l,m),y(l,s),k(d,o,m),k(d,a,m),f||(c=[H(e,"change",n[30]),H(e,"change",n[31]),be(Oe.call(null,a,"Apply to all screens")),H(a,"click",Ze(we(n[32])))],f=!0)},p(d,m){m[1]&8192&&t!==(t=d[44])&&p(e,"id",t),m[0]&2&&(e.checked=d[1]),m[1]&8192&&r!==(r=d[44])&&p(l,"for",r),m[0]&64&&u!==(u="iconoir-keyframes txt-sm "+(d[6]?"txt-disabled":"link-hint"))&&p(a,"class",u),m[0]&64&&B(a,"no-pointer-events",d[6])},d(d){d&&(v(e),v(i),v(l),v(o),v(a)),f=!1,me(c)}}}function P2(n){let e,t,i,l,s,r,o;return{c(){e=w("div"),t=w("input"),l=I(),s=w("div"),s.textContent="px",p(t,"id",i=n[44]),p(t,"type","number"),p(t,"min","0"),p(s,"class","addon"),p(e,"class","field-group")},m(a,u){k(a,e,u),y(e,t),n[33](t),ge(t,n[9].fixedFooter),y(e,l),y(e,s),r||(o=H(t,"input",n[34]),r=!0)},p(a,u){u[1]&8192&&i!==(i=a[44])&&p(t,"id",i),u[0]&512&&vt(t.value)!==a[9].fixedFooter&&ge(t,a[9].fixedFooter)},d(a){a&&v(e),n[33](null),r=!1,o()}}}function N2(n){let e,t,i,l,s,r,o,a;return{c(){e=w("input"),i=I(),l=w("label"),s=te("Replace screen"),p(e,"type","file"),p(e,"id",t=n[44]),p(e,"class","hidden"),p(l,"for",r=n[44]),p(l,"class","link-hint txt-sm")},m(u,f){k(u,e,f),k(u,i,f),k(u,l,f),y(l,s),o||(a=H(e,"change",n[35]),o=!0)},p(u,f){f[1]&8192&&t!==(t=u[44])&&p(e,"id",t),f[1]&8192&&r!==(r=u[44])&&p(l,"for",r)},d(u){u&&(v(e),v(i),v(l)),o=!1,a()}}}function A2(n){let e,t,i,l,s,r,o,a,u,f,c,d,m,h,_,b,g,T,L,O,C,S,P,R,A,D,M,Z,Y;return i=new Ce({props:{class:"form-field required",name:"title",$$slots:{default:[O2,({uniqueId:z})=>({44:z}),({uniqueId:z})=>[0,z?8192:0]]},$$scope:{ctx:n}}}),r=new Ce({props:{class:"form-field form-field-sm",name:"alignment",$$slots:{default:[C2,({uniqueId:z})=>({44:z}),({uniqueId:z})=>[0,z?8192:0]]},$$scope:{ctx:n}}}),u=new Ce({props:{class:"form-field form-field-sm",name:"background",$$slots:{default:[E2,({uniqueId:z})=>({44:z}),({uniqueId:z})=>[0,z?8192:0]]},$$scope:{ctx:n}}}),d=new Ce({props:{class:"form-field form-field-sm form-field-toggle",$$slots:{default:[L2,({uniqueId:z})=>({44:z}),({uniqueId:z})=>[0,z?8192:0]]},$$scope:{ctx:n}}}),_=new Ce({props:{class:"form-field form-field-sm form-field-sm "+(n[0]?"":"invisible"),name:"fixedHeader",$$slots:{default:[I2,({uniqueId:z})=>({44:z}),({uniqueId:z})=>[0,z?8192:0]]},$$scope:{ctx:n}}}),T=new Ce({props:{class:"form-field form-field-sm form-field-toggle",$$slots:{default:[j2,({uniqueId:z})=>({44:z}),({uniqueId:z})=>[0,z?8192:0]]},$$scope:{ctx:n}}}),C=new Ce({props:{class:"form-field form-field-sm form-field-sm "+(n[1]?"":"invisible"),name:"fixedFooter",$$slots:{default:[P2,({uniqueId:z})=>({44:z}),({uniqueId:z})=>[0,z?8192:0]]},$$scope:{ctx:n}}}),D=new Ce({props:{class:"block",name:"file",$$slots:{default:[N2,({uniqueId:z})=>({44:z}),({uniqueId:z})=>[0,z?8192:0]]},$$scope:{ctx:n}}}),{c(){e=w("form"),t=w("div"),F(i.$$.fragment),l=I(),s=w("div"),F(r.$$.fragment),o=I(),a=w("div"),F(u.$$.fragment),f=I(),c=w("div"),F(d.$$.fragment),m=I(),h=w("div"),F(_.$$.fragment),b=I(),g=w("div"),F(T.$$.fragment),L=I(),O=w("div"),F(C.$$.fragment),S=I(),P=w("hr"),R=I(),A=w("div"),F(D.$$.fragment),p(t,"class","col-12"),p(s,"class","col-6"),p(a,"class","col-6"),p(c,"class","col-6 flex-align-self-center"),p(h,"class","col-6"),p(g,"class","col-6 flex-align-self-center"),p(O,"class","col-6"),p(A,"class","block"),p(e,"class","grid grid-sm")},m(z,N){k(z,e,N),y(e,t),q(i,t,null),y(e,l),y(e,s),q(r,s,null),y(e,o),y(e,a),q(u,a,null),y(e,f),y(e,c),q(d,c,null),y(e,m),y(e,h),q(_,h,null),y(e,b),y(e,g),q(T,g,null),y(e,L),y(e,O),q(C,O,null),y(e,S),y(e,P),y(e,R),y(e,A),q(D,A,null),n[36](e),M=!0,Z||(Y=[H(e,"change",n[13]),H(e,"submit",we(n[14])),H(e,"click",Ze(n[19]))],Z=!0)},p(z,N){const W={};N[0]&512|N[1]&270336&&(W.$$scope={dirty:N,ctx:z}),i.$set(W);const ne={};N[0]&576|N[1]&262144&&(ne.$$scope={dirty:N,ctx:z}),r.$set(ne);const X={};N[0]&576|N[1]&270336&&(X.$$scope={dirty:N,ctx:z}),u.$set(X);const U={};N[0]&593|N[1]&270336&&(U.$$scope={dirty:N,ctx:z}),d.$set(U);const de={};N[0]&1&&(de.class="form-field form-field-sm form-field-sm "+(z[0]?"":"invisible")),N[0]&528|N[1]&270336&&(de.$$scope={dirty:N,ctx:z}),_.$set(de);const re={};N[0]&610|N[1]&270336&&(re.$$scope={dirty:N,ctx:z}),T.$set(re);const pe={};N[0]&2&&(pe.class="form-field form-field-sm form-field-sm "+(z[1]?"":"invisible")),N[0]&544|N[1]&270336&&(pe.$$scope={dirty:N,ctx:z}),C.$set(pe);const Ee={};N[0]&768|N[1]&270336&&(Ee.$$scope={dirty:N,ctx:z}),D.$set(Ee)},i(z){M||(E(i.$$.fragment,z),E(r.$$.fragment,z),E(u.$$.fragment,z),E(d.$$.fragment,z),E(_.$$.fragment,z),E(T.$$.fragment,z),E(C.$$.fragment,z),E(D.$$.fragment,z),M=!0)},o(z){j(i.$$.fragment,z),j(r.$$.fragment,z),j(u.$$.fragment,z),j(d.$$.fragment,z),j(_.$$.fragment,z),j(T.$$.fragment,z),j(C.$$.fragment,z),j(D.$$.fragment,z),M=!1},d(z){z&&v(e),$(i),$(r),$(u),$(d),$(_),$(T),$(C),$(D),n[36](null),Z=!1,me(Y)}}}function D2(n){let e,t,i,l,s,r,o,a;function u(h,_){return h[6]?T2:S2}let f=u(n),c=f(n);function d(h){n[38](h)}let m={class:"screen-settings",focusHide:!n[8],$$slots:{default:[A2]},$$scope:{ctx:n}};return n[7]!==void 0&&(m.active=n[7]),i=new Rt({props:m}),n[37](i),le.push(()=>Ae(i,"active",d)),i.$on("show",n[11]),i.$on("hide",n[12]),{c(){e=w("div"),c.c(),t=I(),F(i.$$.fragment),p(e,"tabindex","0"),p(e,"class","btn btn-circle btn-hint txt-hint btn-transparent btn-screen-settings")},m(h,_){k(h,e,_),c.m(e,null),y(e,t),q(i,e,null),r=!0,o||(a=be(s=Oe.call(null,e,n[7]?void 0:{position:"top",text:"Screen settings"})),o=!0)},p(h,_){f!==(f=u(h))&&(c.d(1),c=f(h),c&&(c.c(),c.m(e,t)));const b={};_[0]&256&&(b.focusHide=!h[8]),_[0]&891|_[1]&262144&&(b.$$scope={dirty:_,ctx:h}),!l&&_[0]&128&&(l=!0,b.active=h[7],Ne(()=>l=!1)),i.$set(b),s&&et(s.update)&&_[0]&128&&s.update.call(null,h[7]?void 0:{position:"top",text:"Screen settings"})},i(h){r||(E(i.$$.fragment,h),r=!0)},o(h){j(i.$$.fragment,h),r=!1},d(h){h&&v(e),c.d(),n[37](null),$(i),o=!1,a()}}}function M2(n,e,t){let i,l,s,r;ee(n,pt,oe=>t(41,l=oe)),ee(n,Ke,oe=>t(9,s=oe)),ee(n,Yl,oe=>t(18,r=oe));const o=it(),a={left:"Left",center:"Center",right:"Right"};let u,f,c,d,m=!1,h=!1,_=!1,b=!1,g=!1,T;function L(){u==null||u.show()}function O(){u==null||u.hide()}P();function C(){Jt({}),t(8,g=!1),P()}function S(){(i||s.id&&f&&!f.reportValidity())&&L()}function P(){t(0,_=s.fixedHeader>0),t(1,b=s.fixedFooter>0)}function R(){clearTimeout(T),T=setTimeout(A,100)}async function A(){if(f!=null&&f.reportValidity()){t(6,m=!0);try{const oe=await V.collection("screens").update(s.id,s);Nn(oe),o("save",oe),t(6,m=!1)}catch(oe){L(),oe!=null&&oe.isAbort||(t(6,m=!1),V.error(oe))}}}async function D(oe,x){t(6,m=!0);const je={};je[oe]=x;try{const Re=[];for(let Xe of l)Re.push(V.collection("screens").update(Xe.id,je,{requestKey:"bulk_update_prop_"+oe+Xe.id}));await Promise.all(Re).then(Xe=>{for(let bt of Xe)Nn(bt)}),_t("Successfully bulk applied the screen setting."),t(6,m=!1)}catch(Re){Re!=null&&Re.isAbort||(t(6,m=!1),V.error(Re))}}function M(oe){$e.call(this,n,oe)}function Z(){s.title=this.value,Ke.set(s)}const Y=()=>{D("alignment",s.alignment)},z=oe=>{ke(Ke,s.alignment=oe,s),A()},N=()=>{D("background",s.background)};function W(){s.background=this.value,Ke.set(s)}function ne(){_=this.checked,t(0,_)}const X=oe=>{oe.target.checked&&oe.stopPropagation(),c==null||c.select()},U=()=>D("fixedHeader",s.fixedHeader);function de(oe){le[oe?"unshift":"push"](()=>{c=oe,t(4,c)})}function re(){s.fixedHeader=vt(this.value),Ke.set(s)}function pe(){b=this.checked,t(1,b)}const Ee=oe=>{oe.target.checked&&oe.stopPropagation(),d==null||d.select()},tt=()=>D("fixedFooter",s.fixedFooter);function ut(oe){le[oe?"unshift":"push"](()=>{d=oe,t(5,d)})}function lt(){s.fixedFooter=vt(this.value),Ke.set(s)}const dt=oe=>{oe.target.files.length&&(t(8,g=!0),rr(s,oe.target.files[0]).finally(()=>{t(8,g=!1)}))};function se(oe){le[oe?"unshift":"push"](()=>{f=oe,t(3,f)})}function J(oe){le[oe?"unshift":"push"](()=>{u=oe,t(2,u)})}function G(oe){h=oe,t(7,h)}return n.$$.update=()=>{n.$$.dirty[0]&262144&&(i=!K.isEmpty(r)),n.$$.dirty[0]&1&&(_||ke(Ke,s.fixedHeader=0,s)),n.$$.dirty[0]&2&&(b||ke(Ke,s.fixedFooter=0,s))},[_,b,u,f,c,d,m,h,g,s,a,C,S,R,A,D,L,O,r,M,Z,Y,z,N,W,ne,X,U,de,re,pe,Ee,tt,ut,lt,dt,se,J,G]}class R2 extends ve{constructor(e){super(),ye(this,e,M2,D2,_e,{show:16,hide:17},null,[-1,-1])}get show(){return this.$$.ctx[16]}get hide(){return this.$$.ctx[17]}}function Fu(n,e,t){var s;const i=n.slice();i[18]=e[t],i[20]=e,i[21]=t;const l=(s=i[4].filter(function(...o){return n[14](i[18],...o)}))==null?void 0:s.length;return i[19]=l,i}function H2(n){let e,t,i,l,s,r,o,a;function u(...f){return n[10](n[18],...f)}return{c(){var f;e=w("input"),l=I(),s=w("label"),p(e,"type","checkbox"),p(e,"id",t=n[22]),e.checked=i=(f=n[18].screens)==null?void 0:f.includes(n[1].id),p(s,"for",r=n[22])},m(f,c){k(f,e,c),k(f,l,c),k(f,s,c),o||(a=H(e,"change",u),o=!0)},p(f,c){var d;n=f,c&4194304&&t!==(t=n[22])&&p(e,"id",t),c&6&&i!==(i=(d=n[18].screens)==null?void 0:d.includes(n[1].id))&&(e.checked=i),c&4194304&&r!==(r=n[22])&&p(s,"for",r)},d(f){f&&(v(e),v(l),v(s)),o=!1,a()}}}function Wu(n,e){let t,i,l,s,r=e[18].title+"",o,a,u,f,c=e[19]+"",d,m,h,_,b,g;i=new Ce({props:{class:"form-field form-field-toggle form-field-auto m-0",$$slots:{default:[H2,({uniqueId:C})=>({22:C}),({uniqueId:C})=>C?4194304:0]},$$scope:{ctx:e}}});function T(...C){return e[11](e[18],...C)}function L(...C){return e[12](e[18],e[20],e[21],...C)}function O(){return e[13](e[18])}return{key:n,first:null,c(){t=w("div"),F(i.$$.fragment),l=I(),s=w("span"),o=te(r),u=I(),f=w("code"),d=te(c),m=I(),h=w("button"),h.innerHTML='<i class="iconoir-trash txt-xs"></i>',p(s,"class","template-title"),p(s,"contenteditable","true"),p(s,"data-placeholder",a=e[18].title),p(s,"title","Edit name"),p(f,"class","txt-hint"),p(h,"type","button"),p(h,"class","btn btn-circle btn-sm btn-danger btn-transparent m-l-auto link-fade delete-btn svelte-1ysnxpb"),p(t,"class","dropdown-item"),this.first=t},m(C,S){k(C,t,S),q(i,t,null),y(t,l),y(t,s),y(s,o),y(t,u),y(t,f),y(f,d),y(t,m),y(t,h),_=!0,b||(g=[H(s,"blur",T),H(s,"keydown",$2),H(s,"input",L),be(Oe.call(null,f,"Total hotspots")),H(h,"click",we(O)),H(t,"click",Ze(e[9]))],b=!0)},p(C,S){e=C;const P={};S&12582918&&(P.$$scope={dirty:S,ctx:e}),i.$set(P),(!_||S&4)&&r!==(r=e[18].title+"")&&Rf(o,r),(!_||S&4&&a!==(a=e[18].title))&&p(s,"data-placeholder",a),(!_||S&20)&&c!==(c=e[19]+"")&&Se(d,c)},i(C){_||(E(i.$$.fragment,C),_=!0)},o(C){j(i.$$.fragment,C),_=!1},d(C){C&&v(t),$(i),b=!1,me(g)}}}function U2(n){let e=[],t=new Map,i,l,s,r,o,a,u=Le(n[2]);const f=c=>c[18].id;for(let c=0;c<u.length;c+=1){let d=Fu(n,u,c),m=f(d);t.set(m,e[c]=Wu(m,d))}return{c(){for(let c=0;c<e.length;c+=1)e[c].c();i=I(),l=w("div"),s=w("button"),s.innerHTML='<i class="iconoir-plus"></i> <span class="txt">New hotspot template</span>',p(s,"type","button"),p(s,"class","btn btn-block btn-sm btn-success btn-semitransparent"),p(l,"class","block p-5"),B(l,"m-t-5",n[2].length)},m(c,d){for(let m=0;m<e.length;m+=1)e[m]&&e[m].m(c,d);k(c,i,d),k(c,l,d),y(l,s),r=!0,o||(a=H(s,"click",n[8]),o=!0)},p(c,d){d&4194550&&(u=Le(c[2]),ae(),e=St(e,d,f,1,c,u,t,i.parentNode,At,Wu,i,Fu),ue()),(!r||d&4)&&B(l,"m-t-5",c[2].length)},i(c){if(!r){for(let d=0;d<u.length;d+=1)E(e[d]);r=!0}},o(c){for(let d=0;d<e.length;d+=1)j(e[d]);r=!1},d(c){c&&(v(i),v(l));for(let d=0;d<e.length;d+=1)e[d].d(c);o=!1,a()}}}function q2(n){let e,t,i=n[3].length+"",l,s,r=n[3].length==1?"template":"templates",o,a,u,f,c,d;return c=new Rt({props:{class:"dropdown templates-dropdown dropdown-upside",focusHide:!1,disableHide:n[0],$$slots:{default:[U2]},$$scope:{ctx:n}}}),{c(){e=w("div"),t=w("strong"),l=te(i),s=te(" Applied hotspot "),o=te(r),a=I(),u=w("i"),f=I(),F(c.$$.fragment),p(u,"class","iconoir-nav-arrow-up"),p(e,"tabindex","0"),p(e,"type","button"),p(e,"class","btn btn-sm btn-hint txt-hint btn-transparent entrance-right")},m(m,h){k(m,e,h),y(e,t),y(t,l),y(e,s),y(e,o),y(e,a),y(e,u),y(e,f),q(c,e,null),d=!0},p(m,[h]){(!d||h&8)&&i!==(i=m[3].length+"")&&Se(l,i),(!d||h&8)&&r!==(r=m[3].length==1?"template":"templates")&&Se(o,r);const _={};h&1&&(_.disableHide=m[0]),h&8388630&&(_.$$scope={dirty:h,ctx:m}),c.$set(_)},i(m){d||(E(c.$$.fragment,m),d=!0)},o(m){j(c.$$.fragment,m),d=!1},d(m){m&&v(e),$(c)}}}const $2=n=>{n.code==="Enter"&&(n.preventDefault(),n.target.blur())};function F2(n,e,t){let i,l,s,r;ee(n,Ke,C=>t(1,i=C)),ee(n,dn,C=>t(2,l=C)),ee(n,J0,C=>t(3,s=C)),ee(n,yn,C=>t(4,r=C));const o=it();let a=!1,u=null;function f(C){clearTimeout(u),u=setTimeout(()=>{c(C)},100)}async function c(C){if(C!=null&&C.id){zi(C);try{C=await V.collection("hotspotTemplates").update(C.id,C),o("save",C)}catch(S){S.isAbort||V.error(S)}}}function d(C){if(a||!(C!=null&&C.id))return;let S=`Do you really want to delete template "${C.title}" and all of its hotspots?`;t(0,a=!0),Pt(S,()=>m(C),()=>{setTimeout(()=>{t(0,a=!1)},0)})}async function m(C){if(C!=null&&C.id){t(0,a=!0);try{await V.collection("hotspotTemplates").delete(C.id),o("delete",C),Id(C),t(0,a=!1)}catch(S){S.isAbort||(V.error(S),t(0,a=!1))}}}async function h(){let C="Template ",S="";for(let R=1;R<1e3&&(S=C+(l.length+R),!!l.find(A=>A.title==S));R++);let P={id:"auto"+K.randomString(11),prototype:i.prototype,screens:[i.id],title:S};zi(P);try{P=await V.collection("hotspotTemplates").create(P),zi(P),o("create",P)}catch(R){R.isAbort||V.error(R)}}Gt(()=>{u&&clearTimeout(u)});function _(C){$e.call(this,n,C)}return[a,i,l,s,r,f,c,d,h,_,(C,S)=>{S.target.checked?K.pushUnique(C.screens,i.id):K.removeByValue(C.screens,i.id),c(C)},(C,S)=>{var P;(P=S.target.textContent)!=null&&P.trim()||(S.target.textContent=C.title)},(C,S,P,R)=>{var D;const A=(D=R.target.textContent)==null?void 0:D.trim();A&&A!=C.title&&(ke(dn,S[P].title=A,l),f(C))},C=>d(C),(C,S)=>S.hotspotTemplate==C.id]}class W2 extends ve{constructor(e){super(),ye(this,e,F2,q2,_e,{})}}function V2(n){let e,t,i,l,s,r,o,a,u,f;return{c(){e=w("input"),i=I(),l=w("label"),s=te("Show hotspots ("),r=te(n[4]),o=te(")"),p(e,"type","checkbox"),p(e,"id",t=n[15]),p(l,"for",a=n[15])},m(c,d){k(c,e,d),n[8](e),e.checked=n[5],k(c,i,d),k(c,l,d),y(l,s),y(l,r),y(l,o),u||(f=H(e,"change",n[9]),u=!0)},p(c,d){d&32768&&t!==(t=c[15])&&p(e,"id",t),d&32&&(e.checked=c[5]),d&16&&Se(r,c[4]),d&32768&&a!==(a=c[15])&&p(l,"for",a)},d(c){c&&(v(e),v(i),v(l)),n[8](null),u=!1,f()}}}function z2(n){let e,t,i,l,s,r,o,a,u,f;return{c(){e=w("input"),i=I(),l=w("label"),s=te("Show notes ("),r=te(n[3]),o=te(")"),p(e,"type","checkbox"),p(e,"id",t=n[15]),p(l,"for",a=n[15])},m(c,d){k(c,e,d),n[11](e),e.checked=n[6],k(c,i,d),k(c,l,d),y(l,s),y(l,r),y(l,o),u||(f=H(e,"change",n[12]),u=!0)},p(c,d){d&32768&&t!==(t=c[15])&&p(e,"id",t),d&64&&(e.checked=c[6]),d&8&&Se(r,c[3]),d&32768&&a!==(a=c[15])&&p(l,"for",a)},d(c){c&&(v(e),v(i),v(l)),n[11](null),u=!1,f()}}}function B2(n){let e,t,i,l,s,r,o,a;return t=new Ce({props:{class:"form-field form-field-sm form-field-toggle m-0",$$slots:{default:[V2,({uniqueId:u})=>({15:u}),({uniqueId:u})=>u?32768:0]},$$scope:{ctx:n}}}),s=new Ce({props:{class:"form-field form-field-sm form-field-toggle m-0",$$slots:{default:[z2,({uniqueId:u})=>({15:u}),({uniqueId:u})=>u?32768:0]},$$scope:{ctx:n}}}),{c(){e=w("div"),F(t.$$.fragment),i=I(),l=w("div"),F(s.$$.fragment),p(e,"class","dropdown-item"),p(l,"class","dropdown-item")},m(u,f){k(u,e,f),q(t,e,null),k(u,i,f),k(u,l,f),q(s,l,null),r=!0,o||(a=[H(e,"click",Ze(n[10])),H(l,"click",Ze(n[13]))],o=!0)},p(u,f){const c={};f&98354&&(c.$$scope={dirty:f,ctx:u}),t.$set(c);const d={};f&98380&&(d.$$scope={dirty:f,ctx:u}),s.$set(d)},i(u){r||(E(t.$$.fragment,u),E(s.$$.fragment,u),r=!0)},o(u){j(t.$$.fragment,u),j(s.$$.fragment,u),r=!1},d(u){u&&(v(e),v(i),v(l)),$(t),$(s),o=!1,me(a)}}}function Z2(n){let e,t,i,l,s,r,o,a,u;function f(d){n[14](d)}let c={class:"dropdown dropdown-upside dropdown-nowrap",$$slots:{default:[B2]},$$scope:{ctx:n}};return n[0]!==void 0&&(c.active=n[0]),l=new Rt({props:c}),le.push(()=>Ae(l,"active",f)),{c(){e=w("div"),t=w("i"),i=I(),F(l.$$.fragment),p(t,"class","iconoir-switch-on"),p(e,"tabindex","0"),p(e,"type","button"),p(e,"class","btn btn-circle btn-hint txt-hint btn-transparent entrance-right")},m(d,m){k(d,e,m),y(e,t),y(e,i),q(l,e,null),o=!0,a||(u=be(r=Oe.call(null,e,n[0]?void 0:{position:"top",text:"Preview options"})),a=!0)},p(d,[m]){const h={};m&65662&&(h.$$scope={dirty:m,ctx:d}),!s&&m&1&&(s=!0,h.active=d[0],Ne(()=>s=!1)),l.$set(h),r&&et(r.update)&&m&1&&r.update.call(null,d[0]?void 0:{position:"top",text:"Preview options"})},i(d){o||(E(l.$$.fragment,d),o=!0)},o(d){j(l.$$.fragment,d),o=!1},d(d){d&&v(e),$(l),a=!1,u()}}}function Y2(n,e,t){let i,l,s,r,o;ee(n,Ad,T=>t(7,s=T)),ee(n,Pl,T=>t(5,r=T)),ee(n,Nl,T=>t(6,o=T));let a=!1,u,f;function c(T){le[T?"unshift":"push"](()=>{u=T,t(1,u)})}function d(){r=this.checked,Pl.set(r)}const m=()=>t(1,u.checked^=!0,u);function h(T){le[T?"unshift":"push"](()=>{f=T,t(2,f)})}function _(){o=this.checked,Nl.set(o)}const b=()=>t(2,f.checked^=!0,f);function g(T){a=T,t(0,a)}return n.$$.update=()=>{var T,L;n.$$.dirty&128&&t(4,i=((T=s==null?void 0:s.filter(O=>O.type!=xe.note))==null?void 0:T.length)||0),n.$$.dirty&128&&t(3,l=((L=s==null?void 0:s.filter(O=>O.type==xe.note))==null?void 0:L.length)||0)},[a,u,f,l,i,r,o,s,c,d,m,h,_,b,g]}class qd extends ve{constructor(e){super(),ye(this,e,Y2,Z2,_e,{})}}function Vu(n,e,t){const i=n.slice();return i[13]=e[t],i[15]=t,i}function ms(n){const e=n.slice(),t=e[3].filter(function(...l){return n[11](e[13],...l)}).length||0;return e[16]=t,e}function zu(n){let e,t,i,l,s,r,o,a,u,f,c,d,m=n[3].length&&Bu(n);function h(g,T){return g[5].length?G2:J2}let _=h(n),b=_(n);return{c(){e=w("aside"),t=w("header"),i=w("h6"),i.textContent="Screen comments",l=I(),s=w("button"),s.innerHTML='<i class="iconoir-xmark"></i>',r=I(),m&&m.c(),o=I(),a=w("div"),b.c(),p(s,"type","button"),p(s,"class","btn btn-sm btn-transparent btn-hint btn-circle close-btn"),p(t,"class","sidebar-section sidebar-header"),p(a,"class","sidebar-section sidebar-content"),p(e,"class","screen-preview-sidebar comments-sidebar")},m(g,T){k(g,e,T),y(e,t),y(t,i),y(t,l),y(t,s),y(t,r),m&&m.m(t,null),y(e,o),y(e,a),b.m(a,null),f=!0,c||(d=[be(Oe.call(null,s,{position:"left",text:"Close"})),H(s,"click",we(n[1])),H(e,"introend",K.triggerResize),H(e,"outroend",K.triggerResize)],c=!0)},p(g,T){g[3].length?m?(m.p(g,T),T&8&&E(m,1)):(m=Bu(g),m.c(),E(m,1),m.m(t,null)):m&&(ae(),j(m,1,1,()=>{m=null}),ue()),_===(_=h(g))&&b?b.p(g,T):(b.d(1),b=_(g),b&&(b.c(),b.m(a,null)))},i(g){f||(E(m),g&&kt(()=>{f&&(u||(u=ct(e,Et,{duration:200,axis:"x"},!0)),u.run(1))}),f=!0)},o(g){j(m),g&&(u||(u=ct(e,Et,{duration:200,axis:"x"},!1)),u.run(0)),f=!1},d(g){g&&v(e),m&&m.d(),b.d(),g&&u&&u.end(),c=!1,me(d)}}}function Bu(n){let e,t;return e=new Ce({props:{class:"form-field form-field-toggle m-t-xs m-b-5 entrance-top",$$slots:{default:[K2,({uniqueId:i})=>({17:i}),({uniqueId:i})=>i?131072:0]},$$scope:{ctx:n}}}),{c(){F(e.$$.fragment)},m(i,l){q(e,i,l),t=!0},p(i,l){const s={};l&393236&&(s.$$scope={dirty:l,ctx:i}),e.$set(s)},i(i){t||(E(e.$$.fragment,i),t=!0)},o(i){j(e.$$.fragment,i),t=!1},d(i){$(e,i)}}}function K2(n){let e,t,i,l,s,r,o,a,u,f,c;return{c(){e=w("input"),l=I(),s=w("label"),r=te("Show resolved comments ("),o=te(n[2]),a=te(")"),p(e,"type","checkbox"),p(e,"id",t=n[17]),e.disabled=i=n[2]==0,p(s,"for",u=n[17])},m(d,m){k(d,e,m),e.checked=n[4],k(d,l,m),k(d,s,m),y(s,r),y(s,o),y(s,a),f||(c=H(e,"change",n[10]),f=!0)},p(d,m){m&131072&&t!==(t=d[17])&&p(e,"id",t),m&4&&i!==(i=d[2]==0)&&(e.disabled=i),m&16&&(e.checked=d[4]),m&4&&Se(o,d[2]),m&131072&&u!==(u=d[17])&&p(s,"for",u)},d(d){d&&(v(e),v(l),v(s)),f=!1,c()}}}function G2(n){let e,t=[],i=new Map,l=Le(n[3]);const s=r=>r[13].id;for(let r=0;r<l.length;r+=1){let o=Vu(n,l,r),a=s(o);i.set(a,t[r]=Gu(a,o))}return{c(){e=w("div");for(let r=0;r<t.length;r+=1)t[r].c();p(e,"class","flex-list primary-comments-list entrance-top")},m(r,o){k(r,e,o);for(let a=0;a<t.length;a+=1)t[a]&&t[a].m(e,null)},p(r,o){o&88&&(l=Le(r[3]),t=St(t,o,s,1,r,l,i,e,Zf,Gu,null,Vu))},d(r){r&&v(e);for(let o=0;o<t.length;o+=1)t[o].d()}}}function J2(n){let e,t,i,l;function s(a,u){return!a[4]&&a[2]>0?Q2:X2}let r=s(n),o=r(n);return{c(){e=w("div"),t=w("div"),t.innerHTML='<i class="iconoir-message-alert"></i>',i=I(),l=w("div"),o.c(),p(t,"class","icon"),p(l,"class","title txt-disabled"),p(e,"class","placeholder-block entrance-top")},m(a,u){k(a,e,u),y(e,t),y(e,i),y(e,l),o.m(l,null)},p(a,u){r!==(r=s(a))&&(o.d(1),o=r(a),o&&(o.c(),o.m(l,null)))},d(a){a&&v(e),o.d()}}}function Zu(n){let e,t,i,l,s=n[15]+1+"",r,o,a,u=K.getCommentAuthor(n[13])+"",f,c,d,m,h=n[13].message+"",_,b,g,T,L=K.relativeDate(n[13].created)+"",O,C,S,P,R,A=n[13].resolved&&Yu(),D=n[16]>0&&Ku(n);function M(){return n[12](n[13])}return{c(){var Z;e=w("button"),t=w("div"),i=w("strong"),l=te("#"),r=te(s),o=I(),a=w("span"),f=te(u),c=I(),A&&A.c(),d=I(),m=w("div"),_=te(h),b=I(),g=w("div"),T=w("span"),O=te(L),C=I(),D&&D.c(),S=I(),p(i,"class","meta-item number"),p(a,"class","meta-item txt-ellipsis"),p(t,"class","meta"),p(m,"class","content"),p(T,"class","meta-item date"),p(g,"class","meta"),p(e,"type","button"),p(e,"class","bubble primary-comment"),B(e,"active",n[13].id==((Z=n[6])==null?void 0:Z.id))},m(Z,Y){k(Z,e,Y),y(e,t),y(t,i),y(i,l),y(i,r),y(t,o),y(t,a),y(a,f),y(t,c),A&&A.m(t,null),y(e,d),y(e,m),y(m,_),y(e,b),y(e,g),y(g,T),y(T,O),y(g,C),D&&D.m(g,null),y(e,S),P||(R=H(e,"click",we(M)),P=!0)},p(Z,Y){var z;n=Z,Y&8&&s!==(s=n[15]+1+"")&&Se(r,s),Y&8&&u!==(u=K.getCommentAuthor(n[13])+"")&&Se(f,u),n[13].resolved?A||(A=Yu(),A.c(),A.m(t,null)):A&&(A.d(1),A=null),Y&8&&h!==(h=n[13].message+"")&&Se(_,h),Y&8&&L!==(L=K.relativeDate(n[13].created)+"")&&Se(O,L),n[16]>0?D?D.p(n,Y):(D=Ku(n),D.c(),D.m(g,null)):D&&(D.d(1),D=null),Y&72&&B(e,"active",n[13].id==((z=n[6])==null?void 0:z.id))},d(Z){Z&&v(e),A&&A.d(),D&&D.d(),P=!1,R()}}}function Yu(n){let e,t,i;return{c(){e=w("span"),e.innerHTML='<i class="iconoir-double-check txt-success"></i>',p(e,"class","meta-item resolved m-l-auto")},m(l,s){k(l,e,s),t||(i=be(Oe.call(null,e,"Resolved")),t=!0)},d(l){l&&v(e),t=!1,i()}}}function Ku(n){let e,t=n[16]+"",i,l,s=n[16]==1?"reply":"replies",r;return{c(){e=w("span"),i=te(t),l=I(),r=te(s),p(e,"class","meta-item m-l-auto")},m(o,a){k(o,e,a),y(e,i),y(e,l),y(e,r)},p(o,a){a&8&&t!==(t=o[16]+"")&&Se(i,t),a&8&&s!==(s=o[16]==1?"reply":"replies")&&Se(r,s)},d(o){o&&v(e)}}}function Gu(n,e){let t,i,l=(e[4]||!e[13].resolved)&&Zu(ms(e));return{key:n,first:null,c(){t=De(),l&&l.c(),i=De(),this.first=t},m(s,r){k(s,t,r),l&&l.m(s,r),k(s,i,r)},p(s,r){e=s,e[4]||!e[13].resolved?l?l.p(ms(e),r):(l=Zu(ms(e)),l.c(),l.m(i.parentNode,i)):l&&(l.d(1),l=null)},d(s){s&&(v(t),v(i)),l&&l.d(s)}}}function X2(n){let e;return{c(){e=te("No comments found.")},m(t,i){k(t,e,i)},d(t){t&&v(e)}}}function Q2(n){let e;return{c(){e=te("All comments have been resolved.")},m(t,i){k(t,e,i)},d(t){t&&v(e)}}}function x2(n){let e,t,i=n[0]&&zu(n);return{c(){i&&i.c(),e=De()},m(l,s){i&&i.m(l,s),k(l,e,s),t=!0},p(l,[s]){l[0]?i?(i.p(l,s),s&1&&E(i,1)):(i=zu(l),i.c(),E(i,1),i.m(e.parentNode,e)):i&&(ae(),j(i,1,1,()=>{i=null}),ue())},i(l){t||(E(i),t=!0)},o(l){j(i),t=!1},d(l){l&&v(e),i&&i.d(l)}}}function ew(n,e,t){let i,l,s,r,o,a;ee(n,Wi,b=>t(4,r=b)),ee(n,Od,b=>t(9,o=b)),ee(n,Wt,b=>t(6,a=b));let{active:u=!1}=e;function f(){u?d():c()}function c(){t(0,u=!0)}function d(){t(0,u=!1)}function m(){r=this.checked,Wi.set(r)}const h=(b,g)=>g.replyTo==b.id,_=b=>{ke(Wt,a=b,a)};return n.$$set=b=>{"active"in b&&t(0,u=b.active)},n.$$.update=()=>{n.$$.dirty&512&&t(3,i=o==null?void 0:o.filter(b=>!!b.id)),n.$$.dirty&8&&t(2,l=i.filter(b=>b.resolved).length),n.$$.dirty&4&&l==0&&ke(Wi,r=!1,r),n.$$.dirty&24&&t(5,s=r?i:i.filter(b=>!b.resolved))},[u,d,l,i,r,s,a,f,c,o,m,h,_]}class $d extends ve{constructor(e){super(),ye(this,e,ew,x2,_e,{active:0,toggle:7,show:8,hide:1})}get toggle(){return this.$$.ctx[7]}get show(){return this.$$.ctx[8]}get hide(){return this.$$.ctx[1]}}function tw(n){let e;const t=n[15].default,i=st(t,n,n[19],null);return{c(){i&&i.c()},m(l,s){i&&i.m(l,s),e=!0},p(l,s){i&&i.p&&(!e||s&524288)&&ot(i,t,l,l[19],e?rt(t,l[19],s,null):at(l[19]),null)},i(l){e||(E(i,l),e=!0)},o(l){j(i,l),e=!1},d(l){i&&i.d(l)}}}function nw(n){let e,t,i,l,s,r;const o=[{class:"popover "+n[1]},{trigger:n[5]},n[8]];function a(f){n[17](f)}let u={$$slots:{default:[tw]},$$scope:{ctx:n}};for(let f=0;f<o.length;f+=1)u=Ue(u,o[f]);return n[0]!==void 0&&(u.active=n[0]),t=new Rt({props:u}),n[16](t),le.push(()=>Ae(t,"active",a)),t.$on("show",n[6]),t.$on("hide",n[7]),{c(){e=w("div"),F(t.$$.fragment),p(e,"class","popover-container"),B(e,"active",n[0])},m(f,c){k(f,e,c),q(t,e,null),n[18](e),l=!0,s||(r=[H(window,"resize",n[2]),H(window,"mainScreenLoaded",n[2])],s=!0)},p(f,[c]){const d=c&290?gt(o,[c&2&&{class:"popover "+f[1]},c&32&&{trigger:f[5]},c&256&&Nt(f[8])]):{};c&524288&&(d.$$scope={dirty:c,ctx:f}),!i&&c&1&&(i=!0,d.active=f[0],Ne(()=>i=!1)),t.$set(d),(!l||c&1)&&B(e,"active",f[0])},i(f){l||(E(t.$$.fragment,f),l=!0)},o(f){j(t.$$.fragment,f),l=!1},d(f){f&&v(e),n[16](null),$(t),n[18](null),s=!1,me(r)}}}let qn;function iw(){return qn=qn||document.querySelector(".popovers"),qn||(qn=document.createElement("div"),qn.classList.add("popovers"),document.body.appendChild(qn)),qn}function lw(n,e,t){const i=["active","vPadding","hPadding","class","show","hide","forceHide","throttleRefreshPosition","refreshPosition"];let l=ft(e,i),{$$slots:s={},$$scope:r}=e;const o=it();let{active:a=!1}=e,{vPadding:u=0}=e,{hPadding:f=0}=e,{class:c=void 0}=e,d,m,h,_,b,g;async function T(N,W=null){t(5,h=N),_=W||document.body,m==null||m.show()}function L(){m==null||m.hide()}function O(){m==null||m.forceHide()}function C(N=100){g||(g=setTimeout(()=>{g=null,S()},N))}function S(){if(!a||!h||!d)return;const N=d.offsetWidth,W=d.offsetHeight,ne=_||document.body,X=ne.clientWidth,U=ne.clientHeight;let de=0,re=0;const pe=h.getBoundingClientRect();de=pe.top+u,X-(pe.left+pe.width+f)>=N?re=pe.left+pe.width+f:pe.left-f>=N?re=pe.left-f-N:(re=pe.left+pe.width/2-N/2-f,de=pe.top+pe.height+u),re+N>X&&(re=X-N),re=re>=0?re:0,de+W>U&&(de=U-W),de=de>=0?de:0,t(3,d.style.top=(de<<0)+"px",d),t(3,d.style.left=(re<<0)+"px",d)}async function P(){M(),await Ot(),S(),A(),o("show")}function R(){M(),D(),o("hide")}function A(){D(),!(!h||!d)&&(b=new MutationObserver(()=>{C(50)}),b.observe(h,{attributeFilter:["width","height","style","display"],childList:!0,subtree:!0}),b.observe(d,{attributeFilter:["width","height"],childList:!0,subtree:!0}))}function D(){b==null||b.disconnect(),b=null}function M(){clearTimeout(g),g=null}gn(()=>{iw().appendChild(d),S();const N=()=>{C(100)};return document.body.addEventListener("scroll",N,!0),()=>{document.body.removeEventListener("scroll",N,!0),M(),D(),d==null||d.remove()}});function Z(N){le[N?"unshift":"push"](()=>{m=N,t(4,m)})}function Y(N){a=N,t(0,a)}function z(N){le[N?"unshift":"push"](()=>{d=N,t(3,d)})}return n.$$set=N=>{e=Ue(Ue({},e),Kt(N)),t(8,l=ft(e,i)),"active"in N&&t(0,a=N.active),"vPadding"in N&&t(9,u=N.vPadding),"hPadding"in N&&t(10,f=N.hPadding),"class"in N&&t(1,c=N.class),"$$scope"in N&&t(19,r=N.$$scope)},[a,c,S,d,m,h,P,R,l,u,f,T,L,O,C,s,Z,Y,z,r]}class Fd extends ve{constructor(e){super(),ye(this,e,lw,nw,_e,{active:0,vPadding:9,hPadding:10,class:1,show:11,hide:12,forceHide:13,throttleRefreshPosition:14,refreshPosition:2})}get show(){return this.$$.ctx[11]}get hide(){return this.$$.ctx[12]}get forceHide(){return this.$$.ctx[13]}get throttleRefreshPosition(){return this.$$.ctx[14]}get refreshPosition(){return this.$$.ctx[2]}}function Ju(n){let e,t,i,l,s;return l=new Rt({props:{class:"dropdown dropdown-sm comment-dropdown",$$slots:{default:[sw]},$$scope:{ctx:n}}}),{c(){e=w("button"),t=w("i"),i=I(),F(l.$$.fragment),p(t,"class","iconoir-more-horiz"),p(e,"type","button"),p(e,"class","btn btn-transparent btn-hint btn-xs btn-options"),p(e,"aria-label","Comment options")},m(r,o){k(r,e,o),y(e,t),y(e,i),q(l,e,null),s=!0},p(r,o){const a={};o&257&&(a.$$scope={dirty:o,ctx:r}),l.$set(a)},i(r){s||(E(l.$$.fragment,r),s=!0)},o(r){j(l.$$.fragment,r),s=!1},d(r){r&&v(e),$(l)}}}function sw(n){let e,t,i;return{c(){e=w("div"),e.innerHTML='<i class="iconoir-trash"></i> <span class="txt">Delete</span>',p(e,"class","dropdown-item link-danger")},m(l,s){k(l,e,s),t||(i=H(e,"click",n[6]),t=!0)},p:Q,d(l){l&&v(e),t=!1,i()}}}function rw(n){var D;let e,t,i,l,s,r,o,a=K.getCommentAuthor(n[0])+"",u,f,c,d=K.relativeDate(n[0].created)+"",m,h,_,b,g,T=n[0].message+"",L,O,C,S;t=new il({props:{user:(D=n[0].expand)==null?void 0:D.user,class:"avatar"}});let P=!n[1]&&Ju(n);const R=n[5].default,A=st(R,n,n[8],null);return{c(){e=w("div"),F(t.$$.fragment),i=I(),l=w("div"),s=w("div"),r=w("div"),o=w("small"),u=te(a),f=I(),c=w("small"),m=te(d),h=I(),P&&P.c(),_=I(),b=w("div"),g=w("div"),L=te(T),O=I(),A&&A.c(),p(o,"class","name"),p(c,"class","txt-xs txt-hint date"),p(r,"class","inline-flex flex-row-gap-0"),p(s,"class","row"),p(g,"class","message"),p(b,"class","row"),p(l,"class","content"),p(e,"class",C="list-item "+(n[0].replyTo?"reply":"primary")),B(e,"unread",!1)},m(M,Z){k(M,e,Z),q(t,e,null),y(e,i),y(e,l),y(l,s),y(s,r),y(r,o),y(o,u),y(r,f),y(r,c),y(c,m),y(s,h),P&&P.m(s,null),y(l,_),y(l,b),y(b,g),y(g,L),y(l,O),A&&A.m(l,null),n[7](e),S=!0},p(M,[Z]){var z;const Y={};Z&1&&(Y.user=(z=M[0].expand)==null?void 0:z.user),t.$set(Y),(!S||Z&1)&&a!==(a=K.getCommentAuthor(M[0])+"")&&Se(u,a),(!S||Z&1)&&d!==(d=K.relativeDate(M[0].created)+"")&&Se(m,d),M[1]?P&&(ae(),j(P,1,1,()=>{P=null}),ue()):P?(P.p(M,Z),Z&2&&E(P,1)):(P=Ju(M),P.c(),E(P,1),P.m(s,null)),(!S||Z&1)&&T!==(T=M[0].message+"")&&Se(L,T),A&&A.p&&(!S||Z&256)&&ot(A,R,M,M[8],S?rt(R,M[8],Z,null):at(M[8]),null),(!S||Z&1&&C!==(C="list-item "+(M[0].replyTo?"reply":"primary")))&&p(e,"class",C),(!S||Z&1)&&B(e,"unread",!1)},i(M){S||(E(t.$$.fragment,M),E(P),E(A,M),S=!0)},o(M){j(t.$$.fragment,M),j(P),j(A,M),S=!1},d(M){M&&v(e),$(t),P&&P.d(),A&&A.d(M),n[7](null)}}}function ow(n,e,t){let i,l;ee(n,$n,b=>t(9,i=b)),ee(n,Wt,b=>t(4,l=b));let{$$slots:s={},$$scope:r}=e;const o=it();let{comment:a}=e,{readonly:u=!1}=e,f;async function c(){await Ot(),f==null||f.scrollIntoView({block:"nearest",inline:"nearest"})}function d(){if(!(a!=null&&a.id)||u)return;let b="Do you really want to delete the selected comment?";a.replyTo||(b="Do you really want to delete the selected comment and all of its replies?"),ke($n,i=!0,i),Pt(b,async()=>m(),()=>{setTimeout(()=>{ke($n,i=!1,i)},0)})}async function m(){if(!(!(a!=null&&a.id)||u)){ke($n,i=!0,i);try{await V.collection("comments").delete(a.id),o("delete",a),Td(a)}catch(b){b.isAbort||V.error(b)}ke($n,i=!1,i)}}const h=()=>d();function _(b){le[b?"unshift":"push"](()=>{f=b,t(2,f)})}return n.$$set=b=>{"comment"in b&&t(0,a=b.comment),"readonly"in b&&t(1,u=b.readonly),"$$scope"in b&&t(8,r=b.$$scope)},n.$$.update=()=>{n.$$.dirty&21&&f&&(l==null?void 0:l.id)==a.id&&c()},[a,u,f,d,l,s,h,_,r]}class aw extends ve{constructor(e){super(),ye(this,e,ow,rw,_e,{comment:0,readonly:1})}}function Xu(n,e,t){const i=n.slice();return i[22]=e[t],i[23]=e,i[24]=t,i}function Qu(n){let e,t=Le(n[3]),i=[];for(let l=0;l<t.length;l+=1)i[l]=xu(Xu(n,t,l));return{c(){e=w("div");for(let l=0;l<i.length;l+=1)i[l].c();p(e,"class","dropdown dropdown-sm collaborators-dropdown")},m(l,s){k(l,e,s);for(let r=0;r<i.length;r+=1)i[r]&&i[r].m(e,null)},p(l,s){if(s&30){t=Le(l[3]);let r;for(r=0;r<t.length;r+=1){const o=Xu(l,t,r);i[r]?i[r].p(o,s):(i[r]=xu(o),i[r].c(),i[r].m(e,null))}for(;r<i.length;r+=1)i[r].d(1);i.length=t.length}},d(l){l&&v(e),ln(i,l)}}}function xu(n){let e,t,i=n[22].label+"",l,s,r=n[24],o,a;const u=()=>n[10](e,r),f=()=>n[10](null,r);function c(){return n[11](n[24])}return{c(){e=w("div"),t=te("+"),l=te(i),s=I(),p(e,"class","dropdown-item"),B(e,"focused",n[24]==n[1])},m(d,m){k(d,e,m),y(e,t),y(e,l),y(e,s),u(),o||(a=H(e,"click",we(c)),o=!0)},p(d,m){n=d,m&8&&i!==(i=n[22].label+"")&&Se(l,i),r!==n[24]&&(f(),r=n[24],u()),m&2&&B(e,"focused",n[24]==n[1])},d(d){d&&v(e),f(),o=!1,a()}}}function uw(n){let e,t=n[0]&&Qu(n);return{c(){t&&t.c(),e=De()},m(i,l){t&&t.m(i,l),k(i,e,l)},p(i,[l]){i[0]?t?t.p(i,l):(t=Qu(i),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},i:Q,o:Q,d(i){i&&v(e),t&&t.d(i)}}}function fw(n,e,t){const i=it();let{input:l}=e,{list:s=[]}=e,{triggers:r=["+","@"]}=e,o=!1,a=0,u=[],f=[];function c(){o||(t(0,o=!0),t(1,a=0),i("show"))}function d(){o&&(t(0,o=!1),i("hide"))}function m(A){A=typeof A<"u"?A:a;let D=g();if(!D.word||!l||!f[A])return;let M=l.value;t(5,l.value=M.substring(0,D.start)+r[0]+f[A].value+M.substring(D.end+1)+" ",l),l.dispatchEvent(new Event("input")),l.focus(),d()}function h(){a<=0?t(1,a=f.length-1):t(1,a--,a),b()}function _(){a>=f.length-1?t(1,a=0):t(1,a++,a),b()}function b(){var A;(A=u[a])==null||A.scrollIntoView({block:"nearest"})}function g(){const A=typeof l.selectionStart<"u"?l.selectionStart:l.value.length;return K.getWordInfoAt(l.value,A-1)}function T(){var D;const A=g();d(),A.word&&r.indexOf((D=A.word)==null?void 0:D[0])>=0&&(t(3,f=L(A.word.substring(1))),f.length&&c())}function L(A){if(A=(A||"").toLowerCase().replace(/\s+/g,""),!A)return s;const D=[];for(let M=s.length-1;M>=0;M--)(s[M].value+s[M].label||"").toLowerCase().replace(/\s+/g,"").indexOf(A)>=0&&D.push(s[M]);return D}function O(A){if(!o)return;let D=A.code;D=="Enter"?(A.preventDefault(),m()):D=="ArrowUp"?(A.preventDefault(),h()):D=="ArrowDown"&&(A.preventDefault(),_())}function C(){l==null||l.removeEventListener("input",T),l==null||l.removeEventListener("keydown",O)}function S(){C(),l.addEventListener("input",T),l.addEventListener("keydown",O)}Gt(()=>{C()});function P(A,D){le[A?"unshift":"push"](()=>{u[D]=A,t(2,u)})}const R=A=>m(A);return n.$$set=A=>{"input"in A&&t(5,l=A.input),"list"in A&&t(6,s=A.list),"triggers"in A&&t(7,r=A.triggers)},n.$$.update=()=>{n.$$.dirty&32&&l&&S()},[o,a,u,f,m,l,s,r,c,d,P,R]}class cw extends ve{constructor(e){super(),ye(this,e,fw,uw,_e,{input:5,list:6,triggers:7,show:8,hide:9})}get show(){return this.$$.ctx[8]}get hide(){return this.$$.ctx[9]}}function ef(n,e,t){const i=n.slice();return i[42]=e[t][0],i[43]=e[t][1],i}function tf(n,e,t){const i=n.slice();return i[46]=e[t],i}function nf(n){let e,t;return e=new Ce({props:{class:"form-field form-field-toggle form-field-sm resolved-checkbox",$$slots:{default:[dw,({uniqueId:i})=>({41:i}),({uniqueId:i})=>[0,i?1024:0]]},$$scope:{ctx:n}}}),{c(){F(e.$$.fragment)},m(i,l){q(e,i,l),t=!0},p(i,l){const s={};l[0]&16|l[1]&263168&&(s.$$scope={dirty:l,ctx:i}),e.$set(s)},i(i){t||(E(e.$$.fragment,i),t=!0)},o(i){j(e.$$.fragment,i),t=!1},d(i){$(e,i)}}}function dw(n){let e,t,i,l,s,r,o,a,u;return{c(){var f;e=w("input"),l=I(),s=w("label"),r=te("Mark as resolved"),p(e,"type","checkbox"),p(e,"id",t=n[41]),e.checked=i=(f=n[4])==null?void 0:f.resolved,p(s,"for",o=n[41])},m(f,c){k(f,e,c),k(f,l,c),k(f,s,c),y(s,r),a||(u=H(e,"change",n[24]),a=!0)},p(f,c){var d;c[1]&1024&&t!==(t=f[41])&&p(e,"id",t),c[0]&16&&i!==(i=(d=f[4])==null?void 0:d.resolved)&&(e.checked=i),c[1]&1024&&o!==(o=f[41])&&p(s,"for",o)},d(f){f&&(v(e),v(l),v(s)),a=!1,u()}}}function lf(n){let e,t,i=Le(n[7]),l=[];for(let r=0;r<i.length;r+=1)l[r]=sf(tf(n,i,r));const s=r=>j(l[r],1,1,()=>{l[r]=null});return{c(){e=w("div");for(let r=0;r<l.length;r+=1)l[r].c();p(e,"class","list comments-list")},m(r,o){k(r,e,o);for(let a=0;a<l.length;a+=1)l[a]&&l[a].m(e,null);t=!0},p(r,o){if(o[0]&136){i=Le(r[7]);let a;for(a=0;a<i.length;a+=1){const u=tf(r,i,a);l[a]?(l[a].p(u,o),E(l[a],1)):(l[a]=sf(u),l[a].c(),E(l[a],1),l[a].m(e,null))}for(ae(),a=i.length;a<l.length;a+=1)s(a);ue()}},i(r){if(!t){for(let o=0;o<i.length;o+=1)E(l[o]);t=!0}},o(r){l=l.filter(Boolean);for(let o=0;o<l.length;o+=1)j(l[o]);t=!1},d(r){r&&v(e),ln(l,r)}}}function sf(n){let e,t;return e=new aw({props:{readonly:!n[3],comment:n[46]}}),{c(){F(e.$$.fragment)},m(i,l){q(e,i,l),t=!0},p(i,l){const s={};l[0]&8&&(s.readonly=!i[3]),l[0]&128&&(s.comment=i[46]),e.$set(s)},i(i){t||(E(e.$$.fragment,i),t=!0)},o(i){j(e.$$.fragment,i),t=!1},d(i){$(e,i)}}}function rf(n){let e,t;return e=new Ce({props:{class:"form-field",name:"guestEmail",inlineError:!0,$$slots:{default:[pw,({uniqueId:i})=>({41:i}),({uniqueId:i})=>[0,i?1024:0]]},$$scope:{ctx:n}}}),{c(){F(e.$$.fragment)},m(i,l){q(e,i,l),t=!0},p(i,l){const s={};l[0]&18|l[1]&263168&&(s.$$scope={dirty:l,ctx:i}),e.$set(s)},i(i){t||(E(e.$$.fragment,i),t=!0)},o(i){j(e.$$.fragment,i),t=!1},d(i){$(e,i)}}}function pw(n){let e,t,i,l,s,r,o,a,u,f;return{c(){var c;e=w("div"),t=w("label"),i=w("i"),s=I(),r=w("input"),p(i,"class","iconoir-mail"),p(t,"class","addon"),p(t,"for",l=n[41]),p(r,"type","email"),p(r,"id",o=n[41]),p(r,"placeholder","Your email"),r.autofocus=a=!n[1]&&!((c=n[4])!=null&&c.id)?!0:null,p(e,"class","field-group")},m(c,d){var m;k(c,e,d),y(e,t),y(t,i),y(e,s),y(e,r),ge(r,n[1]),!n[1]&&!((m=n[4])!=null&&m.id)&&r.focus(),u||(f=H(r,"input",n[25]),u=!0)},p(c,d){var m;d[1]&1024&&l!==(l=c[41])&&p(t,"for",l),d[1]&1024&&o!==(o=c[41])&&p(r,"id",o),d[0]&18&&a!==(a=!c[1]&&!((m=c[4])!=null&&m.id)?!0:null)&&(r.autofocus=a),d[0]&2&&r.value!==c[1]&&ge(r,c[1])},d(c){c&&v(e),u=!1,f()}}}function of(n){let e,t=n[43]+"",i,l,s,r;function o(){return n[29](n[43])}return{c(){e=w("button"),i=te(t),l=I(),p(e,"type","button"),p(e,"title",n[42]),p(e,"class","emoji closable")},m(a,u){k(a,e,u),y(e,i),y(e,l),s||(r=H(e,"click",we(o)),s=!0)},p(a,u){n=a},d(a){a&&v(e),s=!1,r()}}}function mw(n){let e,t=Le(Object.entries(n[11])),i=[];for(let l=0;l<t.length;l+=1)i[l]=of(ef(n,t,l));return{c(){for(let l=0;l<i.length;l+=1)i[l].c();e=De()},m(l,s){for(let r=0;r<i.length;r+=1)i[r]&&i[r].m(l,s);k(l,e,s)},p(l,s){if(s[0]&2049){t=Le(Object.entries(l[11]));let r;for(r=0;r<t.length;r+=1){const o=ef(l,t,r);i[r]?i[r].p(o,s):(i[r]=of(o),i[r].c(),i[r].m(e.parentNode,e))}for(;r<i.length;r+=1)i[r].d(1);i.length=t.length}},d(l){l&&v(e),ln(i,l)}}}function hw(n){let e,t,i,l,s,r,o,a,u,f,c,d,m,h;return u=new Rt({props:{class:"dropdown emojis-dropdown",$$slots:{default:[mw]},$$scope:{ctx:n}}}),{c(){var _;e=w("textarea"),l=I(),s=w("div"),r=w("button"),o=w("i"),a=I(),F(u.$$.fragment),f=I(),c=w("button"),c.innerHTML='<i class="iconoir-send"></i>',p(e,"id",t=n[41]),e.autofocus=i=!n[9]&&!((_=n[4])!=null&&_.id)?!0:null,p(e,"placeholder","Write a comment (@ to mention)"),p(o,"class","iconoir-emoji"),p(r,"type","button"),p(r,"class","btn btn-transparent btn-hint btn-sm btn-circle"),r.disabled=n[2],p(c,"type","button"),p(c,"class","btn btn-transparent btn-hint btn-sm btn-circle"),B(c,"btn-loading",n[2]),p(s,"class","ctrls")},m(_,b){var g;k(_,e,b),n[26](e),ge(e,n[0]),k(_,l,b),k(_,s,b),y(s,r),y(r,o),y(r,a),q(u,r,null),y(s,f),y(s,c),d=!0,!n[9]&&!((g=n[4])!=null&&g.id)&&e.focus(),m||(h=[H(e,"input",n[27]),H(e,"keydown",n[28]),be(Oe.call(null,r,{position:"right",text:"Emojis"})),be(Oe.call(null,c,{position:"right",text:"Send (Ctrl + Enter)"})),H(c,"click",we(n[13]))],m=!0)},p(_,b){var T;(!d||b[1]&1024&&t!==(t=_[41]))&&p(e,"id",t),(!d||b[0]&528&&i!==(i=!_[9]&&!((T=_[4])!=null&&T.id)?!0:null))&&(e.autofocus=i),b[0]&1&&ge(e,_[0]);const g={};b[0]&1|b[1]&262144&&(g.$$scope={dirty:b,ctx:_}),u.$set(g),(!d||b[0]&4)&&(r.disabled=_[2]),(!d||b[0]&4)&&B(c,"btn-loading",_[2])},i(_){d||(E(u.$$.fragment,_),d=!0)},o(_){j(u.$$.fragment,_),d=!1},d(_){_&&(v(e),v(l),v(s)),n[26](null),$(u),m=!1,me(h)}}}function _w(n){var d;let e,t,i,l,s,r,o,a,u=((d=n[4])==null?void 0:d.id)&&nf(n),f=n[7].length&&lf(n),c=n[9]&&rf(n);return s=new Ce({props:{class:"form-field",name:"message",inlineError:!0,$$slots:{default:[hw,({uniqueId:m})=>({41:m}),({uniqueId:m})=>[0,m?1024:0]]},$$scope:{ctx:n}}}),o=new cw({props:{input:n[6],list:n[8]}}),o.$on("hide",n[30]),o.$on("show",n[31]),{c(){u&&u.c(),e=I(),f&&f.c(),t=I(),i=w("div"),c&&c.c(),l=I(),F(s.$$.fragment),r=I(),F(o.$$.fragment),p(i,"class","comment-form")},m(m,h){u&&u.m(m,h),k(m,e,h),f&&f.m(m,h),k(m,t,h),k(m,i,h),c&&c.m(i,null),y(i,l),q(s,i,null),y(i,r),q(o,i,null),a=!0},p(m,h){var g;(g=m[4])!=null&&g.id?u?(u.p(m,h),h[0]&16&&E(u,1)):(u=nf(m),u.c(),E(u,1),u.m(e.parentNode,e)):u&&(ae(),j(u,1,1,()=>{u=null}),ue()),m[7].length?f?(f.p(m,h),h[0]&128&&E(f,1)):(f=lf(m),f.c(),E(f,1),f.m(t.parentNode,t)):f&&(ae(),j(f,1,1,()=>{f=null}),ue()),m[9]?c?(c.p(m,h),h[0]&512&&E(c,1)):(c=rf(m),c.c(),E(c,1),c.m(i,l)):c&&(ae(),j(c,1,1,()=>{c=null}),ue());const _={};h[0]&597|h[1]&263168&&(_.$$scope={dirty:h,ctx:m}),s.$set(_);const b={};h[0]&64&&(b.input=m[6]),h[0]&256&&(b.list=m[8]),o.$set(b)},i(m){a||(E(u),E(f),E(c),E(s.$$.fragment,m),E(o.$$.fragment,m),a=!0)},o(m){j(u),j(f),j(c),j(s.$$.fragment,m),j(o.$$.fragment,m),a=!1},d(m){m&&(v(e),v(t),v(i)),u&&u.d(m),f&&f.d(m),c&&c.d(),$(s),$(o)}}}function gw(n){let e,t;const i=[{class:"comments-popover"},{disableHide:!n[10]},{escHide:n[10]},{vPadding:0},{hPadding:5},n[15]];let l={$$slots:{default:[_w]},$$scope:{ctx:n}};for(let s=0;s<i.length;s+=1)l=Ue(l,i[s]);return e=new Fd({props:l}),n[32](e),e.$on("hide",n[12]),{c(){F(e.$$.fragment)},m(s,r){q(e,s,r),t=!0},p(s,r){const o=r[0]&33792?gt(i,[i[0],r[0]&1024&&{disableHide:!s[10]},r[0]&1024&&{escHide:s[10]},i[3],i[4],r[0]&32768&&Nt(s[15])]):{};r[0]&1023|r[1]&262144&&(o.$$scope={dirty:r,ctx:s}),e.$set(o)},i(s){t||(E(e.$$.fragment,s),t=!0)},o(s){j(e.$$.fragment,s),t=!1},d(s){n[32](null),$(e,s)}}}const af="guestEmail";function bw(n,e,t){let i,l,s,r,o,a;const u=["viewport"];let f=ft(e,u),c,d,m,h,_,b,g,T;ee(n,xn,J=>t(18,c=J)),ee(n,Dn,J=>t(34,d=J)),ee(n,cn,J=>t(19,m=J)),ee(n,wn,J=>t(35,h=J)),ee(n,Wt,J=>t(20,_=J)),ee(n,Ke,J=>t(21,b=J)),ee(n,$n,J=>t(22,g=J)),ee(n,fr,J=>t(23,T=J));const L=it(),O={"+1":"👍","-1":"👎",ok:"👌",pray:"🙏",smile:"🙂",confused:"😕",thinking:"🤔",joy:"😂",hooray:"🎉",watching:"👀",love:"❤️",poop:"💩"};let{viewport:C=null}=e,S,P,R="",A="",D=[],M=!1,Z=[];async function Y(J){if(!J){S==null||S.forceHide();return}await Ot();const G=J.replyTo||J.id,oe=document.querySelector(`[data-comment-pin="${G}"]`);if(!oe){S==null||S.forceHide();return}N(),oe.scrollIntoView({block:"nearest",inline:"nearest"}),U(),S==null||S.show(oe,C),X()}function z(){Ps(),ke(Wt,_=null,_)}function N(J=!1){Jt({}),t(1,A=A||window.localStorage.getItem(af)||""),J?t(0,R=""):t(0,R=(""+R).trim()),t(2,M=!1)}async function W(){if(!s)return;t(2,M=!0);const J={screen:i==null?void 0:i.screen,left:i==null?void 0:i.left,top:i==null?void 0:i.top,replyTo:i==null?void 0:i.id,message:(""+R).trim()};o?J.user=c.id:c.email?J.guestEmail=c.email:J.guestEmail=A;try{const G=await V.collection("comments").create(J,{expand:"user"});N(!0),await Ot(),Ps(),Ti(G,!0),L("create",G)}catch(G){if(G.isAbort)return;J.guestEmail&&K.isEmpty(G.response.data)&&(G.response.data={guestEmail:{code:"invalid_guestEmail",message:"The guest email is invalid or it matches with one of project owners."}}),V.error(G),t(2,M=!1)}}async function ne(J=!0){if(!(M&&!i)){t(2,M=!0);try{const G=await V.collection("comments").update(i.id,{resolved:J},{expand:"user"});t(2,M=!1),await Ot(),J&&(S==null||S.forceHide()),Ti(G),L("resolved",G)}catch(G){G.isAbort||(V.error(G),t(2,M=!1))}}}async function X(){if(!o)return;const J=D.map(x=>x.id),G=h.filter(x=>J.includes(x.comment)),oe=[];for(let x of G)ar(x),oe.push(V.collection("notifications").update(x.id,{read:!0}));return Promise.allSettled(oe)}function U(){var oe,x,je;t(8,Z=[]);const J=[],G=(((oe=m==null?void 0:m.expand)==null?void 0:oe.users)||[]).slice();for(const Re of d)(x=Re.expand)!=null&&x.user?K.pushOrReplaceObject(G,(je=Re.expand)==null?void 0:je.user):Re.guestEmail&&K.pushUnique(J,Re.guestEmail);for(const Re of G){if(Re.id==(c==null?void 0:c.id))continue;const Xe=Re.name||Re.email;Z.push({label:Re.username+(Xe?` (${Xe})`:""),value:Re.username})}for(const Re of J)Re==A||Re==(c==null?void 0:c.email)||Z.push({label:Re,value:Re})}const de=J=>{ne(J.target.checked)};function re(){A=this.value,t(1,A)}function pe(J){le[J?"unshift":"push"](()=>{P=J,t(6,P)})}function Ee(){R=this.value,t(0,R)}const tt=J=>{J.ctrlKey&&J.code==="Enter"&&(J.preventDefault(),W())},ut=J=>{t(0,R+=J)},lt=async()=>{await Ot(),S==null||S.refreshPosition()},dt=async()=>{await Ot(),S==null||S.refreshPosition()};function se(J){le[J?"unshift":"push"](()=>{S=J,t(5,S)})}return n.$$set=J=>{e=Ue(Ue({},e),Kt(J)),t(15,f=ft(e,u)),"viewport"in J&&t(16,C=J.viewport)},n.$$.update=()=>{var J,G;n.$$.dirty[0]&9437184&&t(4,i=T.find(oe=>oe.id&&oe.id==(_==null?void 0:_.replyTo))||_),n.$$.dirty[0]&8388624&&t(17,l=i!=null&&i.id?T.filter(oe=>oe.replyTo===i.id):[]),n.$$.dirty[0]&131088&&t(7,D=i!=null&&i.id?[i].concat(l):[]),n.$$.dirty[0]&5&&(s=!M&&R!=""),n.$$.dirty[0]&4194308&&t(10,r=!M&&!g),n.$$.dirty[0]&3145728&&b&&Y(_),n.$$.dirty[0]&786432&&t(3,o=(c==null?void 0:c.id)&&((G=(J=m==null?void 0:m.expand)==null?void 0:J.users)==null?void 0:G.find(oe=>oe.id==c.id))),n.$$.dirty[0]&262152&&t(9,a=!o&&!(c!=null&&c.email)),n.$$.dirty[0]&2&&A&&window.localStorage.setItem(af,A)},[R,A,M,o,i,S,P,D,Z,a,r,O,z,W,ne,f,C,l,c,m,_,b,g,T,de,re,pe,Ee,tt,ut,lt,dt,se]}class Wd extends ve{constructor(e){super(),ye(this,e,bw,gw,_e,{viewport:16},null,[-1,-1])}}function ww(n){let e,t,i,l,s,r;return t=new Xt({props:{src:V.files.getURL(n[0],n[0].file,{thumb:"100x100t"}),alt:n[0].title}}),{c(){e=w("div"),F(t.$$.fragment),p(e,"class","thumb thumb-handle")},m(o,a){k(o,e,a),q(t,e,null),l=!0,s||(r=be(i=Oe.call(null,e,n[0].title)),s=!0)},p(o,[a]){const u={};a&1&&(u.src=V.files.getURL(o[0],o[0].file,{thumb:"100x100t"})),a&1&&(u.alt=o[0].title),t.$set(u),i&&et(i.update)&&a&1&&i.update.call(null,o[0].title)},i(o){l||(E(t.$$.fragment,o),l=!0)},o(o){j(t.$$.fragment,o),l=!1},d(o){o&&v(e),$(t),s=!1,r()}}}function yw(n,e,t){let{item:i={}}=e;return n.$$set=l=>{"item"in l&&t(0,i=l.item)},[i]}class vw extends ve{constructor(e){super(),ye(this,e,yw,ww,_e,{item:0})}}function kw(n){let e,t,i,l,s=n[0].title+"",r,o;return t=new Xt({props:{src:V.files.getURL(n[0],n[0].file,{thumb:"100x100t"}),alt:n[0].title}}),{c(){e=w("div"),F(t.$$.fragment),i=I(),l=w("span"),r=te(s),p(e,"class","thumb thumb-xs"),p(l,"class","txt title m-l-5")},m(a,u){k(a,e,u),q(t,e,null),k(a,i,u),k(a,l,u),y(l,r),o=!0},p(a,[u]){const f={};u&1&&(f.src=V.files.getURL(a[0],a[0].file,{thumb:"100x100t"})),u&1&&(f.alt=a[0].title),t.$set(f),(!o||u&1)&&s!==(s=a[0].title+"")&&Se(r,s)},i(a){o||(E(t.$$.fragment,a),o=!0)},o(a){j(t.$$.fragment,a),o=!1},d(a){a&&(v(e),v(i),v(l)),$(t)}}}function Sw(n,e,t){let{item:i={}}=e;return n.$$set=l=>{"item"in l&&t(0,i=l.item)},[i]}class Tw extends ve{constructor(e){super(),ye(this,e,Sw,kw,_e,{item:0})}}function Ow(n){let e,t,i,l,s,r,o;const a=[{id:n[6]},{searchable:!0},{class:"screens-select"},{items:n[3]},{noOptionsText:"No screens found"},{selectPlaceholder:"- Select screen -"},{labelComponent:Tw},{optionComponent:vw},{selectionKey:"id"},n[4]];function u(c){n[5](c)}let f={};for(let c=0;c<a.length;c+=1)f=Ue(f,a[c]);return n[0]!==void 0&&(f.keyOfSelected=n[0]),s=new pn({props:f}),le.push(()=>Ae(s,"keyOfSelected",u)),{c(){e=w("label"),t=te(n[1]),l=I(),F(s.$$.fragment),p(e,"for",i=n[6])},m(c,d){k(c,e,d),y(e,t),k(c,l,d),q(s,c,d),o=!0},p(c,d){(!o||d&2)&&Se(t,c[1]),(!o||d&64&&i!==(i=c[6]))&&p(e,"for",i);const m=d&88?gt(a,[d&64&&{id:c[6]},a[1],a[2],d&8&&{items:c[3]},a[4],a[5],a[6],a[7],a[8],d&16&&Nt(c[4])]):{};!r&&d&1&&(r=!0,m.keyOfSelected=c[0],Ne(()=>r=!1)),s.$set(m)},i(c){o||(E(s.$$.fragment,c),o=!0)},o(c){j(s.$$.fragment,c),o=!1},d(c){c&&(v(e),v(l)),$(s,c)}}}function Cw(n){let e,t;return e=new Ce({props:{class:"form-field required "+n[2],name:"settings.screen",$$slots:{default:[Ow,({uniqueId:i})=>({6:i}),({uniqueId:i})=>i?64:0]},$$scope:{ctx:n}}}),{c(){F(e.$$.fragment)},m(i,l){q(e,i,l),t=!0},p(i,[l]){const s={};l&4&&(s.class="form-field required "+i[2]),l&219&&(s.$$scope={dirty:l,ctx:i}),e.$set(s)},i(i){t||(E(e.$$.fragment,i),t=!0)},o(i){j(e.$$.fragment,i),t=!1},d(i){$(e,i)}}}function Ew(n,e,t){const i=["value","label","class"];let l=ft(e,i),s;ee(n,pt,f=>t(3,s=f));let{value:r}=e,{label:o="Screen"}=e,{class:a=""}=e;function u(f){r=f,t(0,r),t(3,s)}return n.$$set=f=>{e=Ue(Ue({},e),Kt(f)),t(4,l=ft(e,i)),"value"in f&&t(0,r=f.value),"label"in f&&t(1,o=f.label),"class"in f&&t(2,a=f.class)},n.$$.update=()=>{n.$$.dirty&9&&!r&&s.length&&t(0,r=s[0].id)},[r,o,a,s,l,u]}class Vd extends ve{constructor(e){super(),ye(this,e,Ew,Cw,_e,{value:0,label:1,class:2})}}function Lw(n){let e,t,i,l,s,r,o;function a(f){n[4](f)}let u={class:"duo-columns-dropdown",id:n[5],items:n[3]};return n[0]!==void 0&&(u.keyOfSelected=n[0]),s=new pn({props:u}),le.push(()=>Ae(s,"keyOfSelected",a)),{c(){e=w("label"),t=te(n[1]),l=I(),F(s.$$.fragment),p(e,"for",i=n[5])},m(f,c){k(f,e,c),y(e,t),k(f,l,c),q(s,f,c),o=!0},p(f,c){(!o||c&2)&&Se(t,f[1]),(!o||c&32&&i!==(i=f[5]))&&p(e,"for",i);const d={};c&32&&(d.id=f[5]),!r&&c&1&&(r=!0,d.keyOfSelected=f[0],Ne(()=>r=!1)),s.$set(d)},i(f){o||(E(s.$$.fragment,f),o=!0)},o(f){j(s.$$.fragment,f),o=!1},d(f){f&&(v(e),v(l)),$(s,f)}}}function Iw(n){let e,t;return e=new Ce({props:{class:"form-field "+n[2],name:"settings.transition",$$slots:{default:[Lw,({uniqueId:i})=>({5:i}),({uniqueId:i})=>i?32:0]},$$scope:{ctx:n}}}),{c(){F(e.$$.fragment)},m(i,l){q(e,i,l),t=!0},p(i,[l]){const s={};l&4&&(s.class="form-field "+i[2]),l&99&&(s.$$scope={dirty:l,ctx:i}),e.$set(s)},i(i){t||(E(e.$$.fragment,i),t=!0)},o(i){j(e.$$.fragment,i),t=!1},d(i){$(e,i)}}}function jw(n,e,t){const i=[{value:"",label:"None",icon:"iconoir-position-align"},{value:"fade",label:"Fade",icon:"iconoir-center-align"},{value:"slide-left",label:"Slide left",icon:"iconoir-align-left-box"},{value:"slide-right",label:"Slide right",icon:"iconoir-align-right-box"},{value:"slide-top",label:"Slide up",icon:"iconoir-align-top-box"},{value:"slide-bottom",label:"Slide down",icon:"iconoir-align-bottom-box"}];let{value:l=""}=e,{label:s="Transitions"}=e,{class:r=""}=e;function o(a){l=a,t(0,l)}return n.$$set=a=>{"value"in a&&t(0,l=a.value),"label"in a&&t(1,s=a.label),"class"in a&&t(2,r=a.class)},n.$$.update=()=>{n.$$.dirty&1&&(typeof l>"u"||l===null)&&t(0,l="")},[l,s,r,i,o]}class rl extends ve{constructor(e){super(),ye(this,e,jw,Iw,_e,{value:0,label:1,class:2})}}function Pw(n){let e,t,i,l,s,r,o;function a(f){n[4](f)}let u={class:"duo-columns-dropdown",id:n[5],items:n[3]};return n[0]!==void 0&&(u.keyOfSelected=n[0]),s=new pn({props:u}),le.push(()=>Ae(s,"keyOfSelected",a)),{c(){e=w("label"),t=te(n[1]),l=I(),F(s.$$.fragment),p(e,"for",i=n[5])},m(f,c){k(f,e,c),y(e,t),k(f,l,c),q(s,f,c),o=!0},p(f,c){(!o||c&2)&&Se(t,f[1]),(!o||c&32&&i!==(i=f[5]))&&p(e,"for",i);const d={};c&32&&(d.id=f[5]),!r&&c&1&&(r=!0,d.keyOfSelected=f[0],Ne(()=>r=!1)),s.$set(d)},i(f){o||(E(s.$$.fragment,f),o=!0)},o(f){j(s.$$.fragment,f),o=!1},d(f){f&&(v(e),v(l)),$(s,f)}}}function Nw(n){let e,t;return e=new Ce({props:{class:"form-field required "+n[2],name:"settings.overlayPosition",$$slots:{default:[Pw,({uniqueId:i})=>({5:i}),({uniqueId:i})=>i?32:0]},$$scope:{ctx:n}}}),{c(){F(e.$$.fragment)},m(i,l){q(e,i,l),t=!0},p(i,[l]){const s={};l&4&&(s.class="form-field required "+i[2]),l&99&&(s.$$scope={dirty:l,ctx:i}),e.$set(s)},i(i){t||(E(e.$$.fragment,i),t=!0)},o(i){j(e.$$.fragment,i),t=!1},d(i){$(e,i)}}}function Aw(n,e,t){const i=[{value:"top-left",label:"Top Left",icon:"iconoir-border-tl"},{value:"top-right",label:"Top Right",icon:"iconoir-border-tr"},{value:"bottom-left",label:"Bottom Left",icon:"iconoir-border-bl"},{value:"bottom-right",label:"Bottom Right",icon:"iconoir-border-br"},{value:"top-center",label:"Top Center",icon:"iconoir-border-top"},{value:"bottom-center",label:"Bottom Center",icon:"iconoir-border-bottom"},{value:"centered",label:"Centered",icon:"iconoir-border-inner"}];let{value:l}=e,{label:s="Position"}=e,{class:r=void 0}=e;function o(a){l=a,t(0,l)}return n.$$set=a=>{"value"in a&&t(0,l=a.value),"label"in a&&t(1,s=a.label),"class"in a&&t(2,r=a.class)},n.$$.update=()=>{n.$$.dirty&1&&(l||t(0,l="centered"))},[l,s,r,i,o]}class Dw extends ve{constructor(e){super(),ye(this,e,Aw,Nw,_e,{value:0,label:1,class:2})}}function uf(n){var ne;let e,t,i,l,s,r,o,a,u,f,c,d,m,h,_,b,g,T,L,O,C,S=n[4].id?"Save":"Create",P,R,A,D,M;i=new Ce({props:{class:"form-field hotspot-type-select",name:"type",$$slots:{default:[Mw,({uniqueId:X})=>({54:X}),({uniqueId:X})=>[0,X?8388608:0]]},$$scope:{ctx:n}}});const Z=[Vw,Ww,Fw,$w,qw,Uw,Hw,Rw],Y=[];function z(X,U){return X[4].type==xe.note?0:X[4].type==xe.screen?1:X[4].type==xe.overlay?2:X[4].type==xe.back?3:X[4].type==xe.next?4:X[4].type==xe.prev?5:X[4].type==xe.url?6:X[4].type==xe.scroll?7:-1}~(s=z(n))&&(r=Y[s]=Z[s](n)),u=new Ce({props:{class:"form-field form-field-toggle",name:"template",$$slots:{default:[Xw,({uniqueId:X})=>({54:X}),({uniqueId:X})=>[0,X?8388608:0]]},$$scope:{ctx:n}}});let N=n[4].hotspotTemplate&&ff(n),W=((ne=n[4])==null?void 0:ne.id)&&df(n);return{c(){e=w("form"),t=w("div"),F(i.$$.fragment),l=I(),r&&r.c(),o=I(),a=w("div"),F(u.$$.fragment),f=I(),N&&N.c(),c=I(),d=w("hr"),m=I(),h=w("footer"),_=w("button"),b=w("span"),b.textContent="Cancel",T=I(),W&&W.c(),L=I(),O=w("button"),C=w("span"),P=te(S),p(a,"class","col-12"),p(t,"class","grid grid-sm"),p(b,"class","txt"),p(_,"type","button"),p(_,"class","btn btn-sm btn-transparent"),_.disabled=g=n[0]||n[1],p(C,"class","txt"),p(O,"type","submit"),p(O,"class","btn btn-sm btn-primary btn-expanded-sm m-l-auto"),O.disabled=R=n[0]||n[1],B(O,"btn-loading",n[0]),p(h,"class","flex flex-gap-10")},m(X,U){k(X,e,U),y(e,t),q(i,t,null),y(t,l),~s&&Y[s].m(t,null),y(t,o),y(t,a),q(u,a,null),y(a,f),N&&N.m(a,null),y(e,c),y(e,d),y(e,m),y(e,h),y(h,_),y(_,b),y(h,T),W&&W.m(h,null),y(h,L),y(h,O),y(O,C),y(C,P),A=!0,D||(M=[H(_,"click",Ze(n[43])),H(e,"submit",we(n[12]))],D=!0)},p(X,U){var Ee;const de={};U[0]&144|U[1]&25165824&&(de.$$scope={dirty:U,ctx:X}),i.$set(de);let re=s;s=z(X),s===re?~s&&Y[s].p(X,U):(r&&(ae(),j(Y[re],1,1,()=>{Y[re]=null}),ue()),~s?(r=Y[s],r?r.p(X,U):(r=Y[s]=Z[s](X),r.c()),E(r,1),r.m(t,o)):r=null);const pe={};U[0]&280|U[1]&25165824&&(pe.$$scope={dirty:U,ctx:X}),u.$set(pe),X[4].hotspotTemplate?N?(N.p(X,U),U[0]&16&&E(N,1)):(N=ff(X),N.c(),E(N,1),N.m(a,null)):N&&(ae(),j(N,1,1,()=>{N=null}),ue()),(!A||U[0]&3&&g!==(g=X[0]||X[1]))&&(_.disabled=g),(Ee=X[4])!=null&&Ee.id?W?W.p(X,U):(W=df(X),W.c(),W.m(h,L)):W&&(W.d(1),W=null),(!A||U[0]&16)&&S!==(S=X[4].id?"Save":"Create")&&Se(P,S),(!A||U[0]&3&&R!==(R=X[0]||X[1]))&&(O.disabled=R),(!A||U[0]&1)&&B(O,"btn-loading",X[0])},i(X){A||(E(i.$$.fragment,X),E(r),E(u.$$.fragment,X),E(N),A=!0)},o(X){j(i.$$.fragment,X),j(r),j(u.$$.fragment,X),j(N),A=!1},d(X){X&&v(e),$(i),~s&&Y[s].d(),$(u),N&&N.d(),W&&W.d(),D=!1,me(M)}}}function Mw(n){let e,t,i;function l(r){n[20](r)}let s={id:n[54],items:n[7]};return n[4].type!==void 0&&(s.keyOfSelected=n[4].type),e=new pn({props:s}),le.push(()=>Ae(e,"keyOfSelected",l)),{c(){F(e.$$.fragment)},m(r,o){q(e,r,o),i=!0},p(r,o){const a={};o[1]&8388608&&(a.id=r[54]),o[0]&128&&(a.items=r[7]),!t&&o[0]&16&&(t=!0,a.keyOfSelected=r[4].type,Ne(()=>t=!1)),e.$set(a)},i(r){i||(E(e.$$.fragment,r),i=!0)},o(r){j(e.$$.fragment,r),i=!1},d(r){$(e,r)}}}function Rw(n){let e,t,i,l,s,r;return t=new Ce({props:{class:"form-field required",name:"settings.scrollTop",$$slots:{default:[zw,({uniqueId:o})=>({54:o}),({uniqueId:o})=>[0,o?8388608:0]]},$$scope:{ctx:n}}}),s=new Ce({props:{class:"form-field required",name:"settings.scrollLeft",$$slots:{default:[Bw,({uniqueId:o})=>({54:o}),({uniqueId:o})=>[0,o?8388608:0]]},$$scope:{ctx:n}}}),{c(){e=w("div"),F(t.$$.fragment),i=I(),l=w("div"),F(s.$$.fragment),p(e,"class","col-6"),p(l,"class","col-6")},m(o,a){k(o,e,a),q(t,e,null),k(o,i,a),k(o,l,a),q(s,l,null),r=!0},p(o,a){const u={};a[0]&16|a[1]&25165824&&(u.$$scope={dirty:a,ctx:o}),t.$set(u);const f={};a[0]&16|a[1]&25165824&&(f.$$scope={dirty:a,ctx:o}),s.$set(f)},i(o){r||(E(t.$$.fragment,o),E(s.$$.fragment,o),r=!0)},o(o){j(t.$$.fragment,o),j(s.$$.fragment,o),r=!1},d(o){o&&(v(e),v(i),v(l)),$(t),$(s)}}}function Hw(n){let e,t;return e=new Ce({props:{class:"form-field required",name:"settings.url",$$slots:{default:[Zw,({uniqueId:i})=>({54:i}),({uniqueId:i})=>[0,i?8388608:0]]},$$scope:{ctx:n}}}),{c(){F(e.$$.fragment)},m(i,l){q(e,i,l),t=!0},p(i,l){const s={};l[0]&16|l[1]&25165824&&(s.$$scope={dirty:l,ctx:i}),e.$set(s)},i(i){t||(E(e.$$.fragment,i),t=!0)},o(i){j(e.$$.fragment,i),t=!1},d(i){$(e,i)}}}function Uw(n){let e,t,i;function l(r){n[35](r)}let s={};return n[4].settings.transition!==void 0&&(s.value=n[4].settings.transition),e=new rl({props:s}),le.push(()=>Ae(e,"value",l)),{c(){F(e.$$.fragment)},m(r,o){q(e,r,o),i=!0},p(r,o){const a={};!t&&o[0]&16&&(t=!0,a.value=r[4].settings.transition,Ne(()=>t=!1)),e.$set(a)},i(r){i||(E(e.$$.fragment,r),i=!0)},o(r){j(e.$$.fragment,r),i=!1},d(r){$(e,r)}}}function qw(n){let e,t,i;function l(r){n[34](r)}let s={};return n[4].settings.transition!==void 0&&(s.value=n[4].settings.transition),e=new rl({props:s}),le.push(()=>Ae(e,"value",l)),{c(){F(e.$$.fragment)},m(r,o){q(e,r,o),i=!0},p(r,o){const a={};!t&&o[0]&16&&(t=!0,a.value=r[4].settings.transition,Ne(()=>t=!1)),e.$set(a)},i(r){i||(E(e.$$.fragment,r),i=!0)},o(r){j(e.$$.fragment,r),i=!1},d(r){$(e,r)}}}function $w(n){let e,t,i;function l(r){n[33](r)}let s={};return n[4].settings.transition!==void 0&&(s.value=n[4].settings.transition),e=new rl({props:s}),le.push(()=>Ae(e,"value",l)),{c(){F(e.$$.fragment)},m(r,o){q(e,r,o),i=!0},p(r,o){const a={};!t&&o[0]&16&&(t=!0,a.value=r[4].settings.transition,Ne(()=>t=!1)),e.$set(a)},i(r){i||(E(e.$$.fragment,r),i=!0)},o(r){j(e.$$.fragment,r),i=!1},d(r){$(e,r)}}}function Fw(n){let e,t,i,l,s,r,o,a,u,f,c,d,m,h,_;function b(S){n[24](S)}let g={};n[4].settings.screen!==void 0&&(g.value=n[4].settings.screen),e=new Vd({props:g}),le.push(()=>Ae(e,"value",b));function T(S){n[25](S)}let L={};n[4].settings.overlayPosition!==void 0&&(L.value=n[4].settings.overlayPosition),l=new Dw({props:L}),le.push(()=>Ae(l,"value",T)),o=new Ce({props:{class:"form-field",$$slots:{default:[Yw,({uniqueId:S})=>({54:S}),({uniqueId:S})=>[0,S?8388608:0]]},$$scope:{ctx:n}}});function O(S){n[30](S)}let C={};return n[4].settings.transition!==void 0&&(C.value=n[4].settings.transition),u=new rl({props:C}),le.push(()=>Ae(u,"value",O)),d=new Ce({props:{class:"form-field form-field-toggle",name:"settings.fixOverlay",$$slots:{default:[Kw,({uniqueId:S})=>({54:S}),({uniqueId:S})=>[0,S?8388608:0]]},$$scope:{ctx:n}}}),h=new Ce({props:{class:"form-field form-field-toggle",name:"settings.outsideClose",$$slots:{default:[Gw,({uniqueId:S})=>({54:S}),({uniqueId:S})=>[0,S?8388608:0]]},$$scope:{ctx:n}}}),{c(){F(e.$$.fragment),i=I(),F(l.$$.fragment),r=I(),F(o.$$.fragment),a=I(),F(u.$$.fragment),c=I(),F(d.$$.fragment),m=I(),F(h.$$.fragment)},m(S,P){q(e,S,P),k(S,i,P),q(l,S,P),k(S,r,P),q(o,S,P),k(S,a,P),q(u,S,P),k(S,c,P),q(d,S,P),k(S,m,P),q(h,S,P),_=!0},p(S,P){const R={};!t&&P[0]&16&&(t=!0,R.value=S[4].settings.screen,Ne(()=>t=!1)),e.$set(R);const A={};!s&&P[0]&16&&(s=!0,A.value=S[4].settings.overlayPosition,Ne(()=>s=!1)),l.$set(A);const D={};P[0]&16|P[1]&25165824&&(D.$$scope={dirty:P,ctx:S}),o.$set(D);const M={};!f&&P[0]&16&&(f=!0,M.value=S[4].settings.transition,Ne(()=>f=!1)),u.$set(M);const Z={};P[0]&16|P[1]&25165824&&(Z.$$scope={dirty:P,ctx:S}),d.$set(Z);const Y={};P[0]&16|P[1]&25165824&&(Y.$$scope={dirty:P,ctx:S}),h.$set(Y)},i(S){_||(E(e.$$.fragment,S),E(l.$$.fragment,S),E(o.$$.fragment,S),E(u.$$.fragment,S),E(d.$$.fragment,S),E(h.$$.fragment,S),_=!0)},o(S){j(e.$$.fragment,S),j(l.$$.fragment,S),j(o.$$.fragment,S),j(u.$$.fragment,S),j(d.$$.fragment,S),j(h.$$.fragment,S),_=!1},d(S){S&&(v(i),v(r),v(a),v(c),v(m)),$(e,S),$(l,S),$(o,S),$(u,S),$(d,S),$(h,S)}}}function Ww(n){let e,t,i,l,s,r;function o(c){n[22](c)}let a={};n[4].settings.screen!==void 0&&(a.value=n[4].settings.screen),e=new Vd({props:a}),le.push(()=>Ae(e,"value",o));function u(c){n[23](c)}let f={};return n[4].settings.transition!==void 0&&(f.value=n[4].settings.transition),l=new rl({props:f}),le.push(()=>Ae(l,"value",u)),{c(){F(e.$$.fragment),i=I(),F(l.$$.fragment)},m(c,d){q(e,c,d),k(c,i,d),q(l,c,d),r=!0},p(c,d){const m={};!t&&d[0]&16&&(t=!0,m.value=c[4].settings.screen,Ne(()=>t=!1)),e.$set(m);const h={};!s&&d[0]&16&&(s=!0,h.value=c[4].settings.transition,Ne(()=>s=!1)),l.$set(h)},i(c){r||(E(e.$$.fragment,c),E(l.$$.fragment,c),r=!0)},o(c){j(e.$$.fragment,c),j(l.$$.fragment,c),r=!1},d(c){c&&v(i),$(e,c),$(l,c)}}}function Vw(n){let e,t;return e=new Ce({props:{class:"form-field required",name:"settings.note",$$slots:{default:[Jw,({uniqueId:i})=>({54:i}),({uniqueId:i})=>[0,i?8388608:0]]},$$scope:{ctx:n}}}),{c(){F(e.$$.fragment)},m(i,l){q(e,i,l),t=!0},p(i,l){const s={};l[0]&16|l[1]&25165824&&(s.$$scope={dirty:l,ctx:i}),e.$set(s)},i(i){t||(E(e.$$.fragment,i),t=!0)},o(i){j(e.$$.fragment,i),t=!1},d(i){$(e,i)}}}function zw(n){let e,t,i,l,s,r,o,a,u,f,c,d,m;return{c(){e=w("label"),t=te("Vertical position"),l=I(),s=w("div"),r=w("input"),a=I(),u=w("label"),f=te("px"),p(e,"for",i=n[54]),p(r,"type","number"),p(r,"id",o=n[54]),p(r,"min","0"),r.required=!0,p(u,"for",c=n[54]),p(u,"class","addon"),p(s,"class","field-group")},m(h,_){k(h,e,_),y(e,t),k(h,l,_),k(h,s,_),y(s,r),ge(r,n[4].settings.scrollTop),y(s,a),y(s,u),y(u,f),d||(m=H(r,"input",n[37]),d=!0)},p(h,_){_[1]&8388608&&i!==(i=h[54])&&p(e,"for",i),_[1]&8388608&&o!==(o=h[54])&&p(r,"id",o),_[0]&16&&vt(r.value)!==h[4].settings.scrollTop&&ge(r,h[4].settings.scrollTop),_[1]&8388608&&c!==(c=h[54])&&p(u,"for",c)},d(h){h&&(v(e),v(l),v(s)),d=!1,m()}}}function Bw(n){let e,t,i,l,s,r,o,a,u,f,c,d,m;return{c(){e=w("label"),t=te("Horizontal position"),l=I(),s=w("div"),r=w("input"),a=I(),u=w("label"),f=te("px"),p(e,"for",i=n[54]),p(r,"type","number"),p(r,"id",o=n[54]),p(r,"min","0"),r.required=!0,p(u,"for",c=n[54]),p(u,"class","addon"),p(s,"class","field-group")},m(h,_){k(h,e,_),y(e,t),k(h,l,_),k(h,s,_),y(s,r),ge(r,n[4].settings.scrollLeft),y(s,a),y(s,u),y(u,f),d||(m=H(r,"input",n[38]),d=!0)},p(h,_){_[1]&8388608&&i!==(i=h[54])&&p(e,"for",i),_[1]&8388608&&o!==(o=h[54])&&p(r,"id",o),_[0]&16&&vt(r.value)!==h[4].settings.scrollLeft&&ge(r,h[4].settings.scrollLeft),_[1]&8388608&&c!==(c=h[54])&&p(u,"for",c)},d(h){h&&(v(e),v(l),v(s)),d=!1,m()}}}function Zw(n){let e,t,i,l,s,r,o,a,u;return{c(){e=w("label"),t=te("URL"),l=I(),s=w("div"),r=w("input"),p(e,"for",i=n[54]),p(r,"type","text"),p(r,"id",o=n[54]),r.required=!0,p(r,"placeholder","eg. https://google.com"),p(s,"class","field-group")},m(f,c){k(f,e,c),y(e,t),k(f,l,c),k(f,s,c),y(s,r),ge(r,n[4].settings.url),a||(u=H(r,"input",n[36]),a=!0)},p(f,c){c[1]&8388608&&i!==(i=f[54])&&p(e,"for",i),c[1]&8388608&&o!==(o=f[54])&&p(r,"id",o),c[0]&16&&r.value!==f[4].settings.url&&ge(r,f[4].settings.url)},d(f){f&&(v(e),v(l),v(s)),a=!1,u()}}}function Yw(n){let e,t,i,l,s,r,o,a,u,f,c,d,m,h,_,b,g,T,L,O,C,S,P,R,A,D,M,Z,Y,z,N,W,ne,X,U;return{c(){e=w("label"),t=te("Offset "),i=w("span"),i.textContent="(px)",s=I(),r=w("div"),o=w("label"),a=te("T"),f=I(),c=w("input"),m=I(),h=w("label"),_=te("B"),g=I(),T=w("input"),O=I(),C=w("label"),S=te("L"),R=I(),A=w("input"),M=I(),Z=w("label"),Y=te("R"),N=I(),W=w("input"),p(i,"class","txt-hint"),p(e,"for",l=n[54]),p(o,"for",u=n[54]+"_t"),p(o,"class","addon"),p(o,"title","Top offset"),p(c,"type","number"),p(c,"id",d=n[54]+"_t"),p(h,"for",b=n[54]+"_b"),p(h,"class","addon"),p(h,"title","Bottom offset"),p(T,"type","number"),p(T,"id",L=n[54]+"_b"),p(C,"for",P=n[54]+"_l"),p(C,"class","addon"),p(C,"title","Left offset"),p(A,"type","number"),p(A,"id",D=n[54]+"_l"),p(Z,"for",z=n[54]+"_r"),p(Z,"class","addon"),p(Z,"title","Right offset"),p(W,"type","number"),p(W,"id",ne=n[54]+"_r"),p(r,"class","field-group")},m(de,re){k(de,e,re),y(e,t),y(e,i),k(de,s,re),k(de,r,re),y(r,o),y(o,a),y(r,f),y(r,c),ge(c,n[4].settings.offsetTop),y(r,m),y(r,h),y(h,_),y(r,g),y(r,T),ge(T,n[4].settings.offsetBottom),y(r,O),y(r,C),y(C,S),y(r,R),y(r,A),ge(A,n[4].settings.offsetLeft),y(r,M),y(r,Z),y(Z,Y),y(r,N),y(r,W),ge(W,n[4].settings.offsetRight),X||(U=[H(c,"input",n[26]),H(T,"input",n[27]),H(A,"input",n[28]),H(W,"input",n[29])],X=!0)},p(de,re){re[1]&8388608&&l!==(l=de[54])&&p(e,"for",l),re[1]&8388608&&u!==(u=de[54]+"_t")&&p(o,"for",u),re[1]&8388608&&d!==(d=de[54]+"_t")&&p(c,"id",d),re[0]&16&&vt(c.value)!==de[4].settings.offsetTop&&ge(c,de[4].settings.offsetTop),re[1]&8388608&&b!==(b=de[54]+"_b")&&p(h,"for",b),re[1]&8388608&&L!==(L=de[54]+"_b")&&p(T,"id",L),re[0]&16&&vt(T.value)!==de[4].settings.offsetBottom&&ge(T,de[4].settings.offsetBottom),re[1]&8388608&&P!==(P=de[54]+"_l")&&p(C,"for",P),re[1]&8388608&&D!==(D=de[54]+"_l")&&p(A,"id",D),re[0]&16&&vt(A.value)!==de[4].settings.offsetLeft&&ge(A,de[4].settings.offsetLeft),re[1]&8388608&&z!==(z=de[54]+"_r")&&p(Z,"for",z),re[1]&8388608&&ne!==(ne=de[54]+"_r")&&p(W,"id",ne),re[0]&16&&vt(W.value)!==de[4].settings.offsetRight&&ge(W,de[4].settings.offsetRight)},d(de){de&&(v(e),v(s),v(r)),X=!1,me(U)}}}function Kw(n){let e,t,i,l,s,r,o,a;return{c(){e=w("input"),i=I(),l=w("label"),s=te("Fix position of overlay"),p(e,"type","checkbox"),p(e,"id",t=n[54]),p(l,"for",r=n[54])},m(u,f){k(u,e,f),e.checked=n[4].settings.fixOverlay,k(u,i,f),k(u,l,f),y(l,s),o||(a=H(e,"change",n[31]),o=!0)},p(u,f){f[1]&8388608&&t!==(t=u[54])&&p(e,"id",t),f[0]&16&&(e.checked=u[4].settings.fixOverlay),f[1]&8388608&&r!==(r=u[54])&&p(l,"for",r)},d(u){u&&(v(e),v(i),v(l)),o=!1,a()}}}function Gw(n){let e,t,i,l,s,r,o,a;return{c(){e=w("input"),i=I(),l=w("label"),s=te("Close on outside click"),p(e,"type","checkbox"),p(e,"id",t=n[54]),p(l,"for",r=n[54])},m(u,f){k(u,e,f),e.checked=n[4].settings.outsideClose,k(u,i,f),k(u,l,f),y(l,s),o||(a=H(e,"change",n[32]),o=!0)},p(u,f){f[1]&8388608&&t!==(t=u[54])&&p(e,"id",t),f[0]&16&&(e.checked=u[4].settings.outsideClose),f[1]&8388608&&r!==(r=u[54])&&p(l,"for",r)},d(u){u&&(v(e),v(i),v(l)),o=!1,a()}}}function Jw(n){let e,t,i,l,s,r;return{c(){e=w("textarea"),i=I(),l=w("div"),l.textContent="The note will be visible in Preview mode on hover.",p(e,"id",t=n[54]),e.required=!0,p(l,"class","help-block")},m(o,a){k(o,e,a),ge(e,n[4].settings.note),k(o,i,a),k(o,l,a),s||(r=H(e,"input",n[21]),s=!0)},p(o,a){a[1]&8388608&&t!==(t=o[54])&&p(e,"id",t),a[0]&16&&ge(e,o[4].settings.note)},d(o){o&&(v(e),v(i),v(l)),s=!1,r()}}}function Xw(n){let e,t,i,l,s,r,o,a,u,f,c;return{c(){e=w("input"),l=I(),s=w("label"),r=w("span"),r.textContent="Include in template",o=I(),a=w("i"),p(e,"type","checkbox"),p(e,"id",t=n[54]),e.checked=i=!!n[4].hotspotTemplate,p(r,"class","txt"),p(a,"class","iconoir-info-circle link-hint"),p(s,"for",u=n[54])},m(d,m){k(d,e,m),k(d,l,m),k(d,s,m),y(s,r),y(s,o),y(s,a),f||(c=[H(e,"change",n[39]),be(Oe.call(null,a,"Reuse the hotspot in other screens"))],f=!0)},p(d,m){m[1]&8388608&&t!==(t=d[54])&&p(e,"id",t),m[0]&16&&i!==(i=!!d[4].hotspotTemplate)&&(e.checked=i),m[1]&8388608&&u!==(u=d[54])&&p(s,"for",u)},d(d){d&&(v(e),v(l),v(s)),f=!1,me(c)}}}function ff(n){let e,t,i,l,s,r;i=new Ce({props:{class:"form-field form-field-sm",$$slots:{default:[Qw,({uniqueId:a})=>({54:a}),({uniqueId:a})=>[0,a?8388608:0]]},$$scope:{ctx:n}}});let o=n[4].hotspotTemplate==Rl&&cf(n);return{c(){e=w("div"),t=w("div"),F(i.$$.fragment),l=I(),o&&o.c(),p(t,"class","template-form svelte-1gupuaj"),p(e,"class","block p-t-xs")},m(a,u){k(a,e,u),y(e,t),q(i,t,null),y(t,l),o&&o.m(t,null),r=!0},p(a,u){const f={};u[0]&272|u[1]&25165824&&(f.$$scope={dirty:u,ctx:a}),i.$set(f),a[4].hotspotTemplate==Rl?o?(o.p(a,u),u[0]&16&&E(o,1)):(o=cf(a),o.c(),E(o,1),o.m(t,null)):o&&(ae(),j(o,1,1,()=>{o=null}),ue())},i(a){r||(E(i.$$.fragment,a),E(o),a&&kt(()=>{r&&(s||(s=ct(e,Et,{duration:150},!0)),s.run(1))}),r=!0)},o(a){j(i.$$.fragment,a),j(o),a&&(s||(s=ct(e,Et,{duration:150},!1)),s.run(0)),r=!1},d(a){a&&v(e),$(i),o&&o.d(),a&&s&&s.end()}}}function Qw(n){let e,t,i;function l(r){n[40](r)}let s={id:n[54],items:n[8],upside:!0};return n[4].hotspotTemplate!==void 0&&(s.keyOfSelected=n[4].hotspotTemplate),e=new pn({props:s}),le.push(()=>Ae(e,"keyOfSelected",l)),{c(){F(e.$$.fragment)},m(r,o){q(e,r,o),i=!0},p(r,o){const a={};o[1]&8388608&&(a.id=r[54]),o[0]&256&&(a.items=r[8]),!t&&o[0]&16&&(t=!0,a.keyOfSelected=r[4].hotspotTemplate,Ne(()=>t=!1)),e.$set(a)},i(r){i||(E(e.$$.fragment,r),i=!0)},o(r){j(e.$$.fragment,r),i=!1},d(r){$(e,r)}}}function cf(n){let e,t,i,l;return t=new Ce({props:{class:"form-field form-field-sm m-t-10",name:"title",$$slots:{default:[xw,({uniqueId:s})=>({54:s}),({uniqueId:s})=>[0,s?8388608:0]]},$$scope:{ctx:n}}}),{c(){e=w("div"),F(t.$$.fragment)},m(s,r){k(s,e,r),q(t,e,null),l=!0},p(s,r){const o={};r[0]&68|r[1]&25165824&&(o.$$scope={dirty:r,ctx:s}),t.$set(o)},i(s){l||(E(t.$$.fragment,s),s&&kt(()=>{l&&(i||(i=ct(e,Et,{duration:150},!0)),i.run(1))}),l=!0)},o(s){j(t.$$.fragment,s),s&&(i||(i=ct(e,Et,{duration:150},!1)),i.run(0)),l=!1},d(s){s&&v(e),$(t),s&&i&&i.end()}}}function xw(n){let e,t,i,l;return{c(){e=w("input"),p(e,"type","text"),p(e,"id",t=n[54]),p(e,"placeholder","Template name *")},m(s,r){k(s,e,r),n[41](e),ge(e,n[6]),i||(l=H(e,"input",n[42]),i=!0)},p(s,r){r[1]&8388608&&t!==(t=s[54])&&p(e,"id",t),r[0]&64&&e.value!==s[6]&&ge(e,s[6])},d(s){s&&v(e),n[41](null),i=!1,l()}}}function df(n){let e,t,i,l,s;return{c(){e=w("button"),t=w("i"),p(t,"class","iconoir-trash txt-sm"),p(e,"type","button"),p(e,"class","btn btn-sm btn-circle btn-transparent btn-danger fade"),e.disabled=i=n[0]||n[1]},m(r,o){k(r,e,o),y(e,t),l||(s=[be(Oe.call(null,e,"Delete hotspot")),H(e,"click",Ze(n[13]))],l=!0)},p(r,o){o[0]&3&&i!==(i=r[0]||r[1])&&(e.disabled=i)},d(r){r&&v(e),l=!1,me(s)}}}function ey(n){let e,t,i=n[4]&&uf(n);return{c(){i&&i.c(),e=De()},m(l,s){i&&i.m(l,s),k(l,e,s),t=!0},p(l,s){l[4]?i?(i.p(l,s),s[0]&16&&E(i,1)):(i=uf(l),i.c(),E(i,1),i.m(e.parentNode,e)):i&&(ae(),j(i,1,1,()=>{i=null}),ue())},i(l){t||(E(i),t=!0)},o(l){j(i),t=!1},d(l){l&&v(e),i&&i.d(l)}}}function ty(n){let e,t;const i=[{class:"hotspots-popover "+(n[10]?"resizing":"")},{disableHide:!n[9]},{vPadding:0},{hPadding:5},{closableToggle:!1},n[14]];let l={$$slots:{default:[ey]},$$scope:{ctx:n}};for(let s=0;s<i.length;s+=1)l=Ue(l,i[s]);return e=new Fd({props:l}),n[44](e),e.$on("hide",n[11]),{c(){F(e.$$.fragment)},m(s,r){q(e,s,r),t=!0},p(s,r){const o=r[0]&17920?gt(i,[r[0]&1024&&{class:"hotspots-popover "+(s[10]?"resizing":"")},r[0]&512&&{disableHide:!s[9]},i[2],i[3],i[4],r[0]&16384&&Nt(s[14])]):{};r[0]&511|r[1]&16777216&&(o.$$scope={dirty:r,ctx:s}),e.$set(o)},i(s){t||(E(e.$$.fragment,s),t=!0)},o(s){j(e.$$.fragment,s),t=!1},d(s){n[44](null),$(e,s)}}}const Rl="@newTemplate";function ny(n,e,t){let i,l;const s=["viewport"];let r=ft(e,s),o,a,u,f,c,d;ee(n,We,fe=>t(4,o=fe)),ee(n,Ke,fe=>t(17,a=fe)),ee(n,Ct,fe=>t(45,u=fe)),ee(n,dn,fe=>t(18,f=fe)),ee(n,hn,fe=>t(10,c=fe)),ee(n,vi,fe=>t(19,d=fe));const m=it(),h=[{value:xe.note,label:"Link to: Note"},{value:xe.screen,label:"Link to: Screen"},{value:xe.overlay,label:"Link to: Screen as overlay"},{value:xe.back,label:"Link to: Back (last visited screen)"},{value:xe.prev,label:"Link to: Prev screen in series"},{value:xe.next,label:"Link to: Next screen in series"},{value:xe.scroll,label:"Link to: Position (scroll to)"}],_=h.concat({value:xe.url,label:"Link to: URL"});let{viewport:b=null}=e,g,T=!1,L=!1,O="",C,S=null,P=h,R="";async function A(){if(!o||c){g==null||g.forceHide();return}const fe=document.querySelector(`[data-hotspot="${o.id}"]`);if(!fe){g==null||g.forceHide();return}fe.scrollIntoView({block:"nearest",inline:"nearest"}),D(),await Ot(),g==null||g.show(fe,b)}function D(){Jt({}),t(6,O=""),t(0,T=!1),t(1,L=!1),t(16,R=""),o&&(!o.screen&&(a!=null&&a.id)&&ke(We,o.screen=a.id,o),ke(We,o.settings=o.settings||{},o),t(3,S=M()),Z())}function M(){if(!o)return null;const fe=Object.assign({},o);return fe.settings=structuredClone(o.settings||{}),fe}function Z(){if(!o)return null;t(16,R=o.type),!o.id&&o.type==xe.overlay&&(ke(We,o.settings=o.settings||{},o),ke(We,o.settings.fixOverlay=!0,o),ke(We,o.settings.outsideClose=!0,o))}function Y(){o!=null&&o.id&&S&&In(S),t(3,S=null),ke(We,o=null,o),Ns()}async function z(){var fe;if(!(T||!o)){t(0,T=!0);try{const ze=M();if(ze.hotspotTemplate){ze.screen=null;let Qe=f.find(wt=>wt.id==ze.hotspotTemplate);Qe?(fe=Qe.screens)!=null&&fe.includes(a.id)||(Qe=await V.collection("hotspotTemplates").update(Qe.id,{"screens+":a.id})):(Qe=await V.collection("hotspotTemplates").create({title:O,prototype:u.id,screens:[a.id]}),ze.hotspotTemplate=Qe.id),zi(Qe)}else ze.screen=a.id;let nt;o!=null&&o.id?nt=await V.collection("hotspots").update(o.id,ze):nt=await V.collection("hotspots").create(ze),t(3,S=nt),In(nt),Ns(),g==null||g.forceHide(),m("save",nt),t(0,T=!1)}catch(ze){ze.isAbort||(V.error(ze),t(0,T=!1))}}}function N(){if(L||!(o!=null&&o.id))return;let fe="Do you really want to delete the selected hotspot?";t(1,L=!0),Pt(fe,W,()=>{setTimeout(()=>{t(1,L=!1)},0)})}async function W(){if(o!=null&&o.id){t(1,L=!0);try{await V.collection("hotspots").delete(o.id),m("delete",S),ke(We,o=null,o),t(1,L=!1)}catch(fe){fe.isAbort||(V.error(fe),t(1,L=!1))}}}function ne(fe){n.$$.not_equal(o.type,fe)&&(o.type=fe,We.set(o))}function X(){o.settings.note=this.value,We.set(o)}function U(fe){n.$$.not_equal(o.settings.screen,fe)&&(o.settings.screen=fe,We.set(o))}function de(fe){n.$$.not_equal(o.settings.transition,fe)&&(o.settings.transition=fe,We.set(o))}function re(fe){n.$$.not_equal(o.settings.screen,fe)&&(o.settings.screen=fe,We.set(o))}function pe(fe){n.$$.not_equal(o.settings.overlayPosition,fe)&&(o.settings.overlayPosition=fe,We.set(o))}function Ee(){o.settings.offsetTop=vt(this.value),We.set(o)}function tt(){o.settings.offsetBottom=vt(this.value),We.set(o)}function ut(){o.settings.offsetLeft=vt(this.value),We.set(o)}function lt(){o.settings.offsetRight=vt(this.value),We.set(o)}function dt(fe){n.$$.not_equal(o.settings.transition,fe)&&(o.settings.transition=fe,We.set(o))}function se(){o.settings.fixOverlay=this.checked,We.set(o)}function J(){o.settings.outsideClose=this.checked,We.set(o)}function G(fe){n.$$.not_equal(o.settings.transition,fe)&&(o.settings.transition=fe,We.set(o))}function oe(fe){n.$$.not_equal(o.settings.transition,fe)&&(o.settings.transition=fe,We.set(o))}function x(fe){n.$$.not_equal(o.settings.transition,fe)&&(o.settings.transition=fe,We.set(o))}function je(){o.settings.url=this.value,We.set(o)}function Re(){o.settings.scrollTop=vt(this.value),We.set(o)}function Xe(){o.settings.scrollLeft=vt(this.value),We.set(o)}const bt=fe=>{var ze;fe.target.checked?o.hotspotTemplate||ke(We,o.hotspotTemplate=(S==null?void 0:S.hotspotTemplate)||((ze=l==null?void 0:l[0])==null?void 0:ze.value),o):ke(We,o.hotspotTemplate="",o)};function Lt(fe){n.$$.not_equal(o.hotspotTemplate,fe)&&(o.hotspotTemplate=fe,We.set(o))}function ie(fe){le[fe?"unshift":"push"](()=>{C=fe,t(2,C)})}function Ve(){O=this.value,t(6,O)}const ce=()=>{g==null||g.hide()};function Pe(fe){le[fe?"unshift":"push"](()=>{g=fe,t(5,g)})}return n.$$set=fe=>{e=Ue(Ue({},e),Kt(fe)),t(14,r=ft(e,s)),"viewport"in fe&&t(15,b=fe.viewport)},n.$$.update=()=>{n.$$.dirty[0]&524288&&(d!=null&&d.allowHotspotsURL?t(7,P=_):t(7,P=h)),n.$$.dirty[0]&131096&&a&&(S==null?void 0:S.id)!=(o==null?void 0:o.id)&&A(),n.$$.dirty[0]&3&&t(9,i=!T&&!L),n.$$.dirty[0]&262144&&t(8,l=f.map(fe=>({value:fe.id,label:fe.title})).concat([{value:Rl,label:"+ New template"}])),n.$$.dirty[0]&20&&(o==null?void 0:o.hotspotTemplate)===Rl&&setTimeout(()=>{C==null||C.focus()},50),n.$$.dirty[0]&65552&&o&&R!=o.type&&Z()},[T,L,C,S,o,g,O,P,l,i,c,Y,z,N,r,b,R,a,f,d,ne,X,U,de,re,pe,Ee,tt,ut,lt,dt,se,J,G,oe,x,je,Re,Xe,bt,Lt,ie,Ve,ce,Pe]}class iy extends ve{constructor(e){super(),ye(this,e,ny,ty,_e,{viewport:15},null,[-1,-1])}}function ly(n){var dr,pr;let e,t,i,l,s,r,o,a,u,f,c,d,m,h,_,b=((dr=n[1])==null?void 0:dr.title)+"",g,T,L,O=Al(n[1])+"",C,S,P=n[0].length+"",R,A,D,M,Z,Y,z,N,W,ne,X,U,de,re,pe,Ee,tt,ut,lt,dt,se,J,G,oe,x,je,Re,Xe,bt,Lt,ie,Ve,ce;o=new Ud({});let Pe=n[12]===Te.comments&&pf(n);function fe(Ie,Ge){if(Ie[17].length)return oy;if(Ie[18].length)return ry}let ze=fe(n),nt=ze&&ze(n),Qe=n[12]==Te.hotspots&&!n[14]&&mf(),wt=n[12]==Te.comments&&!n[16]&&hf(n),Tt=n[12]==Te.preview&&_f(),Ht=((pr=n[3])==null?void 0:pr.scale)!=0&&gf(n);return Xe=new R2({}),Lt=new Hd({props:{active:n[5]}}),{c(){var Ie;e=w("div"),t=w("div"),i=w("div"),i.innerHTML='<i class="iconoir-nav-arrow-left"></i>',l=I(),s=w("div"),s.innerHTML='<i class="iconoir-nav-arrow-right"></i>',r=I(),F(o.$$.fragment),a=I(),Pe&&Pe.c(),u=I(),f=w("nav"),c=w("div"),d=w("button"),d.innerHTML='<i class="iconoir-xmark"></i>',m=I(),h=w("button"),_=w("span"),g=te(b),L=te(`
                    (`),C=te(O),S=te(" of "),R=te(P),A=te(`)
                    `),D=w("i"),Y=I(),z=w("div"),N=w("button"),W=w("i"),X=I(),U=w("button"),de=w("i"),pe=I(),Ee=w("button"),tt=w("i"),ut=I(),nt&&nt.c(),dt=I(),se=w("button"),se.innerHTML='<i class="iconoir-more-vert"></i>',J=I(),G=w("div"),Qe&&Qe.c(),oe=I(),wt&&wt.c(),x=I(),Tt&&Tt.c(),je=I(),Ht&&Ht.c(),Re=I(),F(Xe.$$.fragment),bt=I(),F(Lt.$$.fragment),p(i,"class","screen-preview-nav-ctrl left"),B(i,"disabled",n[10]),p(s,"class","screen-preview-nav-ctrl right"),B(s,"disabled",n[9]),p(t,"class","screen-preview-nav-wrapper"),p(e,"class","screen-preview-container entrance-fade"),p(d,"type","button"),p(d,"class","btn btn-circle btn-transparent btn-hint txt-hint"),p(_,"class","screen-title-trim"),p(_,"title",T=(Ie=n[1])==null?void 0:Ie.title),p(D,"class",M="iconoir-nav-arrow-"+(n[5]?"up":"down")),p(h,"type","button"),p(h,"class",Z="btn btn-sm btn-hint txt-hint "+(n[5]?"btn-semitransparent":"btn-transparent")),p(c,"class","controls-group group-left"),p(W,"class","iconoir-play"),p(N,"class",ne="btn btn-circle "+(n[12]==Te.preview?"btn-primary btn-transparent":"btn-hint btn-transparent txt-hint")),p(de,"class","iconoir-square-3d-corner-to-corner"),p(U,"class",re="btn btn-circle "+(n[12]==Te.hotspots?"btn-success btn-transparent":"btn-hint btn-transparent txt-hint")),B(U,"btn-loading",n[14]||n[15]),p(tt,"class","iconoir-message-text"),p(Ee,"class",lt="btn btn-circle "+(n[12]==Te.comments?"btn-danger btn-transparent":"btn-hint btn-transparent txt-hint")),B(Ee,"btn-loading",n[16]),p(se,"type","button"),p(se,"class","btn btn-circle btn-hint txt-hint btn-transparent responsive-show"),B(se,"active",n[6]),p(z,"class","controls-group group-center"),p(G,"class","controls-group group-right responsive-hide"),p(f,"class","controls-bar"),B(f,"show-responsive-controls",n[6])},m(Ie,Ge){k(Ie,e,Ge),y(e,t),y(t,i),y(t,l),y(t,s),y(t,r),q(o,t,null),n[32](t),y(e,a),Pe&&Pe.m(e,null),k(Ie,u,Ge),k(Ie,f,Ge),y(f,c),y(c,d),y(c,m),y(c,h),y(h,_),y(_,g),y(h,L),y(h,C),y(h,S),y(h,R),y(h,A),y(h,D),y(f,Y),y(f,z),y(z,N),y(N,W),y(z,X),y(z,U),y(U,de),y(z,pe),y(z,Ee),y(Ee,tt),y(Ee,ut),nt&&nt.m(Ee,null),y(z,dt),y(z,se),y(f,J),y(f,G),Qe&&Qe.m(G,null),y(G,oe),wt&&wt.m(G,null),y(G,x),Tt&&Tt.m(G,null),y(G,je),Ht&&Ht.m(G,null),y(G,Re),q(Xe,G,null),k(Ie,bt,Ge),q(Lt,Ie,Ge),ie=!0,Ve||(ce=[H(i,"click",we(n[30])),H(s,"click",we(n[31])),H(t,"drop",we(n[33])),H(t,"dragover",Ze(we(n[29]))),H(d,"click",n[20]),be(Oe.call(null,d,{position:"top",text:"Back to listing"})),H(h,"click",we(n[21])),be(Oe.call(null,N,{position:"top",text:"Preview mode",sub:"P"})),H(N,"click",we(n[35])),be(Oe.call(null,U,{position:"top",text:"Hotspots mode",sub:"H"})),H(U,"click",we(n[36])),be(Oe.call(null,Ee,{position:"top",text:"Comments mode",sub:"C"})),H(Ee,"click",we(n[37])),be(Oe.call(null,se,{position:"top",text:"More options"})),H(se,"click",n[38]),H(f,"click",we(n[40]))],Ve=!0)},p(Ie,Ge){var hr,_r,gr;(!ie||Ge[0]&1024)&&B(i,"disabled",Ie[10]),(!ie||Ge[0]&512)&&B(s,"disabled",Ie[9]),Ie[12]===Te.comments?Pe?(Pe.p(Ie,Ge),Ge[0]&4096&&E(Pe,1)):(Pe=pf(Ie),Pe.c(),E(Pe,1),Pe.m(e,null)):Pe&&(ae(),j(Pe,1,1,()=>{Pe=null}),ue()),(!ie||Ge[0]&2)&&b!==(b=((hr=Ie[1])==null?void 0:hr.title)+"")&&Se(g,b),(!ie||Ge[0]&2&&T!==(T=(_r=Ie[1])==null?void 0:_r.title))&&p(_,"title",T),(!ie||Ge[0]&2)&&O!==(O=Al(Ie[1])+"")&&Se(C,O),(!ie||Ge[0]&1)&&P!==(P=Ie[0].length+"")&&Se(R,P),(!ie||Ge[0]&32&&M!==(M="iconoir-nav-arrow-"+(Ie[5]?"up":"down")))&&p(D,"class",M),(!ie||Ge[0]&32&&Z!==(Z="btn btn-sm btn-hint txt-hint "+(Ie[5]?"btn-semitransparent":"btn-transparent")))&&p(h,"class",Z),(!ie||Ge[0]&4096&&ne!==(ne="btn btn-circle "+(Ie[12]==Te.preview?"btn-primary btn-transparent":"btn-hint btn-transparent txt-hint")))&&p(N,"class",ne),(!ie||Ge[0]&4096&&re!==(re="btn btn-circle "+(Ie[12]==Te.hotspots?"btn-success btn-transparent":"btn-hint btn-transparent txt-hint")))&&p(U,"class",re),(!ie||Ge[0]&53248)&&B(U,"btn-loading",Ie[14]||Ie[15]),ze===(ze=fe(Ie))&&nt?nt.p(Ie,Ge):(nt&&nt.d(1),nt=ze&&ze(Ie),nt&&(nt.c(),nt.m(Ee,null))),(!ie||Ge[0]&4096&&lt!==(lt="btn btn-circle "+(Ie[12]==Te.comments?"btn-danger btn-transparent":"btn-hint btn-transparent txt-hint")))&&p(Ee,"class",lt),(!ie||Ge[0]&69632)&&B(Ee,"btn-loading",Ie[16]),(!ie||Ge[0]&64)&&B(se,"active",Ie[6]),Ie[12]==Te.hotspots&&!Ie[14]?Qe?Ge[0]&20480&&E(Qe,1):(Qe=mf(),Qe.c(),E(Qe,1),Qe.m(G,oe)):Qe&&(ae(),j(Qe,1,1,()=>{Qe=null}),ue()),Ie[12]==Te.comments&&!Ie[16]?wt?wt.p(Ie,Ge):(wt=hf(Ie),wt.c(),wt.m(G,x)):wt&&(wt.d(1),wt=null),Ie[12]==Te.preview?Tt?Ge[0]&4096&&E(Tt,1):(Tt=_f(),Tt.c(),E(Tt,1),Tt.m(G,je)):Tt&&(ae(),j(Tt,1,1,()=>{Tt=null}),ue()),((gr=Ie[3])==null?void 0:gr.scale)!=0?Ht?Ht.p(Ie,Ge):(Ht=gf(Ie),Ht.c(),Ht.m(G,Re)):Ht&&(Ht.d(1),Ht=null),(!ie||Ge[0]&64)&&B(f,"show-responsive-controls",Ie[6]);const mr={};Ge[0]&32&&(mr.active=Ie[5]),Lt.$set(mr)},i(Ie){ie||(E(o.$$.fragment,Ie),E(Pe),E(Qe),E(Tt),E(Xe.$$.fragment,Ie),E(Lt.$$.fragment,Ie),ie=!0)},o(Ie){j(o.$$.fragment,Ie),j(Pe),j(Qe),j(Tt),j(Xe.$$.fragment,Ie),j(Lt.$$.fragment,Ie),ie=!1},d(Ie){Ie&&(v(e),v(u),v(f),v(bt)),$(o),n[32](null),Pe&&Pe.d(),nt&&nt.d(),Qe&&Qe.d(),wt&&wt.d(),Tt&&Tt.d(),Ht&&Ht.d(),$(Xe),$(Lt,Ie),Ve=!1,me(ce)}}}function sy(n){let e;return{c(){e=w("span"),p(e,"class","loader loader-lg m-t-auto m-b-auto")},m(t,i){k(t,e,i)},p:Q,i:Q,o:Q,d(t){t&&v(e)}}}function pf(n){let e,t,i={};return e=new $d({props:i}),n[34](e),{c(){F(e.$$.fragment)},m(l,s){q(e,l,s),t=!0},p(l,s){const r={};e.$set(r)},i(l){t||(E(e.$$.fragment,l),t=!0)},o(l){j(e.$$.fragment,l),t=!1},d(l){n[34](null),$(e,l)}}}function ry(n){let e,t=n[18].length+"",i;return{c(){e=w("sub"),i=te(t),p(e,"class","sub sub-warning"),p(e,"title","Unread resolved comments")},m(l,s){k(l,e,s),y(e,i)},p(l,s){s[0]&262144&&t!==(t=l[18].length+"")&&Se(i,t)},d(l){l&&v(e)}}}function oy(n){let e,t=n[17].length+"",i,l;return{c(){e=w("sub"),i=te(t),p(e,"class",l="sub "+(n[18].length?"sub-warning":n[12]==Te.comments?"sub-danger":"sub-secondary-alt")),p(e,"title","Unresolved comments")},m(s,r){k(s,e,r),y(e,i)},p(s,r){r[0]&131072&&t!==(t=s[17].length+"")&&Se(i,t),r[0]&266240&&l!==(l="sub "+(s[18].length?"sub-warning":s[12]==Te.comments?"sub-danger":"sub-secondary-alt"))&&p(e,"class",l)},d(s){s&&v(e)}}}function mf(n){let e,t;return e=new W2({}),{c(){F(e.$$.fragment)},m(i,l){q(e,i,l),t=!0},i(i){t||(E(e.$$.fragment,i),t=!0)},o(i){j(e.$$.fragment,i),t=!1},d(i){$(e,i)}}}function hf(n){let e,t,i;return{c(){e=w("button"),e.innerHTML='<span class="txt">Comments panel</span>',p(e,"type","button"),p(e,"class","btn btn-sm btn-transparent btn-danger entrance-right")},m(l,s){k(l,e,s),t||(i=H(e,"click",we(n[39])),t=!0)},p:Q,d(l){l&&v(e),t=!1,i()}}}function _f(n){let e,t;return e=new qd({}),{c(){F(e.$$.fragment)},m(i,l){q(e,i,l),t=!0},i(i){t||(E(e.$$.fragment,i),t=!0)},o(i){j(e.$$.fragment,i),t=!1},d(i){$(e,i)}}}function gf(n){let e,t,i,l,s;return{c(){e=w("button"),t=w("i"),p(t,"class","iconoir-scale-frame-reduce"),p(e,"class",i="btn btn-circle btn-hint btn-transparent "+(n[19]?"txt-warning":"txt-hint"))},m(r,o){k(r,e,o),y(e,t),l||(s=[be(Oe.call(null,e,{position:"top",text:"Toggle fit to screen"})),H(e,"click",we(ad))],l=!0)},p(r,o){o[0]&524288&&i!==(i="btn btn-circle btn-hint btn-transparent "+(r[19]?"txt-warning":"txt-hint"))&&p(e,"class",i)},d(r){r&&v(e),l=!1,me(s)}}}function ay(n){let e,t,i,l;const s=[sy,ly],r=[];function o(a,u){return a[11]?1:0}return e=o(n),t=r[e]=s[e](n),{c(){t.c(),i=De()},m(a,u){r[e].m(a,u),k(a,i,u),l=!0},p(a,u){let f=e;e=o(a),e===f?r[e].p(a,u):(ae(),j(r[f],1,1,()=>{r[f]=null}),ue(),t=r[e],t?t.p(a,u):(t=r[e]=s[e](a),t.c()),E(t,1),t.m(i.parentNode,i))},i(a){l||(E(t),l=!0)},o(a){j(t),l=!1},d(a){a&&v(i),r[e].d(a)}}}function uy(n){let e,t,i,l,s,r,o,a;return e=new Ni({props:{fullpage:!0,class:"screen-preview-layout screen-preview-mode-"+n[12]+" "+(n[12]==Te.comments&&n[2]?"screen-preview-comment-popover-active":"")+" "+(n[12]==Te.hotspots&&n[13]?"screen-preview-hotspot-popover-active":""),header:!1,footer:!1,title:n[4],$$slots:{default:[ay]},$$scope:{ctx:n}}}),i=new Wd({props:{viewport:n[8]}}),s=new iy({props:{viewport:n[8]}}),{c(){F(e.$$.fragment),t=I(),F(i.$$.fragment),l=I(),F(s.$$.fragment)},m(u,f){q(e,u,f),k(u,t,f),q(i,u,f),k(u,l,f),q(s,u,f),r=!0,o||(a=H(window,"keydown",n[22]),o=!0)},p(u,f){const c={};f[0]&12292&&(c.class="screen-preview-layout screen-preview-mode-"+u[12]+" "+(u[12]==Te.comments&&u[2]?"screen-preview-comment-popover-active":"")+" "+(u[12]==Te.hotspots&&u[13]?"screen-preview-hotspot-popover-active":"")),f[0]&16&&(c.title=u[4]),f[0]&1040363|f[1]&4096&&(c.$$scope={dirty:f,ctx:u}),e.$set(c);const d={};f[0]&256&&(d.viewport=u[8]),i.$set(d);const m={};f[0]&256&&(m.viewport=u[8]),s.$set(m)},i(u){r||(E(e.$$.fragment,u),E(i.$$.fragment,u),E(s.$$.fragment,u),r=!0)},o(u){j(e.$$.fragment,u),j(i.$$.fragment,u),j(s.$$.fragment,u),r=!1},d(u){u&&(v(t),v(l)),$(e,u),$(i,u),$(s,u),o=!1,a()}}}const fy=".toggler-container > .active";function cy(n,e,t){let i,l,s,r,o,a,u,f,c,d,m,h,_,b,g,T,L,O;ee(n,pt,G=>t(0,o=G)),ee(n,Ke,G=>t(1,a=G)),ee(n,Wt,G=>t(2,u=G)),ee(n,Ct,G=>t(3,f=G)),ee(n,cn,G=>t(27,c=G)),ee(n,Gf,G=>t(28,d=G)),ee(n,ji,G=>t(12,m=G)),ee(n,We,G=>t(13,h=G)),ee(n,Vi,G=>t(14,_=G)),ee(n,Bi,G=>t(15,b=G)),ee(n,bi,G=>t(16,g=G)),ee(n,Cd,G=>t(17,T=G)),ee(n,or,G=>t(18,L=G)),ee(n,Pi,G=>t(19,O=G));const C=K.getHashQueryParams();let{params:S}=e,P="",R=!1,A=!1,D=!1,M,Z,Y=S.screenId;sr(),ud(),z(S.prototypeId,S.screenId);async function z(G,oe){if(!(!G||!oe)){Kl(),tr(),ir(),t(24,R=!0);try{Ed(G),Md(G),jd(G),lr(G),Pd(G),Rd(G);const x=await V.collection("prototypes").getOne(G,{expand:"project.users,screens_via_prototype"});ki(x,!0),Xn(x.expand.project,!0),ke(Ke,a=oe,a),ke(pt,o=K.sortItemsByIds(x.expand.screens_via_prototype,x.screensOrder),o),Ld(G,C.commentId),t(24,R=!1)}catch(x){x.isAbort||(t(24,R=!1),V.error(x))}}}function N(){wi(`/projects/${S==null?void 0:S.projectId}/prototypes/${S.prototypeId}`)}function W(){t(5,A=!A)}function ne(G){if(!(G.altKey||G.ctrlKey||K.isInput(G.target)||document.querySelector(fy))){if(G.code==="Escape"&&A){G.preventDefault(),t(5,A=!1);return}if(G.code==="ArrowLeft"){G.preventDefault(),Cn(-1);return}if(G.code==="ArrowRight"){G.preventDefault(),Cn(1);return}if(G.code==="KeyP"){G.preventDefault(),zt(Te.preview);return}if(G.code==="KeyH"){G.preventDefault(),zt(Te.hotspots);return}if(G.code==="KeyC"){G.preventDefault(),zt(Te.comments);return}}}Gt(()=>{Ut==null||Ut(),an==null||an(),fn==null||fn(),un==null||un()});function X(G){$e.call(this,n,G)}const U=()=>Cn(-1),de=()=>Cn(1);function re(G){le[G?"unshift":"push"](()=>{Z=G,t(8,Z)})}const pe=G=>{G.dataTransfer.files.length&&rr(a,G.dataTransfer.files[0])};function Ee(G){le[G?"unshift":"push"](()=>{M=G,t(7,M)})}const tt=()=>zt(Te.preview),ut=()=>zt(Te.hotspots),lt=()=>zt(Te.comments),dt=()=>t(6,D=!D),se=()=>M==null?void 0:M.toggle(),J=()=>{document.activeElement.blur()};return n.$$set=G=>{"params"in G&&t(23,S=G.params)},n.$$.update=()=>{n.$$.dirty[0]&41943042&&a&&Y==a.id&&S.screenId!=Y&&(t(25,Y=S.screenId),ke(Ke,a=S.screenId,a)),n.$$.dirty[0]&134217738&&t(4,P=[a==null?void 0:a.title,f==null?void 0:f.title,c==null?void 0:c.title].filter(Boolean).join(" - ")),n.$$.dirty[0]&301989898&&a&&a.id!=Y&&(t(25,Y=a.id),wi(`/projects/${f.project}/prototypes/${f.id}/screens/${a.id}?${d}`)),n.$$.dirty[0]&150994954&&t(11,i=!R&&!!(c!=null&&c.id)&&!!(f!=null&&f.id)&&!!(a!=null&&a.id)),n.$$.dirty[0]&3&&t(26,l=o.findIndex(G=>G.id==(a==null?void 0:a.id))),n.$$.dirty[0]&67108864&&t(10,s=l===0),n.$$.dirty[0]&67108865&&t(9,r=o.length-1===l),n.$$.dirty[0]&4&&K.replaceHashQueryParams({commentId:(u==null?void 0:u.id)||null})},[o,a,u,f,P,A,D,M,Z,r,s,i,m,h,_,b,g,T,L,O,N,W,ne,S,R,Y,l,c,d,X,U,de,re,pe,Ee,tt,ut,lt,dt,se,J]}class dy extends ve{constructor(e){super(),ye(this,e,cy,uy,_e,{params:23},null,[-1,-1])}}function py(n){let e,t,i;const l=[{searchable:!0},{class:"prototypes-select"},{dropdownClass:"dropdown-right"},{noOptionsText:"No prototypes found"},{selectPlaceholder:"- Select prototype -"},{items:n[1]},n[2]];function s(o){n[4](o)}let r={};for(let o=0;o<l.length;o+=1)r=Ue(r,l[o]);return n[0]!==void 0&&(r.keyOfSelected=n[0]),e=new pn({props:r}),le.push(()=>Ae(e,"keyOfSelected",s)),{c(){F(e.$$.fragment)},m(o,a){q(e,o,a),i=!0},p(o,[a]){const u=a&6?gt(l,[l[0],l[1],l[2],l[3],l[4],a&2&&{items:o[1]},a&4&&Nt(o[2])]):{};!t&&a&1&&(t=!0,u.keyOfSelected=o[0],Ne(()=>t=!1)),e.$set(u)},i(o){i||(E(e.$$.fragment,o),i=!0)},o(o){j(e.$$.fragment,o),i=!1},d(o){$(e,o)}}}function my(n,e,t){let i;const l=["value"];let s=ft(e,l),r;ee(n,Ft,u=>t(3,r=u));let{value:o}=e;function a(u){o=u,t(0,o)}return n.$$set=u=>{e=Ue(Ue({},e),Kt(u)),t(2,s=ft(e,l)),"value"in u&&t(0,o=u.value)},n.$$.update=()=>{n.$$.dirty&8&&t(1,i=r.map(u=>({value:u.id,label:u.title,icon:K.getPrototypeIcon(u)})))},[o,i,s,r,a]}class hy extends ve{constructor(e){super(),ye(this,e,my,py,_e,{value:0})}}function _y(n){let e,t,i,l,s,r,o,a;return{c(){e=w("label"),t=te("Additional details"),l=I(),s=w("textarea"),p(e,"for",i=n[16]),p(s,"id",r=n[16]),p(s,"rows","3")},m(u,f){k(u,e,f),y(e,t),k(u,l,f),k(u,s,f),ge(s,n[3]),o||(a=H(s,"input",n[9]),o=!0)},p(u,f){f&65536&&i!==(i=u[16])&&p(e,"for",i),f&65536&&r!==(r=u[16])&&p(s,"id",r),f&8&&ge(s,u[3])},d(u){u&&(v(e),v(l),v(s)),o=!1,a()}}}function gy(n){let e,t,i,l,s;return t=new Ce({props:{class:"form-field m-0",name:"message",$$slots:{default:[_y,({uniqueId:r})=>({16:r}),({uniqueId:r})=>r?65536:0]},$$scope:{ctx:n}}}),{c(){e=w("form"),F(t.$$.fragment),p(e,"id",n[5])},m(r,o){k(r,e,o),q(t,e,null),i=!0,l||(s=H(e,"submit",we(n[6])),l=!0)},p(r,o){const a={};o&196616&&(a.$$scope={dirty:o,ctx:r}),t.$set(a)},i(r){i||(E(t.$$.fragment,r),i=!0)},o(r){j(t.$$.fragment,r),i=!1},d(r){r&&v(e),$(t),l=!1,s()}}}function by(n){let e;return{c(){e=w("h5"),e.textContent="Report this design for spam or abusive content",p(e,"class","block txt-center")},m(t,i){k(t,e,i)},p:Q,d(t){t&&v(e)}}}function wy(n){let e,t,i,l,s,r,o;return{c(){e=w("button"),t=w("span"),t.textContent="Close",i=I(),l=w("button"),s=w("span"),s.textContent="Report",p(t,"class","txt"),p(e,"type","button"),p(e,"class","btn btn-transparent m-r-auto"),e.disabled=n[4],p(s,"class","txt"),p(l,"form",n[5]),p(l,"type","submit"),p(l,"class","btn btn-expanded-sm btn-primary"),l.disabled=n[4],B(l,"btn-loading",n[4])},m(a,u){k(a,e,u),y(e,t),k(a,i,u),k(a,l,u),y(l,s),r||(o=H(e,"click",n[8]),r=!0)},p(a,u){u&16&&(e.disabled=a[4]),u&16&&(l.disabled=a[4]),u&16&&B(l,"btn-loading",a[4])},d(a){a&&(v(e),v(i),v(l)),r=!1,o()}}}function yy(n){let e,t,i;function l(r){n[11](r)}let s={popup:!0,$$slots:{footer:[wy],header:[by],default:[gy]},$$scope:{ctx:n}};return n[0]!==void 0&&(s.active=n[0]),e=new mn({props:s}),n[10](e),le.push(()=>Ae(e,"active",l)),e.$on("show",n[12]),e.$on("hide",n[13]),{c(){F(e.$$.fragment)},m(r,o){q(e,r,o),i=!0},p(r,[o]){const a={};o&131096&&(a.$$scope={dirty:o,ctx:r}),!t&&o&1&&(t=!0,a.active=r[0],Ne(()=>t=!1)),e.$set(a)},i(r){i||(E(e.$$.fragment,r),i=!0)},o(r){j(e.$$.fragment,r),i=!1},d(r){n[10](null),$(e,r)}}}function vy(n,e,t){const i=it(),l="report_"+K.randomString(5);let{active:s=!1}=e,r,o="",a=!1;function u(){return c(),r==null?void 0:r.show()}function f(){return r==null?void 0:r.hide()}function c(){Jt({}),t(3,o="")}async function d(){if(!a){t(4,a=!0);try{await V.send("/api/pr/report",{method:"POST",body:{message:o}}),i("submit"),_t("Thank you, we will investigate and remove the project if found inappropriate.",5e3),Yt("/")}catch(L){L.isAbort||V.error(L)}t(4,a=!1)}}Gt(()=>{f()});const m=()=>f();function h(){o=this.value,t(3,o)}function _(L){le[L?"unshift":"push"](()=>{r=L,t(2,r)})}function b(L){s=L,t(0,s)}function g(L){$e.call(this,n,L)}function T(L){$e.call(this,n,L)}return n.$$set=L=>{"active"in L&&t(0,s=L.active)},[s,f,r,o,a,l,d,u,m,h,_,b,g,T]}class ky extends ve{constructor(e){super(),ye(this,e,vy,yy,_e,{active:0,show:7,hide:1})}get show(){return this.$$.ctx[7]}get hide(){return this.$$.ctx[1]}}function Sy(n){let e,t,i=n[3].title+"",l,s,r,o,a,u,f,c,d;return{c(){e=w("div"),t=w("p"),l=te(i),s=I(),r=w("button"),r.innerHTML='<i class="iconoir-warning-triangle-solid"></i> <span class="txt">Report design</span>',o=I(),a=w("hr"),u=I(),f=w("p"),f.innerHTML=`Presented with
                <a href="https://presentator.io" target="_blank" rel="noopener noreferrer">Presentator</a>`,p(t,"class","txt-bold"),p(r,"type","button"),p(r,"class","btn btn-xs btn-transparent btn-danger m-t-xs"),p(a,"class","m-t-xs m-b-xs"),p(f,"class","txt-xs txt-hint"),p(e,"class","content")},m(m,h){k(m,e,h),y(e,t),y(t,l),y(e,s),y(e,r),y(e,o),y(e,a),y(e,u),y(e,f),c||(d=H(r,"click",Ze(n[7])),c=!0)},p(m,h){h&8&&i!==(i=m[3].title+"")&&Se(l,i)},d(m){m&&v(e),c=!1,d()}}}function Ty(n){let e,t,i,l,s,r,o,a,u,f,c;function d(_){n[9](_)}let m={class:"dropdown dropdown-right dropdown-upside project-info-dropdown",$$slots:{default:[Sy]},$$scope:{ctx:n}};n[2]!==void 0&&(m.active=n[2]),l=new Rt({props:m}),n[8](l),le.push(()=>Ae(l,"active",d));let h={};return a=new ky({props:h}),n[10](a),{c(){e=w("div"),t=w("i"),i=I(),F(l.$$.fragment),o=I(),F(a.$$.fragment),p(t,"class","iconoir-info-circle"),p(e,"tabindex","0"),p(e,"class","btn btn-circle btn-hint txt-hint btn-transparent project-info-btn")},m(_,b){k(_,e,b),y(e,t),y(e,i),q(l,e,null),k(_,o,b),q(a,_,b),u=!0,f||(c=[be(r=Oe.call(null,e,n[2]?void 0:{position:"top-right",text:"Project info"})),H(e,"click",Ze(n[6]))],f=!0)},p(_,[b]){const g={};b&2058&&(g.$$scope={dirty:b,ctx:_}),!s&&b&4&&(s=!0,g.active=_[2],Ne(()=>s=!1)),l.$set(g),r&&et(r.update)&&b&4&&r.update.call(null,_[2]?void 0:{position:"top-right",text:"Project info"});const T={};a.$set(T)},i(_){u||(E(l.$$.fragment,_),E(a.$$.fragment,_),u=!0)},o(_){j(l.$$.fragment,_),j(a.$$.fragment,_),u=!1},d(_){_&&(v(e),v(o)),n[8](null),$(l),n[10](null),$(a,_),f=!1,me(c)}}}function Oy(n,e,t){let i;ee(n,cn,h=>t(3,i=h));let l,s,r=!1;function o(){l==null||l.show()}function a(){l==null||l.hide()}function u(h){$e.call(this,n,h)}const f=()=>s==null?void 0:s.show();function c(h){le[h?"unshift":"push"](()=>{l=h,t(0,l)})}function d(h){r=h,t(2,r)}function m(h){le[h?"unshift":"push"](()=>{s=h,t(1,s)})}return[l,s,r,i,o,a,u,f,c,d,m]}class Cy extends ve{constructor(e){super(),ye(this,e,Oy,Ty,_e,{show:4,hide:5})}get show(){return this.$$.ctx[4]}get hide(){return this.$$.ctx[5]}}function Ey(n){let e,t,i,l,s,r,o,a,u,f,c;o=new Ud({});let d=n[4]===Te.comments&&bf(n);return{c(){e=w("div"),t=w("div"),i=w("div"),i.innerHTML='<i class="iconoir-nav-arrow-left"></i>',l=I(),s=w("div"),s.innerHTML='<i class="iconoir-nav-arrow-right"></i>',r=I(),F(o.$$.fragment),a=I(),d&&d.c(),p(i,"class","screen-preview-nav-ctrl left"),B(i,"disabled",n[11]),p(s,"class","screen-preview-nav-ctrl right"),B(s,"disabled",n[10]),p(t,"class","screen-preview-nav-wrapper"),B(t,"discreet",!n[6]),p(e,"class","screen-preview-container entrance-fade")},m(m,h){k(m,e,h),y(e,t),y(t,i),y(t,l),y(t,s),y(t,r),q(o,t,null),n[31](t),y(e,a),d&&d.m(e,null),u=!0,f||(c=[H(i,"click",we(n[29])),H(s,"click",we(n[30]))],f=!0)},p(m,h){(!u||h[0]&2048)&&B(i,"disabled",m[11]),(!u||h[0]&1024)&&B(s,"disabled",m[10]),(!u||h[0]&64)&&B(t,"discreet",!m[6]),m[4]===Te.comments?d?(d.p(m,h),h[0]&16&&E(d,1)):(d=bf(m),d.c(),E(d,1),d.m(e,null)):d&&(ae(),j(d,1,1,()=>{d=null}),ue())},i(m){u||(E(o.$$.fragment,m),E(d),u=!0)},o(m){j(o.$$.fragment,m),j(d),u=!1},d(m){m&&v(e),$(o),n[31](null),d&&d.d(),f=!1,me(c)}}}function Ly(n){let e;return{c(){e=w("div"),e.innerHTML='<div class="placeholder-block"><figure class="icon"><i class="iconoir-media-image-list"></i></figure> <h5 class="title txt-hint">The prototype doesn&#39;t have any screens yet.</h5></div>',p(e,"class","wrapper wrapper-sm m-t-auto m-b-auto")},m(t,i){k(t,e,i)},p:Q,i:Q,o:Q,d(t){t&&v(e)}}}function Iy(n){let e;return{c(){e=w("span"),p(e,"class","loader loader-lg m-t-auto m-b-auto")},m(t,i){k(t,e,i)},p:Q,i:Q,o:Q,d(t){t&&v(e)}}}function bf(n){let e,t,i={};return e=new $d({props:i}),n[32](e),{c(){F(e.$$.fragment)},m(l,s){q(e,l,s),t=!0},p(l,s){const r={};e.$set(r)},i(l){t||(E(e.$$.fragment,l),t=!0)},o(l){j(e.$$.fragment,l),t=!1},d(l){n[32](null),$(e,l)}}}function wf(n){var h,_;let e,t,i,l,s,r,o,a,u,f,c=((h=n[2])==null?void 0:h.id)&&yf(n),d=((_=n[2])==null?void 0:_.id)&&Sf(n),m=n[17].length>1&&Ef(n);return r=new Cy({}),{c(){e=w("nav"),c&&c.c(),t=I(),i=w("div"),d&&d.c(),l=I(),m&&m.c(),s=I(),F(r.$$.fragment),p(i,"class","controls-group group-right responsive-hide"),p(e,"class","controls-bar"),B(e,"show-responsive-controls",n[7])},m(b,g){k(b,e,g),c&&c.m(e,null),y(e,t),y(e,i),d&&d.m(i,null),y(i,l),m&&m.m(i,null),y(i,s),q(r,i,null),a=!0,u||(f=H(e,"click",we(n[38])),u=!0)},p(b,g){var T,L;(T=b[2])!=null&&T.id?c?c.p(b,g):(c=yf(b),c.c(),c.m(e,t)):c&&(c.d(1),c=null),(L=b[2])!=null&&L.id?d?(d.p(b,g),g[0]&4&&E(d,1)):(d=Sf(b),d.c(),E(d,1),d.m(i,l)):d&&(ae(),j(d,1,1,()=>{d=null}),ue()),b[17].length>1?m?(m.p(b,g),g[0]&131072&&E(m,1)):(m=Ef(b),m.c(),E(m,1),m.m(i,s)):m&&(ae(),j(m,1,1,()=>{m=null}),ue()),(!a||g[0]&128)&&B(e,"show-responsive-controls",b[7])},i(b){a||(E(d),E(m),E(r.$$.fragment,b),b&&kt(()=>{a&&(o||(o=ct(e,Et,{duration:150},!0)),o.run(1))}),a=!0)},o(b){j(d),j(m),j(r.$$.fragment,b),b&&(o||(o=ct(e,Et,{duration:150},!1)),o.run(0)),a=!1},d(b){b&&v(e),c&&c.d(),d&&d.d(),m&&m.d(),$(r),b&&o&&o.end(),u=!1,f()}}}function yf(n){var Z,Y;let e,t,i,l=((Z=n[2])==null?void 0:Z.title)+"",s,r,o,a=Al(n[2])+"",u,f,c=n[3].length+"",d,m,h,_,b,g,T,L,O,C,S,P,R,A,D,M=((Y=n[0])==null?void 0:Y.allowComments)&&vf(n);return{c(){var z;e=w("div"),t=w("button"),i=w("span"),s=te(l),o=te(`
                        (`),u=te(a),f=te(" of "),d=te(c),m=te(`)
                        `),h=w("i"),g=I(),T=w("div"),L=w("button"),O=w("i"),S=I(),M&&M.c(),P=I(),R=w("button"),R.innerHTML='<i class="iconoir-more-vert"></i>',p(i,"class","screen-title-trim"),p(i,"title",r=(z=n[2])==null?void 0:z.title),p(h,"class",_="iconoir-nav-arrow-"+(n[5]?"up":"down")),p(t,"type","button"),p(t,"class",b="btn btn-sm btn-hint txt-hint "+(n[5]?"btn-semitransparent":"btn-transparent")),p(e,"class","controls-group group-left"),p(O,"class","iconoir-play"),p(L,"class",C="btn btn-circle "+(n[4]==Te.preview?"btn-primary btn-transparent":"btn-hint btn-transparent txt-hint")),p(R,"type","button"),p(R,"class","btn btn-circle btn-hint txt-hint btn-transparent responsive-show"),B(R,"active",n[7]),p(T,"class","controls-group group-center")},m(z,N){k(z,e,N),y(e,t),y(t,i),y(i,s),y(t,o),y(t,u),y(t,f),y(t,d),y(t,m),y(t,h),k(z,g,N),k(z,T,N),y(T,L),y(L,O),y(T,S),M&&M.m(T,null),y(T,P),y(T,R),A||(D=[H(t,"click",we(n[19])),be(Oe.call(null,L,{position:"top",text:"Preview mode",sub:"P"})),H(L,"click",we(n[33])),be(Oe.call(null,R,{position:"top",text:"More options"})),H(R,"click",n[35])],A=!0)},p(z,N){var W,ne,X;N[0]&4&&l!==(l=((W=z[2])==null?void 0:W.title)+"")&&Se(s,l),N[0]&4&&r!==(r=(ne=z[2])==null?void 0:ne.title)&&p(i,"title",r),N[0]&4&&a!==(a=Al(z[2])+"")&&Se(u,a),N[0]&8&&c!==(c=z[3].length+"")&&Se(d,c),N[0]&32&&_!==(_="iconoir-nav-arrow-"+(z[5]?"up":"down"))&&p(h,"class",_),N[0]&32&&b!==(b="btn btn-sm btn-hint txt-hint "+(z[5]?"btn-semitransparent":"btn-transparent"))&&p(t,"class",b),N[0]&16&&C!==(C="btn btn-circle "+(z[4]==Te.preview?"btn-primary btn-transparent":"btn-hint btn-transparent txt-hint"))&&p(L,"class",C),(X=z[0])!=null&&X.allowComments?M?M.p(z,N):(M=vf(z),M.c(),M.m(T,P)):M&&(M.d(1),M=null),N[0]&128&&B(R,"active",z[7])},d(z){z&&(v(e),v(g),v(T)),M&&M.d(),A=!1,me(D)}}}function vf(n){let e,t,i,l,s,r,o=n[14].length&&kf(n);return{c(){e=w("button"),t=w("i"),i=I(),o&&o.c(),p(t,"class","iconoir-message-text"),p(e,"class",l="btn btn-circle "+(n[4]==Te.comments?"btn-danger btn-transparent":"btn-hint btn-transparent txt-hint")),B(e,"btn-loading",n[13])},m(a,u){k(a,e,u),y(e,t),y(e,i),o&&o.m(e,null),s||(r=[be(Oe.call(null,e,{position:"top",text:"Comments mode",sub:"C"})),H(e,"click",we(n[34]))],s=!0)},p(a,u){a[14].length?o?o.p(a,u):(o=kf(a),o.c(),o.m(e,null)):o&&(o.d(1),o=null),u[0]&16&&l!==(l="btn btn-circle "+(a[4]==Te.comments?"btn-danger btn-transparent":"btn-hint btn-transparent txt-hint"))&&p(e,"class",l),u[0]&8208&&B(e,"btn-loading",a[13])},d(a){a&&v(e),o&&o.d(),s=!1,me(r)}}}function kf(n){let e,t=n[14].length+"",i,l;return{c(){e=w("sub"),i=te(t),p(e,"class",l="sub "+(n[15].length?"sub-warning":n[4]==Te.comments?"sub-danger":"sub-secondary-alt")),p(e,"title","Unread comments")},m(s,r){k(s,e,r),y(e,i)},p(s,r){r[0]&16384&&t!==(t=s[14].length+"")&&Se(i,t),r[0]&32784&&l!==(l="sub "+(s[15].length?"sub-warning":s[4]==Te.comments?"sub-danger":"sub-secondary-alt"))&&p(e,"class",l)},d(s){s&&v(e)}}}function Sf(n){var a;let e,t,i,l,s=((a=n[0])==null?void 0:a.allowComments)&&n[4]==Te.comments&&!n[13]&&Tf(n),r=n[4]==Te.preview&&Of(),o=n[1].scale!=0&&Cf(n);return{c(){s&&s.c(),e=I(),r&&r.c(),t=I(),o&&o.c(),i=De()},m(u,f){s&&s.m(u,f),k(u,e,f),r&&r.m(u,f),k(u,t,f),o&&o.m(u,f),k(u,i,f),l=!0},p(u,f){var c;(c=u[0])!=null&&c.allowComments&&u[4]==Te.comments&&!u[13]?s?s.p(u,f):(s=Tf(u),s.c(),s.m(e.parentNode,e)):s&&(s.d(1),s=null),u[4]==Te.preview?r?f[0]&16&&E(r,1):(r=Of(),r.c(),E(r,1),r.m(t.parentNode,t)):r&&(ae(),j(r,1,1,()=>{r=null}),ue()),u[1].scale!=0?o?o.p(u,f):(o=Cf(u),o.c(),o.m(i.parentNode,i)):o&&(o.d(1),o=null)},i(u){l||(E(r),l=!0)},o(u){j(r),l=!1},d(u){u&&(v(e),v(t),v(i)),s&&s.d(u),r&&r.d(u),o&&o.d(u)}}}function Tf(n){let e,t,i;return{c(){e=w("button"),e.innerHTML='<span class="txt">Comments panel</span>',p(e,"type","button"),p(e,"class","btn btn-sm btn-transparent btn-danger entrance-right")},m(l,s){k(l,e,s),t||(i=H(e,"click",we(n[36])),t=!0)},p:Q,d(l){l&&v(e),t=!1,i()}}}function Of(n){let e,t;return e=new qd({}),{c(){F(e.$$.fragment)},m(i,l){q(e,i,l),t=!0},i(i){t||(E(e.$$.fragment,i),t=!0)},o(i){j(e.$$.fragment,i),t=!1},d(i){$(e,i)}}}function Cf(n){let e,t,i,l,s;return{c(){e=w("button"),t=w("i"),p(t,"class","iconoir-scale-frame-reduce"),p(e,"class",i="btn btn-circle btn-hint btn-transparent "+(n[16]?"txt-warning":"txt-hint"))},m(r,o){k(r,e,o),y(e,t),l||(s=[be(Oe.call(null,e,{position:"top",text:"Toggle fit to screen"})),H(e,"click",we(ad))],l=!0)},p(r,o){o[0]&65536&&i!==(i="btn btn-circle btn-hint btn-transparent "+(r[16]?"txt-warning":"txt-hint"))&&p(e,"class",i)},d(r){r&&v(e),l=!1,me(s)}}}function Ef(n){let e,t,i,l;function s(o){n[37](o)}let r={upside:!0,searchable:!1};return n[18]!==void 0&&(r.value=n[18]),t=new hy({props:r}),le.push(()=>Ae(t,"value",s)),{c(){e=w("div"),F(t.$$.fragment),p(e,"class","form-field form-field-sm")},m(o,a){k(o,e,a),q(t,e,null),l=!0},p(o,a){const u={};!i&&a[0]&262144&&(i=!0,u.value=o[18],Ne(()=>i=!1)),t.$set(u)},i(o){l||(E(t.$$.fragment,o),l=!0)},o(o){j(t.$$.fragment,o),l=!1},d(o){o&&v(e),$(t)}}}function jy(n){let e,t,i,l,s,r=n[6]?"Hide":"Show",o,a,u,f,c,d,m,h,_;const b=[Iy,Ly,Ey],g=[];function T(O,C){var S;return O[12]?(S=O[2])!=null&&S.id?2:1:0}e=T(n),t=g[e]=b[e](n);let L=n[6]&&wf(n);return f=new Hd({props:{active:n[5]}}),d=new Wd({props:{viewport:n[9]}}),{c(){t.c(),i=I(),l=w("div"),s=w("div"),o=te(r),a=I(),L&&L.c(),u=I(),F(f.$$.fragment),c=I(),F(d.$$.fragment),p(s,"class","controls-bar-toggle"),B(s,"active",n[6]),p(l,"class","controls-bar-wrapper")},m(O,C){g[e].m(O,C),k(O,i,C),k(O,l,C),y(l,s),y(s,o),y(l,a),L&&L.m(l,null),k(O,u,C),q(f,O,C),k(O,c,C),q(d,O,C),m=!0,h||(_=[H(window,"keydown",n[21]),H(s,"click",we(n[20]))],h=!0)},p(O,C){let S=e;e=T(O),e===S?g[e].p(O,C):(ae(),j(g[S],1,1,()=>{g[S]=null}),ue(),t=g[e],t?t.p(O,C):(t=g[e]=b[e](O),t.c()),E(t,1),t.m(i.parentNode,i)),(!m||C[0]&64)&&r!==(r=O[6]?"Hide":"Show")&&Se(o,r),(!m||C[0]&64)&&B(s,"active",O[6]),O[6]?L?(L.p(O,C),C[0]&64&&E(L,1)):(L=wf(O),L.c(),E(L,1),L.m(l,null)):L&&(ae(),j(L,1,1,()=>{L=null}),ue());const P={};C[0]&32&&(P.active=O[5]),f.$set(P);const R={};C[0]&512&&(R.viewport=O[9]),d.$set(R)},i(O){m||(E(t),E(L),E(f.$$.fragment,O),E(d.$$.fragment,O),m=!0)},o(O){j(t),j(L),j(f.$$.fragment,O),j(d.$$.fragment,O),m=!1},d(O){O&&(v(i),v(l),v(u),v(c)),g[e].d(O),L&&L.d(),$(f,O),$(d,O),h=!1,me(_)}}}const Py=".toggler-container > .active";function Ny(n,e,t){let i,l,s,r,o,a,u,f,c,d,m,h,_,b,g,T;ee(n,Gf,se=>t(27,o=se)),ee(n,Ct,se=>t(1,a=se)),ee(n,Ke,se=>t(2,u=se)),ee(n,pt,se=>t(3,f=se)),ee(n,Wt,se=>t(28,c=se)),ee(n,ji,se=>t(4,d=se)),ee(n,bi,se=>t(13,m=se)),ee(n,Cd,se=>t(14,h=se)),ee(n,or,se=>t(15,_=se)),ee(n,Pi,se=>t(16,b=se)),ee(n,Ft,se=>t(17,g=se)),ee(n,Gn,se=>t(18,T=se));const L=K.getHashQueryParams();let{link:O}=e,{params:C}=e,S=!1,P=!1,R=!0,A=!1,D,M,Z="",Y="";sr(),ud();async function z(){t(23,S=!0),await Ot(),ir();try{const se=a.id;Md(se),jd(se),lr(se),O!=null&&O.allowComments&&Ed(se),Pd(se),Rd(se);const J=await V.collection("screens").getFullList({filter:`prototype="${se}"`});ke(Ke,u=C.screenId,u),ke(pt,f=K.sortItemsByIds(J,a.screensOrder),f),O!=null&&O.allowComments&&Ld(se,L.commentId),u!=null&&u.id||Yt(`/${O.username}/prototypes/${a.id}?${o}`),t(23,S=!1)}catch(se){se.isAbort||(t(23,S=!1),V.error(se))}}function N(){t(5,P=!P)}function W(){t(6,R=!R),R||(t(5,P=!1),D==null||D.hide())}function ne(se){if(!(se.altKey||se.ctrlKey||K.isInput(se.target)||document.querySelector(Py))){if(se.code==="Escape"&&P){se.preventDefault(),t(5,P=!1);return}if(se.code==="ArrowLeft"){se.preventDefault(),Cn(-1);return}if(se.code==="ArrowRight"){se.preventDefault(),Cn(1);return}if(se.code==="KeyP"){se.preventDefault(),zt(Te.preview);return}if(se.code==="KeyC"&&(O!=null&&O.allowComments)){se.preventDefault(),zt(Te.comments);return}}}Gt(()=>{an==null||an(),Ut==null||Ut(),fn==null||fn(),un==null||un()});const X=()=>Cn(-1),U=()=>Cn(1);function de(se){le[se?"unshift":"push"](()=>{M=se,t(9,M)})}function re(se){le[se?"unshift":"push"](()=>{D=se,t(8,D)})}const pe=()=>zt(Te.preview),Ee=()=>zt(Te.comments),tt=()=>t(7,A=!A),ut=()=>D==null?void 0:D.toggle();function lt(se){T=se,Gn.set(T)}const dt=()=>{document.activeElement.blur()};return n.$$set=se=>{"link"in se&&t(0,O=se.link),"params"in se&&t(22,C=se.params)},n.$$.update=()=>{n.$$.dirty[0]&17&&!(O!=null&&O.allowComments)&&d==Te.comments&&zt(Te.preview),n.$$.dirty[0]&33554434&&a&&Y!=(a==null?void 0:a.id)&&(t(25,Y=a.id),z()),n.$$.dirty[0]&20971524&&u&&Z==u.id&&C.screenId!=Z&&(t(24,Z=C.screenId),ke(Ke,u=C.screenId,u)),n.$$.dirty[0]&150994951&&u&&u.id!=Z&&(t(24,Z=u.id),wi(`/${O.username}/prototypes/${a.id}/screens/${u.id}?${o}`)),n.$$.dirty[0]&8388610&&t(12,i=!S&&!!(a!=null&&a.id)),n.$$.dirty[0]&12&&t(26,l=f.findIndex(se=>se.id==(u==null?void 0:u.id))),n.$$.dirty[0]&67108864&&t(11,s=l===0),n.$$.dirty[0]&67108872&&t(10,r=f.length-1===l),n.$$.dirty[0]&268435456&&K.replaceHashQueryParams({commentId:(c==null?void 0:c.id)||null})},[O,a,u,f,d,P,R,A,D,M,r,s,i,m,h,_,b,g,T,N,W,ne,C,S,Z,Y,l,o,c,X,U,de,re,pe,Ee,tt,ut,lt,dt]}class Ay extends ve{constructor(e){super(),ye(this,e,Ny,jy,_e,{link:0,params:22},null,[-1,-1])}}function Dy(n){let e,t;return e=new Ay({props:{link:n[1],params:n[0].groups}}),{c(){F(e.$$.fragment)},m(i,l){q(e,i,l),t=!0},p(i,l){const s={};l&2&&(s.link=i[1]),l&1&&(s.params=i[0].groups),e.$set(s)},i(i){t||(E(e.$$.fragment,i),t=!0)},o(i){j(e.$$.fragment,i),t=!1},d(i){$(e,i)}}}function My(n){let e;return{c(){e=w("div"),e.innerHTML='<div class="placeholder-block"><figure class="icon"><i class="iconoir-pen-tablet"></i></figure> <h5 class="title txt-hint">The project doesn&#39;t have any prototypes yet.</h5></div>',p(e,"class","wrapper wrapper-sm m-t-auto m-b-auto")},m(t,i){k(t,e,i)},p:Q,i:Q,o:Q,d(t){t&&v(e)}}}function Ry(n){let e;return{c(){e=w("span"),p(e,"class","loader m-t-auto m-b-auto")},m(t,i){k(t,e,i)},p:Q,i:Q,o:Q,d(t){t&&v(e)}}}function Hy(n){let e,t,i,l,s,r,o,a,u,f,c,d,m,h,_;return a=new Ce({props:{class:"form-field form-field-lg",name:"password",$$slots:{default:[Uy,({uniqueId:b})=>({15:b}),({uniqueId:b})=>b?32768:0]},$$scope:{ctx:n}}}),{c(){e=w("div"),t=I(),i=w("div"),l=w("div"),s=w("h4"),s.textContent="The project link is password protected",r=I(),o=w("form"),F(a.$$.fragment),u=I(),f=w("button"),f.innerHTML='<span class="txt">View project</span> <i class="iconoir-arrow-right"></i>',c=I(),d=w("div"),p(e,"class","flex-fill"),p(s,"class","m-b-base"),p(f,"type","submit"),p(f,"class","btn btn-block btn-lg btn-primary btn-next"),B(f,"btn-disabled",n[4]),B(f,"btn-loading",n[4]),p(o,"class","panel-content"),p(l,"class","panel"),p(i,"class","wrapper wrapper-sm m-b-base entrance-top"),p(d,"class","flex-fill")},m(b,g){k(b,e,g),k(b,t,g),k(b,i,g),y(i,l),y(l,s),y(l,r),y(l,o),q(a,o,null),y(o,u),y(o,f),k(b,c,g),k(b,d,g),m=!0,h||(_=H(o,"submit",we(n[14])),h=!0)},p(b,g){const T={};g&98308&&(T.$$scope={dirty:g,ctx:b}),a.$set(T),(!m||g&16)&&B(f,"btn-disabled",b[4]),(!m||g&16)&&B(f,"btn-loading",b[4])},i(b){m||(E(a.$$.fragment,b),m=!0)},o(b){j(a.$$.fragment,b),m=!1},d(b){b&&(v(e),v(t),v(i),v(c),v(d)),$(a),h=!1,_()}}}function Uy(n){let e,t,i,l,s,r,o,a,u;return{c(){e=w("div"),t=w("label"),i=w("i"),s=I(),r=w("input"),p(i,"class","iconoir-lock"),p(t,"for",l=n[15]),p(t,"class","addon prefix"),r.required=!0,r.autofocus=!0,p(r,"type","password"),p(r,"id",o=n[15]),p(r,"placeholder","Password"),p(e,"class","field-group m-b-10")},m(f,c){k(f,e,c),y(e,t),y(t,i),y(e,s),y(e,r),ge(r,n[2]),r.focus(),a||(u=[be(Oe.call(null,t,{position:"left",text:"Password"})),H(r,"input",n[13])],a=!0)},p(f,c){c&32768&&l!==(l=f[15])&&p(t,"for",l),c&32768&&o!==(o=f[15])&&p(r,"id",o),c&4&&r.value!==f[2]&&ge(r,f[2])},d(f){f&&v(e),a=!1,me(u)}}}function qy(n){let e,t,i,l;const s=[Hy,Ry,My,Dy],r=[];function o(a,u){return a[3]?0:a[4]?1:a[6].length?3:2}return e=o(n),t=r[e]=s[e](n),{c(){t.c(),i=De()},m(a,u){r[e].m(a,u),k(a,i,u),l=!0},p(a,u){let f=e;e=o(a),e===f?r[e].p(a,u):(ae(),j(r[f],1,1,()=>{r[f]=null}),ue(),t=r[e],t?t.p(a,u):(t=r[e]=s[e](a),t.c()),E(t,1),t.m(i.parentNode,i))},i(a){l||(E(t),l=!0)},o(a){j(t),l=!1},d(a){a&&v(i),r[e].d(a)}}}function $y(n){let e,t;return e=new Ni({props:{fullpage:!0,class:"screen-preview-layout screen-preview-mode-"+n[7]+" "+(n[7]==Te.comments&&n[8]?"screen-preview-comment-popover-active":""),header:!1,footer:!1,title:n[5],$$slots:{default:[qy]},$$scope:{ctx:n}}}),{c(){F(e.$$.fragment)},m(i,l){q(e,i,l),t=!0},p(i,[l]){const s={};l&384&&(s.class="screen-preview-layout screen-preview-mode-"+i[7]+" "+(i[7]==Te.comments&&i[8]?"screen-preview-comment-popover-active":"")),l&32&&(s.title=i[5]),l&65631&&(s.$$scope={dirty:l,ctx:i}),e.$set(s)},i(i){t||(E(e.$$.fragment,i),t=!0)},o(i){j(e.$$.fragment,i),t=!1},d(i){$(e,i)}}}function Fy(n,e,t){let i,l,s,r,o,a,u;ee(n,Ft,T=>t(6,l=T)),ee(n,Ct,T=>t(10,s=T)),ee(n,cn,T=>t(11,r=T)),ee(n,Ke,T=>t(12,o=T)),ee(n,ji,T=>t(7,a=T)),ee(n,Wt,T=>t(8,u=T));let{params:f}=e,c,d=" ",m=!1,h=!0;_();async function _(){var L,O,C,S,P,R,A,D,M,Z,Y;t(4,h=!0),Kl(),tr();const T=Uh(f.groups.linkSlug);try{const z={expand:"project.users,project.prototypes_via_project"};if(T.authStore.isValid&&((L=T.authStore.record)==null?void 0:L.collectionName)=="links"&&((O=T.authStore.record)==null?void 0:O.username)==f.groups.linkSlug)try{const N=await T.collection("links").authRefresh(z);t(1,c=N.record)}catch{T.authStore.clear();const W=await T.collection("links").authWithPassword(f.groups.linkSlug,d,z);t(1,c=W.record)}else{const N=await T.collection("links").authWithPassword(f.groups.linkSlug,d,z);t(1,c=N.record)}(!V.authStore.isValid||!((R=(S=(C=c.expand)==null?void 0:C.project)==null?void 0:S.users)!=null&&R.includes((P=V.authStore.record)==null?void 0:P.id)))&&V.initStore(f.groups.linkSlug),Xn((A=c.expand)==null?void 0:A.project),ke(Ft,l=((Z=(M=(D=c.expand)==null?void 0:D.project)==null?void 0:M.expand)==null?void 0:Z.prototypes_via_project)||[],l),l.find(N=>N.id==f.groups.prototypeId)?ke(Ct,s=f.groups.prototypeId,s):ke(Ct,s=(Y=l[l.length-1])==null?void 0:Y.id,s),t(3,m=!1),t(4,h=!1)}catch(z){if(z.isAbort)return;t(2,d=""),t(4,h=!1),m?Gs("Invalid password."):t(3,m=!0)}}function b(){d=this.value,t(2,d)}const g=()=>_();return n.$$set=T=>{"params"in T&&t(0,f=T.params)},n.$$.update=()=>{n.$$.dirty&7168&&t(5,i=[o?"Preview "+o.title:null,s==null?void 0:s.title,r==null?void 0:r.title].filter(Boolean).join(" - "))},[f,c,d,m,h,i,l,a,u,_,s,r,o,b,g]}class Wy extends ve{constructor(e){super(),ye(this,e,Fy,$y,_e,{params:0})}}const Qt=new Map;Qt.set("/login",sn({component:q_,conditions:[n=>!V.authStore.isValid]}));Qt.set("/register",sn({component:Q_,conditions:[n=>!V.authStore.isValid]}));Qt.set("/confirm-verification/:token",sn({asyncComponent:()=>$l(()=>import("./PageConfirmVerification-CCLbDb5z.js"),[],import.meta.url)}));Qt.set("/forgotten-password",sn({asyncComponent:()=>$l(()=>import("./PageRequestPasswordReset-B1ynqtqL.js"),[],import.meta.url),conditions:[n=>!V.authStore.isValid]}));Qt.set("/confirm-password-reset/:token",sn({asyncComponent:()=>$l(()=>import("./PageConfirmPasswordReset-Cl-CN0nA.js"),[],import.meta.url)}));Qt.set("/confirm-email-change/:token",sn({asyncComponent:()=>$l(()=>import("./PageConfirmEmailChange-DAbrN-Y9.js"),[],import.meta.url)}));Qt.set("/projects",sn({component:eb,conditions:[n=>V.authStore.isValid]}));Qt.set("/projects/:projectId/prototypes/:prototypeId?",sn({component:Y0,conditions:[n=>V.authStore.isValid]}));Qt.set("/projects/:projectId/prototypes/:prototypeId/screens/:screenId?",sn({component:dy,conditions:[n=>V.authStore.isValid]}));Qt.set(/^\/(?<linkSlug>[\w\.\-]+)(\/?|(\/prototypes\/(?<prototypeId>\w+)(\/screens\/(?<screenId>\w+))?))$/,sn({component:Wy}));Qt.set("*",sn({component:$h}));function Lf(n,e,t){const i=n.slice();return i[2]=e[t],i}function Vy(n){let e;return{c(){e=w("i"),p(e,"class","iconoir-warning-triangle")},m(t,i){k(t,e,i)},d(t){t&&v(e)}}}function zy(n){let e;return{c(){e=w("i"),p(e,"class","iconoir-warning-circle")},m(t,i){k(t,e,i)},d(t){t&&v(e)}}}function By(n){let e;return{c(){e=w("i"),p(e,"class","iconoir-check-circle")},m(t,i){k(t,e,i)},d(t){t&&v(e)}}}function Zy(n){let e;return{c(){e=w("i"),p(e,"class","iconoir-info-circle")},m(t,i){k(t,e,i)},d(t){t&&v(e)}}}function If(n,e){let t,i,l,s,r=e[2].message+"",o,a,u,f,c,d,m,h=Q,_,b,g;function T(S,P){return S[2].type==="info"?Zy:S[2].type==="success"?By:S[2].type==="warning"?zy:Vy}let L=T(e),O=L(e);function C(){return e[1](e[2])}return{key:n,first:null,c(){t=w("div"),i=w("div"),O.c(),l=I(),s=w("div"),o=te(r),a=I(),u=w("button"),u.innerHTML='<i class="iconoir-xmark"></i>',f=I(),p(i,"class","icon"),p(s,"class","content"),p(u,"type","button"),p(u,"class","close"),p(t,"class","alert txt-break"),B(t,"alert-info",e[2].type=="info"),B(t,"alert-success",e[2].type=="success"),B(t,"alert-danger",e[2].type=="error"),B(t,"alert-warning",e[2].type=="warning"),this.first=t},m(S,P){k(S,t,P),y(t,i),O.m(i,null),y(t,l),y(t,s),y(s,o),y(t,a),y(t,u),y(t,f),_=!0,b||(g=H(u,"click",we(C)),b=!0)},p(S,P){e=S,L!==(L=T(e))&&(O.d(1),O=L(e),O&&(O.c(),O.m(i,null))),(!_||P&1)&&r!==(r=e[2].message+"")&&Se(o,r),(!_||P&1)&&B(t,"alert-info",e[2].type=="info"),(!_||P&1)&&B(t,"alert-success",e[2].type=="success"),(!_||P&1)&&B(t,"alert-danger",e[2].type=="error"),(!_||P&1)&&B(t,"alert-warning",e[2].type=="warning")},r(){m=t.getBoundingClientRect()},f(){qf(t),h(),$f(t,m)},a(){h(),h=Uf(t,m,vd,{duration:150})},i(S){_||(S&&kt(()=>{_&&(d&&d.end(1),c=zf(t,Et,{duration:150}),c.start())}),_=!0)},o(S){c&&c.invalidate(),S&&(d=Bf(t,Os,{duration:150})),_=!1},d(S){S&&v(t),O.d(),S&&d&&d.end(),b=!1,g()}}}function Yy(n){let e,t=[],i=new Map,l,s=Le(n[0]);const r=o=>o[2].message;for(let o=0;o<s.length;o+=1){let a=Lf(n,s,o),u=r(a);i.set(u,t[o]=If(u,a))}return{c(){e=w("div");for(let o=0;o<t.length;o+=1)t[o].c();p(e,"class","toasts-wrapper")},m(o,a){k(o,e,a);for(let u=0;u<t.length;u+=1)t[u]&&t[u].m(e,null);l=!0},p(o,[a]){if(a&1){s=Le(o[0]),ae();for(let u=0;u<t.length;u+=1)t[u].r();t=St(t,a,r,1,o,s,i,e,Yf,If,null,Lf);for(let u=0;u<t.length;u+=1)t[u].a();ue()}},i(o){if(!l){for(let a=0;a<s.length;a+=1)E(t[a]);l=!0}},o(o){for(let a=0;a<t.length;a+=1)j(t[a]);l=!1},d(o){o&&v(e);for(let a=0;a<t.length;a+=1)t[a].d()}}}function Ky(n,e,t){let i;return ee(n,Zl,s=>t(0,i=s)),[i,s=>nd(s)]}class Gy extends ve{constructor(e){super(),ye(this,e,Ky,Yy,_e,{})}}function Jy(n){var l;let e,t=((l=n[1])==null?void 0:l.text)+"",i;return{c(){e=w("h4"),i=te(t),p(e,"class","block center txt-break"),p(e,"slot","header")},m(s,r){k(s,e,r),y(e,i)},p(s,r){var o;r&2&&t!==(t=((o=s[1])==null?void 0:o.text)+"")&&Se(i,t)},d(s){s&&v(e)}}}function Xy(n){let e,t,i,l,s,r,o,a,u,f;return{c(){e=w("div"),t=w("div"),i=w("button"),l=w("span"),l.textContent="No",s=I(),r=w("div"),o=w("button"),a=w("span"),a.textContent="Yes",p(l,"class","txt"),i.autofocus=!0,p(i,"type","button"),p(i,"class","btn btn-semitransparent btn-block"),i.disabled=n[2],p(t,"class","col-6"),p(a,"class","txt"),p(o,"type","button"),p(o,"class","btn btn-warning btn-block"),o.disabled=n[2],B(o,"btn-loading",n[2]),p(r,"class","col-6"),p(e,"class","grid")},m(c,d){k(c,e,d),y(e,t),y(t,i),y(i,l),y(e,s),y(e,r),y(r,o),y(o,a),i.focus(),u||(f=[H(i,"click",n[4]),H(o,"click",n[5])],u=!0)},p(c,d){d&4&&(i.disabled=c[2]),d&4&&(o.disabled=c[2]),d&4&&B(o,"btn-loading",c[2])},d(c){c&&v(e),u=!1,me(f)}}}function Qy(n){let e,t,i={class:"confirm-popup hide-content overlay-panel-sm",overlayClose:!n[2],escHide:!n[2],btnClose:!1,popup:!0,$$slots:{footer:[Xy],header:[Jy]},$$scope:{ctx:n}};return e=new mn({props:i}),n[6](e),e.$on("hide",n[7]),{c(){F(e.$$.fragment)},m(l,s){q(e,l,s),t=!0},p(l,[s]){const r={};s&4&&(r.overlayClose=!l[2]),s&4&&(r.escHide=!l[2]),s&271&&(r.$$scope={dirty:s,ctx:l}),e.$set(r)},i(l){t||(E(e.$$.fragment,l),t=!0)},o(l){j(e.$$.fragment,l),t=!1},d(l){n[6](null),$(e,l)}}}function xy(n,e,t){let i;ee(n,nr,c=>t(1,i=c));let l,s=!1,r=!1;const o=()=>{t(3,r=!1),l==null||l.hide()},a=async()=>{i!=null&&i.yesCallback&&(t(2,s=!0),await Promise.resolve(i.yesCallback()),t(2,s=!1)),t(3,r=!0),l==null||l.hide()};function u(c){le[c?"unshift":"push"](()=>{l=c,t(0,l)})}const f=async()=>{!r&&(i!=null&&i.noCallback)&&i.noCallback(),await Ot(),t(3,r=!1),sd()};return n.$$.update=()=>{n.$$.dirty&3&&i!=null&&i.text&&(t(3,r=!1),l==null||l.show())},[l,i,s,r,o,a,u,f]}class ev extends ve{constructor(e){super(),ye(this,e,xy,Qy,_e,{})}}function tv(n){let e,t,i,l,s,r;return e=new _p({props:{routes:Qt}}),e.$on("routeLoading",n[0]),e.$on("conditionsFailed",n[1]),i=new Gy({}),s=new ev({}),{c(){F(e.$$.fragment),t=I(),F(i.$$.fragment),l=I(),F(s.$$.fragment)},m(o,a){q(e,o,a),k(o,t,a),q(i,o,a),k(o,l,a),q(s,o,a),r=!0},p:Q,i(o){r||(E(e.$$.fragment,o),E(i.$$.fragment,o),E(s.$$.fragment,o),r=!0)},o(o){j(e.$$.fragment,o),j(i.$$.fragment,o),j(s.$$.fragment,o),r=!1},d(o){o&&(v(t),v(l)),$(e,o),$(i,o),$(s,o)}}}function nv(n,e,t){let i;ee(n,vi,a=>t(3,i=a));let l;function s(a){a.detail.location!==l&&(l=a.detail.location,Jt({}),sd())}function r(){V.authStore.isValid||V.rememberPath(),Yt("/")}async function o(){try{ke(vi,i=await V.send("/api/pr/options"),i)}catch(a){console.log("failed to load options:",a)}}return o(),gn(()=>{V.authStore.onChange(a=>{a?i1():Vn==null||Vn()})}),[s,r]}class iv extends ve{constructor(e){super(),ye(this,e,nv,tv,_e,{})}}new iv({target:document.getElementById("app")});export{te as A,Se as B,Q as C,ge as D,Oe as E,Ce as F,hi as G,Ni as L,ve as S,j as a,_t as b,F as c,$ as d,Yt as e,xs as f,w as g,I as h,ye as i,p as j,k,y as l,q as m,v as n,H as o,V as p,we as q,Ji as r,_e as s,E as t,be as u,Oi as v,ae as w,ue as x,me as y,B as z};
